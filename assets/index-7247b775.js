var tp=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var Z=(t,e,n)=>(tp(t,e,"read from private field"),n?n.call(t):e.get(t)),Fe=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},st=(t,e,n,r)=>(tp(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var vt=(t,e,n)=>(tp(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function $k(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var yS={exports:{}},Bh={},vS={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wc=Symbol.for("react.element"),Wk=Symbol.for("react.portal"),qk=Symbol.for("react.fragment"),Hk=Symbol.for("react.strict_mode"),Gk=Symbol.for("react.profiler"),Kk=Symbol.for("react.provider"),Qk=Symbol.for("react.context"),Yk=Symbol.for("react.forward_ref"),Xk=Symbol.for("react.suspense"),Jk=Symbol.for("react.memo"),Zk=Symbol.for("react.lazy"),l1=Symbol.iterator;function eA(t){return t===null||typeof t!="object"?null:(t=l1&&t[l1]||t["@@iterator"],typeof t=="function"?t:null)}var xS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wS=Object.assign,_S={};function Qa(t,e,n){this.props=t,this.context=e,this.refs=_S,this.updater=n||xS}Qa.prototype.isReactComponent={};Qa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Qa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function SS(){}SS.prototype=Qa.prototype;function ey(t,e,n){this.props=t,this.context=e,this.refs=_S,this.updater=n||xS}var ty=ey.prototype=new SS;ty.constructor=ey;wS(ty,Qa.prototype);ty.isPureReactComponent=!0;var c1=Array.isArray,TS=Object.prototype.hasOwnProperty,ny={current:null},ES={key:!0,ref:!0,__self:!0,__source:!0};function bS(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)TS.call(e,r)&&!ES.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Wc,type:t,key:s,ref:o,props:i,_owner:ny.current}}function tA(t,e){return{$$typeof:Wc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ry(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wc}function nA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var u1=/\/+/g;function np(t,e){return typeof t=="object"&&t!==null&&t.key!=null?nA(""+t.key):e.toString(36)}function rd(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Wc:case Wk:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+np(o,0):r,c1(i)?(n="",t!=null&&(n=t.replace(u1,"$&/")+"/"),rd(i,e,n,"",function(d){return d})):i!=null&&(ry(i)&&(i=tA(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(u1,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",c1(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+np(s,a);o+=rd(s,e,n,l,i)}else if(l=eA(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+np(s,a++),o+=rd(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function bu(t,e,n){if(t==null)return t;var r=[],i=0;return rd(t,r,"","",function(s){return e.call(n,s,i++)}),r}function rA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var wn={current:null},id={transition:null},iA={ReactCurrentDispatcher:wn,ReactCurrentBatchConfig:id,ReactCurrentOwner:ny};function IS(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:bu,forEach:function(t,e,n){bu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return bu(t,function(){e++}),e},toArray:function(t){return bu(t,function(e){return e})||[]},only:function(t){if(!ry(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Le.Component=Qa;Le.Fragment=qk;Le.Profiler=Gk;Le.PureComponent=ey;Le.StrictMode=Hk;Le.Suspense=Xk;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iA;Le.act=IS;Le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=wS({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=ny.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)TS.call(e,l)&&!ES.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:Wc,type:t.type,key:i,ref:s,props:r,_owner:o}};Le.createContext=function(t){return t={$$typeof:Qk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Kk,_context:t},t.Consumer=t};Le.createElement=bS;Le.createFactory=function(t){var e=bS.bind(null,t);return e.type=t,e};Le.createRef=function(){return{current:null}};Le.forwardRef=function(t){return{$$typeof:Yk,render:t}};Le.isValidElement=ry;Le.lazy=function(t){return{$$typeof:Zk,_payload:{_status:-1,_result:t},_init:rA}};Le.memo=function(t,e){return{$$typeof:Jk,type:t,compare:e===void 0?null:e}};Le.startTransition=function(t){var e=id.transition;id.transition={};try{t()}finally{id.transition=e}};Le.unstable_act=IS;Le.useCallback=function(t,e){return wn.current.useCallback(t,e)};Le.useContext=function(t){return wn.current.useContext(t)};Le.useDebugValue=function(){};Le.useDeferredValue=function(t){return wn.current.useDeferredValue(t)};Le.useEffect=function(t,e){return wn.current.useEffect(t,e)};Le.useId=function(){return wn.current.useId()};Le.useImperativeHandle=function(t,e,n){return wn.current.useImperativeHandle(t,e,n)};Le.useInsertionEffect=function(t,e){return wn.current.useInsertionEffect(t,e)};Le.useLayoutEffect=function(t,e){return wn.current.useLayoutEffect(t,e)};Le.useMemo=function(t,e){return wn.current.useMemo(t,e)};Le.useReducer=function(t,e,n){return wn.current.useReducer(t,e,n)};Le.useRef=function(t){return wn.current.useRef(t)};Le.useState=function(t){return wn.current.useState(t)};Le.useSyncExternalStore=function(t,e,n){return wn.current.useSyncExternalStore(t,e,n)};Le.useTransition=function(){return wn.current.useTransition()};Le.version="18.3.1";vS.exports=Le;var R=vS.exports;const lr=$k(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sA=R,oA=Symbol.for("react.element"),aA=Symbol.for("react.fragment"),lA=Object.prototype.hasOwnProperty,cA=sA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,uA={key:!0,ref:!0,__self:!0,__source:!0};function CS(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)lA.call(e,r)&&!uA.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:oA,type:t,key:s,ref:o,props:i,_owner:cA.current}}Bh.Fragment=aA;Bh.jsx=CS;Bh.jsxs=CS;yS.exports=Bh;var u=yS.exports,um={},kS={exports:{}},qn={},AS={exports:{}},RS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,G){var M=z.length;z.push(G);e:for(;0<M;){var D=M-1>>>1,H=z[D];if(0<i(H,G))z[D]=G,z[M]=H,M=D;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var G=z[0],M=z.pop();if(M!==G){z[0]=M;e:for(var D=0,H=z.length,J=H>>>1;D<J;){var te=2*(D+1)-1,ie=z[te],ee=te+1,U=z[ee];if(0>i(ie,M))ee<H&&0>i(U,ie)?(z[D]=U,z[ee]=M,D=ee):(z[D]=ie,z[te]=M,D=te);else if(ee<H&&0>i(U,M))z[D]=U,z[ee]=M,D=ee;else break e}}return G}function i(z,G){var M=z.sortIndex-G.sortIndex;return M!==0?M:z.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,f=null,p=3,g=!1,x=!1,_=!1,k=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(z){for(var G=n(d);G!==null;){if(G.callback===null)r(d);else if(G.startTime<=z)r(d),G.sortIndex=G.expirationTime,e(l,G);else break;G=n(d)}}function j(z){if(_=!1,w(z),!x)if(n(l)!==null)x=!0,re(L);else{var G=n(d);G!==null&&se(j,G.startTime-z)}}function L(z,G){x=!1,_&&(_=!1,T(S),S=-1),g=!0;var M=p;try{for(w(G),f=n(l);f!==null&&(!(f.expirationTime>G)||z&&!P());){var D=f.callback;if(typeof D=="function"){f.callback=null,p=f.priorityLevel;var H=D(f.expirationTime<=G);G=t.unstable_now(),typeof H=="function"?f.callback=H:f===n(l)&&r(l),w(G)}else r(l);f=n(l)}if(f!==null)var J=!0;else{var te=n(d);te!==null&&se(j,te.startTime-G),J=!1}return J}finally{f=null,p=M,g=!1}}var V=!1,E=null,S=-1,I=5,A=-1;function P(){return!(t.unstable_now()-A<I)}function N(){if(E!==null){var z=t.unstable_now();A=z;var G=!0;try{G=E(!0,z)}finally{G?b():(V=!1,E=null)}}else V=!1}var b;if(typeof v=="function")b=function(){v(N)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,de=W.port2;W.port1.onmessage=N,b=function(){de.postMessage(null)}}else b=function(){k(N,0)};function re(z){E=z,V||(V=!0,b())}function se(z,G){S=k(function(){z(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){x||g||(x=!0,re(L))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(z){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var M=p;p=G;try{return z()}finally{p=M}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,G){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var M=p;p=z;try{return G()}finally{p=M}},t.unstable_scheduleCallback=function(z,G,M){var D=t.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?D+M:D):M=D,z){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=M+H,z={id:h++,callback:G,priorityLevel:z,startTime:M,expirationTime:H,sortIndex:-1},M>D?(z.sortIndex=M,e(d,z),n(l)===null&&z===n(d)&&(_?(T(S),S=-1):_=!0,se(j,M-D))):(z.sortIndex=H,e(l,z),x||g||(x=!0,re(L))),z},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(z){var G=p;return function(){var M=p;p=G;try{return z.apply(this,arguments)}finally{p=M}}}})(RS);AS.exports=RS;var dA=AS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hA=R,$n=dA;function Q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var PS=new Set,sc={};function Io(t,e){Ra(t,e),Ra(t+"Capture",e)}function Ra(t,e){for(sc[t]=e,t=0;t<e.length;t++)PS.add(e[t])}var gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dm=Object.prototype.hasOwnProperty,fA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d1={},h1={};function pA(t){return dm.call(h1,t)?!0:dm.call(d1,t)?!1:fA.test(t)?h1[t]=!0:(d1[t]=!0,!1)}function mA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function gA(t,e,n,r){if(e===null||typeof e>"u"||mA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function _n(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Yt[t]=new _n(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Yt[e]=new _n(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Yt[t]=new _n(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Yt[t]=new _n(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Yt[t]=new _n(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Yt[t]=new _n(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Yt[t]=new _n(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Yt[t]=new _n(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Yt[t]=new _n(t,5,!1,t.toLowerCase(),null,!1,!1)});var iy=/[\-:]([a-z])/g;function sy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(iy,sy);Yt[e]=new _n(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(iy,sy);Yt[e]=new _n(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(iy,sy);Yt[e]=new _n(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Yt[t]=new _n(t,1,!1,t.toLowerCase(),null,!1,!1)});Yt.xlinkHref=new _n("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Yt[t]=new _n(t,1,!1,t.toLowerCase(),null,!0,!0)});function oy(t,e,n,r){var i=Yt.hasOwnProperty(e)?Yt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(gA(e,n,i,r)&&(n=null),r||i===null?pA(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ci=hA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Iu=Symbol.for("react.element"),Qo=Symbol.for("react.portal"),Yo=Symbol.for("react.fragment"),ay=Symbol.for("react.strict_mode"),hm=Symbol.for("react.profiler"),NS=Symbol.for("react.provider"),DS=Symbol.for("react.context"),ly=Symbol.for("react.forward_ref"),fm=Symbol.for("react.suspense"),pm=Symbol.for("react.suspense_list"),cy=Symbol.for("react.memo"),Ui=Symbol.for("react.lazy"),jS=Symbol.for("react.offscreen"),f1=Symbol.iterator;function ml(t){return t===null||typeof t!="object"?null:(t=f1&&t[f1]||t["@@iterator"],typeof t=="function"?t:null)}var mt=Object.assign,rp;function kl(t){if(rp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);rp=e&&e[1]||""}return`
`+rp+t}var ip=!1;function sp(t,e){if(!t||ip)return"";ip=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{ip=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?kl(t):""}function yA(t){switch(t.tag){case 5:return kl(t.type);case 16:return kl("Lazy");case 13:return kl("Suspense");case 19:return kl("SuspenseList");case 0:case 2:case 15:return t=sp(t.type,!1),t;case 11:return t=sp(t.type.render,!1),t;case 1:return t=sp(t.type,!0),t;default:return""}}function mm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Yo:return"Fragment";case Qo:return"Portal";case hm:return"Profiler";case ay:return"StrictMode";case fm:return"Suspense";case pm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case DS:return(t.displayName||"Context")+".Consumer";case NS:return(t._context.displayName||"Context")+".Provider";case ly:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case cy:return e=t.displayName||null,e!==null?e:mm(t.type)||"Memo";case Ui:e=t._payload,t=t._init;try{return mm(t(e))}catch{}}return null}function vA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mm(e);case 8:return e===ay?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function xs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function LS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function xA(t){var e=LS(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Cu(t){t._valueTracker||(t._valueTracker=xA(t))}function MS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=LS(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Pd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gm(t,e){var n=e.checked;return mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function p1(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=xs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function VS(t,e){e=e.checked,e!=null&&oy(t,"checked",e,!1)}function ym(t,e){VS(t,e);var n=xs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?vm(t,e.type,n):e.hasOwnProperty("defaultValue")&&vm(t,e.type,xs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function m1(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function vm(t,e,n){(e!=="number"||Pd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Al=Array.isArray;function fa(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+xs(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function xm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Q(91));return mt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function g1(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Q(92));if(Al(n)){if(1<n.length)throw Error(Q(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:xs(n)}}function OS(t,e){var n=xs(e.value),r=xs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function y1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function FS(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?FS(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ku,zS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ku=ku||document.createElement("div"),ku.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ku.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function oc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ol={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wA=["Webkit","ms","Moz","O"];Object.keys(Ol).forEach(function(t){wA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ol[e]=Ol[t]})});function US(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ol.hasOwnProperty(t)&&Ol[t]?(""+e).trim():e+"px"}function BS(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=US(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var _A=mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _m(t,e){if(e){if(_A[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Q(62))}}function Sm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tm=null;function uy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Em=null,pa=null,ma=null;function v1(t){if(t=Gc(t)){if(typeof Em!="function")throw Error(Q(280));var e=t.stateNode;e&&(e=Gh(e),Em(t.stateNode,t.type,e))}}function $S(t){pa?ma?ma.push(t):ma=[t]:pa=t}function WS(){if(pa){var t=pa,e=ma;if(ma=pa=null,v1(t),e)for(t=0;t<e.length;t++)v1(e[t])}}function qS(t,e){return t(e)}function HS(){}var op=!1;function GS(t,e,n){if(op)return t(e,n);op=!0;try{return qS(t,e,n)}finally{op=!1,(pa!==null||ma!==null)&&(HS(),WS())}}function ac(t,e){var n=t.stateNode;if(n===null)return null;var r=Gh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Q(231,e,typeof n));return n}var bm=!1;if(gi)try{var gl={};Object.defineProperty(gl,"passive",{get:function(){bm=!0}}),window.addEventListener("test",gl,gl),window.removeEventListener("test",gl,gl)}catch{bm=!1}function SA(t,e,n,r,i,s,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Fl=!1,Nd=null,Dd=!1,Im=null,TA={onError:function(t){Fl=!0,Nd=t}};function EA(t,e,n,r,i,s,o,a,l){Fl=!1,Nd=null,SA.apply(TA,arguments)}function bA(t,e,n,r,i,s,o,a,l){if(EA.apply(this,arguments),Fl){if(Fl){var d=Nd;Fl=!1,Nd=null}else throw Error(Q(198));Dd||(Dd=!0,Im=d)}}function Co(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function KS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function x1(t){if(Co(t)!==t)throw Error(Q(188))}function IA(t){var e=t.alternate;if(!e){if(e=Co(t),e===null)throw Error(Q(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return x1(i),t;if(s===r)return x1(i),e;s=s.sibling}throw Error(Q(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(Q(189))}}if(n.alternate!==r)throw Error(Q(190))}if(n.tag!==3)throw Error(Q(188));return n.stateNode.current===n?t:e}function QS(t){return t=IA(t),t!==null?YS(t):null}function YS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=YS(t);if(e!==null)return e;t=t.sibling}return null}var XS=$n.unstable_scheduleCallback,w1=$n.unstable_cancelCallback,CA=$n.unstable_shouldYield,kA=$n.unstable_requestPaint,bt=$n.unstable_now,AA=$n.unstable_getCurrentPriorityLevel,dy=$n.unstable_ImmediatePriority,JS=$n.unstable_UserBlockingPriority,jd=$n.unstable_NormalPriority,RA=$n.unstable_LowPriority,ZS=$n.unstable_IdlePriority,$h=null,Br=null;function PA(t){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot($h,t,void 0,(t.current.flags&128)===128)}catch{}}var _r=Math.clz32?Math.clz32:jA,NA=Math.log,DA=Math.LN2;function jA(t){return t>>>=0,t===0?32:31-(NA(t)/DA|0)|0}var Au=64,Ru=4194304;function Rl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ld(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Rl(a):(s&=o,s!==0&&(r=Rl(s)))}else o=n&~i,o!==0?r=Rl(o):s!==0&&(r=Rl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-_r(e),i=1<<n,r|=t[n],e&=~i;return r}function LA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function MA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-_r(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=LA(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Cm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function eT(){var t=Au;return Au<<=1,!(Au&4194240)&&(Au=64),t}function ap(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function qc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-_r(e),t[e]=n}function VA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-_r(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function hy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-_r(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var qe=0;function tT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var nT,fy,rT,iT,sT,km=!1,Pu=[],is=null,ss=null,os=null,lc=new Map,cc=new Map,Wi=[],OA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _1(t,e){switch(t){case"focusin":case"focusout":is=null;break;case"dragenter":case"dragleave":ss=null;break;case"mouseover":case"mouseout":os=null;break;case"pointerover":case"pointerout":lc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":cc.delete(e.pointerId)}}function yl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Gc(e),e!==null&&fy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function FA(t,e,n,r,i){switch(e){case"focusin":return is=yl(is,t,e,n,r,i),!0;case"dragenter":return ss=yl(ss,t,e,n,r,i),!0;case"mouseover":return os=yl(os,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return lc.set(s,yl(lc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,cc.set(s,yl(cc.get(s)||null,t,e,n,r,i)),!0}return!1}function oT(t){var e=Js(t.target);if(e!==null){var n=Co(e);if(n!==null){if(e=n.tag,e===13){if(e=KS(n),e!==null){t.blockedOn=e,sT(t.priority,function(){rT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function sd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Am(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Tm=r,n.target.dispatchEvent(r),Tm=null}else return e=Gc(n),e!==null&&fy(e),t.blockedOn=n,!1;e.shift()}return!0}function S1(t,e,n){sd(t)&&n.delete(e)}function zA(){km=!1,is!==null&&sd(is)&&(is=null),ss!==null&&sd(ss)&&(ss=null),os!==null&&sd(os)&&(os=null),lc.forEach(S1),cc.forEach(S1)}function vl(t,e){t.blockedOn===e&&(t.blockedOn=null,km||(km=!0,$n.unstable_scheduleCallback($n.unstable_NormalPriority,zA)))}function uc(t){function e(i){return vl(i,t)}if(0<Pu.length){vl(Pu[0],t);for(var n=1;n<Pu.length;n++){var r=Pu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(is!==null&&vl(is,t),ss!==null&&vl(ss,t),os!==null&&vl(os,t),lc.forEach(e),cc.forEach(e),n=0;n<Wi.length;n++)r=Wi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Wi.length&&(n=Wi[0],n.blockedOn===null);)oT(n),n.blockedOn===null&&Wi.shift()}var ga=Ci.ReactCurrentBatchConfig,Md=!0;function UA(t,e,n,r){var i=qe,s=ga.transition;ga.transition=null;try{qe=1,py(t,e,n,r)}finally{qe=i,ga.transition=s}}function BA(t,e,n,r){var i=qe,s=ga.transition;ga.transition=null;try{qe=4,py(t,e,n,r)}finally{qe=i,ga.transition=s}}function py(t,e,n,r){if(Md){var i=Am(t,e,n,r);if(i===null)yp(t,e,r,Vd,n),_1(t,r);else if(FA(i,t,e,n,r))r.stopPropagation();else if(_1(t,r),e&4&&-1<OA.indexOf(t)){for(;i!==null;){var s=Gc(i);if(s!==null&&nT(s),s=Am(t,e,n,r),s===null&&yp(t,e,r,Vd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else yp(t,e,r,null,n)}}var Vd=null;function Am(t,e,n,r){if(Vd=null,t=uy(r),t=Js(t),t!==null)if(e=Co(t),e===null)t=null;else if(n=e.tag,n===13){if(t=KS(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Vd=t,null}function aT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(AA()){case dy:return 1;case JS:return 4;case jd:case RA:return 16;case ZS:return 536870912;default:return 16}default:return 16}}var es=null,my=null,od=null;function lT(){if(od)return od;var t,e=my,n=e.length,r,i="value"in es?es.value:es.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return od=i.slice(t,1<r?1-r:void 0)}function ad(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Nu(){return!0}function T1(){return!1}function Hn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Nu:T1,this.isPropagationStopped=T1,this}return mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Nu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Nu)},persist:function(){},isPersistent:Nu}),e}var Ya={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gy=Hn(Ya),Hc=mt({},Ya,{view:0,detail:0}),$A=Hn(Hc),lp,cp,xl,Wh=mt({},Hc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==xl&&(xl&&t.type==="mousemove"?(lp=t.screenX-xl.screenX,cp=t.screenY-xl.screenY):cp=lp=0,xl=t),lp)},movementY:function(t){return"movementY"in t?t.movementY:cp}}),E1=Hn(Wh),WA=mt({},Wh,{dataTransfer:0}),qA=Hn(WA),HA=mt({},Hc,{relatedTarget:0}),up=Hn(HA),GA=mt({},Ya,{animationName:0,elapsedTime:0,pseudoElement:0}),KA=Hn(GA),QA=mt({},Ya,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),YA=Hn(QA),XA=mt({},Ya,{data:0}),b1=Hn(XA),JA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ZA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=eR[t])?!!e[t]:!1}function yy(){return tR}var nR=mt({},Hc,{key:function(t){if(t.key){var e=JA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ad(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ZA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yy,charCode:function(t){return t.type==="keypress"?ad(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ad(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),rR=Hn(nR),iR=mt({},Wh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),I1=Hn(iR),sR=mt({},Hc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yy}),oR=Hn(sR),aR=mt({},Ya,{propertyName:0,elapsedTime:0,pseudoElement:0}),lR=Hn(aR),cR=mt({},Wh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),uR=Hn(cR),dR=[9,13,27,32],vy=gi&&"CompositionEvent"in window,zl=null;gi&&"documentMode"in document&&(zl=document.documentMode);var hR=gi&&"TextEvent"in window&&!zl,cT=gi&&(!vy||zl&&8<zl&&11>=zl),C1=String.fromCharCode(32),k1=!1;function uT(t,e){switch(t){case"keyup":return dR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Xo=!1;function fR(t,e){switch(t){case"compositionend":return dT(e);case"keypress":return e.which!==32?null:(k1=!0,C1);case"textInput":return t=e.data,t===C1&&k1?null:t;default:return null}}function pR(t,e){if(Xo)return t==="compositionend"||!vy&&uT(t,e)?(t=lT(),od=my=es=null,Xo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return cT&&e.locale!=="ko"?null:e.data;default:return null}}var mR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function A1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!mR[t.type]:e==="textarea"}function hT(t,e,n,r){$S(r),e=Od(e,"onChange"),0<e.length&&(n=new gy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ul=null,dc=null;function gR(t){TT(t,0)}function qh(t){var e=ea(t);if(MS(e))return t}function yR(t,e){if(t==="change")return e}var fT=!1;if(gi){var dp;if(gi){var hp="oninput"in document;if(!hp){var R1=document.createElement("div");R1.setAttribute("oninput","return;"),hp=typeof R1.oninput=="function"}dp=hp}else dp=!1;fT=dp&&(!document.documentMode||9<document.documentMode)}function P1(){Ul&&(Ul.detachEvent("onpropertychange",pT),dc=Ul=null)}function pT(t){if(t.propertyName==="value"&&qh(dc)){var e=[];hT(e,dc,t,uy(t)),GS(gR,e)}}function vR(t,e,n){t==="focusin"?(P1(),Ul=e,dc=n,Ul.attachEvent("onpropertychange",pT)):t==="focusout"&&P1()}function xR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return qh(dc)}function wR(t,e){if(t==="click")return qh(e)}function _R(t,e){if(t==="input"||t==="change")return qh(e)}function SR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var br=typeof Object.is=="function"?Object.is:SR;function hc(t,e){if(br(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!dm.call(e,i)||!br(t[i],e[i]))return!1}return!0}function N1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function D1(t,e){var n=N1(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=N1(n)}}function mT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?mT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function gT(){for(var t=window,e=Pd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Pd(t.document)}return e}function xy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function TR(t){var e=gT(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&mT(n.ownerDocument.documentElement,n)){if(r!==null&&xy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=D1(n,s);var o=D1(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ER=gi&&"documentMode"in document&&11>=document.documentMode,Jo=null,Rm=null,Bl=null,Pm=!1;function j1(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Pm||Jo==null||Jo!==Pd(r)||(r=Jo,"selectionStart"in r&&xy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Bl&&hc(Bl,r)||(Bl=r,r=Od(Rm,"onSelect"),0<r.length&&(e=new gy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Jo)))}function Du(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Zo={animationend:Du("Animation","AnimationEnd"),animationiteration:Du("Animation","AnimationIteration"),animationstart:Du("Animation","AnimationStart"),transitionend:Du("Transition","TransitionEnd")},fp={},yT={};gi&&(yT=document.createElement("div").style,"AnimationEvent"in window||(delete Zo.animationend.animation,delete Zo.animationiteration.animation,delete Zo.animationstart.animation),"TransitionEvent"in window||delete Zo.transitionend.transition);function Hh(t){if(fp[t])return fp[t];if(!Zo[t])return t;var e=Zo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in yT)return fp[t]=e[n];return t}var vT=Hh("animationend"),xT=Hh("animationiteration"),wT=Hh("animationstart"),_T=Hh("transitionend"),ST=new Map,L1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rs(t,e){ST.set(t,e),Io(e,[t])}for(var pp=0;pp<L1.length;pp++){var mp=L1[pp],bR=mp.toLowerCase(),IR=mp[0].toUpperCase()+mp.slice(1);Rs(bR,"on"+IR)}Rs(vT,"onAnimationEnd");Rs(xT,"onAnimationIteration");Rs(wT,"onAnimationStart");Rs("dblclick","onDoubleClick");Rs("focusin","onFocus");Rs("focusout","onBlur");Rs(_T,"onTransitionEnd");Ra("onMouseEnter",["mouseout","mouseover"]);Ra("onMouseLeave",["mouseout","mouseover"]);Ra("onPointerEnter",["pointerout","pointerover"]);Ra("onPointerLeave",["pointerout","pointerover"]);Io("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Io("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Io("onBeforeInput",["compositionend","keypress","textInput","paste"]);Io("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Io("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Io("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pl));function M1(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,bA(r,e,void 0,t),t.currentTarget=null}function TT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;M1(i,a,d),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;M1(i,a,d),s=l}}}if(Dd)throw t=Im,Dd=!1,Im=null,t}function ot(t,e){var n=e[Mm];n===void 0&&(n=e[Mm]=new Set);var r=t+"__bubble";n.has(r)||(ET(e,t,2,!1),n.add(r))}function gp(t,e,n){var r=0;e&&(r|=4),ET(n,t,r,e)}var ju="_reactListening"+Math.random().toString(36).slice(2);function fc(t){if(!t[ju]){t[ju]=!0,PS.forEach(function(n){n!=="selectionchange"&&(CR.has(n)||gp(n,!1,t),gp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ju]||(e[ju]=!0,gp("selectionchange",!1,e))}}function ET(t,e,n,r){switch(aT(e)){case 1:var i=UA;break;case 4:i=BA;break;default:i=py}n=i.bind(null,e,n,t),i=void 0,!bm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function yp(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Js(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}GS(function(){var d=s,h=uy(n),f=[];e:{var p=ST.get(t);if(p!==void 0){var g=gy,x=t;switch(t){case"keypress":if(ad(n)===0)break e;case"keydown":case"keyup":g=rR;break;case"focusin":x="focus",g=up;break;case"focusout":x="blur",g=up;break;case"beforeblur":case"afterblur":g=up;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=E1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=qA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=oR;break;case vT:case xT:case wT:g=KA;break;case _T:g=lR;break;case"scroll":g=$A;break;case"wheel":g=uR;break;case"copy":case"cut":case"paste":g=YA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=I1}var _=(e&4)!==0,k=!_&&t==="scroll",T=_?p!==null?p+"Capture":null:p;_=[];for(var v=d,w;v!==null;){w=v;var j=w.stateNode;if(w.tag===5&&j!==null&&(w=j,T!==null&&(j=ac(v,T),j!=null&&_.push(pc(v,j,w)))),k)break;v=v.return}0<_.length&&(p=new g(p,x,null,n,h),f.push({event:p,listeners:_}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&n!==Tm&&(x=n.relatedTarget||n.fromElement)&&(Js(x)||x[yi]))break e;if((g||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,g?(x=n.relatedTarget||n.toElement,g=d,x=x?Js(x):null,x!==null&&(k=Co(x),x!==k||x.tag!==5&&x.tag!==6)&&(x=null)):(g=null,x=d),g!==x)){if(_=E1,j="onMouseLeave",T="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(_=I1,j="onPointerLeave",T="onPointerEnter",v="pointer"),k=g==null?p:ea(g),w=x==null?p:ea(x),p=new _(j,v+"leave",g,n,h),p.target=k,p.relatedTarget=w,j=null,Js(h)===d&&(_=new _(T,v+"enter",x,n,h),_.target=w,_.relatedTarget=k,j=_),k=j,g&&x)t:{for(_=g,T=x,v=0,w=_;w;w=Oo(w))v++;for(w=0,j=T;j;j=Oo(j))w++;for(;0<v-w;)_=Oo(_),v--;for(;0<w-v;)T=Oo(T),w--;for(;v--;){if(_===T||T!==null&&_===T.alternate)break t;_=Oo(_),T=Oo(T)}_=null}else _=null;g!==null&&V1(f,p,g,_,!1),x!==null&&k!==null&&V1(f,k,x,_,!0)}}e:{if(p=d?ea(d):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var L=yR;else if(A1(p))if(fT)L=_R;else{L=xR;var V=vR}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(L=wR);if(L&&(L=L(t,d))){hT(f,L,n,h);break e}V&&V(t,p,d),t==="focusout"&&(V=p._wrapperState)&&V.controlled&&p.type==="number"&&vm(p,"number",p.value)}switch(V=d?ea(d):window,t){case"focusin":(A1(V)||V.contentEditable==="true")&&(Jo=V,Rm=d,Bl=null);break;case"focusout":Bl=Rm=Jo=null;break;case"mousedown":Pm=!0;break;case"contextmenu":case"mouseup":case"dragend":Pm=!1,j1(f,n,h);break;case"selectionchange":if(ER)break;case"keydown":case"keyup":j1(f,n,h)}var E;if(vy)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Xo?uT(t,n)&&(S="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(cT&&n.locale!=="ko"&&(Xo||S!=="onCompositionStart"?S==="onCompositionEnd"&&Xo&&(E=lT()):(es=h,my="value"in es?es.value:es.textContent,Xo=!0)),V=Od(d,S),0<V.length&&(S=new b1(S,t,null,n,h),f.push({event:S,listeners:V}),E?S.data=E:(E=dT(n),E!==null&&(S.data=E)))),(E=hR?fR(t,n):pR(t,n))&&(d=Od(d,"onBeforeInput"),0<d.length&&(h=new b1("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=E))}TT(f,e)})}function pc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Od(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ac(t,n),s!=null&&r.unshift(pc(t,s,i)),s=ac(t,e),s!=null&&r.push(pc(t,s,i))),t=t.return}return r}function Oo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function V1(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,i?(l=ac(n,s),l!=null&&o.unshift(pc(n,l,a))):i||(l=ac(n,s),l!=null&&o.push(pc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var kR=/\r\n?/g,AR=/\u0000|\uFFFD/g;function O1(t){return(typeof t=="string"?t:""+t).replace(kR,`
`).replace(AR,"")}function Lu(t,e,n){if(e=O1(e),O1(t)!==e&&n)throw Error(Q(425))}function Fd(){}var Nm=null,Dm=null;function jm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Lm=typeof setTimeout=="function"?setTimeout:void 0,RR=typeof clearTimeout=="function"?clearTimeout:void 0,F1=typeof Promise=="function"?Promise:void 0,PR=typeof queueMicrotask=="function"?queueMicrotask:typeof F1<"u"?function(t){return F1.resolve(null).then(t).catch(NR)}:Lm;function NR(t){setTimeout(function(){throw t})}function vp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),uc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);uc(e)}function as(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function z1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Xa=Math.random().toString(36).slice(2),Or="__reactFiber$"+Xa,mc="__reactProps$"+Xa,yi="__reactContainer$"+Xa,Mm="__reactEvents$"+Xa,DR="__reactListeners$"+Xa,jR="__reactHandles$"+Xa;function Js(t){var e=t[Or];if(e)return e;for(var n=t.parentNode;n;){if(e=n[yi]||n[Or]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=z1(t);t!==null;){if(n=t[Or])return n;t=z1(t)}return e}t=n,n=t.parentNode}return null}function Gc(t){return t=t[Or]||t[yi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ea(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Q(33))}function Gh(t){return t[mc]||null}var Vm=[],ta=-1;function Ps(t){return{current:t}}function lt(t){0>ta||(t.current=Vm[ta],Vm[ta]=null,ta--)}function et(t,e){ta++,Vm[ta]=t.current,t.current=e}var ws={},un=Ps(ws),Rn=Ps(!1),po=ws;function Pa(t,e){var n=t.type.contextTypes;if(!n)return ws;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Pn(t){return t=t.childContextTypes,t!=null}function zd(){lt(Rn),lt(un)}function U1(t,e,n){if(un.current!==ws)throw Error(Q(168));et(un,e),et(Rn,n)}function bT(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Q(108,vA(t)||"Unknown",i));return mt({},n,r)}function Ud(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ws,po=un.current,et(un,t),et(Rn,Rn.current),!0}function B1(t,e,n){var r=t.stateNode;if(!r)throw Error(Q(169));n?(t=bT(t,e,po),r.__reactInternalMemoizedMergedChildContext=t,lt(Rn),lt(un),et(un,t)):lt(Rn),et(Rn,n)}var ni=null,Kh=!1,xp=!1;function IT(t){ni===null?ni=[t]:ni.push(t)}function LR(t){Kh=!0,IT(t)}function Ns(){if(!xp&&ni!==null){xp=!0;var t=0,e=qe;try{var n=ni;for(qe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ni=null,Kh=!1}catch(i){throw ni!==null&&(ni=ni.slice(t+1)),XS(dy,Ns),i}finally{qe=e,xp=!1}}return null}var na=[],ra=0,Bd=null,$d=0,er=[],tr=0,mo=null,oi=1,ai="";function Ws(t,e){na[ra++]=$d,na[ra++]=Bd,Bd=t,$d=e}function CT(t,e,n){er[tr++]=oi,er[tr++]=ai,er[tr++]=mo,mo=t;var r=oi;t=ai;var i=32-_r(r)-1;r&=~(1<<i),n+=1;var s=32-_r(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,oi=1<<32-_r(e)+i|n<<i|r,ai=s+t}else oi=1<<s|n<<i|r,ai=t}function wy(t){t.return!==null&&(Ws(t,1),CT(t,1,0))}function _y(t){for(;t===Bd;)Bd=na[--ra],na[ra]=null,$d=na[--ra],na[ra]=null;for(;t===mo;)mo=er[--tr],er[tr]=null,ai=er[--tr],er[tr]=null,oi=er[--tr],er[tr]=null}var Bn=null,On=null,ct=!1,gr=null;function kT(t,e){var n=ir(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function $1(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Bn=t,On=as(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Bn=t,On=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=mo!==null?{id:oi,overflow:ai}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ir(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Bn=t,On=null,!0):!1;default:return!1}}function Om(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Fm(t){if(ct){var e=On;if(e){var n=e;if(!$1(t,e)){if(Om(t))throw Error(Q(418));e=as(n.nextSibling);var r=Bn;e&&$1(t,e)?kT(r,n):(t.flags=t.flags&-4097|2,ct=!1,Bn=t)}}else{if(Om(t))throw Error(Q(418));t.flags=t.flags&-4097|2,ct=!1,Bn=t}}}function W1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Bn=t}function Mu(t){if(t!==Bn)return!1;if(!ct)return W1(t),ct=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!jm(t.type,t.memoizedProps)),e&&(e=On)){if(Om(t))throw AT(),Error(Q(418));for(;e;)kT(t,e),e=as(e.nextSibling)}if(W1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){On=as(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}On=null}}else On=Bn?as(t.stateNode.nextSibling):null;return!0}function AT(){for(var t=On;t;)t=as(t.nextSibling)}function Na(){On=Bn=null,ct=!1}function Sy(t){gr===null?gr=[t]:gr.push(t)}var MR=Ci.ReactCurrentBatchConfig;function wl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Q(309));var r=n.stateNode}if(!r)throw Error(Q(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Q(284));if(!n._owner)throw Error(Q(290,t))}return t}function Vu(t,e){throw t=Object.prototype.toString.call(e),Error(Q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function q1(t){var e=t._init;return e(t._payload)}function RT(t){function e(T,v){if(t){var w=T.deletions;w===null?(T.deletions=[v],T.flags|=16):w.push(v)}}function n(T,v){if(!t)return null;for(;v!==null;)e(T,v),v=v.sibling;return null}function r(T,v){for(T=new Map;v!==null;)v.key!==null?T.set(v.key,v):T.set(v.index,v),v=v.sibling;return T}function i(T,v){return T=ds(T,v),T.index=0,T.sibling=null,T}function s(T,v,w){return T.index=w,t?(w=T.alternate,w!==null?(w=w.index,w<v?(T.flags|=2,v):w):(T.flags|=2,v)):(T.flags|=1048576,v)}function o(T){return t&&T.alternate===null&&(T.flags|=2),T}function a(T,v,w,j){return v===null||v.tag!==6?(v=Ip(w,T.mode,j),v.return=T,v):(v=i(v,w),v.return=T,v)}function l(T,v,w,j){var L=w.type;return L===Yo?h(T,v,w.props.children,j,w.key):v!==null&&(v.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Ui&&q1(L)===v.type)?(j=i(v,w.props),j.ref=wl(T,v,w),j.return=T,j):(j=pd(w.type,w.key,w.props,null,T.mode,j),j.ref=wl(T,v,w),j.return=T,j)}function d(T,v,w,j){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=Cp(w,T.mode,j),v.return=T,v):(v=i(v,w.children||[]),v.return=T,v)}function h(T,v,w,j,L){return v===null||v.tag!==7?(v=lo(w,T.mode,j,L),v.return=T,v):(v=i(v,w),v.return=T,v)}function f(T,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Ip(""+v,T.mode,w),v.return=T,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Iu:return w=pd(v.type,v.key,v.props,null,T.mode,w),w.ref=wl(T,null,v),w.return=T,w;case Qo:return v=Cp(v,T.mode,w),v.return=T,v;case Ui:var j=v._init;return f(T,j(v._payload),w)}if(Al(v)||ml(v))return v=lo(v,T.mode,w,null),v.return=T,v;Vu(T,v)}return null}function p(T,v,w,j){var L=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return L!==null?null:a(T,v,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Iu:return w.key===L?l(T,v,w,j):null;case Qo:return w.key===L?d(T,v,w,j):null;case Ui:return L=w._init,p(T,v,L(w._payload),j)}if(Al(w)||ml(w))return L!==null?null:h(T,v,w,j,null);Vu(T,w)}return null}function g(T,v,w,j,L){if(typeof j=="string"&&j!==""||typeof j=="number")return T=T.get(w)||null,a(v,T,""+j,L);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Iu:return T=T.get(j.key===null?w:j.key)||null,l(v,T,j,L);case Qo:return T=T.get(j.key===null?w:j.key)||null,d(v,T,j,L);case Ui:var V=j._init;return g(T,v,w,V(j._payload),L)}if(Al(j)||ml(j))return T=T.get(w)||null,h(v,T,j,L,null);Vu(v,j)}return null}function x(T,v,w,j){for(var L=null,V=null,E=v,S=v=0,I=null;E!==null&&S<w.length;S++){E.index>S?(I=E,E=null):I=E.sibling;var A=p(T,E,w[S],j);if(A===null){E===null&&(E=I);break}t&&E&&A.alternate===null&&e(T,E),v=s(A,v,S),V===null?L=A:V.sibling=A,V=A,E=I}if(S===w.length)return n(T,E),ct&&Ws(T,S),L;if(E===null){for(;S<w.length;S++)E=f(T,w[S],j),E!==null&&(v=s(E,v,S),V===null?L=E:V.sibling=E,V=E);return ct&&Ws(T,S),L}for(E=r(T,E);S<w.length;S++)I=g(E,T,S,w[S],j),I!==null&&(t&&I.alternate!==null&&E.delete(I.key===null?S:I.key),v=s(I,v,S),V===null?L=I:V.sibling=I,V=I);return t&&E.forEach(function(P){return e(T,P)}),ct&&Ws(T,S),L}function _(T,v,w,j){var L=ml(w);if(typeof L!="function")throw Error(Q(150));if(w=L.call(w),w==null)throw Error(Q(151));for(var V=L=null,E=v,S=v=0,I=null,A=w.next();E!==null&&!A.done;S++,A=w.next()){E.index>S?(I=E,E=null):I=E.sibling;var P=p(T,E,A.value,j);if(P===null){E===null&&(E=I);break}t&&E&&P.alternate===null&&e(T,E),v=s(P,v,S),V===null?L=P:V.sibling=P,V=P,E=I}if(A.done)return n(T,E),ct&&Ws(T,S),L;if(E===null){for(;!A.done;S++,A=w.next())A=f(T,A.value,j),A!==null&&(v=s(A,v,S),V===null?L=A:V.sibling=A,V=A);return ct&&Ws(T,S),L}for(E=r(T,E);!A.done;S++,A=w.next())A=g(E,T,S,A.value,j),A!==null&&(t&&A.alternate!==null&&E.delete(A.key===null?S:A.key),v=s(A,v,S),V===null?L=A:V.sibling=A,V=A);return t&&E.forEach(function(N){return e(T,N)}),ct&&Ws(T,S),L}function k(T,v,w,j){if(typeof w=="object"&&w!==null&&w.type===Yo&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Iu:e:{for(var L=w.key,V=v;V!==null;){if(V.key===L){if(L=w.type,L===Yo){if(V.tag===7){n(T,V.sibling),v=i(V,w.props.children),v.return=T,T=v;break e}}else if(V.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Ui&&q1(L)===V.type){n(T,V.sibling),v=i(V,w.props),v.ref=wl(T,V,w),v.return=T,T=v;break e}n(T,V);break}else e(T,V);V=V.sibling}w.type===Yo?(v=lo(w.props.children,T.mode,j,w.key),v.return=T,T=v):(j=pd(w.type,w.key,w.props,null,T.mode,j),j.ref=wl(T,v,w),j.return=T,T=j)}return o(T);case Qo:e:{for(V=w.key;v!==null;){if(v.key===V)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(T,v.sibling),v=i(v,w.children||[]),v.return=T,T=v;break e}else{n(T,v);break}else e(T,v);v=v.sibling}v=Cp(w,T.mode,j),v.return=T,T=v}return o(T);case Ui:return V=w._init,k(T,v,V(w._payload),j)}if(Al(w))return x(T,v,w,j);if(ml(w))return _(T,v,w,j);Vu(T,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(T,v.sibling),v=i(v,w),v.return=T,T=v):(n(T,v),v=Ip(w,T.mode,j),v.return=T,T=v),o(T)):n(T,v)}return k}var Da=RT(!0),PT=RT(!1),Wd=Ps(null),qd=null,ia=null,Ty=null;function Ey(){Ty=ia=qd=null}function by(t){var e=Wd.current;lt(Wd),t._currentValue=e}function zm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ya(t,e){qd=t,Ty=ia=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Cn=!0),t.firstContext=null)}function cr(t){var e=t._currentValue;if(Ty!==t)if(t={context:t,memoizedValue:e,next:null},ia===null){if(qd===null)throw Error(Q(308));ia=t,qd.dependencies={lanes:0,firstContext:t}}else ia=ia.next=t;return e}var Zs=null;function Iy(t){Zs===null?Zs=[t]:Zs.push(t)}function NT(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Iy(e)):(n.next=i.next,i.next=n),e.interleaved=n,vi(t,r)}function vi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Bi=!1;function Cy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function DT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function di(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ls(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,vi(t,n)}return i=r.interleaved,i===null?(e.next=e,Iy(r)):(e.next=i.next,i.next=e),r.interleaved=e,vi(t,n)}function ld(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hy(t,n)}}function H1(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Hd(t,e,n,r){var i=t.updateQueue;Bi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?s=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,h=d=l=null,a=s;do{var p=a.lane,g=a.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var x=t,_=a;switch(p=e,g=n,_.tag){case 1:if(x=_.payload,typeof x=="function"){f=x.call(g,f,p);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=_.payload,p=typeof x=="function"?x.call(g,f,p):x,p==null)break e;f=mt({},f,p);break e;case 2:Bi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else g={eventTime:g,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=g,l=f):h=h.next=g,o|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(1);if(h===null&&(l=f),i.baseState=l,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);yo|=o,t.lanes=o,t.memoizedState=f}}function G1(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Q(191,i));i.call(r)}}}var Kc={},$r=Ps(Kc),gc=Ps(Kc),yc=Ps(Kc);function eo(t){if(t===Kc)throw Error(Q(174));return t}function ky(t,e){switch(et(yc,e),et(gc,t),et($r,Kc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:wm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=wm(e,t)}lt($r),et($r,e)}function ja(){lt($r),lt(gc),lt(yc)}function jT(t){eo(yc.current);var e=eo($r.current),n=wm(e,t.type);e!==n&&(et(gc,t),et($r,n))}function Ay(t){gc.current===t&&(lt($r),lt(gc))}var ht=Ps(0);function Gd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var wp=[];function Ry(){for(var t=0;t<wp.length;t++)wp[t]._workInProgressVersionPrimary=null;wp.length=0}var cd=Ci.ReactCurrentDispatcher,_p=Ci.ReactCurrentBatchConfig,go=0,pt=null,Lt=null,zt=null,Kd=!1,$l=!1,vc=0,VR=0;function tn(){throw Error(Q(321))}function Py(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!br(t[n],e[n]))return!1;return!0}function Ny(t,e,n,r,i,s){if(go=s,pt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,cd.current=t===null||t.memoizedState===null?UR:BR,t=n(r,i),$l){s=0;do{if($l=!1,vc=0,25<=s)throw Error(Q(301));s+=1,zt=Lt=null,e.updateQueue=null,cd.current=$R,t=n(r,i)}while($l)}if(cd.current=Qd,e=Lt!==null&&Lt.next!==null,go=0,zt=Lt=pt=null,Kd=!1,e)throw Error(Q(300));return t}function Dy(){var t=vc!==0;return vc=0,t}function Dr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?pt.memoizedState=zt=t:zt=zt.next=t,zt}function ur(){if(Lt===null){var t=pt.alternate;t=t!==null?t.memoizedState:null}else t=Lt.next;var e=zt===null?pt.memoizedState:zt.next;if(e!==null)zt=e,Lt=t;else{if(t===null)throw Error(Q(310));Lt=t,t={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},zt===null?pt.memoizedState=zt=t:zt=zt.next=t}return zt}function xc(t,e){return typeof e=="function"?e(t):e}function Sp(t){var e=ur(),n=e.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=t;var r=Lt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,d=s;do{var h=d.lane;if((go&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,pt.lanes|=h,yo|=h}d=d.next}while(d!==null&&d!==s);l===null?o=r:l.next=a,br(r,e.memoizedState)||(Cn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,pt.lanes|=s,yo|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Tp(t){var e=ur(),n=e.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);br(s,e.memoizedState)||(Cn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function LT(){}function MT(t,e){var n=pt,r=ur(),i=e(),s=!br(r.memoizedState,i);if(s&&(r.memoizedState=i,Cn=!0),r=r.queue,jy(FT.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||zt!==null&&zt.memoizedState.tag&1){if(n.flags|=2048,wc(9,OT.bind(null,n,r,i,e),void 0,null),Ut===null)throw Error(Q(349));go&30||VT(n,e,i)}return i}function VT(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function OT(t,e,n,r){e.value=n,e.getSnapshot=r,zT(e)&&UT(t)}function FT(t,e,n){return n(function(){zT(e)&&UT(t)})}function zT(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!br(t,n)}catch{return!0}}function UT(t){var e=vi(t,1);e!==null&&Sr(e,t,1,-1)}function K1(t){var e=Dr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xc,lastRenderedState:t},e.queue=t,t=t.dispatch=zR.bind(null,pt,t),[e.memoizedState,t]}function wc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function BT(){return ur().memoizedState}function ud(t,e,n,r){var i=Dr();pt.flags|=t,i.memoizedState=wc(1|e,n,void 0,r===void 0?null:r)}function Qh(t,e,n,r){var i=ur();r=r===void 0?null:r;var s=void 0;if(Lt!==null){var o=Lt.memoizedState;if(s=o.destroy,r!==null&&Py(r,o.deps)){i.memoizedState=wc(e,n,s,r);return}}pt.flags|=t,i.memoizedState=wc(1|e,n,s,r)}function Q1(t,e){return ud(8390656,8,t,e)}function jy(t,e){return Qh(2048,8,t,e)}function $T(t,e){return Qh(4,2,t,e)}function WT(t,e){return Qh(4,4,t,e)}function qT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function HT(t,e,n){return n=n!=null?n.concat([t]):null,Qh(4,4,qT.bind(null,e,t),n)}function Ly(){}function GT(t,e){var n=ur();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Py(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function KT(t,e){var n=ur();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Py(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function QT(t,e,n){return go&21?(br(n,e)||(n=eT(),pt.lanes|=n,yo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Cn=!0),t.memoizedState=n)}function OR(t,e){var n=qe;qe=n!==0&&4>n?n:4,t(!0);var r=_p.transition;_p.transition={};try{t(!1),e()}finally{qe=n,_p.transition=r}}function YT(){return ur().memoizedState}function FR(t,e,n){var r=us(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},XT(t))JT(e,n);else if(n=NT(t,e,n,r),n!==null){var i=xn();Sr(n,t,r,i),ZT(n,e,r)}}function zR(t,e,n){var r=us(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(XT(t))JT(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,br(a,o)){var l=e.interleaved;l===null?(i.next=i,Iy(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=NT(t,e,i,r),n!==null&&(i=xn(),Sr(n,t,r,i),ZT(n,e,r))}}function XT(t){var e=t.alternate;return t===pt||e!==null&&e===pt}function JT(t,e){$l=Kd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ZT(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hy(t,n)}}var Qd={readContext:cr,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useInsertionEffect:tn,useLayoutEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useMutableSource:tn,useSyncExternalStore:tn,useId:tn,unstable_isNewReconciler:!1},UR={readContext:cr,useCallback:function(t,e){return Dr().memoizedState=[t,e===void 0?null:e],t},useContext:cr,useEffect:Q1,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ud(4194308,4,qT.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ud(4194308,4,t,e)},useInsertionEffect:function(t,e){return ud(4,2,t,e)},useMemo:function(t,e){var n=Dr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Dr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=FR.bind(null,pt,t),[r.memoizedState,t]},useRef:function(t){var e=Dr();return t={current:t},e.memoizedState=t},useState:K1,useDebugValue:Ly,useDeferredValue:function(t){return Dr().memoizedState=t},useTransition:function(){var t=K1(!1),e=t[0];return t=OR.bind(null,t[1]),Dr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=pt,i=Dr();if(ct){if(n===void 0)throw Error(Q(407));n=n()}else{if(n=e(),Ut===null)throw Error(Q(349));go&30||VT(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Q1(FT.bind(null,r,s,t),[t]),r.flags|=2048,wc(9,OT.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Dr(),e=Ut.identifierPrefix;if(ct){var n=ai,r=oi;n=(r&~(1<<32-_r(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=vc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=VR++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},BR={readContext:cr,useCallback:GT,useContext:cr,useEffect:jy,useImperativeHandle:HT,useInsertionEffect:$T,useLayoutEffect:WT,useMemo:KT,useReducer:Sp,useRef:BT,useState:function(){return Sp(xc)},useDebugValue:Ly,useDeferredValue:function(t){var e=ur();return QT(e,Lt.memoizedState,t)},useTransition:function(){var t=Sp(xc)[0],e=ur().memoizedState;return[t,e]},useMutableSource:LT,useSyncExternalStore:MT,useId:YT,unstable_isNewReconciler:!1},$R={readContext:cr,useCallback:GT,useContext:cr,useEffect:jy,useImperativeHandle:HT,useInsertionEffect:$T,useLayoutEffect:WT,useMemo:KT,useReducer:Tp,useRef:BT,useState:function(){return Tp(xc)},useDebugValue:Ly,useDeferredValue:function(t){var e=ur();return Lt===null?e.memoizedState=t:QT(e,Lt.memoizedState,t)},useTransition:function(){var t=Tp(xc)[0],e=ur().memoizedState;return[t,e]},useMutableSource:LT,useSyncExternalStore:MT,useId:YT,unstable_isNewReconciler:!1};function hr(t,e){if(t&&t.defaultProps){e=mt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Um(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:mt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Yh={isMounted:function(t){return(t=t._reactInternals)?Co(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=xn(),i=us(t),s=di(r,i);s.payload=e,n!=null&&(s.callback=n),e=ls(t,s,i),e!==null&&(Sr(e,t,i,r),ld(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=xn(),i=us(t),s=di(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ls(t,s,i),e!==null&&(Sr(e,t,i,r),ld(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=xn(),r=us(t),i=di(n,r);i.tag=2,e!=null&&(i.callback=e),e=ls(t,i,r),e!==null&&(Sr(e,t,r,n),ld(e,t,r))}};function Y1(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!hc(n,r)||!hc(i,s):!0}function eE(t,e,n){var r=!1,i=ws,s=e.contextType;return typeof s=="object"&&s!==null?s=cr(s):(i=Pn(e)?po:un.current,r=e.contextTypes,s=(r=r!=null)?Pa(t,i):ws),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Yh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function X1(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Yh.enqueueReplaceState(e,e.state,null)}function Bm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Cy(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=cr(s):(s=Pn(e)?po:un.current,i.context=Pa(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Um(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Yh.enqueueReplaceState(i,i.state,null),Hd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function La(t,e){try{var n="",r=e;do n+=yA(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Ep(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function $m(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var WR=typeof WeakMap=="function"?WeakMap:Map;function tE(t,e,n){n=di(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Xd||(Xd=!0,Zm=r),$m(t,e)},n}function nE(t,e,n){n=di(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){$m(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){$m(t,e),typeof r!="function"&&(cs===null?cs=new Set([this]):cs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function J1(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new WR;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=iP.bind(null,t,e,n),e.then(t,t))}function Z1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ex(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=di(-1,1),e.tag=2,ls(n,e,1))),n.lanes|=1),t)}var qR=Ci.ReactCurrentOwner,Cn=!1;function vn(t,e,n,r){e.child=t===null?PT(e,null,n,r):Da(e,t.child,n,r)}function tx(t,e,n,r,i){n=n.render;var s=e.ref;return ya(e,i),r=Ny(t,e,n,r,s,i),n=Dy(),t!==null&&!Cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,xi(t,e,i)):(ct&&n&&wy(e),e.flags|=1,vn(t,e,r,i),e.child)}function nx(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!$y(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,rE(t,e,s,r,i)):(t=pd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:hc,n(o,r)&&t.ref===e.ref)return xi(t,e,i)}return e.flags|=1,t=ds(s,r),t.ref=e.ref,t.return=e,e.child=t}function rE(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(hc(s,r)&&t.ref===e.ref)if(Cn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Cn=!0);else return e.lanes=t.lanes,xi(t,e,i)}return Wm(t,e,n,r,i)}function iE(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},et(oa,Mn),Mn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,et(oa,Mn),Mn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,et(oa,Mn),Mn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,et(oa,Mn),Mn|=r;return vn(t,e,i,n),e.child}function sE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Wm(t,e,n,r,i){var s=Pn(n)?po:un.current;return s=Pa(e,s),ya(e,i),n=Ny(t,e,n,r,s,i),r=Dy(),t!==null&&!Cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,xi(t,e,i)):(ct&&r&&wy(e),e.flags|=1,vn(t,e,n,i),e.child)}function rx(t,e,n,r,i){if(Pn(n)){var s=!0;Ud(e)}else s=!1;if(ya(e,i),e.stateNode===null)dd(t,e),eE(e,n,r),Bm(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=cr(d):(d=Pn(n)?po:un.current,d=Pa(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&X1(e,o,r,d),Bi=!1;var p=e.memoizedState;o.state=p,Hd(e,r,o,i),l=e.memoizedState,a!==r||p!==l||Rn.current||Bi?(typeof h=="function"&&(Um(e,n,h,r),l=e.memoizedState),(a=Bi||Y1(e,n,a,r,p,l,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,DT(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:hr(e.type,a),o.props=d,f=e.pendingProps,p=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=cr(l):(l=Pn(n)?po:un.current,l=Pa(e,l));var g=n.getDerivedStateFromProps;(h=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||p!==l)&&X1(e,o,r,l),Bi=!1,p=e.memoizedState,o.state=p,Hd(e,r,o,i);var x=e.memoizedState;a!==f||p!==x||Rn.current||Bi?(typeof g=="function"&&(Um(e,n,g,r),x=e.memoizedState),(d=Bi||Y1(e,n,d,r,p,x,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return qm(t,e,n,r,s,i)}function qm(t,e,n,r,i,s){sE(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&B1(e,n,!1),xi(t,e,s);r=e.stateNode,qR.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Da(e,t.child,null,s),e.child=Da(e,null,a,s)):vn(t,e,a,s),e.memoizedState=r.state,i&&B1(e,n,!0),e.child}function oE(t){var e=t.stateNode;e.pendingContext?U1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&U1(t,e.context,!1),ky(t,e.containerInfo)}function ix(t,e,n,r,i){return Na(),Sy(i),e.flags|=256,vn(t,e,n,r),e.child}var Hm={dehydrated:null,treeContext:null,retryLane:0};function Gm(t){return{baseLanes:t,cachePool:null,transitions:null}}function aE(t,e,n){var r=e.pendingProps,i=ht.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),et(ht,i&1),t===null)return Fm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Zh(o,r,0,null),t=lo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Gm(n),e.memoizedState=Hm,t):My(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return HR(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ds(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=ds(a,s):(s=lo(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Gm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Hm,r}return s=t.child,t=s.sibling,r=ds(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function My(t,e){return e=Zh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ou(t,e,n,r){return r!==null&&Sy(r),Da(e,t.child,null,n),t=My(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function HR(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Ep(Error(Q(422))),Ou(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Zh({mode:"visible",children:r.children},i,0,null),s=lo(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Da(e,t.child,null,o),e.child.memoizedState=Gm(o),e.memoizedState=Hm,s);if(!(e.mode&1))return Ou(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Q(419)),r=Ep(s,r,void 0),Ou(t,e,o,r)}if(a=(o&t.childLanes)!==0,Cn||a){if(r=Ut,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,vi(t,i),Sr(r,t,i,-1))}return By(),r=Ep(Error(Q(421))),Ou(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=sP.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,On=as(i.nextSibling),Bn=e,ct=!0,gr=null,t!==null&&(er[tr++]=oi,er[tr++]=ai,er[tr++]=mo,oi=t.id,ai=t.overflow,mo=e),e=My(e,r.children),e.flags|=4096,e)}function sx(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),zm(t.return,e,n)}function bp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function lE(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(vn(t,e,r.children,n),r=ht.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&sx(t,n,e);else if(t.tag===19)sx(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(et(ht,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Gd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),bp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Gd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}bp(e,!0,n,null,s);break;case"together":bp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function dd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function xi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),yo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Q(153));if(e.child!==null){for(t=e.child,n=ds(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ds(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function GR(t,e,n){switch(e.tag){case 3:oE(e),Na();break;case 5:jT(e);break;case 1:Pn(e.type)&&Ud(e);break;case 4:ky(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;et(Wd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(et(ht,ht.current&1),e.flags|=128,null):n&e.child.childLanes?aE(t,e,n):(et(ht,ht.current&1),t=xi(t,e,n),t!==null?t.sibling:null);et(ht,ht.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return lE(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),et(ht,ht.current),r)break;return null;case 22:case 23:return e.lanes=0,iE(t,e,n)}return xi(t,e,n)}var cE,Km,uE,dE;cE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Km=function(){};uE=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,eo($r.current);var s=null;switch(n){case"input":i=gm(t,i),r=gm(t,r),s=[];break;case"select":i=mt({},i,{value:void 0}),r=mt({},r,{value:void 0}),s=[];break;case"textarea":i=xm(t,i),r=xm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Fd)}_m(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var a=i[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(sc.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var l=r[d];if(a=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(sc.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&ot("scroll",t),s||a===l||(s=[])):(s=s||[]).push(d,l))}n&&(s=s||[]).push("style",n);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};dE=function(t,e,n,r){n!==r&&(e.flags|=4)};function _l(t,e){if(!ct)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function nn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function KR(t,e,n){var r=e.pendingProps;switch(_y(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(e),null;case 1:return Pn(e.type)&&zd(),nn(e),null;case 3:return r=e.stateNode,ja(),lt(Rn),lt(un),Ry(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Mu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,gr!==null&&(ng(gr),gr=null))),Km(t,e),nn(e),null;case 5:Ay(e);var i=eo(yc.current);if(n=e.type,t!==null&&e.stateNode!=null)uE(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Q(166));return nn(e),null}if(t=eo($r.current),Mu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Or]=e,r[mc]=s,t=(e.mode&1)!==0,n){case"dialog":ot("cancel",r),ot("close",r);break;case"iframe":case"object":case"embed":ot("load",r);break;case"video":case"audio":for(i=0;i<Pl.length;i++)ot(Pl[i],r);break;case"source":ot("error",r);break;case"img":case"image":case"link":ot("error",r),ot("load",r);break;case"details":ot("toggle",r);break;case"input":p1(r,s),ot("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ot("invalid",r);break;case"textarea":g1(r,s),ot("invalid",r)}_m(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Lu(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Lu(r.textContent,a,t),i=["children",""+a]):sc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ot("scroll",r)}switch(n){case"input":Cu(r),m1(r,s,!0);break;case"textarea":Cu(r),y1(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Fd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=FS(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Or]=e,t[mc]=r,cE(t,e,!1,!1),e.stateNode=t;e:{switch(o=Sm(n,r),n){case"dialog":ot("cancel",t),ot("close",t),i=r;break;case"iframe":case"object":case"embed":ot("load",t),i=r;break;case"video":case"audio":for(i=0;i<Pl.length;i++)ot(Pl[i],t);i=r;break;case"source":ot("error",t),i=r;break;case"img":case"image":case"link":ot("error",t),ot("load",t),i=r;break;case"details":ot("toggle",t),i=r;break;case"input":p1(t,r),i=gm(t,r),ot("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=mt({},r,{value:void 0}),ot("invalid",t);break;case"textarea":g1(t,r),i=xm(t,r),ot("invalid",t);break;default:i=r}_m(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?BS(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&zS(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&oc(t,l):typeof l=="number"&&oc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(sc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ot("scroll",t):l!=null&&oy(t,s,l,o))}switch(n){case"input":Cu(t),m1(t,r,!1);break;case"textarea":Cu(t),y1(t);break;case"option":r.value!=null&&t.setAttribute("value",""+xs(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?fa(t,!!r.multiple,s,!1):r.defaultValue!=null&&fa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Fd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return nn(e),null;case 6:if(t&&e.stateNode!=null)dE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Q(166));if(n=eo(yc.current),eo($r.current),Mu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Or]=e,(s=r.nodeValue!==n)&&(t=Bn,t!==null))switch(t.tag){case 3:Lu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Lu(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Or]=e,e.stateNode=r}return nn(e),null;case 13:if(lt(ht),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ct&&On!==null&&e.mode&1&&!(e.flags&128))AT(),Na(),e.flags|=98560,s=!1;else if(s=Mu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Q(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Q(317));s[Or]=e}else Na(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;nn(e),s=!1}else gr!==null&&(ng(gr),gr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ht.current&1?Mt===0&&(Mt=3):By())),e.updateQueue!==null&&(e.flags|=4),nn(e),null);case 4:return ja(),Km(t,e),t===null&&fc(e.stateNode.containerInfo),nn(e),null;case 10:return by(e.type._context),nn(e),null;case 17:return Pn(e.type)&&zd(),nn(e),null;case 19:if(lt(ht),s=e.memoizedState,s===null)return nn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)_l(s,!1);else{if(Mt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Gd(t),o!==null){for(e.flags|=128,_l(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return et(ht,ht.current&1|2),e.child}t=t.sibling}s.tail!==null&&bt()>Ma&&(e.flags|=128,r=!0,_l(s,!1),e.lanes=4194304)}else{if(!r)if(t=Gd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),_l(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ct)return nn(e),null}else 2*bt()-s.renderingStartTime>Ma&&n!==1073741824&&(e.flags|=128,r=!0,_l(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=bt(),e.sibling=null,n=ht.current,et(ht,r?n&1|2:n&1),e):(nn(e),null);case 22:case 23:return Uy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Mn&1073741824&&(nn(e),e.subtreeFlags&6&&(e.flags|=8192)):nn(e),null;case 24:return null;case 25:return null}throw Error(Q(156,e.tag))}function QR(t,e){switch(_y(e),e.tag){case 1:return Pn(e.type)&&zd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ja(),lt(Rn),lt(un),Ry(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ay(e),null;case 13:if(lt(ht),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Q(340));Na()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return lt(ht),null;case 4:return ja(),null;case 10:return by(e.type._context),null;case 22:case 23:return Uy(),null;case 24:return null;default:return null}}var Fu=!1,an=!1,YR=typeof WeakSet=="function"?WeakSet:Set,ue=null;function sa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){xt(t,e,r)}else n.current=null}function Qm(t,e,n){try{n()}catch(r){xt(t,e,r)}}var ox=!1;function XR(t,e){if(Nm=Md,t=gT(),xy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,f=t,p=null;t:for(;;){for(var g;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(g=f.firstChild)!==null;)p=f,f=g;for(;;){if(f===t)break t;if(p===n&&++d===i&&(a=o),p===s&&++h===r&&(l=o),(g=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=g}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Dm={focusedElem:t,selectionRange:n},Md=!1,ue=e;ue!==null;)if(e=ue,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ue=t;else for(;ue!==null;){e=ue;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var _=x.memoizedProps,k=x.memoizedState,T=e.stateNode,v=T.getSnapshotBeforeUpdate(e.elementType===e.type?_:hr(e.type,_),k);T.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(j){xt(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,ue=t;break}ue=e.return}return x=ox,ox=!1,x}function Wl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Qm(e,n,s)}i=i.next}while(i!==r)}}function Xh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Ym(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function hE(t){var e=t.alternate;e!==null&&(t.alternate=null,hE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Or],delete e[mc],delete e[Mm],delete e[DR],delete e[jR])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function fE(t){return t.tag===5||t.tag===3||t.tag===4}function ax(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||fE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Xm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Fd));else if(r!==4&&(t=t.child,t!==null))for(Xm(t,e,n),t=t.sibling;t!==null;)Xm(t,e,n),t=t.sibling}function Jm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Jm(t,e,n),t=t.sibling;t!==null;)Jm(t,e,n),t=t.sibling}var qt=null,mr=!1;function ji(t,e,n){for(n=n.child;n!==null;)pE(t,e,n),n=n.sibling}function pE(t,e,n){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount($h,n)}catch{}switch(n.tag){case 5:an||sa(n,e);case 6:var r=qt,i=mr;qt=null,ji(t,e,n),qt=r,mr=i,qt!==null&&(mr?(t=qt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):qt.removeChild(n.stateNode));break;case 18:qt!==null&&(mr?(t=qt,n=n.stateNode,t.nodeType===8?vp(t.parentNode,n):t.nodeType===1&&vp(t,n),uc(t)):vp(qt,n.stateNode));break;case 4:r=qt,i=mr,qt=n.stateNode.containerInfo,mr=!0,ji(t,e,n),qt=r,mr=i;break;case 0:case 11:case 14:case 15:if(!an&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Qm(n,e,o),i=i.next}while(i!==r)}ji(t,e,n);break;case 1:if(!an&&(sa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){xt(n,e,a)}ji(t,e,n);break;case 21:ji(t,e,n);break;case 22:n.mode&1?(an=(r=an)||n.memoizedState!==null,ji(t,e,n),an=r):ji(t,e,n);break;default:ji(t,e,n)}}function lx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new YR),e.forEach(function(r){var i=oP.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function dr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:qt=a.stateNode,mr=!1;break e;case 3:qt=a.stateNode.containerInfo,mr=!0;break e;case 4:qt=a.stateNode.containerInfo,mr=!0;break e}a=a.return}if(qt===null)throw Error(Q(160));pE(s,o,i),qt=null,mr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(d){xt(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)mE(e,t),e=e.sibling}function mE(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(dr(e,t),Nr(t),r&4){try{Wl(3,t,t.return),Xh(3,t)}catch(_){xt(t,t.return,_)}try{Wl(5,t,t.return)}catch(_){xt(t,t.return,_)}}break;case 1:dr(e,t),Nr(t),r&512&&n!==null&&sa(n,n.return);break;case 5:if(dr(e,t),Nr(t),r&512&&n!==null&&sa(n,n.return),t.flags&32){var i=t.stateNode;try{oc(i,"")}catch(_){xt(t,t.return,_)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&VS(i,s),Sm(a,o);var d=Sm(a,s);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?BS(i,f):h==="dangerouslySetInnerHTML"?zS(i,f):h==="children"?oc(i,f):oy(i,h,f,d)}switch(a){case"input":ym(i,s);break;case"textarea":OS(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?fa(i,!!s.multiple,g,!1):p!==!!s.multiple&&(s.defaultValue!=null?fa(i,!!s.multiple,s.defaultValue,!0):fa(i,!!s.multiple,s.multiple?[]:"",!1))}i[mc]=s}catch(_){xt(t,t.return,_)}}break;case 6:if(dr(e,t),Nr(t),r&4){if(t.stateNode===null)throw Error(Q(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(_){xt(t,t.return,_)}}break;case 3:if(dr(e,t),Nr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{uc(e.containerInfo)}catch(_){xt(t,t.return,_)}break;case 4:dr(e,t),Nr(t);break;case 13:dr(e,t),Nr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Fy=bt())),r&4&&lx(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(an=(d=an)||h,dr(e,t),an=d):dr(e,t),Nr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ue=t,h=t.child;h!==null;){for(f=ue=h;ue!==null;){switch(p=ue,g=p.child,p.tag){case 0:case 11:case 14:case 15:Wl(4,p,p.return);break;case 1:sa(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(_){xt(r,n,_)}}break;case 5:sa(p,p.return);break;case 22:if(p.memoizedState!==null){ux(f);continue}}g!==null?(g.return=p,ue=g):ux(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=US("display",o))}catch(_){xt(t,t.return,_)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(_){xt(t,t.return,_)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:dr(e,t),Nr(t),r&4&&lx(t);break;case 21:break;default:dr(e,t),Nr(t)}}function Nr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(fE(n)){var r=n;break e}n=n.return}throw Error(Q(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(oc(i,""),r.flags&=-33);var s=ax(t);Jm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=ax(t);Xm(t,a,o);break;default:throw Error(Q(161))}}catch(l){xt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function JR(t,e,n){ue=t,gE(t)}function gE(t,e,n){for(var r=(t.mode&1)!==0;ue!==null;){var i=ue,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Fu;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||an;a=Fu;var d=an;if(Fu=o,(an=l)&&!d)for(ue=i;ue!==null;)o=ue,l=o.child,o.tag===22&&o.memoizedState!==null?dx(i):l!==null?(l.return=o,ue=l):dx(i);for(;s!==null;)ue=s,gE(s),s=s.sibling;ue=i,Fu=a,an=d}cx(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ue=s):cx(t)}}function cx(t){for(;ue!==null;){var e=ue;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:an||Xh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!an)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:hr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&G1(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}G1(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&uc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}an||e.flags&512&&Ym(e)}catch(p){xt(e,e.return,p)}}if(e===t){ue=null;break}if(n=e.sibling,n!==null){n.return=e.return,ue=n;break}ue=e.return}}function ux(t){for(;ue!==null;){var e=ue;if(e===t){ue=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ue=n;break}ue=e.return}}function dx(t){for(;ue!==null;){var e=ue;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Xh(4,e)}catch(l){xt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){xt(e,i,l)}}var s=e.return;try{Ym(e)}catch(l){xt(e,s,l)}break;case 5:var o=e.return;try{Ym(e)}catch(l){xt(e,o,l)}}}catch(l){xt(e,e.return,l)}if(e===t){ue=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ue=a;break}ue=e.return}}var ZR=Math.ceil,Yd=Ci.ReactCurrentDispatcher,Vy=Ci.ReactCurrentOwner,sr=Ci.ReactCurrentBatchConfig,Be=0,Ut=null,Rt=null,Qt=0,Mn=0,oa=Ps(0),Mt=0,_c=null,yo=0,Jh=0,Oy=0,ql=null,En=null,Fy=0,Ma=1/0,ti=null,Xd=!1,Zm=null,cs=null,zu=!1,ts=null,Jd=0,Hl=0,eg=null,hd=-1,fd=0;function xn(){return Be&6?bt():hd!==-1?hd:hd=bt()}function us(t){return t.mode&1?Be&2&&Qt!==0?Qt&-Qt:MR.transition!==null?(fd===0&&(fd=eT()),fd):(t=qe,t!==0||(t=window.event,t=t===void 0?16:aT(t.type)),t):1}function Sr(t,e,n,r){if(50<Hl)throw Hl=0,eg=null,Error(Q(185));qc(t,n,r),(!(Be&2)||t!==Ut)&&(t===Ut&&(!(Be&2)&&(Jh|=n),Mt===4&&qi(t,Qt)),Nn(t,r),n===1&&Be===0&&!(e.mode&1)&&(Ma=bt()+500,Kh&&Ns()))}function Nn(t,e){var n=t.callbackNode;MA(t,e);var r=Ld(t,t===Ut?Qt:0);if(r===0)n!==null&&w1(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&w1(n),e===1)t.tag===0?LR(hx.bind(null,t)):IT(hx.bind(null,t)),PR(function(){!(Be&6)&&Ns()}),n=null;else{switch(tT(r)){case 1:n=dy;break;case 4:n=JS;break;case 16:n=jd;break;case 536870912:n=ZS;break;default:n=jd}n=EE(n,yE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function yE(t,e){if(hd=-1,fd=0,Be&6)throw Error(Q(327));var n=t.callbackNode;if(va()&&t.callbackNode!==n)return null;var r=Ld(t,t===Ut?Qt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Zd(t,r);else{e=r;var i=Be;Be|=2;var s=xE();(Ut!==t||Qt!==e)&&(ti=null,Ma=bt()+500,ao(t,e));do try{nP();break}catch(a){vE(t,a)}while(1);Ey(),Yd.current=s,Be=i,Rt!==null?e=0:(Ut=null,Qt=0,e=Mt)}if(e!==0){if(e===2&&(i=Cm(t),i!==0&&(r=i,e=tg(t,i))),e===1)throw n=_c,ao(t,0),qi(t,r),Nn(t,bt()),n;if(e===6)qi(t,r);else{if(i=t.current.alternate,!(r&30)&&!eP(i)&&(e=Zd(t,r),e===2&&(s=Cm(t),s!==0&&(r=s,e=tg(t,s))),e===1))throw n=_c,ao(t,0),qi(t,r),Nn(t,bt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Q(345));case 2:qs(t,En,ti);break;case 3:if(qi(t,r),(r&130023424)===r&&(e=Fy+500-bt(),10<e)){if(Ld(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){xn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Lm(qs.bind(null,t,En,ti),e);break}qs(t,En,ti);break;case 4:if(qi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-_r(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=bt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ZR(r/1960))-r,10<r){t.timeoutHandle=Lm(qs.bind(null,t,En,ti),r);break}qs(t,En,ti);break;case 5:qs(t,En,ti);break;default:throw Error(Q(329))}}}return Nn(t,bt()),t.callbackNode===n?yE.bind(null,t):null}function tg(t,e){var n=ql;return t.current.memoizedState.isDehydrated&&(ao(t,e).flags|=256),t=Zd(t,e),t!==2&&(e=En,En=n,e!==null&&ng(e)),t}function ng(t){En===null?En=t:En.push.apply(En,t)}function eP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!br(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function qi(t,e){for(e&=~Oy,e&=~Jh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-_r(e),r=1<<n;t[n]=-1,e&=~r}}function hx(t){if(Be&6)throw Error(Q(327));va();var e=Ld(t,0);if(!(e&1))return Nn(t,bt()),null;var n=Zd(t,e);if(t.tag!==0&&n===2){var r=Cm(t);r!==0&&(e=r,n=tg(t,r))}if(n===1)throw n=_c,ao(t,0),qi(t,e),Nn(t,bt()),n;if(n===6)throw Error(Q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,qs(t,En,ti),Nn(t,bt()),null}function zy(t,e){var n=Be;Be|=1;try{return t(e)}finally{Be=n,Be===0&&(Ma=bt()+500,Kh&&Ns())}}function vo(t){ts!==null&&ts.tag===0&&!(Be&6)&&va();var e=Be;Be|=1;var n=sr.transition,r=qe;try{if(sr.transition=null,qe=1,t)return t()}finally{qe=r,sr.transition=n,Be=e,!(Be&6)&&Ns()}}function Uy(){Mn=oa.current,lt(oa)}function ao(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,RR(n)),Rt!==null)for(n=Rt.return;n!==null;){var r=n;switch(_y(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&zd();break;case 3:ja(),lt(Rn),lt(un),Ry();break;case 5:Ay(r);break;case 4:ja();break;case 13:lt(ht);break;case 19:lt(ht);break;case 10:by(r.type._context);break;case 22:case 23:Uy()}n=n.return}if(Ut=t,Rt=t=ds(t.current,null),Qt=Mn=e,Mt=0,_c=null,Oy=Jh=yo=0,En=ql=null,Zs!==null){for(e=0;e<Zs.length;e++)if(n=Zs[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Zs=null}return t}function vE(t,e){do{var n=Rt;try{if(Ey(),cd.current=Qd,Kd){for(var r=pt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Kd=!1}if(go=0,zt=Lt=pt=null,$l=!1,vc=0,Vy.current=null,n===null||n.return===null){Mt=1,_c=e,Rt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Qt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=Z1(o);if(g!==null){g.flags&=-257,ex(g,o,a,s,e),g.mode&1&&J1(s,d,e),e=g,l=d;var x=e.updateQueue;if(x===null){var _=new Set;_.add(l),e.updateQueue=_}else x.add(l);break e}else{if(!(e&1)){J1(s,d,e),By();break e}l=Error(Q(426))}}else if(ct&&a.mode&1){var k=Z1(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),ex(k,o,a,s,e),Sy(La(l,a));break e}}s=l=La(l,a),Mt!==4&&(Mt=2),ql===null?ql=[s]:ql.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var T=tE(s,l,e);H1(s,T);break e;case 1:a=l;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(cs===null||!cs.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var j=nE(s,a,e);H1(s,j);break e}}s=s.return}while(s!==null)}_E(n)}catch(L){e=L,Rt===n&&n!==null&&(Rt=n=n.return);continue}break}while(1)}function xE(){var t=Yd.current;return Yd.current=Qd,t===null?Qd:t}function By(){(Mt===0||Mt===3||Mt===2)&&(Mt=4),Ut===null||!(yo&268435455)&&!(Jh&268435455)||qi(Ut,Qt)}function Zd(t,e){var n=Be;Be|=2;var r=xE();(Ut!==t||Qt!==e)&&(ti=null,ao(t,e));do try{tP();break}catch(i){vE(t,i)}while(1);if(Ey(),Be=n,Yd.current=r,Rt!==null)throw Error(Q(261));return Ut=null,Qt=0,Mt}function tP(){for(;Rt!==null;)wE(Rt)}function nP(){for(;Rt!==null&&!CA();)wE(Rt)}function wE(t){var e=TE(t.alternate,t,Mn);t.memoizedProps=t.pendingProps,e===null?_E(t):Rt=e,Vy.current=null}function _E(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=QR(n,e),n!==null){n.flags&=32767,Rt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Mt=6,Rt=null;return}}else if(n=KR(n,e,Mn),n!==null){Rt=n;return}if(e=e.sibling,e!==null){Rt=e;return}Rt=e=t}while(e!==null);Mt===0&&(Mt=5)}function qs(t,e,n){var r=qe,i=sr.transition;try{sr.transition=null,qe=1,rP(t,e,n,r)}finally{sr.transition=i,qe=r}return null}function rP(t,e,n,r){do va();while(ts!==null);if(Be&6)throw Error(Q(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Q(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(VA(t,s),t===Ut&&(Rt=Ut=null,Qt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||zu||(zu=!0,EE(jd,function(){return va(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=sr.transition,sr.transition=null;var o=qe;qe=1;var a=Be;Be|=4,Vy.current=null,XR(t,n),mE(n,t),TR(Dm),Md=!!Nm,Dm=Nm=null,t.current=n,JR(n),kA(),Be=a,qe=o,sr.transition=s}else t.current=n;if(zu&&(zu=!1,ts=t,Jd=i),s=t.pendingLanes,s===0&&(cs=null),PA(n.stateNode),Nn(t,bt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Xd)throw Xd=!1,t=Zm,Zm=null,t;return Jd&1&&t.tag!==0&&va(),s=t.pendingLanes,s&1?t===eg?Hl++:(Hl=0,eg=t):Hl=0,Ns(),null}function va(){if(ts!==null){var t=tT(Jd),e=sr.transition,n=qe;try{if(sr.transition=null,qe=16>t?16:t,ts===null)var r=!1;else{if(t=ts,ts=null,Jd=0,Be&6)throw Error(Q(331));var i=Be;for(Be|=4,ue=t.current;ue!==null;){var s=ue,o=s.child;if(ue.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(ue=d;ue!==null;){var h=ue;switch(h.tag){case 0:case 11:case 15:Wl(8,h,s)}var f=h.child;if(f!==null)f.return=h,ue=f;else for(;ue!==null;){h=ue;var p=h.sibling,g=h.return;if(hE(h),h===d){ue=null;break}if(p!==null){p.return=g,ue=p;break}ue=g}}}var x=s.alternate;if(x!==null){var _=x.child;if(_!==null){x.child=null;do{var k=_.sibling;_.sibling=null,_=k}while(_!==null)}}ue=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ue=o;else e:for(;ue!==null;){if(s=ue,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Wl(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,ue=T;break e}ue=s.return}}var v=t.current;for(ue=v;ue!==null;){o=ue;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,ue=w;else e:for(o=v;ue!==null;){if(a=ue,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Xh(9,a)}}catch(L){xt(a,a.return,L)}if(a===o){ue=null;break e}var j=a.sibling;if(j!==null){j.return=a.return,ue=j;break e}ue=a.return}}if(Be=i,Ns(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot($h,t)}catch{}r=!0}return r}finally{qe=n,sr.transition=e}}return!1}function fx(t,e,n){e=La(n,e),e=tE(t,e,1),t=ls(t,e,1),e=xn(),t!==null&&(qc(t,1,e),Nn(t,e))}function xt(t,e,n){if(t.tag===3)fx(t,t,n);else for(;e!==null;){if(e.tag===3){fx(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(cs===null||!cs.has(r))){t=La(n,t),t=nE(e,t,1),e=ls(e,t,1),t=xn(),e!==null&&(qc(e,1,t),Nn(e,t));break}}e=e.return}}function iP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=xn(),t.pingedLanes|=t.suspendedLanes&n,Ut===t&&(Qt&n)===n&&(Mt===4||Mt===3&&(Qt&130023424)===Qt&&500>bt()-Fy?ao(t,0):Oy|=n),Nn(t,e)}function SE(t,e){e===0&&(t.mode&1?(e=Ru,Ru<<=1,!(Ru&130023424)&&(Ru=4194304)):e=1);var n=xn();t=vi(t,e),t!==null&&(qc(t,e,n),Nn(t,n))}function sP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),SE(t,n)}function oP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Q(314))}r!==null&&r.delete(e),SE(t,n)}var TE;TE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Rn.current)Cn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Cn=!1,GR(t,e,n);Cn=!!(t.flags&131072)}else Cn=!1,ct&&e.flags&1048576&&CT(e,$d,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;dd(t,e),t=e.pendingProps;var i=Pa(e,un.current);ya(e,n),i=Ny(null,e,r,t,i,n);var s=Dy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pn(r)?(s=!0,Ud(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Cy(e),i.updater=Yh,e.stateNode=i,i._reactInternals=e,Bm(e,r,t,n),e=qm(null,e,r,!0,s,n)):(e.tag=0,ct&&s&&wy(e),vn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(dd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=lP(r),t=hr(r,t),i){case 0:e=Wm(null,e,r,t,n);break e;case 1:e=rx(null,e,r,t,n);break e;case 11:e=tx(null,e,r,t,n);break e;case 14:e=nx(null,e,r,hr(r.type,t),n);break e}throw Error(Q(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:hr(r,i),Wm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:hr(r,i),rx(t,e,r,i,n);case 3:e:{if(oE(e),t===null)throw Error(Q(387));r=e.pendingProps,s=e.memoizedState,i=s.element,DT(t,e),Hd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=La(Error(Q(423)),e),e=ix(t,e,r,n,i);break e}else if(r!==i){i=La(Error(Q(424)),e),e=ix(t,e,r,n,i);break e}else for(On=as(e.stateNode.containerInfo.firstChild),Bn=e,ct=!0,gr=null,n=PT(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Na(),r===i){e=xi(t,e,n);break e}vn(t,e,r,n)}e=e.child}return e;case 5:return jT(e),t===null&&Fm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,jm(r,i)?o=null:s!==null&&jm(r,s)&&(e.flags|=32),sE(t,e),vn(t,e,o,n),e.child;case 6:return t===null&&Fm(e),null;case 13:return aE(t,e,n);case 4:return ky(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Da(e,null,r,n):vn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:hr(r,i),tx(t,e,r,i,n);case 7:return vn(t,e,e.pendingProps,n),e.child;case 8:return vn(t,e,e.pendingProps.children,n),e.child;case 12:return vn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,et(Wd,r._currentValue),r._currentValue=o,s!==null)if(br(s.value,o)){if(s.children===i.children&&!Rn.current){e=xi(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=di(-1,n&-n),l.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),zm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Q(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),zm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}vn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ya(e,n),i=cr(i),r=r(i),e.flags|=1,vn(t,e,r,n),e.child;case 14:return r=e.type,i=hr(r,e.pendingProps),i=hr(r.type,i),nx(t,e,r,i,n);case 15:return rE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:hr(r,i),dd(t,e),e.tag=1,Pn(r)?(t=!0,Ud(e)):t=!1,ya(e,n),eE(e,r,i),Bm(e,r,i,n),qm(null,e,r,!0,t,n);case 19:return lE(t,e,n);case 22:return iE(t,e,n)}throw Error(Q(156,e.tag))};function EE(t,e){return XS(t,e)}function aP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ir(t,e,n,r){return new aP(t,e,n,r)}function $y(t){return t=t.prototype,!(!t||!t.isReactComponent)}function lP(t){if(typeof t=="function")return $y(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ly)return 11;if(t===cy)return 14}return 2}function ds(t,e){var n=t.alternate;return n===null?(n=ir(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function pd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")$y(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Yo:return lo(n.children,i,s,e);case ay:o=8,i|=8;break;case hm:return t=ir(12,n,e,i|2),t.elementType=hm,t.lanes=s,t;case fm:return t=ir(13,n,e,i),t.elementType=fm,t.lanes=s,t;case pm:return t=ir(19,n,e,i),t.elementType=pm,t.lanes=s,t;case jS:return Zh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case NS:o=10;break e;case DS:o=9;break e;case ly:o=11;break e;case cy:o=14;break e;case Ui:o=16,r=null;break e}throw Error(Q(130,t==null?t:typeof t,""))}return e=ir(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function lo(t,e,n,r){return t=ir(7,t,r,e),t.lanes=n,t}function Zh(t,e,n,r){return t=ir(22,t,r,e),t.elementType=jS,t.lanes=n,t.stateNode={isHidden:!1},t}function Ip(t,e,n){return t=ir(6,t,null,e),t.lanes=n,t}function Cp(t,e,n){return e=ir(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function cP(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ap(0),this.expirationTimes=ap(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ap(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Wy(t,e,n,r,i,s,o,a,l){return t=new cP(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ir(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cy(s),t}function uP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function bE(t){if(!t)return ws;t=t._reactInternals;e:{if(Co(t)!==t||t.tag!==1)throw Error(Q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Q(171))}if(t.tag===1){var n=t.type;if(Pn(n))return bT(t,n,e)}return e}function IE(t,e,n,r,i,s,o,a,l){return t=Wy(n,r,!0,t,i,s,o,a,l),t.context=bE(null),n=t.current,r=xn(),i=us(n),s=di(r,i),s.callback=e??null,ls(n,s,i),t.current.lanes=i,qc(t,i,r),Nn(t,r),t}function ef(t,e,n,r){var i=e.current,s=xn(),o=us(i);return n=bE(n),e.context===null?e.context=n:e.pendingContext=n,e=di(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ls(i,e,o),t!==null&&(Sr(t,i,o,s),ld(t,i,o)),o}function eh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function px(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function qy(t,e){px(t,e),(t=t.alternate)&&px(t,e)}function dP(){return null}var CE=typeof reportError=="function"?reportError:function(t){console.error(t)};function Hy(t){this._internalRoot=t}tf.prototype.render=Hy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Q(409));ef(t,e,null,null)};tf.prototype.unmount=Hy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;vo(function(){ef(null,t,null,null)}),e[yi]=null}};function tf(t){this._internalRoot=t}tf.prototype.unstable_scheduleHydration=function(t){if(t){var e=iT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Wi.length&&e!==0&&e<Wi[n].priority;n++);Wi.splice(n,0,t),n===0&&oT(t)}};function Gy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function nf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function mx(){}function hP(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=eh(o);s.call(d)}}var o=IE(e,r,t,0,null,!1,!1,"",mx);return t._reactRootContainer=o,t[yi]=o.current,fc(t.nodeType===8?t.parentNode:t),vo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var d=eh(l);a.call(d)}}var l=Wy(t,0,!1,null,null,!1,!1,"",mx);return t._reactRootContainer=l,t[yi]=l.current,fc(t.nodeType===8?t.parentNode:t),vo(function(){ef(e,l,n,r)}),l}function rf(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=eh(o);a.call(l)}}ef(e,o,t,i)}else o=hP(n,e,t,i,r);return eh(o)}nT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Rl(e.pendingLanes);n!==0&&(hy(e,n|1),Nn(e,bt()),!(Be&6)&&(Ma=bt()+500,Ns()))}break;case 13:vo(function(){var r=vi(t,1);if(r!==null){var i=xn();Sr(r,t,1,i)}}),qy(t,1)}};fy=function(t){if(t.tag===13){var e=vi(t,134217728);if(e!==null){var n=xn();Sr(e,t,134217728,n)}qy(t,134217728)}};rT=function(t){if(t.tag===13){var e=us(t),n=vi(t,e);if(n!==null){var r=xn();Sr(n,t,e,r)}qy(t,e)}};iT=function(){return qe};sT=function(t,e){var n=qe;try{return qe=t,e()}finally{qe=n}};Em=function(t,e,n){switch(e){case"input":if(ym(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Gh(r);if(!i)throw Error(Q(90));MS(r),ym(r,i)}}}break;case"textarea":OS(t,n);break;case"select":e=n.value,e!=null&&fa(t,!!n.multiple,e,!1)}};qS=zy;HS=vo;var fP={usingClientEntryPoint:!1,Events:[Gc,ea,Gh,$S,WS,zy]},Sl={findFiberByHostInstance:Js,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pP={bundleType:Sl.bundleType,version:Sl.version,rendererPackageName:Sl.rendererPackageName,rendererConfig:Sl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ci.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=QS(t),t===null?null:t.stateNode},findFiberByHostInstance:Sl.findFiberByHostInstance||dP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Uu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Uu.isDisabled&&Uu.supportsFiber)try{$h=Uu.inject(pP),Br=Uu}catch{}}qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fP;qn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gy(e))throw Error(Q(200));return uP(t,e,null,n)};qn.createRoot=function(t,e){if(!Gy(t))throw Error(Q(299));var n=!1,r="",i=CE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Wy(t,1,!1,null,null,n,!1,r,i),t[yi]=e.current,fc(t.nodeType===8?t.parentNode:t),new Hy(e)};qn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Q(188)):(t=Object.keys(t).join(","),Error(Q(268,t)));return t=QS(e),t=t===null?null:t.stateNode,t};qn.flushSync=function(t){return vo(t)};qn.hydrate=function(t,e,n){if(!nf(e))throw Error(Q(200));return rf(null,t,e,!0,n)};qn.hydrateRoot=function(t,e,n){if(!Gy(t))throw Error(Q(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=CE;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=IE(e,null,t,1,n??null,i,!1,s,o),t[yi]=e.current,fc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new tf(e)};qn.render=function(t,e,n){if(!nf(e))throw Error(Q(200));return rf(null,t,e,!1,n)};qn.unmountComponentAtNode=function(t){if(!nf(t))throw Error(Q(40));return t._reactRootContainer?(vo(function(){rf(null,null,t,!1,function(){t._reactRootContainer=null,t[yi]=null})}),!0):!1};qn.unstable_batchedUpdates=zy;qn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!nf(n))throw Error(Q(200));if(t==null||t._reactInternals===void 0)throw Error(Q(38));return rf(t,e,n,!1,r)};qn.version="18.3.1-next-f1338f8080-20240426";function kE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kE)}catch(t){console.error(t)}}kE(),kS.exports=qn;var mP=kS.exports,gx=mP;um.createRoot=gx.createRoot,um.hydrateRoot=gx.hydrateRoot;const AE=R.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),sf=R.createContext({}),of=R.createContext(null),af=typeof document<"u",Ky=af?R.useLayoutEffect:R.useEffect,RE=R.createContext({strict:!1}),Qy=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),gP="framerAppearId",PE="data-"+Qy(gP);function yP(t,e,n,r){const{visualElement:i}=R.useContext(sf),s=R.useContext(RE),o=R.useContext(of),a=R.useContext(AE).reducedMotion,l=R.useRef();r=r||s.renderer,!l.current&&r&&(l.current=r(t,{visualState:e,parent:i,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:a}));const d=l.current;R.useInsertionEffect(()=>{d&&d.update(n,o)});const h=R.useRef(!!(n[PE]&&!window.HandoffComplete));return Ky(()=>{d&&(d.render(),h.current&&d.animationState&&d.animationState.animateChanges())}),R.useEffect(()=>{d&&(d.updateFeatures(),!h.current&&d.animationState&&d.animationState.animateChanges(),h.current&&(h.current=!1,window.HandoffComplete=!0))}),d}function aa(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function vP(t,e,n){return R.useCallback(r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):aa(n)&&(n.current=r))},[e])}function Sc(t){return typeof t=="string"||Array.isArray(t)}function lf(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const Yy=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Xy=["initial",...Yy];function cf(t){return lf(t.animate)||Xy.some(e=>Sc(t[e]))}function NE(t){return!!(cf(t)||t.variants)}function xP(t,e){if(cf(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Sc(n)?n:void 0,animate:Sc(r)?r:void 0}}return t.inherit!==!1?e:{}}function wP(t){const{initial:e,animate:n}=xP(t,R.useContext(sf));return R.useMemo(()=>({initial:e,animate:n}),[yx(e),yx(n)])}function yx(t){return Array.isArray(t)?t.join(" "):t}const vx={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Tc={};for(const t in vx)Tc[t]={isEnabled:e=>vx[t].some(n=>!!e[n])};function _P(t){for(const e in t)Tc[e]={...Tc[e],...t[e]}}const Jy=R.createContext({}),DE=R.createContext({}),SP=Symbol.for("motionComponentSymbol");function TP({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:i}){t&&_P(t);function s(a,l){let d;const h={...R.useContext(AE),...a,layoutId:EP(a)},{isStatic:f}=h,p=wP(a),g=r(a,f);if(!f&&af){p.visualElement=yP(i,g,h,e);const x=R.useContext(DE),_=R.useContext(RE).strict;p.visualElement&&(d=p.visualElement.loadFeatures(h,_,t,x))}return R.createElement(sf.Provider,{value:p},d&&p.visualElement?R.createElement(d,{visualElement:p.visualElement,...h}):null,n(i,a,vP(g,p.visualElement,l),g,f,p.visualElement))}const o=R.forwardRef(s);return o[SP]=i,o}function EP({layoutId:t}){const e=R.useContext(Jy).id;return e&&t!==void 0?e+"-"+t:t}function bP(t){function e(r,i={}){return TP(t(r,i))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(r,i)=>(n.has(i)||n.set(i,e(i)),n.get(i))})}const IP=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Zy(t){return typeof t!="string"||t.includes("-")?!1:!!(IP.indexOf(t)>-1||/[A-Z]/.test(t))}const th={};function CP(t){Object.assign(th,t)}const Qc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ko=new Set(Qc);function jE(t,{layout:e,layoutId:n}){return ko.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!th[t]||t==="opacity")}const Dn=t=>!!(t&&t.getVelocity),kP={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},AP=Qc.length;function RP(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},r,i){let s="";for(let o=0;o<AP;o++){const a=Qc[o];if(t[a]!==void 0){const l=kP[a]||a;s+=`${l}(${t[a]}) `}}return e&&!t.z&&(s+="translateZ(0)"),s=s.trim(),i?s=i(t,r?"":s):n&&r&&(s="none"),s}const LE=t=>e=>typeof e=="string"&&e.startsWith(t),ME=LE("--"),rg=LE("var(--"),PP=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,NP=(t,e)=>e&&typeof t=="number"?e.transform(t):t,_s=(t,e,n)=>Math.min(Math.max(n,t),e),Ao={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Gl={...Ao,transform:t=>_s(0,1,t)},Bu={...Ao,default:1},Kl=t=>Math.round(t*1e5)/1e5,uf=/(-)?([\d]*\.?[\d])+/g,VE=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,DP=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Yc(t){return typeof t=="string"}const Xc=t=>({test:e=>Yc(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Fi=Xc("deg"),Wr=Xc("%"),Se=Xc("px"),jP=Xc("vh"),LP=Xc("vw"),xx={...Wr,parse:t=>Wr.parse(t)/100,transform:t=>Wr.transform(t*100)},wx={...Ao,transform:Math.round},OE={borderWidth:Se,borderTopWidth:Se,borderRightWidth:Se,borderBottomWidth:Se,borderLeftWidth:Se,borderRadius:Se,radius:Se,borderTopLeftRadius:Se,borderTopRightRadius:Se,borderBottomRightRadius:Se,borderBottomLeftRadius:Se,width:Se,maxWidth:Se,height:Se,maxHeight:Se,size:Se,top:Se,right:Se,bottom:Se,left:Se,padding:Se,paddingTop:Se,paddingRight:Se,paddingBottom:Se,paddingLeft:Se,margin:Se,marginTop:Se,marginRight:Se,marginBottom:Se,marginLeft:Se,rotate:Fi,rotateX:Fi,rotateY:Fi,rotateZ:Fi,scale:Bu,scaleX:Bu,scaleY:Bu,scaleZ:Bu,skew:Fi,skewX:Fi,skewY:Fi,distance:Se,translateX:Se,translateY:Se,translateZ:Se,x:Se,y:Se,z:Se,perspective:Se,transformPerspective:Se,opacity:Gl,originX:xx,originY:xx,originZ:Se,zIndex:wx,fillOpacity:Gl,strokeOpacity:Gl,numOctaves:wx};function e0(t,e,n,r){const{style:i,vars:s,transform:o,transformOrigin:a}=t;let l=!1,d=!1,h=!0;for(const f in e){const p=e[f];if(ME(f)){s[f]=p;continue}const g=OE[f],x=NP(p,g);if(ko.has(f)){if(l=!0,o[f]=x,!h)continue;p!==(g.default||0)&&(h=!1)}else f.startsWith("origin")?(d=!0,a[f]=x):i[f]=x}if(e.transform||(l||r?i.transform=RP(t.transform,n,h,r):i.transform&&(i.transform="none")),d){const{originX:f="50%",originY:p="50%",originZ:g=0}=a;i.transformOrigin=`${f} ${p} ${g}`}}const t0=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function FE(t,e,n){for(const r in e)!Dn(e[r])&&!jE(r,n)&&(t[r]=e[r])}function MP({transformTemplate:t},e,n){return R.useMemo(()=>{const r=t0();return e0(r,e,{enableHardwareAcceleration:!n},t),Object.assign({},r.vars,r.style)},[e])}function VP(t,e,n){const r=t.style||{},i={};return FE(i,r,t),Object.assign(i,MP(t,e,n)),t.transformValues?t.transformValues(i):i}function OP(t,e,n){const r={},i=VP(t,e,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=i,r}const FP=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function nh(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||FP.has(t)}let zE=t=>!nh(t);function zP(t){t&&(zE=e=>e.startsWith("on")?!nh(e):t(e))}try{zP(require("@emotion/is-prop-valid").default)}catch{}function UP(t,e,n){const r={};for(const i in t)i==="values"&&typeof t.values=="object"||(zE(i)||n===!0&&nh(i)||!e&&!nh(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}function _x(t,e,n){return typeof t=="string"?t:Se.transform(e+n*t)}function BP(t,e,n){const r=_x(e,t.x,t.width),i=_x(n,t.y,t.height);return`${r} ${i}`}const $P={offset:"stroke-dashoffset",array:"stroke-dasharray"},WP={offset:"strokeDashoffset",array:"strokeDasharray"};function qP(t,e,n=1,r=0,i=!0){t.pathLength=1;const s=i?$P:WP;t[s.offset]=Se.transform(-r);const o=Se.transform(e),a=Se.transform(n);t[s.array]=`${o} ${a}`}function n0(t,{attrX:e,attrY:n,attrScale:r,originX:i,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...d},h,f,p){if(e0(t,d,h,p),f){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:g,style:x,dimensions:_}=t;g.transform&&(_&&(x.transform=g.transform),delete g.transform),_&&(i!==void 0||s!==void 0||x.transform)&&(x.transformOrigin=BP(_,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(g.x=e),n!==void 0&&(g.y=n),r!==void 0&&(g.scale=r),o!==void 0&&qP(g,o,a,l,!1)}const UE=()=>({...t0(),attrs:{}}),r0=t=>typeof t=="string"&&t.toLowerCase()==="svg";function HP(t,e,n,r){const i=R.useMemo(()=>{const s=UE();return n0(s,e,{enableHardwareAcceleration:!1},r0(r),t.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};FE(s,t.style,t),i.style={...s,...i.style}}return i}function GP(t=!1){return(n,r,i,{latestValues:s},o)=>{const l=(Zy(n)?HP:OP)(r,s,o,n),h={...UP(r,typeof n=="string",t),...l,ref:i},{children:f}=r,p=R.useMemo(()=>Dn(f)?f.get():f,[f]);return R.createElement(n,{...h,children:p})}}function BE(t,{style:e,vars:n},r,i){Object.assign(t.style,e,i&&i.getProjectionStyles(r));for(const s in n)t.style.setProperty(s,n[s])}const $E=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function WE(t,e,n,r){BE(t,e,void 0,r);for(const i in e.attrs)t.setAttribute($E.has(i)?i:Qy(i),e.attrs[i])}function i0(t,e){const{style:n}=t,r={};for(const i in n)(Dn(n[i])||e.style&&Dn(e.style[i])||jE(i,t))&&(r[i]=n[i]);return r}function qE(t,e){const n=i0(t,e);for(const r in t)if(Dn(t[r])||Dn(e[r])){const i=Qc.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[i]=t[r]}return n}function s0(t,e,n,r={},i={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,i)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,i)),e}function HE(t){const e=R.useRef(null);return e.current===null&&(e.current=t()),e.current}const rh=t=>Array.isArray(t),KP=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),QP=t=>rh(t)?t[t.length-1]||0:t;function md(t){const e=Dn(t)?t.get():t;return KP(e)?e.toValue():e}function YP({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,i,s){const o={latestValues:XP(r,i,s,t),renderState:e()};return n&&(o.mount=a=>n(r,a,o)),o}const GE=t=>(e,n)=>{const r=R.useContext(sf),i=R.useContext(of),s=()=>YP(t,e,r,i);return n?s():HE(s)};function XP(t,e,n,r){const i={},s=r(t,{});for(const p in s)i[p]=md(s[p]);let{initial:o,animate:a}=t;const l=cf(t),d=NE(t);e&&d&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let h=n?n.initial===!1:!1;h=h||o===!1;const f=h?a:o;return f&&typeof f!="boolean"&&!lf(f)&&(Array.isArray(f)?f:[f]).forEach(g=>{const x=s0(t,g);if(!x)return;const{transitionEnd:_,transition:k,...T}=x;for(const v in T){let w=T[v];if(Array.isArray(w)){const j=h?w.length-1:0;w=w[j]}w!==null&&(i[v]=w)}for(const v in _)i[v]=_[v]}),i}const wt=t=>t;class Sx{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function JP(t){let e=new Sx,n=new Sx,r=0,i=!1,s=!1;const o=new WeakSet,a={schedule:(l,d=!1,h=!1)=>{const f=h&&i,p=f?e:n;return d&&o.add(l),p.add(l)&&f&&i&&(r=e.order.length),l},cancel:l=>{n.remove(l),o.delete(l)},process:l=>{if(i){s=!0;return}if(i=!0,[e,n]=[n,e],n.clear(),r=e.order.length,r)for(let d=0;d<r;d++){const h=e.order[d];h(l),o.has(h)&&(a.schedule(h),t())}i=!1,s&&(s=!1,a.process(l))}};return a}const $u=["prepare","read","update","preRender","render","postRender"],ZP=40;function e5(t,e){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=$u.reduce((f,p)=>(f[p]=JP(()=>n=!0),f),{}),o=f=>s[f].process(i),a=()=>{const f=performance.now();n=!1,i.delta=r?1e3/60:Math.max(Math.min(f-i.timestamp,ZP),1),i.timestamp=f,i.isProcessing=!0,$u.forEach(o),i.isProcessing=!1,n&&e&&(r=!1,t(a))},l=()=>{n=!0,r=!0,i.isProcessing||t(a)};return{schedule:$u.reduce((f,p)=>{const g=s[p];return f[p]=(x,_=!1,k=!1)=>(n||l(),g.schedule(x,_,k)),f},{}),cancel:f=>$u.forEach(p=>s[p].cancel(f)),state:i,steps:s}}const{schedule:tt,cancel:wi,state:sn,steps:kp}=e5(typeof requestAnimationFrame<"u"?requestAnimationFrame:wt,!0),t5={useVisualState:GE({scrapeMotionValuesFromProps:qE,createRenderState:UE,onMount:(t,e,{renderState:n,latestValues:r})=>{tt.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),tt.render(()=>{n0(n,r,{enableHardwareAcceleration:!1},r0(e.tagName),t.transformTemplate),WE(e,n)})}})},n5={useVisualState:GE({scrapeMotionValuesFromProps:i0,createRenderState:t0})};function r5(t,{forwardMotionProps:e=!1},n,r){return{...Zy(t)?t5:n5,preloadedFeatures:n,useRender:GP(e),createVisualElement:r,Component:t}}function li(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const KE=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function df(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const i5=t=>e=>KE(e)&&t(e,df(e));function hi(t,e,n,r){return li(t,e,i5(n),r)}const s5=(t,e)=>n=>e(t(n)),hs=(...t)=>t.reduce(s5);function QE(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const Tx=QE("dragHorizontal"),Ex=QE("dragVertical");function YE(t){let e=!1;if(t==="y")e=Ex();else if(t==="x")e=Tx();else{const n=Tx(),r=Ex();n&&r?e=()=>{n(),r()}:(n&&n(),r&&r())}return e}function XE(){const t=YE(!0);return t?(t(),!1):!0}class Ds{constructor(e){this.isMounted=!1,this.node=e}update(){}}function bx(t,e){const n="pointer"+(e?"enter":"leave"),r="onHover"+(e?"Start":"End"),i=(s,o)=>{if(s.pointerType==="touch"||XE())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e),a[r]&&tt.update(()=>a[r](s,o))};return hi(t.current,n,i,{passive:!t.getProps()[r]})}class o5 extends Ds{mount(){this.unmount=hs(bx(this.node,!0),bx(this.node,!1))}unmount(){}}class a5 extends Ds{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=hs(li(this.node.current,"focus",()=>this.onFocus()),li(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const JE=(t,e)=>e?t===e?!0:JE(t,e.parentElement):!1;function Ap(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,df(n))}class l5 extends Ds{constructor(){super(...arguments),this.removeStartListeners=wt,this.removeEndListeners=wt,this.removeAccessibleListeners=wt,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const r=this.node.getProps(),s=hi(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:h,globalTapTarget:f}=this.node.getProps();tt.update(()=>{!f&&!JE(this.node.current,a.target)?h&&h(a,l):d&&d(a,l)})},{passive:!(r.onTap||r.onPointerUp)}),o=hi(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=hs(s,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=s=>{if(s.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||Ap("up",(l,d)=>{const{onTap:h}=this.node.getProps();h&&tt.update(()=>h(l,d))})};this.removeEndListeners(),this.removeEndListeners=li(this.node.current,"keyup",o),Ap("down",(a,l)=>{this.startPress(a,l)})},n=li(this.node.current,"keydown",e),r=()=>{this.isPressing&&Ap("cancel",(s,o)=>this.cancelPress(s,o))},i=li(this.node.current,"blur",r);this.removeAccessibleListeners=hs(n,i)}}startPress(e,n){this.isPressing=!0;const{onTapStart:r,whileTap:i}=this.node.getProps();i&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&tt.update(()=>r(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!XE()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&tt.update(()=>r(e,n))}mount(){const e=this.node.getProps(),n=hi(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),r=li(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=hs(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const ig=new WeakMap,Rp=new WeakMap,c5=t=>{const e=ig.get(t.target);e&&e(t)},u5=t=>{t.forEach(c5)};function d5({root:t,...e}){const n=t||document;Rp.has(n)||Rp.set(n,{});const r=Rp.get(n),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(u5,{root:t,...e})),r[i]}function h5(t,e,n){const r=d5(e);return ig.set(t,n),r.observe(t),()=>{ig.delete(t),r.unobserve(t)}}const f5={some:0,all:1};class p5 extends Ds{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:s}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:f5[i]},a=l=>{const{isIntersecting:d}=l;if(this.isInView===d||(this.isInView=d,s&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),p=d?h:f;p&&p(l)};return h5(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(m5(e,n))&&this.startObserver()}unmount(){}}function m5({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const g5={inView:{Feature:p5},tap:{Feature:l5},focus:{Feature:a5},hover:{Feature:o5}};function ZE(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function y5(t){const e={};return t.values.forEach((n,r)=>e[r]=n.get()),e}function v5(t){const e={};return t.values.forEach((n,r)=>e[r]=n.getVelocity()),e}function hf(t,e,n){const r=t.getProps();return s0(r,e,n!==void 0?n:r.custom,y5(t),v5(t))}let x5=wt,o0=wt;const fs=t=>t*1e3,fi=t=>t/1e3,w5={current:!1},eb=t=>Array.isArray(t)&&typeof t[0]=="number";function tb(t){return!!(!t||typeof t=="string"&&nb[t]||eb(t)||Array.isArray(t)&&t.every(tb))}const Nl=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,nb={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Nl([0,.65,.55,1]),circOut:Nl([.55,0,1,.45]),backIn:Nl([.31,.01,.66,-.59]),backOut:Nl([.33,1.53,.69,.99])};function rb(t){if(t)return eb(t)?Nl(t):Array.isArray(t)?t.map(rb):nb[t]}function _5(t,e,n,{delay:r=0,duration:i,repeat:s=0,repeatType:o="loop",ease:a,times:l}={}){const d={[e]:n};l&&(d.offset=l);const h=rb(a);return Array.isArray(h)&&(d.easing=h),t.animate(d,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}function S5(t,{repeat:e,repeatType:n="loop"}){const r=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[r]}const ib=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,T5=1e-7,E5=12;function b5(t,e,n,r,i){let s,o,a=0;do o=e+(n-e)/2,s=ib(o,r,i)-t,s>0?n=o:e=o;while(Math.abs(s)>T5&&++a<E5);return o}function Jc(t,e,n,r){if(t===e&&n===r)return wt;const i=s=>b5(s,0,1,t,n);return s=>s===0||s===1?s:ib(i(s),e,r)}const I5=Jc(.42,0,1,1),C5=Jc(0,0,.58,1),sb=Jc(.42,0,.58,1),k5=t=>Array.isArray(t)&&typeof t[0]!="number",ob=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,ab=t=>e=>1-t(1-e),a0=t=>1-Math.sin(Math.acos(t)),lb=ab(a0),A5=ob(a0),cb=Jc(.33,1.53,.69,.99),l0=ab(cb),R5=ob(l0),P5=t=>(t*=2)<1?.5*l0(t):.5*(2-Math.pow(2,-10*(t-1))),N5={linear:wt,easeIn:I5,easeInOut:sb,easeOut:C5,circIn:a0,circInOut:A5,circOut:lb,backIn:l0,backInOut:R5,backOut:cb,anticipate:P5},Ix=t=>{if(Array.isArray(t)){o0(t.length===4);const[e,n,r,i]=t;return Jc(e,n,r,i)}else if(typeof t=="string")return N5[t];return t},c0=(t,e)=>n=>!!(Yc(n)&&DP.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),ub=(t,e,n)=>r=>{if(!Yc(r))return r;const[i,s,o,a]=r.match(uf);return{[t]:parseFloat(i),[e]:parseFloat(s),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},D5=t=>_s(0,255,t),Pp={...Ao,transform:t=>Math.round(D5(t))},to={test:c0("rgb","red"),parse:ub("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+Pp.transform(t)+", "+Pp.transform(e)+", "+Pp.transform(n)+", "+Kl(Gl.transform(r))+")"};function j5(t){let e="",n="",r="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const sg={test:c0("#"),parse:j5,transform:to.transform},la={test:c0("hsl","hue"),parse:ub("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Wr.transform(Kl(e))+", "+Wr.transform(Kl(n))+", "+Kl(Gl.transform(r))+")"},yn={test:t=>to.test(t)||sg.test(t)||la.test(t),parse:t=>to.test(t)?to.parse(t):la.test(t)?la.parse(t):sg.parse(t),transform:t=>Yc(t)?t:t.hasOwnProperty("red")?to.transform(t):la.transform(t)},ft=(t,e,n)=>-n*t+n*e+t;function Np(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function L5({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let i=0,s=0,o=0;if(!e)i=s=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;i=Np(l,a,t+1/3),s=Np(l,a,t),o=Np(l,a,t-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:r}}const Dp=(t,e,n)=>{const r=t*t;return Math.sqrt(Math.max(0,n*(e*e-r)+r))},M5=[sg,to,la],V5=t=>M5.find(e=>e.test(t));function Cx(t){const e=V5(t);let n=e.parse(t);return e===la&&(n=L5(n)),n}const db=(t,e)=>{const n=Cx(t),r=Cx(e),i={...n};return s=>(i.red=Dp(n.red,r.red,s),i.green=Dp(n.green,r.green,s),i.blue=Dp(n.blue,r.blue,s),i.alpha=ft(n.alpha,r.alpha,s),to.transform(i))};function O5(t){var e,n;return isNaN(t)&&Yc(t)&&(((e=t.match(uf))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(VE))===null||n===void 0?void 0:n.length)||0)>0}const hb={regex:PP,countKey:"Vars",token:"${v}",parse:wt},fb={regex:VE,countKey:"Colors",token:"${c}",parse:yn.parse},pb={regex:uf,countKey:"Numbers",token:"${n}",parse:Ao.parse};function jp(t,{regex:e,countKey:n,token:r,parse:i}){const s=t.tokenised.match(e);s&&(t["num"+n]=s.length,t.tokenised=t.tokenised.replace(e,r),t.values.push(...s.map(i)))}function ih(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&jp(n,hb),jp(n,fb),jp(n,pb),n}function mb(t){return ih(t).values}function gb(t){const{values:e,numColors:n,numVars:r,tokenised:i}=ih(t),s=e.length;return o=>{let a=i;for(let l=0;l<s;l++)l<r?a=a.replace(hb.token,o[l]):l<r+n?a=a.replace(fb.token,yn.transform(o[l])):a=a.replace(pb.token,Kl(o[l]));return a}}const F5=t=>typeof t=="number"?0:t;function z5(t){const e=mb(t);return gb(t)(e.map(F5))}const Ss={test:O5,parse:mb,createTransformer:gb,getAnimatableNone:z5},yb=(t,e)=>n=>`${n>0?e:t}`;function vb(t,e){return typeof t=="number"?n=>ft(t,e,n):yn.test(t)?db(t,e):t.startsWith("var(")?yb(t,e):wb(t,e)}const xb=(t,e)=>{const n=[...t],r=n.length,i=t.map((s,o)=>vb(s,e[o]));return s=>{for(let o=0;o<r;o++)n[o]=i[o](s);return n}},U5=(t,e)=>{const n={...t,...e},r={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(r[i]=vb(t[i],e[i]));return i=>{for(const s in r)n[s]=r[s](i);return n}},wb=(t,e)=>{const n=Ss.createTransformer(e),r=ih(t),i=ih(e);return r.numVars===i.numVars&&r.numColors===i.numColors&&r.numNumbers>=i.numNumbers?hs(xb(r.values,i.values),n):yb(t,e)},Ec=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},kx=(t,e)=>n=>ft(t,e,n);function B5(t){return typeof t=="number"?kx:typeof t=="string"?yn.test(t)?db:wb:Array.isArray(t)?xb:typeof t=="object"?U5:kx}function $5(t,e,n){const r=[],i=n||B5(t[0]),s=t.length-1;for(let o=0;o<s;o++){let a=i(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||wt:e;a=hs(l,a)}r.push(a)}return r}function _b(t,e,{clamp:n=!0,ease:r,mixer:i}={}){const s=t.length;if(o0(s===e.length),s===1)return()=>e[0];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=$5(e,r,i),a=o.length,l=d=>{let h=0;if(a>1)for(;h<t.length-2&&!(d<t[h+1]);h++);const f=Ec(t[h],t[h+1],d);return o[h](f)};return n?d=>l(_s(t[0],t[s-1],d)):l}function W5(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const i=Ec(0,e,r);t.push(ft(n,1,i))}}function q5(t){const e=[0];return W5(e,t.length-1),e}function H5(t,e){return t.map(n=>n*e)}function G5(t,e){return t.map(()=>e||sb).splice(0,t.length-1)}function sh({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const i=k5(r)?r.map(Ix):Ix(r),s={done:!1,value:e[0]},o=H5(n&&n.length===e.length?n:q5(e),t),a=_b(o,e,{ease:Array.isArray(i)?i:G5(e,i)});return{calculatedDuration:t,next:l=>(s.value=a(l),s.done=l>=t,s)}}function Sb(t,e){return e?t*(1e3/e):0}const K5=5;function Tb(t,e,n){const r=Math.max(e-K5,0);return Sb(n-t(r),e-r)}const Lp=.001,Q5=.01,Ax=10,Y5=.05,X5=1;function J5({duration:t=800,bounce:e=.25,velocity:n=0,mass:r=1}){let i,s;x5(t<=fs(Ax));let o=1-e;o=_s(Y5,X5,o),t=_s(Q5,Ax,fi(t)),o<1?(i=d=>{const h=d*o,f=h*t,p=h-n,g=og(d,o),x=Math.exp(-f);return Lp-p/g*x},s=d=>{const f=d*o*t,p=f*n+n,g=Math.pow(o,2)*Math.pow(d,2)*t,x=Math.exp(-f),_=og(Math.pow(d,2),o);return(-i(d)+Lp>0?-1:1)*((p-g)*x)/_}):(i=d=>{const h=Math.exp(-d*t),f=(d-n)*t+1;return-Lp+h*f},s=d=>{const h=Math.exp(-d*t),f=(n-d)*(t*t);return h*f});const a=5/t,l=e4(i,s,a);if(t=fs(t),isNaN(l))return{stiffness:100,damping:10,duration:t};{const d=Math.pow(l,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:t}}}const Z5=12;function e4(t,e,n){let r=n;for(let i=1;i<Z5;i++)r=r-t(r)/e(r);return r}function og(t,e){return t*Math.sqrt(1-e*e)}const t4=["duration","bounce"],n4=["stiffness","damping","mass"];function Rx(t,e){return e.some(n=>t[n]!==void 0)}function r4(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!Rx(t,n4)&&Rx(t,t4)){const n=J5(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function Eb({keyframes:t,restDelta:e,restSpeed:n,...r}){const i=t[0],s=t[t.length-1],o={done:!1,value:i},{stiffness:a,damping:l,mass:d,duration:h,velocity:f,isResolvedFromDuration:p}=r4({...r,velocity:-fi(r.velocity||0)}),g=f||0,x=l/(2*Math.sqrt(a*d)),_=s-i,k=fi(Math.sqrt(a/d)),T=Math.abs(_)<5;n||(n=T?.01:2),e||(e=T?.005:.5);let v;if(x<1){const w=og(k,x);v=j=>{const L=Math.exp(-x*k*j);return s-L*((g+x*k*_)/w*Math.sin(w*j)+_*Math.cos(w*j))}}else if(x===1)v=w=>s-Math.exp(-k*w)*(_+(g+k*_)*w);else{const w=k*Math.sqrt(x*x-1);v=j=>{const L=Math.exp(-x*k*j),V=Math.min(w*j,300);return s-L*((g+x*k*_)*Math.sinh(V)+w*_*Math.cosh(V))/w}}return{calculatedDuration:p&&h||null,next:w=>{const j=v(w);if(p)o.done=w>=h;else{let L=g;w!==0&&(x<1?L=Tb(v,w,j):L=0);const V=Math.abs(L)<=n,E=Math.abs(s-j)<=e;o.done=V&&E}return o.value=o.done?s:j,o}}}function Px({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:d=.5,restSpeed:h}){const f=t[0],p={done:!1,value:f},g=S=>a!==void 0&&S<a||l!==void 0&&S>l,x=S=>a===void 0?l:l===void 0||Math.abs(a-S)<Math.abs(l-S)?a:l;let _=n*e;const k=f+_,T=o===void 0?k:o(k);T!==k&&(_=T-f);const v=S=>-_*Math.exp(-S/r),w=S=>T+v(S),j=S=>{const I=v(S),A=w(S);p.done=Math.abs(I)<=d,p.value=p.done?T:A};let L,V;const E=S=>{g(p.value)&&(L=S,V=Eb({keyframes:[p.value,x(p.value)],velocity:Tb(w,S,p.value),damping:i,stiffness:s,restDelta:d,restSpeed:h}))};return E(0),{calculatedDuration:null,next:S=>{let I=!1;return!V&&L===void 0&&(I=!0,j(S),E(S)),L!==void 0&&S>L?V.next(S-L):(!I&&j(S),p)}}}const i4=t=>{const e=({timestamp:n})=>t(n);return{start:()=>tt.update(e,!0),stop:()=>wi(e),now:()=>sn.isProcessing?sn.timestamp:performance.now()}},Nx=2e4;function Dx(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<Nx;)e+=n,r=t.next(e);return e>=Nx?1/0:e}const s4={decay:Px,inertia:Px,tween:sh,keyframes:sh,spring:Eb};function oh({autoplay:t=!0,delay:e=0,driver:n=i4,keyframes:r,type:i="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:a="loop",onPlay:l,onStop:d,onComplete:h,onUpdate:f,...p}){let g=1,x=!1,_,k;const T=()=>{k=new Promise(D=>{_=D})};T();let v;const w=s4[i]||sh;let j;w!==sh&&typeof r[0]!="number"&&(j=_b([0,100],r,{clamp:!1}),r=[0,100]);const L=w({...p,keyframes:r});let V;a==="mirror"&&(V=w({...p,keyframes:[...r].reverse(),velocity:-(p.velocity||0)}));let E="idle",S=null,I=null,A=null;L.calculatedDuration===null&&s&&(L.calculatedDuration=Dx(L));const{calculatedDuration:P}=L;let N=1/0,b=1/0;P!==null&&(N=P+o,b=N*(s+1)-o);let W=0;const de=D=>{if(I===null)return;g>0&&(I=Math.min(I,D)),g<0&&(I=Math.min(D-b/g,I)),S!==null?W=S:W=Math.round(D-I)*g;const H=W-e*(g>=0?1:-1),J=g>=0?H<0:H>b;W=Math.max(H,0),E==="finished"&&S===null&&(W=b);let te=W,ie=L;if(s){const pe=Math.min(W,b)/N;let _e=Math.floor(pe),ge=pe%1;!ge&&pe>=1&&(ge=1),ge===1&&_e--,_e=Math.min(_e,s+1),!!(_e%2)&&(a==="reverse"?(ge=1-ge,o&&(ge-=o/N)):a==="mirror"&&(ie=V)),te=_s(0,1,ge)*N}const ee=J?{done:!1,value:r[0]}:ie.next(te);j&&(ee.value=j(ee.value));let{done:U}=ee;!J&&P!==null&&(U=g>=0?W>=b:W<=0);const Y=S===null&&(E==="finished"||E==="running"&&U);return f&&f(ee.value),Y&&z(),ee},re=()=>{v&&v.stop(),v=void 0},se=()=>{E="idle",re(),_(),T(),I=A=null},z=()=>{E="finished",h&&h(),re(),_()},G=()=>{if(x)return;v||(v=n(de));const D=v.now();l&&l(),S!==null?I=D-S:(!I||E==="finished")&&(I=D),E==="finished"&&T(),A=I,S=null,E="running",v.start()};t&&G();const M={then(D,H){return k.then(D,H)},get time(){return fi(W)},set time(D){D=fs(D),W=D,S!==null||!v||g===0?S=D:I=v.now()-D/g},get duration(){const D=L.calculatedDuration===null?Dx(L):L.calculatedDuration;return fi(D)},get speed(){return g},set speed(D){D===g||!v||(g=D,M.time=fi(W))},get state(){return E},play:G,pause:()=>{E="paused",S=W},stop:()=>{x=!0,E!=="idle"&&(E="idle",d&&d(),se())},cancel:()=>{A!==null&&de(A),se()},complete:()=>{E="finished"},sample:D=>(I=0,de(D))};return M}function o4(t){let e;return()=>(e===void 0&&(e=t()),e)}const a4=o4(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),l4=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Wu=10,c4=2e4,u4=(t,e)=>e.type==="spring"||t==="backgroundColor"||!tb(e.ease);function d4(t,e,{onUpdate:n,onComplete:r,...i}){if(!(a4()&&l4.has(e)&&!i.repeatDelay&&i.repeatType!=="mirror"&&i.damping!==0&&i.type!=="inertia"))return!1;let o=!1,a,l,d=!1;const h=()=>{l=new Promise(w=>{a=w})};h();let{keyframes:f,duration:p=300,ease:g,times:x}=i;if(u4(e,i)){const w=oh({...i,repeat:0,delay:0});let j={done:!1,value:f[0]};const L=[];let V=0;for(;!j.done&&V<c4;)j=w.sample(V),L.push(j.value),V+=Wu;x=void 0,f=L,p=V-Wu,g="linear"}const _=_5(t.owner.current,e,f,{...i,duration:p,ease:g,times:x}),k=()=>{d=!1,_.cancel()},T=()=>{d=!0,tt.update(k),a(),h()};return _.onfinish=()=>{d||(t.set(S5(f,i)),r&&r(),T())},{then(w,j){return l.then(w,j)},attachTimeline(w){return _.timeline=w,_.onfinish=null,wt},get time(){return fi(_.currentTime||0)},set time(w){_.currentTime=fs(w)},get speed(){return _.playbackRate},set speed(w){_.playbackRate=w},get duration(){return fi(p)},play:()=>{o||(_.play(),wi(k))},pause:()=>_.pause(),stop:()=>{if(o=!0,_.playState==="idle")return;const{currentTime:w}=_;if(w){const j=oh({...i,autoplay:!1});t.setWithVelocity(j.sample(w-Wu).value,j.sample(w).value,Wu)}T()},complete:()=>{d||_.finish()},cancel:T}}function h4({keyframes:t,delay:e,onUpdate:n,onComplete:r}){const i=()=>(n&&n(t[t.length-1]),r&&r(),{time:0,speed:1,duration:0,play:wt,pause:wt,stop:wt,then:s=>(s(),Promise.resolve()),cancel:wt,complete:wt});return e?oh({keyframes:[0,1],duration:0,delay:e,onComplete:i}):i()}const f4={type:"spring",stiffness:500,damping:25,restSpeed:10},p4=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),m4={type:"keyframes",duration:.8},g4={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},y4=(t,{keyframes:e})=>e.length>2?m4:ko.has(t)?t.startsWith("scale")?p4(e[1]):f4:g4,ag=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Ss.test(e)||e==="0")&&!e.startsWith("url(")),v4=new Set(["brightness","contrast","saturate","opacity"]);function x4(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(uf)||[];if(!r)return t;const i=n.replace(r,"");let s=v4.has(e)?1:0;return r!==n&&(s*=100),e+"("+s+i+")"}const w4=/([a-z-]*)\(.*?\)/g,lg={...Ss,getAnimatableNone:t=>{const e=t.match(w4);return e?e.map(x4).join(" "):t}},_4={...OE,color:yn,backgroundColor:yn,outlineColor:yn,fill:yn,stroke:yn,borderColor:yn,borderTopColor:yn,borderRightColor:yn,borderBottomColor:yn,borderLeftColor:yn,filter:lg,WebkitFilter:lg},u0=t=>_4[t];function bb(t,e){let n=u0(t);return n!==lg&&(n=Ss),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const Ib=t=>/^0[^.\s]+$/.test(t);function S4(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||Ib(t)}function T4(t,e,n,r){const i=ag(e,n);let s;Array.isArray(n)?s=[...n]:s=[null,n];const o=r.from!==void 0?r.from:t.get();let a;const l=[];for(let d=0;d<s.length;d++)s[d]===null&&(s[d]=d===0?o:s[d-1]),S4(s[d])&&l.push(d),typeof s[d]=="string"&&s[d]!=="none"&&s[d]!=="0"&&(a=s[d]);if(i&&l.length&&a)for(let d=0;d<l.length;d++){const h=l[d];s[h]=bb(e,a)}return s}function E4({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:d,...h}){return!!Object.keys(h).length}function d0(t,e){return t[e]||t.default||t}const b4={skipAnimations:!1},h0=(t,e,n,r={})=>i=>{const s=d0(r,t)||{},o=s.delay||r.delay||0;let{elapsed:a=0}=r;a=a-fs(o);const l=T4(e,t,n,s),d=l[0],h=l[l.length-1],f=ag(t,d),p=ag(t,h);let g={keyframes:l,velocity:e.getVelocity(),ease:"easeOut",...s,delay:-a,onUpdate:x=>{e.set(x),s.onUpdate&&s.onUpdate(x)},onComplete:()=>{i(),s.onComplete&&s.onComplete()}};if(E4(s)||(g={...g,...y4(t,g)}),g.duration&&(g.duration=fs(g.duration)),g.repeatDelay&&(g.repeatDelay=fs(g.repeatDelay)),!f||!p||w5.current||s.type===!1||b4.skipAnimations)return h4(g);if(!r.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const x=d4(e,t,g);if(x)return x}return oh(g)};function ah(t){return!!(Dn(t)&&t.add)}const Cb=t=>/^\-?\d*\.?\d+$/.test(t);function f0(t,e){t.indexOf(e)===-1&&t.push(e)}function p0(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class m0{constructor(){this.subscriptions=[]}add(e){return f0(this.subscriptions,e),()=>p0(this.subscriptions,e)}notify(e,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,r);else for(let s=0;s<i;s++){const o=this.subscriptions[s];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const I4=t=>!isNaN(parseFloat(t));class C4{constructor(e,n={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,i=!0)=>{this.prev=this.current,this.current=r;const{delta:s,timestamp:o}=sn;this.lastUpdated!==o&&(this.timeDelta=s,this.lastUpdated=o,tt.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>tt.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=I4(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new m0);const r=this.events[e].add(n);return e==="change"?()=>{r(),tt.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=e,this.timeDelta=r}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?Sb(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Va(t,e){return new C4(t,e)}const kb=t=>e=>e.test(t),k4={test:t=>t==="auto",parse:t=>t},Ab=[Ao,Se,Wr,Fi,LP,jP,k4],Tl=t=>Ab.find(kb(t)),A4=[...Ab,yn,Ss],R4=t=>A4.find(kb(t));function P4(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Va(n))}function N4(t,e){const n=hf(t,e);let{transitionEnd:r={},transition:i={},...s}=n?t.makeTargetAnimatable(n,!1):{};s={...s,...r};for(const o in s){const a=QP(s[o]);P4(t,o,a)}}function D4(t,e,n){var r,i;const s=Object.keys(e).filter(a=>!t.hasValue(a)),o=s.length;if(o)for(let a=0;a<o;a++){const l=s[a],d=e[l];let h=null;Array.isArray(d)&&(h=d[0]),h===null&&(h=(i=(r=n[l])!==null&&r!==void 0?r:t.readValue(l))!==null&&i!==void 0?i:e[l]),h!=null&&(typeof h=="string"&&(Cb(h)||Ib(h))?h=parseFloat(h):!R4(h)&&Ss.test(d)&&(h=bb(l,d)),t.addValue(l,Va(h,{owner:t})),n[l]===void 0&&(n[l]=h),h!==null&&t.setBaseTarget(l,h))}}function j4(t,e){return e?(e[t]||e.default||e).from:void 0}function L4(t,e,n){const r={};for(const i in t){const s=j4(i,e);if(s!==void 0)r[i]=s;else{const o=n.getValue(i);o&&(r[i]=o.get())}}return r}function M4({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function V4(t,e){const n=t.get();if(Array.isArray(e)){for(let r=0;r<e.length;r++)if(e[r]!==n)return!0}else return n!==e}function Rb(t,e,{delay:n=0,transitionOverride:r,type:i}={}){let{transition:s=t.getDefaultTransition(),transitionEnd:o,...a}=t.makeTargetAnimatable(e);const l=t.getValue("willChange");r&&(s=r);const d=[],h=i&&t.animationState&&t.animationState.getState()[i];for(const f in a){const p=t.getValue(f),g=a[f];if(!p||g===void 0||h&&M4(h,f))continue;const x={delay:n,elapsed:0,...d0(s||{},f)};if(window.HandoffAppearAnimations){const T=t.getProps()[PE];if(T){const v=window.HandoffAppearAnimations(T,f,p,tt);v!==null&&(x.elapsed=v,x.isHandoff=!0)}}let _=!x.isHandoff&&!V4(p,g);if(x.type==="spring"&&(p.getVelocity()||x.velocity)&&(_=!1),p.animation&&(_=!1),_)continue;p.start(h0(f,p,g,t.shouldReduceMotion&&ko.has(f)?{type:!1}:x));const k=p.animation;ah(l)&&(l.add(f),k.then(()=>l.remove(f))),d.push(k)}return o&&Promise.all(d).then(()=>{o&&N4(t,o)}),d}function cg(t,e,n={}){const r=hf(t,e,n.custom);let{transition:i=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const s=r?()=>Promise.all(Rb(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(l=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:f}=i;return O4(t,e,d+l,h,f,n)}:()=>Promise.resolve(),{when:a}=i;if(a){const[l,d]=a==="beforeChildren"?[s,o]:[o,s];return l().then(()=>d())}else return Promise.all([s(),o(n.delay)])}function O4(t,e,n=0,r=0,i=1,s){const o=[],a=(t.variantChildren.size-1)*r,l=i===1?(d=0)=>d*r:(d=0)=>a-d*r;return Array.from(t.variantChildren).sort(F4).forEach((d,h)=>{d.notify("AnimationStart",e),o.push(cg(d,e,{...s,delay:n+l(h)}).then(()=>d.notify("AnimationComplete",e)))}),Promise.all(o)}function F4(t,e){return t.sortNodePosition(e)}function z4(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>cg(t,s,n));r=Promise.all(i)}else if(typeof e=="string")r=cg(t,e,n);else{const i=typeof e=="function"?hf(t,e,n.custom):e;r=Promise.all(Rb(t,i,n))}return r.then(()=>t.notify("AnimationComplete",e))}const U4=[...Yy].reverse(),B4=Yy.length;function $4(t){return e=>Promise.all(e.map(({animation:n,options:r})=>z4(t,n,r)))}function W4(t){let e=$4(t);const n=H4();let r=!0;const i=(l,d)=>{const h=hf(t,d);if(h){const{transition:f,transitionEnd:p,...g}=h;l={...l,...g,...p}}return l};function s(l){e=l(t)}function o(l,d){const h=t.getProps(),f=t.getVariantContext(!0)||{},p=[],g=new Set;let x={},_=1/0;for(let T=0;T<B4;T++){const v=U4[T],w=n[v],j=h[v]!==void 0?h[v]:f[v],L=Sc(j),V=v===d?w.isActive:null;V===!1&&(_=T);let E=j===f[v]&&j!==h[v]&&L;if(E&&r&&t.manuallyAnimateOnMount&&(E=!1),w.protectedKeys={...x},!w.isActive&&V===null||!j&&!w.prevProp||lf(j)||typeof j=="boolean")continue;let I=q4(w.prevProp,j)||v===d&&w.isActive&&!E&&L||T>_&&L,A=!1;const P=Array.isArray(j)?j:[j];let N=P.reduce(i,{});V===!1&&(N={});const{prevResolvedValues:b={}}=w,W={...b,...N},de=re=>{I=!0,g.has(re)&&(A=!0,g.delete(re)),w.needsAnimating[re]=!0};for(const re in W){const se=N[re],z=b[re];if(x.hasOwnProperty(re))continue;let G=!1;rh(se)&&rh(z)?G=!ZE(se,z):G=se!==z,G?se!==void 0?de(re):g.add(re):se!==void 0&&g.has(re)?de(re):w.protectedKeys[re]=!0}w.prevProp=j,w.prevResolvedValues=N,w.isActive&&(x={...x,...N}),r&&t.blockInitialAnimation&&(I=!1),I&&(!E||A)&&p.push(...P.map(re=>({animation:re,options:{type:v,...l}})))}if(g.size){const T={};g.forEach(v=>{const w=t.getBaseTarget(v);w!==void 0&&(T[v]=w)}),p.push({animation:T})}let k=!!p.length;return r&&(h.initial===!1||h.initial===h.animate)&&!t.manuallyAnimateOnMount&&(k=!1),r=!1,k?e(p):Promise.resolve()}function a(l,d,h){var f;if(n[l].isActive===d)return Promise.resolve();(f=t.variantChildren)===null||f===void 0||f.forEach(g=>{var x;return(x=g.animationState)===null||x===void 0?void 0:x.setActive(l,d)}),n[l].isActive=d;const p=o(h,l);for(const g in n)n[g].protectedKeys={};return p}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>n}}function q4(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!ZE(e,t):!1}function Bs(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function H4(){return{animate:Bs(!0),whileInView:Bs(),whileHover:Bs(),whileTap:Bs(),whileDrag:Bs(),whileFocus:Bs(),exit:Bs()}}class G4 extends Ds{constructor(e){super(e),e.animationState||(e.animationState=W4(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),lf(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let K4=0;class Q4 extends Ds{constructor(){super(...arguments),this.id=K4++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const s=this.node.animationState.setActive("exit",!e,{custom:r??this.node.getProps().custom});n&&!e&&s.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Y4={animation:{Feature:G4},exit:{Feature:Q4}},jx=(t,e)=>Math.abs(t-e);function X4(t,e){const n=jx(t.x,e.x),r=jx(t.y,e.y);return Math.sqrt(n**2+r**2)}class Pb{constructor(e,n,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=Vp(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,g=X4(f.offset,{x:0,y:0})>=3;if(!p&&!g)return;const{point:x}=f,{timestamp:_}=sn;this.history.push({...x,timestamp:_});const{onStart:k,onMove:T}=this.handlers;p||(k&&k(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,f)},this.handlePointerMove=(f,p)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=Mp(p,this.transformPagePoint),tt.update(this.updatePoint,!0)},this.handlePointerUp=(f,p)=>{this.end();const{onEnd:g,onSessionEnd:x,resumeAnimation:_}=this.handlers;if(this.dragSnapToOrigin&&_&&_(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const k=Vp(f.type==="pointercancel"?this.lastMoveEventInfo:Mp(p,this.transformPagePoint),this.history);this.startEvent&&g&&g(f,k),x&&x(f,k)},!KE(e))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=r,this.contextWindow=i||window;const o=df(e),a=Mp(o,this.transformPagePoint),{point:l}=a,{timestamp:d}=sn;this.history=[{...l,timestamp:d}];const{onSessionStart:h}=n;h&&h(e,Vp(a,this.history)),this.removeListeners=hs(hi(this.contextWindow,"pointermove",this.handlePointerMove),hi(this.contextWindow,"pointerup",this.handlePointerUp),hi(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),wi(this.updatePoint)}}function Mp(t,e){return e?{point:e(t.point)}:t}function Lx(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Vp({point:t},e){return{point:t,delta:Lx(t,Nb(e)),offset:Lx(t,J4(e)),velocity:Z4(e,.1)}}function J4(t){return t[0]}function Nb(t){return t[t.length-1]}function Z4(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const i=Nb(t);for(;n>=0&&(r=t[n],!(i.timestamp-r.timestamp>fs(e)));)n--;if(!r)return{x:0,y:0};const s=fi(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const o={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Wn(t){return t.max-t.min}function ug(t,e=0,n=.01){return Math.abs(t-e)<=n}function Mx(t,e,n,r=.5){t.origin=r,t.originPoint=ft(e.min,e.max,t.origin),t.scale=Wn(n)/Wn(e),(ug(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=ft(n.min,n.max,t.origin)-t.originPoint,(ug(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Ql(t,e,n,r){Mx(t.x,e.x,n.x,r?r.originX:void 0),Mx(t.y,e.y,n.y,r?r.originY:void 0)}function Vx(t,e,n){t.min=n.min+e.min,t.max=t.min+Wn(e)}function eN(t,e,n){Vx(t.x,e.x,n.x),Vx(t.y,e.y,n.y)}function Ox(t,e,n){t.min=e.min-n.min,t.max=t.min+Wn(e)}function Yl(t,e,n){Ox(t.x,e.x,n.x),Ox(t.y,e.y,n.y)}function tN(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?ft(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?ft(n,t,r.max):Math.min(t,n)),t}function Fx(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function nN(t,{top:e,left:n,bottom:r,right:i}){return{x:Fx(t.x,n,i),y:Fx(t.y,e,r)}}function zx(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function rN(t,e){return{x:zx(t.x,e.x),y:zx(t.y,e.y)}}function iN(t,e){let n=.5;const r=Wn(t),i=Wn(e);return i>r?n=Ec(e.min,e.max-r,t.min):r>i&&(n=Ec(t.min,t.max-i,e.min)),_s(0,1,n)}function sN(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const dg=.35;function oN(t=dg){return t===!1?t=0:t===!0&&(t=dg),{x:Ux(t,"left","right"),y:Ux(t,"top","bottom")}}function Ux(t,e,n){return{min:Bx(t,e),max:Bx(t,n)}}function Bx(t,e){return typeof t=="number"?t:t[e]||0}const $x=()=>({translate:0,scale:1,origin:0,originPoint:0}),ca=()=>({x:$x(),y:$x()}),Wx=()=>({min:0,max:0}),At=()=>({x:Wx(),y:Wx()});function Zn(t){return[t("x"),t("y")]}function Db({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function aN({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function lN(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function Op(t){return t===void 0||t===1}function hg({scale:t,scaleX:e,scaleY:n}){return!Op(t)||!Op(e)||!Op(n)}function Hs(t){return hg(t)||jb(t)||t.z||t.rotate||t.rotateX||t.rotateY}function jb(t){return qx(t.x)||qx(t.y)}function qx(t){return t&&t!=="0%"}function lh(t,e,n){const r=t-n,i=e*r;return n+i}function Hx(t,e,n,r,i){return i!==void 0&&(t=lh(t,i,r)),lh(t,n,r)+e}function fg(t,e=0,n=1,r,i){t.min=Hx(t.min,e,n,r,i),t.max=Hx(t.max,e,n,r,i)}function Lb(t,{x:e,y:n}){fg(t.x,e.translate,e.scale,e.originPoint),fg(t.y,n.translate,n.scale,n.originPoint)}function cN(t,e,n,r=!1){const i=n.length;if(!i)return;e.x=e.y=1;let s,o;for(let a=0;a<i;a++){s=n[a],o=s.projectionDelta;const l=s.instance;l&&l.style&&l.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&ua(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Lb(t,o)),r&&Hs(s.latestValues)&&ua(t,s.latestValues))}e.x=Gx(e.x),e.y=Gx(e.y)}function Gx(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function $i(t,e){t.min=t.min+e,t.max=t.max+e}function Kx(t,e,[n,r,i]){const s=e[i]!==void 0?e[i]:.5,o=ft(t.min,t.max,s);fg(t,e[n],e[r],o,e.scale)}const uN=["x","scaleX","originX"],dN=["y","scaleY","originY"];function ua(t,e){Kx(t.x,e,uN),Kx(t.y,e,dN)}function Mb(t,e){return Db(lN(t.getBoundingClientRect(),e))}function hN(t,e,n){const r=Mb(t,n),{scroll:i}=e;return i&&($i(r.x,i.offset.x),$i(r.y,i.offset.y)),r}const Vb=({current:t})=>t?t.ownerDocument.defaultView:null,fN=new WeakMap;class pN{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=At(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(df(h,"page").point)},s=(h,f)=>{const{drag:p,dragPropagation:g,onDragStart:x}=this.getProps();if(p&&!g&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=YE(p),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Zn(k=>{let T=this.getAxisMotionValue(k).get()||0;if(Wr.test(T)){const{projection:v}=this.visualElement;if(v&&v.layout){const w=v.layout.layoutBox[k];w&&(T=Wn(w)*(parseFloat(T)/100))}}this.originPoint[k]=T}),x&&tt.update(()=>x(h,f),!1,!0);const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},o=(h,f)=>{const{dragPropagation:p,dragDirectionLock:g,onDirectionLock:x,onDrag:_}=this.getProps();if(!p&&!this.openGlobalLock)return;const{offset:k}=f;if(g&&this.currentDirection===null){this.currentDirection=mN(k),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",f.point,k),this.updateAxis("y",f.point,k),this.visualElement.render(),_&&_(h,f)},a=(h,f)=>this.stop(h,f),l=()=>Zn(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new Pb(e,{onSessionStart:i,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:Vb(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&tt.update(()=>s(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:i}=this.getProps();if(!r||!qu(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=tN(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;n&&aa(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&i?this.constraints=nN(i.layoutBox,n):this.constraints=!1,this.elastic=oN(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Zn(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=sN(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!aa(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=hN(r,i.root,this.visualElement.getTransformPagePoint());let o=rN(i.layout.layoutBox,s);if(n){const a=n(aN(o));this.hasMutatedConstraints=!!a,a&&(o=Db(a))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},d=Zn(h=>{if(!qu(h,n,this.currentDirection))return;let f=l&&l[h]||{};o&&(f={min:0,max:0});const p=i?200:1e6,g=i?40:1e7,x={type:"inertia",velocity:r?e[h]:0,bounceStiffness:p,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...s,...f};return this.startAxisValueAnimation(h,x)});return Promise.all(d).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return r.start(h0(e,r,0,n))}stopAnimation(){Zn(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Zn(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Zn(n=>{const{drag:r}=this.getProps();if(!qu(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:a}=i.layout.layoutBox[n];s.set(e[n]-ft(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!aa(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Zn(o=>{const a=this.getAxisMotionValue(o);if(a){const l=a.get();i[o]=iN({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Zn(o=>{if(!qu(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:d}=this.constraints[o];a.set(ft(l,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;fN.set(this.visualElement,this);const e=this.visualElement.current,n=hi(e,"pointerdown",l=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();aa(l)&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),r();const o=li(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:d})=>{this.isDragging&&d&&(Zn(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=l[h].translate,f.set(f.get()+l[h].translate))}),this.visualElement.render())});return()=>{o(),n(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:o=dg,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function qu(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function mN(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class gN extends Ds{constructor(e){super(e),this.removeGroupControls=wt,this.removeListeners=wt,this.controls=new pN(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||wt}unmount(){this.removeGroupControls(),this.removeListeners()}}const Qx=t=>(e,n)=>{t&&tt.update(()=>t(e,n))};class yN extends Ds{constructor(){super(...arguments),this.removePointerDownListener=wt}onPointerDown(e){this.session=new Pb(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Vb(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:Qx(e),onStart:Qx(n),onMove:r,onEnd:(s,o)=>{delete this.session,i&&tt.update(()=>i(s,o))}}}mount(){this.removePointerDownListener=hi(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function vN(){const t=R.useContext(of);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:r}=t,i=R.useId();return R.useEffect(()=>r(i),[]),!e&&n?[!1,()=>n&&n(i)]:[!0]}const gd={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Yx(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const El={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Se.test(t))t=parseFloat(t);else return t;const n=Yx(t,e.target.x),r=Yx(t,e.target.y);return`${n}% ${r}%`}},xN={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,i=Ss.parse(t);if(i.length>5)return r;const s=Ss.createTransformer(t),o=typeof i[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;i[0+o]/=a,i[1+o]/=l;const d=ft(a,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),s(i)}};class wN extends lr.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;CP(_N),s&&(n.group&&n.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),gd.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:i,isPresent:s}=this.props,o=r.projection;return o&&(o.isPresent=s,i||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||tt.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Ob(t){const[e,n]=vN(),r=R.useContext(Jy);return lr.createElement(wN,{...t,layoutGroup:r,switchLayoutGroup:R.useContext(DE),isPresent:e,safeToRemove:n})}const _N={borderRadius:{...El,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:El,borderTopRightRadius:El,borderBottomLeftRadius:El,borderBottomRightRadius:El,boxShadow:xN},Fb=["TopLeft","TopRight","BottomLeft","BottomRight"],SN=Fb.length,Xx=t=>typeof t=="string"?parseFloat(t):t,Jx=t=>typeof t=="number"||Se.test(t);function TN(t,e,n,r,i,s){i?(t.opacity=ft(0,n.opacity!==void 0?n.opacity:1,EN(r)),t.opacityExit=ft(e.opacity!==void 0?e.opacity:1,0,bN(r))):s&&(t.opacity=ft(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<SN;o++){const a=`border${Fb[o]}Radius`;let l=Zx(e,a),d=Zx(n,a);if(l===void 0&&d===void 0)continue;l||(l=0),d||(d=0),l===0||d===0||Jx(l)===Jx(d)?(t[a]=Math.max(ft(Xx(l),Xx(d),r),0),(Wr.test(d)||Wr.test(l))&&(t[a]+="%")):t[a]=d}(e.rotate||n.rotate)&&(t.rotate=ft(e.rotate||0,n.rotate||0,r))}function Zx(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const EN=zb(0,.5,lb),bN=zb(.5,.95,wt);function zb(t,e,n){return r=>r<t?0:r>e?1:n(Ec(t,e,r))}function ew(t,e){t.min=e.min,t.max=e.max}function Yn(t,e){ew(t.x,e.x),ew(t.y,e.y)}function tw(t,e,n,r,i){return t-=e,t=lh(t,1/n,r),i!==void 0&&(t=lh(t,1/i,r)),t}function IN(t,e=0,n=1,r=.5,i,s=t,o=t){if(Wr.test(e)&&(e=parseFloat(e),e=ft(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=ft(s.min,s.max,r);t===s&&(a-=e),t.min=tw(t.min,e,n,a,i),t.max=tw(t.max,e,n,a,i)}function nw(t,e,[n,r,i],s,o){IN(t,e[n],e[r],e[i],e.scale,s,o)}const CN=["x","scaleX","originX"],kN=["y","scaleY","originY"];function rw(t,e,n,r){nw(t.x,e,CN,n?n.x:void 0,r?r.x:void 0),nw(t.y,e,kN,n?n.y:void 0,r?r.y:void 0)}function iw(t){return t.translate===0&&t.scale===1}function Ub(t){return iw(t.x)&&iw(t.y)}function AN(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function Bb(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function sw(t){return Wn(t.x)/Wn(t.y)}class RN{constructor(){this.members=[]}add(e){f0(this.members,e),e.scheduleRender()}remove(e){if(p0(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function ow(t,e,n){let r="";const i=t.x.translate/e.x,s=t.y.translate/e.y;if((i||s)&&(r=`translate3d(${i}px, ${s}px, 0) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:l,rotateX:d,rotateY:h}=n;l&&(r+=`rotate(${l}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `)}const o=t.x.scale*e.x,a=t.y.scale*e.y;return(o!==1||a!==1)&&(r+=`scale(${o}, ${a})`),r||"none"}const PN=(t,e)=>t.depth-e.depth;class NN{constructor(){this.children=[],this.isDirty=!1}add(e){f0(this.children,e),this.isDirty=!0}remove(e){p0(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(PN),this.isDirty=!1,this.children.forEach(e)}}function DN(t,e){const n=performance.now(),r=({timestamp:i})=>{const s=i-n;s>=e&&(wi(r),t(s-e))};return tt.read(r,!0),()=>wi(r)}function jN(t){window.MotionDebug&&window.MotionDebug.record(t)}function LN(t){return t instanceof SVGElement&&t.tagName!=="svg"}function MN(t,e,n){const r=Dn(t)?t:Va(t);return r.start(h0("",r,e,n)),r.animation}const aw=["","X","Y","Z"],VN={visibility:"hidden"},lw=1e3;let ON=0;const Gs={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function $b({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},a=e==null?void 0:e()){this.id=ON++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Gs.totalNodes=Gs.resolvedTargetDeltas=Gs.recalculatedProjection=0,this.nodes.forEach(UN),this.nodes.forEach(HN),this.nodes.forEach(GN),this.nodes.forEach(BN),jN(Gs)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new NN)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new m0),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=LN(o),this.instance=o;const{layoutId:l,layout:d,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(d||l)&&(this.isLayoutDirty=!0),t){let f;const p=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=DN(p,250),gd.hasAnimatedSinceResize&&(gd.hasAnimatedSinceResize=!1,this.nodes.forEach(uw))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||d)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:p,hasRelativeTargetChanged:g,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||h.getDefaultTransition()||JN,{onLayoutAnimationStart:k,onLayoutAnimationComplete:T}=h.getProps(),v=!this.targetLayout||!Bb(this.targetLayout,x)||g,w=!p&&g;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||p&&(v||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,w);const j={...d0(_,"layout"),onPlay:k,onComplete:T};(h.shouldReduceMotion||this.options.layoutRoot)&&(j.delay=0,j.type=!1),this.startAnimation(j)}else p||uw(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,wi(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(KN),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(cw);return}this.isUpdating||this.nodes.forEach(WN),this.isUpdating=!1,this.nodes.forEach(qN),this.nodes.forEach(FN),this.nodes.forEach(zN),this.clearAllSnapshots();const a=performance.now();sn.delta=_s(0,1e3/60,a-sn.timestamp),sn.timestamp=a,sn.isProcessing=!0,kp.update.process(sn),kp.preRender.process(sn),kp.render.process(sn),sn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach($N),this.sharedNodes.forEach(QN)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,tt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){tt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=At(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform,a=this.projectionDelta&&!Ub(this.projectionDelta),l=this.getTransformTemplate(),d=l?l(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&(a||Hs(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),ZN(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return At();const a=o.measureViewportBox(),{scroll:l}=this.root;return l&&($i(a.x,l.offset.x),$i(a.y,l.offset.y)),a}removeElementScroll(o){const a=At();Yn(a,o);for(let l=0;l<this.path.length;l++){const d=this.path[l],{scroll:h,options:f}=d;if(d!==this.root&&h&&f.layoutScroll){if(h.isRoot){Yn(a,o);const{scroll:p}=this.root;p&&($i(a.x,-p.offset.x),$i(a.y,-p.offset.y))}$i(a.x,h.offset.x),$i(a.y,h.offset.y)}}return a}applyTransform(o,a=!1){const l=At();Yn(l,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&ua(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Hs(h.latestValues)&&ua(l,h.latestValues)}return Hs(this.latestValues)&&ua(l,this.latestValues),l}removeTransform(o){const a=At();Yn(a,o);for(let l=0;l<this.path.length;l++){const d=this.path[l];if(!d.instance||!Hs(d.latestValues))continue;hg(d.latestValues)&&d.updateSnapshot();const h=At(),f=d.measurePageBox();Yn(h,f),rw(a,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return Hs(this.latestValues)&&rw(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==sn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==l;if(!(o||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:p}=this.options;if(!(!this.layout||!(f||p))){if(this.resolvedRelativeTargetAt=sn.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=At(),this.relativeTargetOrigin=At(),Yl(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),Yn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=At(),this.targetWithTransforms=At()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),eN(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Yn(this.target,this.layout.layoutBox),Lb(this.target,this.targetDelta)):Yn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=At(),this.relativeTargetOrigin=At(),Yl(this.relativeTargetOrigin,this.target,g.target),Yn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Gs.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||hg(this.parent.latestValues)||jb(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let d=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(d=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===sn.timestamp&&(d=!1),d)return;const{layout:h,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||f))return;Yn(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,g=this.treeScale.y;cN(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox);const{target:x}=a;if(!x){this.projectionTransform&&(this.projectionDelta=ca(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=ca(),this.projectionDeltaWithTransform=ca());const _=this.projectionTransform;Ql(this.projectionDelta,this.layoutCorrected,x,this.latestValues),this.projectionTransform=ow(this.projectionDelta,this.treeScale),(this.projectionTransform!==_||this.treeScale.x!==p||this.treeScale.y!==g)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x)),Gs.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,a=!1){const l=this.snapshot,d=l?l.latestValues:{},h={...this.latestValues},f=ca();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const p=At(),g=l?l.source:void 0,x=this.layout?this.layout.source:void 0,_=g!==x,k=this.getStack(),T=!k||k.members.length<=1,v=!!(_&&!T&&this.options.crossfade===!0&&!this.path.some(XN));this.animationProgress=0;let w;this.mixTargetDelta=j=>{const L=j/1e3;dw(f.x,o.x,L),dw(f.y,o.y,L),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Yl(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),YN(this.relativeTarget,this.relativeTargetOrigin,p,L),w&&AN(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=At()),Yn(w,this.relativeTarget)),_&&(this.animationValues=h,TN(h,d,this.latestValues,L,v,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=L},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(wi(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=tt.update(()=>{gd.hasAnimatedSinceResize=!0,this.currentAnimation=MN(0,lw,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(lw),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:d,latestValues:h}=o;if(!(!a||!l||!d)){if(this!==o&&this.layout&&d&&Wb(this.options.animationType,this.layout.layoutBox,d.layoutBox)){l=this.target||At();const f=Wn(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+f;const p=Wn(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+p}Yn(a,l),ua(a,h),Ql(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new RN),this.sharedNodes.get(o).add(a);const d=a.options.initialPromotionConfig;a.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const d=this.getStack();d&&d.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(a=!0),!a)return;const d={};for(let h=0;h<aw.length;h++){const f="rotate"+aw[h];l[f]&&(d[f]=l[f],o.setStaticValue(f,0))}o.render();for(const h in d)o.setStaticValue(h,d[h]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return VN;const d={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=md(o==null?void 0:o.pointerEvents)||"",d.transform=h?h(this.latestValues,""):"none",d;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const _={};return this.options.layoutId&&(_.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,_.pointerEvents=md(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Hs(this.latestValues)&&(_.transform=h?h({},""):"none",this.hasProjected=!1),_}const p=f.animationValues||f.latestValues;this.applyTransformsToTarget(),d.transform=ow(this.projectionDeltaWithTransform,this.treeScale,p),h&&(d.transform=h(p,d.transform));const{x:g,y:x}=this.projectionDelta;d.transformOrigin=`${g.origin*100}% ${x.origin*100}% 0`,f.animationValues?d.opacity=f===this?(l=(a=p.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:d.opacity=f===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const _ in th){if(p[_]===void 0)continue;const{correct:k,applyTo:T}=th[_],v=d.transform==="none"?p[_]:k(p[_],f);if(T){const w=T.length;for(let j=0;j<w;j++)d[T[j]]=v}else d[_]=v}return this.options.layoutId&&(d.pointerEvents=f===this?md(o==null?void 0:o.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(cw),this.root.sharedNodes.clear()}}}function FN(t){t.updateLayout()}function zN(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=t.layout,{animationType:s}=t.options,o=n.source!==t.layout.source;s==="size"?Zn(f=>{const p=o?n.measuredBox[f]:n.layoutBox[f],g=Wn(p);p.min=r[f].min,p.max=p.min+g}):Wb(s,n.layoutBox,r)&&Zn(f=>{const p=o?n.measuredBox[f]:n.layoutBox[f],g=Wn(r[f]);p.max=p.min+g,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+g)});const a=ca();Ql(a,r,n.layoutBox);const l=ca();o?Ql(l,t.applyTransform(i,!0),n.measuredBox):Ql(l,r,n.layoutBox);const d=!Ub(a);let h=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:p,layout:g}=f;if(p&&g){const x=At();Yl(x,n.layoutBox,p.layoutBox);const _=At();Yl(_,r,g.layoutBox),Bb(x,_)||(h=!0),f.options.layoutRoot&&(t.relativeTarget=_,t.relativeTargetOrigin=x,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:d,hasRelativeTargetChanged:h})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function UN(t){Gs.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function BN(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function $N(t){t.clearSnapshot()}function cw(t){t.clearMeasurements()}function WN(t){t.isLayoutDirty=!1}function qN(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function uw(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function HN(t){t.resolveTargetDelta()}function GN(t){t.calcProjection()}function KN(t){t.resetRotation()}function QN(t){t.removeLeadSnapshot()}function dw(t,e,n){t.translate=ft(e.translate,0,n),t.scale=ft(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function hw(t,e,n,r){t.min=ft(e.min,n.min,r),t.max=ft(e.max,n.max,r)}function YN(t,e,n,r){hw(t.x,e.x,n.x,r),hw(t.y,e.y,n.y,r)}function XN(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const JN={duration:.45,ease:[.4,0,.1,1]},fw=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),pw=fw("applewebkit/")&&!fw("chrome/")?Math.round:wt;function mw(t){t.min=pw(t.min),t.max=pw(t.max)}function ZN(t){mw(t.x),mw(t.y)}function Wb(t,e,n){return t==="position"||t==="preserve-aspect"&&!ug(sw(e),sw(n),.2)}const eD=$b({attachResizeListener:(t,e)=>li(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Fp={current:void 0},qb=$b({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Fp.current){const t=new eD({});t.mount(window),t.setOptions({layoutScroll:!0}),Fp.current=t}return Fp.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),tD={pan:{Feature:yN},drag:{Feature:gN,ProjectionNode:qb,MeasureLayout:Ob}},nD=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function rD(t){const e=nD.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]}function pg(t,e,n=1){const[r,i]=rD(t);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const o=s.trim();return Cb(o)?parseFloat(o):o}else return rg(i)?pg(i,e,n+1):i}function iD(t,{...e},n){const r=t.current;if(!(r instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(i=>{const s=i.get();if(!rg(s))return;const o=pg(s,r);o&&i.set(o)});for(const i in e){const s=e[i];if(!rg(s))continue;const o=pg(s,r);o&&(e[i]=o,n||(n={}),n[i]===void 0&&(n[i]=s))}return{target:e,transitionEnd:n}}const sD=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),Hb=t=>sD.has(t),oD=t=>Object.keys(t).some(Hb),gw=t=>t===Ao||t===Se,yw=(t,e)=>parseFloat(t.split(", ")[e]),vw=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/);if(i)return yw(i[1],e);{const s=r.match(/^matrix\((.+)\)$/);return s?yw(s[1],t):0}},aD=new Set(["x","y","z"]),lD=Qc.filter(t=>!aD.has(t));function cD(t){const e=[];return lD.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const Oa={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:vw(4,13),y:vw(5,14)};Oa.translateX=Oa.x;Oa.translateY=Oa.y;const uD=(t,e,n)=>{const r=e.measureViewportBox(),i=e.current,s=getComputedStyle(i),{display:o}=s,a={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(d=>{a[d]=Oa[d](r,s)}),e.render();const l=e.measureViewportBox();return n.forEach(d=>{const h=e.getValue(d);h&&h.jump(a[d]),t[d]=Oa[d](l,s)}),t},dD=(t,e,n={},r={})=>{e={...e},r={...r};const i=Object.keys(e).filter(Hb);let s=[],o=!1;const a=[];if(i.forEach(l=>{const d=t.getValue(l);if(!t.hasValue(l))return;let h=n[l],f=Tl(h);const p=e[l];let g;if(rh(p)){const x=p.length,_=p[0]===null?1:0;h=p[_],f=Tl(h);for(let k=_;k<x&&p[k]!==null;k++)g?o0(Tl(p[k])===g):g=Tl(p[k])}else g=Tl(p);if(f!==g)if(gw(f)&&gw(g)){const x=d.get();typeof x=="string"&&d.set(parseFloat(x)),typeof p=="string"?e[l]=parseFloat(p):Array.isArray(p)&&g===Se&&(e[l]=p.map(parseFloat))}else f!=null&&f.transform&&(g!=null&&g.transform)&&(h===0||p===0)?h===0?d.set(g.transform(h)):e[l]=f.transform(p):(o||(s=cD(t),o=!0),a.push(l),r[l]=r[l]!==void 0?r[l]:e[l],d.jump(p))}),a.length){const l=a.indexOf("height")>=0?window.pageYOffset:null,d=uD(e,t,a);return s.length&&s.forEach(([h,f])=>{t.getValue(h).set(f)}),t.render(),af&&l!==null&&window.scrollTo({top:l}),{target:d,transitionEnd:r}}else return{target:e,transitionEnd:r}};function hD(t,e,n,r){return oD(e)?dD(t,e,n,r):{target:e,transitionEnd:r}}const fD=(t,e,n,r)=>{const i=iD(t,e,r);return e=i.target,r=i.transitionEnd,hD(t,e,n,r)},mg={current:null},Gb={current:!1};function pD(){if(Gb.current=!0,!!af)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>mg.current=t.matches;t.addListener(e),e()}else mg.current=!1}function mD(t,e,n){const{willChange:r}=e;for(const i in e){const s=e[i],o=n[i];if(Dn(s))t.addValue(i,s),ah(r)&&r.add(i);else if(Dn(o))t.addValue(i,Va(s,{owner:t})),ah(r)&&r.remove(i);else if(o!==s)if(t.hasValue(i)){const a=t.getValue(i);!a.hasAnimated&&a.set(s)}else{const a=t.getStaticValue(i);t.addValue(i,Va(a!==void 0?a:s,{owner:t}))}}for(const i in n)e[i]===void 0&&t.removeValue(i);return e}const xw=new WeakMap,Kb=Object.keys(Tc),gD=Kb.length,ww=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],yD=Xy.length;class vD{constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:i,visualState:s},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>tt.render(this.render,!1,!0);const{latestValues:a,renderState:l}=s;this.latestValues=a,this.baseTarget={...a},this.initialValues=n.initial?{...a}:{},this.renderState=l,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.isControllingVariants=cf(n),this.isVariantNode=NE(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(n,{});for(const f in h){const p=h[f];a[f]!==void 0&&Dn(p)&&(p.set(a[f],!1),ah(d)&&d.add(f))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,xw.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),Gb.current||pD(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:mg.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){xw.delete(this.current),this.projection&&this.projection.unmount(),wi(this.notifyUpdate),wi(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const r=ko.has(e),i=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&tt.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{i(),s()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},r,i,s){let o,a;for(let l=0;l<gD;l++){const d=Kb[l],{isEnabled:h,Feature:f,ProjectionNode:p,MeasureLayout:g}=Tc[d];p&&(o=p),h(n)&&(!this.features[d]&&f&&(this.features[d]=new f(this)),g&&(a=g))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:d,drag:h,dragConstraints:f,layoutScroll:p,layoutRoot:g}=n;this.projection.setOptions({layoutId:l,layout:d,alwaysMeasureLayout:!!h||f&&aa(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof d=="string"?d:"both",initialPromotionConfig:s,layoutScroll:p,layoutRoot:g})}return a}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):At()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<ww.length;r++){const i=ww[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s=e["on"+i];s&&(this.propEventSubscriptions[i]=this.on(i,s))}this.prevMotionValues=mD(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<yD;r++){const i=Xy[r],s=this.props[i];(Sc(s)||s===!1)&&(n[i]=s)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Va(n,{owner:this}),this.addValue(e,r)),r}readValue(e){var n;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props,i=typeof r=="string"||typeof r=="object"?(n=s0(this.props,r))===null||n===void 0?void 0:n[e]:void 0;if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Dn(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new m0),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class Qb extends vD{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...r},{transformValues:i},s){let o=L4(r,e||{},this);if(i&&(n&&(n=i(n)),r&&(r=i(r)),o&&(o=i(o))),s){D4(this,r,o);const a=fD(this,r,o,n);n=a.transitionEnd,r=a.target}return{transition:e,transitionEnd:n,...r}}}function xD(t){return window.getComputedStyle(t)}class wD extends Qb{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(ko.has(n)){const r=u0(n);return r&&r.default||0}else{const r=xD(e),i=(ME(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return Mb(e,n)}build(e,n,r,i){e0(e,n,r,i.transformTemplate)}scrapeMotionValuesFromProps(e,n){return i0(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Dn(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,r,i){BE(e,n,r,i)}}class _D extends Qb{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(ko.has(n)){const r=u0(n);return r&&r.default||0}return n=$E.has(n)?n:Qy(n),e.getAttribute(n)}measureInstanceViewportBox(){return At()}scrapeMotionValuesFromProps(e,n){return qE(e,n)}build(e,n,r,i){n0(e,n,r,this.isSVGTag,i.transformTemplate)}renderInstance(e,n,r,i){WE(e,n,r,i)}mount(e){this.isSVGTag=r0(e.tagName),super.mount(e)}}const SD=(t,e)=>Zy(t)?new _D(e,{enableHardwareAcceleration:!1}):new wD(e,{enableHardwareAcceleration:!0}),TD={layout:{ProjectionNode:qb,MeasureLayout:Ob}},ED={...Y4,...g5,...tD,...TD},Ue=bP((t,e)=>r5(t,e,ED,SD));function Yb(){const t=R.useRef(!1);return Ky(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function bD(){const t=Yb(),[e,n]=R.useState(0),r=R.useCallback(()=>{t.current&&n(e+1)},[e]);return[R.useCallback(()=>tt.postRender(r),[r]),e]}class ID extends R.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function CD({children:t,isPresent:e}){const n=R.useId(),r=R.useRef(null),i=R.useRef({width:0,height:0,top:0,left:0});return R.useInsertionEffect(()=>{const{width:s,height:o,top:a,left:l}=i.current;if(e||!r.current||!s||!o)return;r.current.dataset.motionPopId=n;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${s}px !important;
            height: ${o}px !important;
            top: ${a}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[e]),R.createElement(ID,{isPresent:e,childRef:r,sizeRef:i},R.cloneElement(t,{ref:r}))}const zp=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:o})=>{const a=HE(kD),l=R.useId(),d=R.useMemo(()=>({id:l,initial:e,isPresent:n,custom:i,onExitComplete:h=>{a.set(h,!0);for(const f of a.values())if(!f)return;r&&r()},register:h=>(a.set(h,!1),()=>a.delete(h))}),s?void 0:[n]);return R.useMemo(()=>{a.forEach((h,f)=>a.set(f,!1))},[n]),R.useEffect(()=>{!n&&!a.size&&r&&r()},[n]),o==="popLayout"&&(t=R.createElement(CD,{isPresent:n},t)),R.createElement(of.Provider,{value:d},t)};function kD(){return new Map}function AD(t){return R.useEffect(()=>()=>t(),[])}const Ks=t=>t.key||"";function RD(t,e){t.forEach(n=>{const r=Ks(n);e.set(r,n)})}function PD(t){const e=[];return R.Children.forEach(t,n=>{R.isValidElement(n)&&e.push(n)}),e}const kn=({children:t,custom:e,initial:n=!0,onExitComplete:r,exitBeforeEnter:i,presenceAffectsLayout:s=!0,mode:o="sync"})=>{const a=R.useContext(Jy).forceRender||bD()[0],l=Yb(),d=PD(t);let h=d;const f=R.useRef(new Map).current,p=R.useRef(h),g=R.useRef(new Map).current,x=R.useRef(!0);if(Ky(()=>{x.current=!1,RD(d,g),p.current=h}),AD(()=>{x.current=!0,g.clear(),f.clear()}),x.current)return R.createElement(R.Fragment,null,h.map(v=>R.createElement(zp,{key:Ks(v),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:s,mode:o},v)));h=[...h];const _=p.current.map(Ks),k=d.map(Ks),T=_.length;for(let v=0;v<T;v++){const w=_[v];k.indexOf(w)===-1&&!f.has(w)&&f.set(w,void 0)}return o==="wait"&&f.size&&(h=[]),f.forEach((v,w)=>{if(k.indexOf(w)!==-1)return;const j=g.get(w);if(!j)return;const L=_.indexOf(w);let V=v;if(!V){const E=()=>{f.delete(w);const S=Array.from(g.keys()).filter(I=>!k.includes(I));if(S.forEach(I=>g.delete(I)),p.current=d.filter(I=>{const A=Ks(I);return A===w||S.includes(A)}),!f.size){if(l.current===!1)return;a(),r&&r()}};V=R.createElement(zp,{key:Ks(j),isPresent:!1,onExitComplete:E,custom:e,presenceAffectsLayout:s,mode:o},j),f.set(w,V)}h.splice(L,0,V)}),h=h.map(v=>{const w=v.key;return f.has(w)?v:R.createElement(zp,{key:Ks(v),isPresent:!0,presenceAffectsLayout:s,mode:o},v)}),R.createElement(R.Fragment,null,f.size?h:h.map(v=>R.cloneElement(v)))},ND=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},DD=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Jb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,d=l?t[i+2]:0,h=s>>2,f=(s&3)<<4|a>>4;let p=(a&15)<<2|d>>6,g=d&63;l||(g=64,o||(p=64)),r.push(n[h],n[f],n[p],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Xb(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):DD(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||d==null||f==null)throw new jD;const p=s<<2|a>>4;if(r.push(p),d!==64){const g=a<<4&240|d>>2;if(r.push(g),f!==64){const x=d<<6&192|f;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class jD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const LD=function(t){const e=Xb(t);return Jb.encodeByteArray(e,!0)},ch=function(t){return LD(t).replace(/\./g,"")},Zb=function(t){try{return Jb.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD=()=>MD().__FIREBASE_DEFAULTS__,OD=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},FD=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Zb(t[1]);return e&&JSON.parse(e)},ff=()=>{try{return ND()||VD()||OD()||FD()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},e2=t=>{var e,n;return(n=(e=ff())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},g0=t=>{const e=e2(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},t2=()=>{var t;return(t=ff())==null?void 0:t.config},n2=t=>{var e;return(e=ff())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jr(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function pf(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t},a="";return[ch(JSON.stringify(n)),ch(JSON.stringify(o)),a].join(".")}const Xl={};function UD(){const t={prod:[],emulator:[]};for(const e of Object.keys(Xl))Xl[e]?t.emulator.push(e):t.prod.push(e);return t}function BD(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let _w=!1;function mf(t,e){if(typeof window>"u"||typeof document>"u"||!Jr(window.location.host)||Xl[t]===e||Xl[t]||_w)return;Xl[t]=e;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=UD().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function d(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{_w=!0,o()},p}function h(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function f(){const p=BD(r),g=n("text"),x=document.getElementById(g)||document.createElement("span"),_=n("learnmore"),k=document.getElementById(_)||document.createElement("a"),T=n("preprendIcon"),v=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const w=p.element;a(w),h(k,_);const j=d();l(v,T),w.append(v,x,k,j),document.body.appendChild(w)}s?(x.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $D(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dn())}function WD(){var e;const t=(e=ff())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function HD(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function GD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function KD(){const t=dn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function QD(){return!WD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function YD(){try{return typeof indexedDB=="object"}catch{return!1}}function XD(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JD="FirebaseError";class Cr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=JD,Object.setPrototypeOf(this,Cr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zc.prototype.create)}}class Zc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?ZD(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Cr(i,a,r)}}function ZD(t,e){return t.replace(ej,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const ej=/\{\$([^}]+)}/g;function tj(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function xo(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Sw(s)&&Sw(o)){if(!xo(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Sw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function nj(t,e){const n=new rj(t,e);return n.subscribe.bind(n)}class rj{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");ij(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Up),i.error===void 0&&(i.error=Up),i.complete===void 0&&(i.complete=Up);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ij(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Up(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(t){return t&&t._delegate?t._delegate:t}class _i{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new zD;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(aj(e))try{this.getOrInitializeService({instanceIdentifier:Qs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Qs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Qs){return this.instances.has(e)}getOptions(e=Qs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:oj(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Qs){return this.component?this.component.multipleInstances?e:Qs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function oj(t){return t===Qs?void 0:t}function aj(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new sj(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Me;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Me||(Me={}));const cj={debug:Me.DEBUG,verbose:Me.VERBOSE,info:Me.INFO,warn:Me.WARN,error:Me.ERROR,silent:Me.SILENT},uj=Me.INFO,dj={[Me.DEBUG]:"log",[Me.VERBOSE]:"log",[Me.INFO]:"info",[Me.WARN]:"warn",[Me.ERROR]:"error"},hj=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=dj[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class y0{constructor(e){this.name=e,this._logLevel=uj,this._logHandler=hj,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Me))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Me.DEBUG,...e),this._logHandler(this,Me.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Me.VERBOSE,...e),this._logHandler(this,Me.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Me.INFO,...e),this._logHandler(this,Me.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Me.WARN,...e),this._logHandler(this,Me.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Me.ERROR,...e),this._logHandler(this,Me.ERROR,...e)}}const fj=(t,e)=>e.some(n=>t instanceof n);let Tw,Ew;function pj(){return Tw||(Tw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function mj(){return Ew||(Ew=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const i2=new WeakMap,gg=new WeakMap,s2=new WeakMap,Bp=new WeakMap,v0=new WeakMap;function gj(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(ps(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&i2.set(n,t)}).catch(()=>{}),v0.set(e,t),e}function yj(t){if(gg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});gg.set(t,e)}let yg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return gg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||s2.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ps(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function vj(t){yg=t(yg)}function xj(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call($p(this),e,...n);return s2.set(r,e.sort?e.sort():[e]),ps(r)}:mj().includes(t)?function(...e){return t.apply($p(this),e),ps(i2.get(this))}:function(...e){return ps(t.apply($p(this),e))}}function wj(t){return typeof t=="function"?xj(t):(t instanceof IDBTransaction&&yj(t),fj(t,pj())?new Proxy(t,yg):t)}function ps(t){if(t instanceof IDBRequest)return gj(t);if(Bp.has(t))return Bp.get(t);const e=wj(t);return e!==t&&(Bp.set(t,e),v0.set(e,t)),e}const $p=t=>v0.get(t);function _j(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=ps(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ps(o.result),l.oldVersion,l.newVersion,ps(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const Sj=["get","getKey","getAll","getAllKeys","count"],Tj=["put","add","delete","clear"],Wp=new Map;function bw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Wp.get(e))return Wp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=Tj.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Sj.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),i&&l.done]))[0]};return Wp.set(e,s),s}vj(t=>({...t,get:(e,n,r)=>bw(e,n)||t.get(e,n,r),has:(e,n)=>!!bw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(bj(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function bj(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const vg="@firebase/app",Iw="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Si=new y0("@firebase/app"),Ij="@firebase/app-compat",Cj="@firebase/analytics-compat",kj="@firebase/analytics",Aj="@firebase/app-check-compat",Rj="@firebase/app-check",Pj="@firebase/auth",Nj="@firebase/auth-compat",Dj="@firebase/database",jj="@firebase/data-connect",Lj="@firebase/database-compat",Mj="@firebase/functions",Vj="@firebase/functions-compat",Oj="@firebase/installations",Fj="@firebase/installations-compat",zj="@firebase/messaging",Uj="@firebase/messaging-compat",Bj="@firebase/performance",$j="@firebase/performance-compat",Wj="@firebase/remote-config",qj="@firebase/remote-config-compat",Hj="@firebase/storage",Gj="@firebase/storage-compat",Kj="@firebase/firestore",Qj="@firebase/ai",Yj="@firebase/firestore-compat",Xj="firebase",Jj="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xg="[DEFAULT]",Zj={[vg]:"fire-core",[Ij]:"fire-core-compat",[kj]:"fire-analytics",[Cj]:"fire-analytics-compat",[Rj]:"fire-app-check",[Aj]:"fire-app-check-compat",[Pj]:"fire-auth",[Nj]:"fire-auth-compat",[Dj]:"fire-rtdb",[jj]:"fire-data-connect",[Lj]:"fire-rtdb-compat",[Mj]:"fire-fn",[Vj]:"fire-fn-compat",[Oj]:"fire-iid",[Fj]:"fire-iid-compat",[zj]:"fire-fcm",[Uj]:"fire-fcm-compat",[Bj]:"fire-perf",[$j]:"fire-perf-compat",[Wj]:"fire-rc",[qj]:"fire-rc-compat",[Hj]:"fire-gcs",[Gj]:"fire-gcs-compat",[Kj]:"fire-fst",[Yj]:"fire-fst-compat",[Qj]:"fire-vertex","fire-js":"fire-js",[Xj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh=new Map,eL=new Map,wg=new Map;function Cw(t,e){try{t.container.addComponent(e)}catch(n){Si.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ts(t){const e=t.name;if(wg.has(e))return Si.debug(`There were multiple attempts to register component ${e}.`),!1;wg.set(e,t);for(const n of uh.values())Cw(n,t);for(const n of eL.values())Cw(n,t);return!0}function tu(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Vn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ms=new Zc("app","Firebase",tL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new _i("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ms.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro=Jj;function o2(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:xg,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw ms.create("bad-app-name",{appName:String(i)});if(n||(n=t2()),!n)throw ms.create("no-options");const s=uh.get(i);if(s){if(xo(n,s.options)&&xo(r,s.config))return s;throw ms.create("duplicate-app",{appName:i})}const o=new lj(i);for(const l of wg.values())o.addComponent(l);const a=new nL(n,r,o);return uh.set(i,a),a}function gf(t=xg){const e=uh.get(t);if(!e&&t===xg&&t2())return o2();if(!e)throw ms.create("no-app",{appName:t});return e}function or(t,e,n){let r=Zj[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Si.warn(o.join(" "));return}Ts(new _i(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rL="firebase-heartbeat-database",iL=1,bc="firebase-heartbeat-store";let qp=null;function a2(){return qp||(qp=_j(rL,iL,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(bc)}catch(n){console.warn(n)}}}}).catch(t=>{throw ms.create("idb-open",{originalErrorMessage:t.message})})),qp}async function sL(t){try{const n=(await a2()).transaction(bc),r=await n.objectStore(bc).get(l2(t));return await n.done,r}catch(e){if(e instanceof Cr)Si.warn(e.message);else{const n=ms.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Si.warn(n.message)}}}async function kw(t,e){try{const r=(await a2()).transaction(bc,"readwrite");await r.objectStore(bc).put(e,l2(t)),await r.done}catch(n){if(n instanceof Cr)Si.warn(n.message);else{const r=ms.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Si.warn(r.message)}}}function l2(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL=1024,aL=30;class lL{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new uL(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Aw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>aL){const o=dL(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Si.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Aw(),{heartbeatsToSend:r,unsentEntries:i}=cL(this._heartbeatsCache.heartbeats),s=ch(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Si.warn(n),""}}}function Aw(){return new Date().toISOString().substring(0,10)}function cL(t,e=oL){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Rw(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Rw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class uL{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return YD()?XD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await sL(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return kw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return kw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Rw(t){return ch(JSON.stringify({version:2,heartbeats:t})).length}function dL(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hL(t){Ts(new _i("platform-logger",e=>new Ej(e),"PRIVATE")),Ts(new _i("heartbeat",e=>new lL(e),"PRIVATE")),or(vg,Iw,t),or(vg,Iw,"esm2020"),or("fire-js","")}hL("");var fL="firebase",pL="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */or(fL,pL,"app");var Pw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gs,c2;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,S){function I(){}I.prototype=S.prototype,E.F=S.prototype,E.prototype=new I,E.prototype.constructor=E,E.D=function(A,P,N){for(var b=Array(arguments.length-2),W=2;W<arguments.length;W++)b[W-2]=arguments[W];return S.prototype[P].apply(A,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,S,I){I||(I=0);const A=Array(16);if(typeof S=="string")for(var P=0;P<16;++P)A[P]=S.charCodeAt(I++)|S.charCodeAt(I++)<<8|S.charCodeAt(I++)<<16|S.charCodeAt(I++)<<24;else for(P=0;P<16;++P)A[P]=S[I++]|S[I++]<<8|S[I++]<<16|S[I++]<<24;S=E.g[0],I=E.g[1],P=E.g[2];let N=E.g[3],b;b=S+(N^I&(P^N))+A[0]+3614090360&4294967295,S=I+(b<<7&4294967295|b>>>25),b=N+(P^S&(I^P))+A[1]+3905402710&4294967295,N=S+(b<<12&4294967295|b>>>20),b=P+(I^N&(S^I))+A[2]+606105819&4294967295,P=N+(b<<17&4294967295|b>>>15),b=I+(S^P&(N^S))+A[3]+3250441966&4294967295,I=P+(b<<22&4294967295|b>>>10),b=S+(N^I&(P^N))+A[4]+4118548399&4294967295,S=I+(b<<7&4294967295|b>>>25),b=N+(P^S&(I^P))+A[5]+1200080426&4294967295,N=S+(b<<12&4294967295|b>>>20),b=P+(I^N&(S^I))+A[6]+2821735955&4294967295,P=N+(b<<17&4294967295|b>>>15),b=I+(S^P&(N^S))+A[7]+4249261313&4294967295,I=P+(b<<22&4294967295|b>>>10),b=S+(N^I&(P^N))+A[8]+1770035416&4294967295,S=I+(b<<7&4294967295|b>>>25),b=N+(P^S&(I^P))+A[9]+2336552879&4294967295,N=S+(b<<12&4294967295|b>>>20),b=P+(I^N&(S^I))+A[10]+4294925233&4294967295,P=N+(b<<17&4294967295|b>>>15),b=I+(S^P&(N^S))+A[11]+2304563134&4294967295,I=P+(b<<22&4294967295|b>>>10),b=S+(N^I&(P^N))+A[12]+1804603682&4294967295,S=I+(b<<7&4294967295|b>>>25),b=N+(P^S&(I^P))+A[13]+4254626195&4294967295,N=S+(b<<12&4294967295|b>>>20),b=P+(I^N&(S^I))+A[14]+2792965006&4294967295,P=N+(b<<17&4294967295|b>>>15),b=I+(S^P&(N^S))+A[15]+1236535329&4294967295,I=P+(b<<22&4294967295|b>>>10),b=S+(P^N&(I^P))+A[1]+4129170786&4294967295,S=I+(b<<5&4294967295|b>>>27),b=N+(I^P&(S^I))+A[6]+3225465664&4294967295,N=S+(b<<9&4294967295|b>>>23),b=P+(S^I&(N^S))+A[11]+643717713&4294967295,P=N+(b<<14&4294967295|b>>>18),b=I+(N^S&(P^N))+A[0]+3921069994&4294967295,I=P+(b<<20&4294967295|b>>>12),b=S+(P^N&(I^P))+A[5]+3593408605&4294967295,S=I+(b<<5&4294967295|b>>>27),b=N+(I^P&(S^I))+A[10]+38016083&4294967295,N=S+(b<<9&4294967295|b>>>23),b=P+(S^I&(N^S))+A[15]+3634488961&4294967295,P=N+(b<<14&4294967295|b>>>18),b=I+(N^S&(P^N))+A[4]+3889429448&4294967295,I=P+(b<<20&4294967295|b>>>12),b=S+(P^N&(I^P))+A[9]+568446438&4294967295,S=I+(b<<5&4294967295|b>>>27),b=N+(I^P&(S^I))+A[14]+3275163606&4294967295,N=S+(b<<9&4294967295|b>>>23),b=P+(S^I&(N^S))+A[3]+4107603335&4294967295,P=N+(b<<14&4294967295|b>>>18),b=I+(N^S&(P^N))+A[8]+1163531501&4294967295,I=P+(b<<20&4294967295|b>>>12),b=S+(P^N&(I^P))+A[13]+2850285829&4294967295,S=I+(b<<5&4294967295|b>>>27),b=N+(I^P&(S^I))+A[2]+4243563512&4294967295,N=S+(b<<9&4294967295|b>>>23),b=P+(S^I&(N^S))+A[7]+1735328473&4294967295,P=N+(b<<14&4294967295|b>>>18),b=I+(N^S&(P^N))+A[12]+2368359562&4294967295,I=P+(b<<20&4294967295|b>>>12),b=S+(I^P^N)+A[5]+4294588738&4294967295,S=I+(b<<4&4294967295|b>>>28),b=N+(S^I^P)+A[8]+2272392833&4294967295,N=S+(b<<11&4294967295|b>>>21),b=P+(N^S^I)+A[11]+1839030562&4294967295,P=N+(b<<16&4294967295|b>>>16),b=I+(P^N^S)+A[14]+4259657740&4294967295,I=P+(b<<23&4294967295|b>>>9),b=S+(I^P^N)+A[1]+2763975236&4294967295,S=I+(b<<4&4294967295|b>>>28),b=N+(S^I^P)+A[4]+1272893353&4294967295,N=S+(b<<11&4294967295|b>>>21),b=P+(N^S^I)+A[7]+4139469664&4294967295,P=N+(b<<16&4294967295|b>>>16),b=I+(P^N^S)+A[10]+3200236656&4294967295,I=P+(b<<23&4294967295|b>>>9),b=S+(I^P^N)+A[13]+681279174&4294967295,S=I+(b<<4&4294967295|b>>>28),b=N+(S^I^P)+A[0]+3936430074&4294967295,N=S+(b<<11&4294967295|b>>>21),b=P+(N^S^I)+A[3]+3572445317&4294967295,P=N+(b<<16&4294967295|b>>>16),b=I+(P^N^S)+A[6]+76029189&4294967295,I=P+(b<<23&4294967295|b>>>9),b=S+(I^P^N)+A[9]+3654602809&4294967295,S=I+(b<<4&4294967295|b>>>28),b=N+(S^I^P)+A[12]+3873151461&4294967295,N=S+(b<<11&4294967295|b>>>21),b=P+(N^S^I)+A[15]+530742520&4294967295,P=N+(b<<16&4294967295|b>>>16),b=I+(P^N^S)+A[2]+3299628645&4294967295,I=P+(b<<23&4294967295|b>>>9),b=S+(P^(I|~N))+A[0]+4096336452&4294967295,S=I+(b<<6&4294967295|b>>>26),b=N+(I^(S|~P))+A[7]+1126891415&4294967295,N=S+(b<<10&4294967295|b>>>22),b=P+(S^(N|~I))+A[14]+2878612391&4294967295,P=N+(b<<15&4294967295|b>>>17),b=I+(N^(P|~S))+A[5]+4237533241&4294967295,I=P+(b<<21&4294967295|b>>>11),b=S+(P^(I|~N))+A[12]+1700485571&4294967295,S=I+(b<<6&4294967295|b>>>26),b=N+(I^(S|~P))+A[3]+2399980690&4294967295,N=S+(b<<10&4294967295|b>>>22),b=P+(S^(N|~I))+A[10]+4293915773&4294967295,P=N+(b<<15&4294967295|b>>>17),b=I+(N^(P|~S))+A[1]+2240044497&4294967295,I=P+(b<<21&4294967295|b>>>11),b=S+(P^(I|~N))+A[8]+1873313359&4294967295,S=I+(b<<6&4294967295|b>>>26),b=N+(I^(S|~P))+A[15]+4264355552&4294967295,N=S+(b<<10&4294967295|b>>>22),b=P+(S^(N|~I))+A[6]+2734768916&4294967295,P=N+(b<<15&4294967295|b>>>17),b=I+(N^(P|~S))+A[13]+1309151649&4294967295,I=P+(b<<21&4294967295|b>>>11),b=S+(P^(I|~N))+A[4]+4149444226&4294967295,S=I+(b<<6&4294967295|b>>>26),b=N+(I^(S|~P))+A[11]+3174756917&4294967295,N=S+(b<<10&4294967295|b>>>22),b=P+(S^(N|~I))+A[2]+718787259&4294967295,P=N+(b<<15&4294967295|b>>>17),b=I+(N^(P|~S))+A[9]+3951481745&4294967295,E.g[0]=E.g[0]+S&4294967295,E.g[1]=E.g[1]+(P+(b<<21&4294967295|b>>>11))&4294967295,E.g[2]=E.g[2]+P&4294967295,E.g[3]=E.g[3]+N&4294967295}r.prototype.v=function(E,S){S===void 0&&(S=E.length);const I=S-this.blockSize,A=this.C;let P=this.h,N=0;for(;N<S;){if(P==0)for(;N<=I;)i(this,E,N),N+=this.blockSize;if(typeof E=="string"){for(;N<S;)if(A[P++]=E.charCodeAt(N++),P==this.blockSize){i(this,A),P=0;break}}else for(;N<S;)if(A[P++]=E[N++],P==this.blockSize){i(this,A),P=0;break}}this.h=P,this.o+=S},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var S=1;S<E.length-8;++S)E[S]=0;S=this.o*8;for(var I=E.length-8;I<E.length;++I)E[I]=S&255,S/=256;for(this.v(E),E=Array(16),S=0,I=0;I<4;++I)for(let A=0;A<32;A+=8)E[S++]=this.g[I]>>>A&255;return E};function s(E,S){var I=a;return Object.prototype.hasOwnProperty.call(I,E)?I[E]:I[E]=S(E)}function o(E,S){this.h=S;const I=[];let A=!0;for(let P=E.length-1;P>=0;P--){const N=E[P]|0;A&&N==S||(I[P]=N,A=!1)}this.g=I}var a={};function l(E){return-128<=E&&E<128?s(E,function(S){return new o([S|0],S<0?-1:0)}):new o([E|0],E<0?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return f;if(E<0)return k(d(-E));const S=[];let I=1;for(let A=0;E>=I;A++)S[A]=E/I|0,I*=4294967296;return new o(S,0)}function h(E,S){if(E.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(E.charAt(0)=="-")return k(h(E.substring(1),S));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=d(Math.pow(S,8));let A=f;for(let N=0;N<E.length;N+=8){var P=Math.min(8,E.length-N);const b=parseInt(E.substring(N,N+P),S);P<8?(P=d(Math.pow(S,P)),A=A.j(P).add(d(b))):(A=A.j(I),A=A.add(d(b)))}return A}var f=l(0),p=l(1),g=l(16777216);t=o.prototype,t.m=function(){if(_(this))return-k(this).m();let E=0,S=1;for(let I=0;I<this.g.length;I++){const A=this.i(I);E+=(A>=0?A:4294967296+A)*S,S*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(x(this))return"0";if(_(this))return"-"+k(this).toString(E);const S=d(Math.pow(E,6));var I=this;let A="";for(;;){const P=j(I,S).g;I=T(I,P.j(S));let N=((I.g.length>0?I.g[0]:I.h)>>>0).toString(E);if(I=P,x(I))return N+A;for(;N.length<6;)N="0"+N;A=N+A}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function x(E){if(E.h!=0)return!1;for(let S=0;S<E.g.length;S++)if(E.g[S]!=0)return!1;return!0}function _(E){return E.h==-1}t.l=function(E){return E=T(this,E),_(E)?-1:x(E)?0:1};function k(E){const S=E.g.length,I=[];for(let A=0;A<S;A++)I[A]=~E.g[A];return new o(I,~E.h).add(p)}t.abs=function(){return _(this)?k(this):this},t.add=function(E){const S=Math.max(this.g.length,E.g.length),I=[];let A=0;for(let P=0;P<=S;P++){let N=A+(this.i(P)&65535)+(E.i(P)&65535),b=(N>>>16)+(this.i(P)>>>16)+(E.i(P)>>>16);A=b>>>16,N&=65535,b&=65535,I[P]=b<<16|N}return new o(I,I[I.length-1]&-2147483648?-1:0)};function T(E,S){return E.add(k(S))}t.j=function(E){if(x(this)||x(E))return f;if(_(this))return _(E)?k(this).j(k(E)):k(k(this).j(E));if(_(E))return k(this.j(k(E)));if(this.l(g)<0&&E.l(g)<0)return d(this.m()*E.m());const S=this.g.length+E.g.length,I=[];for(var A=0;A<2*S;A++)I[A]=0;for(A=0;A<this.g.length;A++)for(let P=0;P<E.g.length;P++){const N=this.i(A)>>>16,b=this.i(A)&65535,W=E.i(P)>>>16,de=E.i(P)&65535;I[2*A+2*P]+=b*de,v(I,2*A+2*P),I[2*A+2*P+1]+=N*de,v(I,2*A+2*P+1),I[2*A+2*P+1]+=b*W,v(I,2*A+2*P+1),I[2*A+2*P+2]+=N*W,v(I,2*A+2*P+2)}for(E=0;E<S;E++)I[E]=I[2*E+1]<<16|I[2*E];for(E=S;E<2*S;E++)I[E]=0;return new o(I,0)};function v(E,S){for(;(E[S]&65535)!=E[S];)E[S+1]+=E[S]>>>16,E[S]&=65535,S++}function w(E,S){this.g=E,this.h=S}function j(E,S){if(x(S))throw Error("division by zero");if(x(E))return new w(f,f);if(_(E))return S=j(k(E),S),new w(k(S.g),k(S.h));if(_(S))return S=j(E,k(S)),new w(k(S.g),S.h);if(E.g.length>30){if(_(E)||_(S))throw Error("slowDivide_ only works with positive integers.");for(var I=p,A=S;A.l(E)<=0;)I=L(I),A=L(A);var P=V(I,1),N=V(A,1);for(A=V(A,2),I=V(I,2);!x(A);){var b=N.add(A);b.l(E)<=0&&(P=P.add(I),N=b),A=V(A,1),I=V(I,1)}return S=T(E,P.j(S)),new w(P,S)}for(P=f;E.l(S)>=0;){for(I=Math.max(1,Math.floor(E.m()/S.m())),A=Math.ceil(Math.log(I)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),N=d(I),b=N.j(S);_(b)||b.l(E)>0;)I-=A,N=d(I),b=N.j(S);x(N)&&(N=p),P=P.add(N),E=T(E,b)}return new w(P,E)}t.B=function(E){return j(this,E).h},t.and=function(E){const S=Math.max(this.g.length,E.g.length),I=[];for(let A=0;A<S;A++)I[A]=this.i(A)&E.i(A);return new o(I,this.h&E.h)},t.or=function(E){const S=Math.max(this.g.length,E.g.length),I=[];for(let A=0;A<S;A++)I[A]=this.i(A)|E.i(A);return new o(I,this.h|E.h)},t.xor=function(E){const S=Math.max(this.g.length,E.g.length),I=[];for(let A=0;A<S;A++)I[A]=this.i(A)^E.i(A);return new o(I,this.h^E.h)};function L(E){const S=E.g.length+1,I=[];for(let A=0;A<S;A++)I[A]=E.i(A)<<1|E.i(A-1)>>>31;return new o(I,E.h)}function V(E,S){const I=S>>5;S%=32;const A=E.g.length-I,P=[];for(let N=0;N<A;N++)P[N]=S>0?E.i(N+I)>>>S|E.i(N+I+1)<<32-S:E.i(N+I);return new o(P,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,c2=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,gs=o}).apply(typeof Pw<"u"?Pw:typeof self<"u"?self:typeof window<"u"?window:{});var Hu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var u2,Dl,d2,yd,_g,h2,f2,p2;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hu=="object"&&Hu];for(var m=0;m<c.length;++m){var y=c[m];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(c,m){if(m)e:{var y=r;c=c.split(".");for(var C=0;C<c.length-1;C++){var O=c[C];if(!(O in y))break e;y=y[O]}c=c[c.length-1],C=y[c],m=m(C),m!=C&&m!=null&&e(y,c,{configurable:!0,writable:!0,value:m})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(m){var y=[],C;for(C in m)Object.prototype.hasOwnProperty.call(m,C)&&y.push([C,m[C]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(c){var m=typeof c;return m=="object"&&c!=null||m=="function"}function l(c,m,y){return c.call.apply(c.bind,arguments)}function d(c,m,y){return d=l,d.apply(null,arguments)}function h(c,m){var y=Array.prototype.slice.call(arguments,1);return function(){var C=y.slice();return C.push.apply(C,arguments),c.apply(this,C)}}function f(c,m){function y(){}y.prototype=m.prototype,c.Z=m.prototype,c.prototype=new y,c.prototype.constructor=c,c.Ob=function(C,O,F){for(var ne=Array(arguments.length-2),Re=2;Re<arguments.length;Re++)ne[Re-2]=arguments[Re];return m.prototype[O].apply(C,ne)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function g(c){const m=c.length;if(m>0){const y=Array(m);for(let C=0;C<m;C++)y[C]=c[C];return y}return[]}function x(c,m){for(let C=1;C<arguments.length;C++){const O=arguments[C];var y=typeof O;if(y=y!="object"?y:O?Array.isArray(O)?"array":y:"null",y=="array"||y=="object"&&typeof O.length=="number"){y=c.length||0;const F=O.length||0;c.length=y+F;for(let ne=0;ne<F;ne++)c[y+ne]=O[ne]}else c.push(O)}}class _{constructor(m,y){this.i=m,this.j=y,this.h=0,this.g=null}get(){let m;return this.h>0?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function k(c){o.setTimeout(()=>{throw c},0)}function T(){var c=E;let m=null;return c.g&&(m=c.g,c.g=c.g.next,c.g||(c.h=null),m.next=null),m}class v{constructor(){this.h=this.g=null}add(m,y){const C=w.get();C.set(m,y),this.h?this.h.next=C:this.g=C,this.h=C}}var w=new _(()=>new j,c=>c.reset());class j{constructor(){this.next=this.g=this.h=null}set(m,y){this.h=m,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let L,V=!1,E=new v,S=()=>{const c=Promise.resolve(void 0);L=()=>{c.then(I)}};function I(){for(var c;c=T();){try{c.h.call(c.g)}catch(y){k(y)}var m=w;m.j(c),m.h<100&&(m.h++,c.next=m.g,m.g=c)}V=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(c,m){this.type=c,this.g=this.target=m,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var N=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,m=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const y=()=>{};o.addEventListener("test",y,m),o.removeEventListener("test",y,m)}catch{}return c}();function b(c){return/^[\s\xa0]*$/.test(c)}function W(c,m){P.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,m)}f(W,P),W.prototype.init=function(c,m){const y=this.type=c.type,C=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=m,m=c.relatedTarget,m||(y=="mouseover"?m=c.fromElement:y=="mouseout"&&(m=c.toElement)),this.relatedTarget=m,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&W.Z.h.call(this)},W.prototype.h=function(){W.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var de="closure_listenable_"+(Math.random()*1e6|0),re=0;function se(c,m,y,C,O){this.listener=c,this.proxy=null,this.src=m,this.type=y,this.capture=!!C,this.ha=O,this.key=++re,this.da=this.fa=!1}function z(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function G(c,m,y){for(const C in c)m.call(y,c[C],C,c)}function M(c,m){for(const y in c)m.call(void 0,c[y],y,c)}function D(c){const m={};for(const y in c)m[y]=c[y];return m}const H="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(c,m){let y,C;for(let O=1;O<arguments.length;O++){C=arguments[O];for(y in C)c[y]=C[y];for(let F=0;F<H.length;F++)y=H[F],Object.prototype.hasOwnProperty.call(C,y)&&(c[y]=C[y])}}function te(c){this.src=c,this.g={},this.h=0}te.prototype.add=function(c,m,y,C,O){const F=c.toString();c=this.g[F],c||(c=this.g[F]=[],this.h++);const ne=ee(c,m,C,O);return ne>-1?(m=c[ne],y||(m.fa=!1)):(m=new se(m,this.src,F,!!C,O),m.fa=y,c.push(m)),m};function ie(c,m){const y=m.type;if(y in c.g){var C=c.g[y],O=Array.prototype.indexOf.call(C,m,void 0),F;(F=O>=0)&&Array.prototype.splice.call(C,O,1),F&&(z(m),c.g[y].length==0&&(delete c.g[y],c.h--))}}function ee(c,m,y,C){for(let O=0;O<c.length;++O){const F=c[O];if(!F.da&&F.listener==m&&F.capture==!!y&&F.ha==C)return O}return-1}var U="closure_lm_"+(Math.random()*1e6|0),Y={};function pe(c,m,y,C,O){if(C&&C.once)return Ae(c,m,y,C,O);if(Array.isArray(m)){for(let F=0;F<m.length;F++)pe(c,m[F],y,C,O);return null}return y=dt(y),c&&c[de]?c.J(m,y,a(C)?!!C.capture:!!C,O):_e(c,m,y,!1,C,O)}function _e(c,m,y,C,O,F){if(!m)throw Error("Invalid event type");const ne=a(O)?!!O.capture:!!O;let Re=Ye(c);if(Re||(c[U]=Re=new te(c)),y=Re.add(m,y,C,ne,F),y.proxy)return y;if(C=ge(),y.proxy=C,C.src=c,C.listener=y,c.addEventListener)N||(O=ne),O===void 0&&(O=!1),c.addEventListener(m.toString(),C,O);else if(c.attachEvent)c.attachEvent(ke(m.toString()),C);else if(c.addListener&&c.removeListener)c.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return y}function ge(){function c(y){return m.call(c.src,c.listener,y)}const m=Ge;return c}function Ae(c,m,y,C,O){if(Array.isArray(m)){for(let F=0;F<m.length;F++)Ae(c,m[F],y,C,O);return null}return y=dt(y),c&&c[de]?c.K(m,y,a(C)?!!C.capture:!!C,O):_e(c,m,y,!0,C,O)}function $(c,m,y,C,O){if(Array.isArray(m))for(var F=0;F<m.length;F++)$(c,m[F],y,C,O);else C=a(C)?!!C.capture:!!C,y=dt(y),c&&c[de]?(c=c.i,F=String(m).toString(),F in c.g&&(m=c.g[F],y=ee(m,y,C,O),y>-1&&(z(m[y]),Array.prototype.splice.call(m,y,1),m.length==0&&(delete c.g[F],c.h--)))):c&&(c=Ye(c))&&(m=c.g[m.toString()],c=-1,m&&(c=ee(m,y,C,O)),(y=c>-1?m[c]:null)&&ae(y))}function ae(c){if(typeof c!="number"&&c&&!c.da){var m=c.src;if(m&&m[de])ie(m.i,c);else{var y=c.type,C=c.proxy;m.removeEventListener?m.removeEventListener(y,C,c.capture):m.detachEvent?m.detachEvent(ke(y),C):m.addListener&&m.removeListener&&m.removeListener(C),(y=Ye(m))?(ie(y,c),y.h==0&&(y.src=null,m[U]=null)):z(c)}}}function ke(c){return c in Y?Y[c]:Y[c]="on"+c}function Ge(c,m){if(c.da)c=!0;else{m=new W(m,this);const y=c.listener,C=c.ha||c.src;c.fa&&ae(c),c=y.call(C,m)}return c}function Ye(c){return c=c[U],c instanceof te?c:null}var Xe="__closure_events_fn_"+(Math.random()*1e9>>>0);function dt(c){return typeof c=="function"?c:(c[Xe]||(c[Xe]=function(m){return c.handleEvent(m)}),c[Xe])}function Ne(){A.call(this),this.i=new te(this),this.M=this,this.G=null}f(Ne,A),Ne.prototype[de]=!0,Ne.prototype.removeEventListener=function(c,m,y,C){$(this,c,m,y,C)};function He(c,m){var y,C=c.G;if(C)for(y=[];C;C=C.G)y.push(C);if(c=c.M,C=m.type||m,typeof m=="string")m=new P(m,c);else if(m instanceof P)m.target=m.target||c;else{var O=m;m=new P(C,c),J(m,O)}O=!0;let F,ne;if(y)for(ne=y.length-1;ne>=0;ne--)F=m.g=y[ne],O=Kn(F,C,!0,m)&&O;if(F=m.g=c,O=Kn(F,C,!0,m)&&O,O=Kn(F,C,!1,m)&&O,y)for(ne=0;ne<y.length;ne++)F=m.g=y[ne],O=Kn(F,C,!1,m)&&O}Ne.prototype.N=function(){if(Ne.Z.N.call(this),this.i){var c=this.i;for(const m in c.g){const y=c.g[m];for(let C=0;C<y.length;C++)z(y[C]);delete c.g[m],c.h--}}this.G=null},Ne.prototype.J=function(c,m,y,C){return this.i.add(String(c),m,!1,y,C)},Ne.prototype.K=function(c,m,y,C){return this.i.add(String(c),m,!0,y,C)};function Kn(c,m,y,C){if(m=c.i.g[String(m)],!m)return!0;m=m.concat();let O=!0;for(let F=0;F<m.length;++F){const ne=m[F];if(ne&&!ne.da&&ne.capture==y){const Re=ne.listener,Dt=ne.ha||ne.src;ne.fa&&ie(c.i,ne),O=Re.call(Dt,C)!==!1&&O}}return O&&!C.defaultPrevented}function Qn(c,m){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(m)>2147483647?-1:o.setTimeout(c,m||0)}function jn(c){c.g=Qn(()=>{c.g=null,c.i&&(c.i=!1,jn(c))},c.l);const m=c.h;c.h=null,c.m.apply(null,m)}class kr extends A{constructor(m,y){super(),this.m=m,this.l=y,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:jn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Jt(c){A.call(this),this.h=c,this.g={}}f(Jt,A);var Zt=[];function Ar(c){G(c.g,function(m,y){this.g.hasOwnProperty(y)&&ae(m)},c),c.g={}}Jt.prototype.N=function(){Jt.Z.N.call(this),Ar(this)},Jt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ee=o.JSON.stringify,he=o.JSON.parse,fe=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function De(){}function nt(){}var rt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function We(){P.call(this,"d")}f(We,P);function hn(){P.call(this,"c")}f(hn,P);var Je={},K=null;function le(){return K=K||new Ne}Je.Ia="serverreachability";function me(c){P.call(this,Je.Ia,c)}f(me,P);function X(c){const m=le();He(m,new me(m))}Je.STAT_EVENT="statevent";function xe(c,m){P.call(this,Je.STAT_EVENT,c),this.stat=m}f(xe,P);function ye(c){const m=le();He(m,new xe(m,c))}Je.Ja="timingevent";function St(c,m){P.call(this,Je.Ja,c),this.size=m}f(St,P);function Ke(c,m){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},m)}function je(){this.g=!0}je.prototype.ua=function(){this.g=!1};function Bt(c,m,y,C,O,F){c.info(function(){if(c.g)if(F){var ne="",Re=F.split("&");for(let Qe=0;Qe<Re.length;Qe++){var Dt=Re[Qe].split("=");if(Dt.length>1){const Ot=Dt[0];Dt=Dt[1];const Pr=Ot.split("_");ne=Pr.length>=2&&Pr[1]=="type"?ne+(Ot+"="+Dt+"&"):ne+(Ot+"=redacted&")}}}else ne=null;else ne=F;return"XMLHTTP REQ ("+C+") [attempt "+O+"]: "+m+`
`+y+`
`+ne})}function $t(c,m,y,C,O,F,ne){c.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+O+"]: "+m+`
`+y+`
`+F+" "+ne})}function en(c,m,y,C){c.info(function(){return"XMLHTTP TEXT ("+m+"): "+Ek(c,y)+(C?" "+C:"")})}function Tk(c,m){c.info(function(){return"TIMEOUT: "+m})}je.prototype.info=function(){};function Ek(c,m){if(!c.g)return m;if(!m)return null;try{const F=JSON.parse(m);if(F){for(c=0;c<F.length;c++)if(Array.isArray(F[c])){var y=F[c];if(!(y.length<2)){var C=y[1];if(Array.isArray(C)&&!(C.length<1)){var O=C[0];if(O!="noop"&&O!="stop"&&O!="close")for(let ne=1;ne<C.length;ne++)C[ne]=""}}}}return Ee(F)}catch{return m}}var mu={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Tv={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ev;function Uf(){}f(Uf,De),Uf.prototype.g=function(){return new XMLHttpRequest},Ev=new Uf;function il(c){return encodeURIComponent(String(c))}function bk(c){var m=1;c=c.split(":");const y=[];for(;m>0&&c.length;)y.push(c.shift()),m--;return c.length&&y.push(c.join(":")),y}function ki(c,m,y,C){this.j=c,this.i=m,this.l=y,this.S=C||1,this.V=new Jt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new bv}function bv(){this.i=null,this.g="",this.h=!1}var Iv={},Bf={};function $f(c,m,y){c.M=1,c.A=yu(Rr(m)),c.u=y,c.R=!0,Cv(c,null)}function Cv(c,m){c.F=Date.now(),gu(c),c.B=Rr(c.A);var y=c.B,C=c.S;Array.isArray(C)||(C=[String(C)]),zv(y.i,"t",C),c.C=0,y=c.j.L,c.h=new bv,c.g=i1(c.j,y?m:null,!c.u),c.P>0&&(c.O=new kr(d(c.Y,c,c.g),c.P)),m=c.V,y=c.g,C=c.ba;var O="readystatechange";Array.isArray(O)||(O&&(Zt[0]=O.toString()),O=Zt);for(let F=0;F<O.length;F++){const ne=pe(y,O[F],C||m.handleEvent,!1,m.h||m);if(!ne)break;m.g[ne.key]=ne}m=c.J?D(c.J):{},c.u?(c.v||(c.v="POST"),m["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,m)):(c.v="GET",c.g.ea(c.B,c.v,null,m)),X(),Bt(c.i,c.v,c.B,c.l,c.S,c.u)}ki.prototype.ba=function(c){c=c.target;const m=this.O;m&&Pi(c)==3?m.j():this.Y(c)},ki.prototype.Y=function(c){try{if(c==this.g)e:{const Re=Pi(this.g),Dt=this.g.ya(),Qe=this.g.ca();if(!(Re<3)&&(Re!=3||this.g&&(this.h.h||this.g.la()||Gv(this.g)))){this.K||Re!=4||Dt==7||(Dt==8||Qe<=0?X(3):X(2)),Wf(this);var m=this.g.ca();this.X=m;var y=Ik(this);if(this.o=m==200,$t(this.i,this.v,this.B,this.l,this.S,Re,m),this.o){if(this.U&&!this.L){t:{if(this.g){var C,O=this.g;if((C=O.g?O.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(C)){var F=C;break t}}F=null}if(c=F)en(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,qf(this,c);else{this.o=!1,this.m=3,ye(12),Os(this),sl(this);break e}}if(this.R){c=!0;let Ot;for(;!this.K&&this.C<y.length;)if(Ot=Ck(this,y),Ot==Bf){Re==4&&(this.m=4,ye(14),c=!1),en(this.i,this.l,null,"[Incomplete Response]");break}else if(Ot==Iv){this.m=4,ye(15),en(this.i,this.l,y,"[Invalid Chunk]"),c=!1;break}else en(this.i,this.l,Ot,null),qf(this,Ot);if(kv(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Re!=4||y.length!=0||this.h.h||(this.m=1,ye(16),c=!1),this.o=this.o&&c,!c)en(this.i,this.l,y,"[Invalid Chunked Response]"),Os(this),sl(this);else if(y.length>0&&!this.W){this.W=!0;var ne=this.j;ne.g==this&&ne.aa&&!ne.P&&(ne.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),Zf(ne),ne.P=!0,ye(11))}}else en(this.i,this.l,y,null),qf(this,y);Re==4&&Os(this),this.o&&!this.K&&(Re==4?e1(this.j,this):(this.o=!1,gu(this)))}else Uk(this.g),m==400&&y.indexOf("Unknown SID")>0?(this.m=3,ye(12)):(this.m=0,ye(13)),Os(this),sl(this)}}}catch{}finally{}};function Ik(c){if(!kv(c))return c.g.la();const m=Gv(c.g);if(m==="")return"";let y="";const C=m.length,O=Pi(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Os(c),sl(c),"";c.h.i=new o.TextDecoder}for(let F=0;F<C;F++)c.h.h=!0,y+=c.h.i.decode(m[F],{stream:!(O&&F==C-1)});return m.length=0,c.h.g+=y,c.C=0,c.h.g}function kv(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Ck(c,m){var y=c.C,C=m.indexOf(`
`,y);return C==-1?Bf:(y=Number(m.substring(y,C)),isNaN(y)?Iv:(C+=1,C+y>m.length?Bf:(m=m.slice(C,C+y),c.C=C+y,m)))}ki.prototype.cancel=function(){this.K=!0,Os(this)};function gu(c){c.T=Date.now()+c.H,Av(c,c.H)}function Av(c,m){if(c.D!=null)throw Error("WatchDog timer not null");c.D=Ke(d(c.aa,c),m)}function Wf(c){c.D&&(o.clearTimeout(c.D),c.D=null)}ki.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Tk(this.i,this.B),this.M!=2&&(X(),ye(17)),Os(this),this.m=2,sl(this)):Av(this,this.T-c)};function sl(c){c.j.I==0||c.K||e1(c.j,c)}function Os(c){Wf(c);var m=c.O;m&&typeof m.dispose=="function"&&m.dispose(),c.O=null,Ar(c.V),c.g&&(m=c.g,c.g=null,m.abort(),m.dispose())}function qf(c,m){try{var y=c.j;if(y.I!=0&&(y.g==c||Hf(y.h,c))){if(!c.L&&Hf(y.h,c)&&y.I==3){try{var C=y.Ba.g.parse(m)}catch{C=null}if(Array.isArray(C)&&C.length==3){var O=C;if(O[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<c.F)Su(y),wu(y);else break e;Jf(y),ye(18)}}else y.xa=O[1],0<y.xa-y.K&&O[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=Ke(d(y.Va,y),6e3));Nv(y.h)<=1&&y.ta&&(y.ta=void 0)}else zs(y,11)}else if((c.L||y.g==c)&&Su(y),!b(m))for(O=y.Ba.g.parse(m),m=0;m<O.length;m++){let Qe=O[m];const Ot=Qe[0];if(!(Ot<=y.K))if(y.K=Ot,Qe=Qe[1],y.I==2)if(Qe[0]=="c"){y.M=Qe[1],y.ba=Qe[2];const Pr=Qe[3];Pr!=null&&(y.ka=Pr,y.j.info("VER="+y.ka));const Us=Qe[4];Us!=null&&(y.za=Us,y.j.info("SVER="+y.za));const Ni=Qe[5];Ni!=null&&typeof Ni=="number"&&Ni>0&&(C=1.5*Ni,y.O=C,y.j.info("backChannelRequestTimeoutMs_="+C)),C=y;const Di=c.g;if(Di){const Eu=Di.g?Di.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Eu){var F=C.h;F.g||Eu.indexOf("spdy")==-1&&Eu.indexOf("quic")==-1&&Eu.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(Gf(F,F.h),F.h=null))}if(C.G){const ep=Di.g?Di.g.getResponseHeader("X-HTTP-Session-Id"):null;ep&&(C.wa=ep,it(C.J,C.G,ep))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-c.F,y.j.info("Handshake RTT: "+y.T+"ms")),C=y;var ne=c;if(C.na=r1(C,C.L?C.ba:null,C.W),ne.L){Dv(C.h,ne);var Re=ne,Dt=C.O;Dt&&(Re.H=Dt),Re.D&&(Wf(Re),gu(Re)),C.g=ne}else Jv(C);y.i.length>0&&_u(y)}else Qe[0]!="stop"&&Qe[0]!="close"||zs(y,7);else y.I==3&&(Qe[0]=="stop"||Qe[0]=="close"?Qe[0]=="stop"?zs(y,7):Xf(y):Qe[0]!="noop"&&y.l&&y.l.qa(Qe),y.A=0)}}X(4)}catch{}}var kk=class{constructor(c,m){this.g=c,this.map=m}};function Rv(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Pv(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Nv(c){return c.h?1:c.g?c.g.size:0}function Hf(c,m){return c.h?c.h==m:c.g?c.g.has(m):!1}function Gf(c,m){c.g?c.g.add(m):c.h=m}function Dv(c,m){c.h&&c.h==m?c.h=null:c.g&&c.g.has(m)&&c.g.delete(m)}Rv.prototype.cancel=function(){if(this.i=jv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function jv(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let m=c.i;for(const y of c.g.values())m=m.concat(y.G);return m}return g(c.i)}var Lv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ak(c,m){if(c){c=c.split("&");for(let y=0;y<c.length;y++){const C=c[y].indexOf("=");let O,F=null;C>=0?(O=c[y].substring(0,C),F=c[y].substring(C+1)):O=c[y],m(O,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function Ai(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let m;c instanceof Ai?(this.l=c.l,ol(this,c.j),this.o=c.o,this.g=c.g,al(this,c.u),this.h=c.h,Kf(this,Uv(c.i)),this.m=c.m):c&&(m=String(c).match(Lv))?(this.l=!1,ol(this,m[1]||"",!0),this.o=ll(m[2]||""),this.g=ll(m[3]||"",!0),al(this,m[4]),this.h=ll(m[5]||"",!0),Kf(this,m[6]||"",!0),this.m=ll(m[7]||"")):(this.l=!1,this.i=new ul(null,this.l))}Ai.prototype.toString=function(){const c=[];var m=this.j;m&&c.push(cl(m,Mv,!0),":");var y=this.g;return(y||m=="file")&&(c.push("//"),(m=this.o)&&c.push(cl(m,Mv,!0),"@"),c.push(il(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&c.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&c.push("/"),c.push(cl(y,y.charAt(0)=="/"?Nk:Pk,!0))),(y=this.i.toString())&&c.push("?",y),(y=this.m)&&c.push("#",cl(y,jk)),c.join("")},Ai.prototype.resolve=function(c){const m=Rr(this);let y=!!c.j;y?ol(m,c.j):y=!!c.o,y?m.o=c.o:y=!!c.g,y?m.g=c.g:y=c.u!=null;var C=c.h;if(y)al(m,c.u);else if(y=!!c.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var O=m.h.lastIndexOf("/");O!=-1&&(C=m.h.slice(0,O+1)+C)}if(O=C,O==".."||O==".")C="";else if(O.indexOf("./")!=-1||O.indexOf("/.")!=-1){C=O.lastIndexOf("/",0)==0,O=O.split("/");const F=[];for(let ne=0;ne<O.length;){const Re=O[ne++];Re=="."?C&&ne==O.length&&F.push(""):Re==".."?((F.length>1||F.length==1&&F[0]!="")&&F.pop(),C&&ne==O.length&&F.push("")):(F.push(Re),C=!0)}C=F.join("/")}else C=O}return y?m.h=C:y=c.i.toString()!=="",y?Kf(m,Uv(c.i)):y=!!c.m,y&&(m.m=c.m),m};function Rr(c){return new Ai(c)}function ol(c,m,y){c.j=y?ll(m,!0):m,c.j&&(c.j=c.j.replace(/:$/,""))}function al(c,m){if(m){if(m=Number(m),isNaN(m)||m<0)throw Error("Bad port number "+m);c.u=m}else c.u=null}function Kf(c,m,y){m instanceof ul?(c.i=m,Lk(c.i,c.l)):(y||(m=cl(m,Dk)),c.i=new ul(m,c.l))}function it(c,m,y){c.i.set(m,y)}function yu(c){return it(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function ll(c,m){return c?m?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function cl(c,m,y){return typeof c=="string"?(c=encodeURI(c).replace(m,Rk),y&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Rk(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Mv=/[#\/\?@]/g,Pk=/[#\?:]/g,Nk=/[#\?]/g,Dk=/[#\?@]/g,jk=/#/g;function ul(c,m){this.h=this.g=null,this.i=c||null,this.j=!!m}function Fs(c){c.g||(c.g=new Map,c.h=0,c.i&&Ak(c.i,function(m,y){c.add(decodeURIComponent(m.replace(/\+/g," ")),y)}))}t=ul.prototype,t.add=function(c,m){Fs(this),this.i=null,c=Mo(this,c);let y=this.g.get(c);return y||this.g.set(c,y=[]),y.push(m),this.h+=1,this};function Vv(c,m){Fs(c),m=Mo(c,m),c.g.has(m)&&(c.i=null,c.h-=c.g.get(m).length,c.g.delete(m))}function Ov(c,m){return Fs(c),m=Mo(c,m),c.g.has(m)}t.forEach=function(c,m){Fs(this),this.g.forEach(function(y,C){y.forEach(function(O){c.call(m,O,C,this)},this)},this)};function Fv(c,m){Fs(c);let y=[];if(typeof m=="string")Ov(c,m)&&(y=y.concat(c.g.get(Mo(c,m))));else for(c=Array.from(c.g.values()),m=0;m<c.length;m++)y=y.concat(c[m]);return y}t.set=function(c,m){return Fs(this),this.i=null,c=Mo(this,c),Ov(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[m]),this.h+=1,this},t.get=function(c,m){return c?(c=Fv(this,c),c.length>0?String(c[0]):m):m};function zv(c,m,y){Vv(c,m),y.length>0&&(c.i=null,c.g.set(Mo(c,m),g(y)),c.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],m=Array.from(this.g.keys());for(let C=0;C<m.length;C++){var y=m[C];const O=il(y);y=Fv(this,y);for(let F=0;F<y.length;F++){let ne=O;y[F]!==""&&(ne+="="+il(y[F])),c.push(ne)}}return this.i=c.join("&")};function Uv(c){const m=new ul;return m.i=c.i,c.g&&(m.g=new Map(c.g),m.h=c.h),m}function Mo(c,m){return m=String(m),c.j&&(m=m.toLowerCase()),m}function Lk(c,m){m&&!c.j&&(Fs(c),c.i=null,c.g.forEach(function(y,C){const O=C.toLowerCase();C!=O&&(Vv(this,C),zv(this,O,y))},c)),c.j=m}function Mk(c,m){const y=new je;if(o.Image){const C=new Image;C.onload=h(Ri,y,"TestLoadImage: loaded",!0,m,C),C.onerror=h(Ri,y,"TestLoadImage: error",!1,m,C),C.onabort=h(Ri,y,"TestLoadImage: abort",!1,m,C),C.ontimeout=h(Ri,y,"TestLoadImage: timeout",!1,m,C),o.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=c}else m(!1)}function Vk(c,m){const y=new je,C=new AbortController,O=setTimeout(()=>{C.abort(),Ri(y,"TestPingServer: timeout",!1,m)},1e4);fetch(c,{signal:C.signal}).then(F=>{clearTimeout(O),F.ok?Ri(y,"TestPingServer: ok",!0,m):Ri(y,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(O),Ri(y,"TestPingServer: error",!1,m)})}function Ri(c,m,y,C,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),C(y)}catch{}}function Ok(){this.g=new fe}function Qf(c){this.i=c.Sb||null,this.h=c.ab||!1}f(Qf,De),Qf.prototype.g=function(){return new vu(this.i,this.h)};function vu(c,m){Ne.call(this),this.H=c,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(vu,Ne),t=vu.prototype,t.open=function(c,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=m,this.readyState=1,hl(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const m={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(m.body=c),(this.H||o).fetch(new Request(this.D,m)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,dl(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,hl(this)),this.g&&(this.readyState=3,hl(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Bv(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function Bv(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var m=c.value?c.value:new Uint8Array(0);(m=this.B.decode(m,{stream:!c.done}))&&(this.response=this.responseText+=m)}c.done?dl(this):hl(this),this.readyState==3&&Bv(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,dl(this))},t.Na=function(c){this.g&&(this.response=c,dl(this))},t.ga=function(){this.g&&dl(this)};function dl(c){c.readyState=4,c.l=null,c.j=null,c.B=null,hl(c)}t.setRequestHeader=function(c,m){this.A.append(c,m)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],m=this.h.entries();for(var y=m.next();!y.done;)y=y.value,c.push(y[0]+": "+y[1]),y=m.next();return c.join(`\r
`)};function hl(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(vu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function $v(c){let m="";return G(c,function(y,C){m+=C,m+=":",m+=y,m+=`\r
`}),m}function Yf(c,m,y){e:{for(C in y){var C=!1;break e}C=!0}C||(y=$v(y),typeof c=="string"?y!=null&&il(y):it(c,m,y))}function yt(c){Ne.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(yt,Ne);var Fk=/^https?$/i,zk=["POST","PUT"];t=yt.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,m,y,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);m=m?m.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ev.g(),this.g.onreadystatechange=p(d(this.Ca,this));try{this.B=!0,this.g.open(m,String(c),!0),this.B=!1}catch(F){Wv(this,F);return}if(c=y||"",y=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var O in C)y.set(O,C[O]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const F of C.keys())y.set(F,C.get(F));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(y.keys()).find(F=>F.toLowerCase()=="content-type"),O=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(zk,m,void 0)>=0)||C||O||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,ne]of y)this.g.setRequestHeader(F,ne);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(F){Wv(this,F)}};function Wv(c,m){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=m,c.o=5,qv(c),xu(c)}function qv(c){c.A||(c.A=!0,He(c,"complete"),He(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,He(this,"complete"),He(this,"abort"),xu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xu(this,!0)),yt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Hv(this):this.Xa())},t.Xa=function(){Hv(this)};function Hv(c){if(c.h&&typeof s<"u"){if(c.v&&Pi(c)==4)setTimeout(c.Ca.bind(c),0);else if(He(c,"readystatechange"),Pi(c)==4){c.h=!1;try{const F=c.ca();e:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var y;if(!(y=m)){var C;if(C=F===0){let ne=String(c.D).match(Lv)[1]||null;!ne&&o.self&&o.self.location&&(ne=o.self.location.protocol.slice(0,-1)),C=!Fk.test(ne?ne.toLowerCase():"")}y=C}if(y)He(c,"complete"),He(c,"success");else{c.o=6;try{var O=Pi(c)>2?c.g.statusText:""}catch{O=""}c.l=O+" ["+c.ca()+"]",qv(c)}}finally{xu(c)}}}}function xu(c,m){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const y=c.g;c.g=null,m||He(c,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Pi(c){return c.g?c.g.readyState:0}t.ca=function(){try{return Pi(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var m=this.g.responseText;return c&&m.indexOf(c)==0&&(m=m.substring(c.length)),he(m)}};function Gv(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Uk(c){const m={};c=(c.g&&Pi(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<c.length;C++){if(b(c[C]))continue;var y=bk(c[C]);const O=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const F=m[O]||[];m[O]=F,F.push(y)}M(m,function(C){return C.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function fl(c,m,y){return y&&y.internalChannelParams&&y.internalChannelParams[c]||m}function Kv(c){this.za=0,this.i=[],this.j=new je,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=fl("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=fl("baseRetryDelayMs",5e3,c),this.Za=fl("retryDelaySeedMs",1e4,c),this.Ta=fl("forwardChannelMaxRetries",2,c),this.va=fl("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Rv(c&&c.concurrentRequestLimit),this.Ba=new Ok,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Kv.prototype,t.ka=8,t.I=1,t.connect=function(c,m,y,C){ye(0),this.W=c,this.H=m||{},y&&C!==void 0&&(this.H.OSID=y,this.H.OAID=C),this.F=this.X,this.J=r1(this,null,this.W),_u(this)};function Xf(c){if(Qv(c),c.I==3){var m=c.V++,y=Rr(c.J);if(it(y,"SID",c.M),it(y,"RID",m),it(y,"TYPE","terminate"),pl(c,y),m=new ki(c,c.j,m),m.M=2,m.A=yu(Rr(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(m.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=m.A,y=!0),y||(m.g=i1(m.j,null),m.g.ea(m.A)),m.F=Date.now(),gu(m)}n1(c)}function wu(c){c.g&&(Zf(c),c.g.cancel(),c.g=null)}function Qv(c){wu(c),c.v&&(o.clearTimeout(c.v),c.v=null),Su(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function _u(c){if(!Pv(c.h)&&!c.m){c.m=!0;var m=c.Ea;L||S(),V||(L(),V=!0),E.add(m,c),c.D=0}}function Bk(c,m){return Nv(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=m.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=Ke(d(c.Ea,c,m),t1(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const O=new ki(this,this.j,c);let F=this.o;if(this.U&&(F?(F=D(F),J(F,this.U)):F=this.U),this.u!==null||this.R||(O.J=F,F=null),this.S)e:{for(var m=0,y=0;y<this.i.length;y++){t:{var C=this.i[y];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(m+=C,m>4096){m=y;break e}if(m===4096||y===this.i.length-1){m=y+1;break e}}m=1e3}else m=1e3;m=Xv(this,O,m),y=Rr(this.J),it(y,"RID",c),it(y,"CVER",22),this.G&&it(y,"X-HTTP-Session-Id",this.G),pl(this,y),F&&(this.R?m="headers="+il($v(F))+"&"+m:this.u&&Yf(y,this.u,F)),Gf(this.h,O),this.Ra&&it(y,"TYPE","init"),this.S?(it(y,"$req",m),it(y,"SID","null"),O.U=!0,$f(O,y,null)):$f(O,y,m),this.I=2}}else this.I==3&&(c?Yv(this,c):this.i.length==0||Pv(this.h)||Yv(this))};function Yv(c,m){var y;m?y=m.l:y=c.V++;const C=Rr(c.J);it(C,"SID",c.M),it(C,"RID",y),it(C,"AID",c.K),pl(c,C),c.u&&c.o&&Yf(C,c.u,c.o),y=new ki(c,c.j,y,c.D+1),c.u===null&&(y.J=c.o),m&&(c.i=m.G.concat(c.i)),m=Xv(c,y,1e3),y.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Gf(c.h,y),$f(y,C,m)}function pl(c,m){c.H&&G(c.H,function(y,C){it(m,C,y)}),c.l&&G({},function(y,C){it(m,C,y)})}function Xv(c,m,y){y=Math.min(c.i.length,y);const C=c.l?d(c.l.Ka,c.l,c):null;e:{var O=c.i;let Re=-1;for(;;){const Dt=["count="+y];Re==-1?y>0?(Re=O[0].g,Dt.push("ofs="+Re)):Re=0:Dt.push("ofs="+Re);let Qe=!0;for(let Ot=0;Ot<y;Ot++){var F=O[Ot].g;const Pr=O[Ot].map;if(F-=Re,F<0)Re=Math.max(0,O[Ot].g-100),Qe=!1;else try{F="req"+F+"_"||"";try{var ne=Pr instanceof Map?Pr:Object.entries(Pr);for(const[Us,Ni]of ne){let Di=Ni;a(Ni)&&(Di=Ee(Ni)),Dt.push(F+Us+"="+encodeURIComponent(Di))}}catch(Us){throw Dt.push(F+"type="+encodeURIComponent("_badmap")),Us}}catch{C&&C(Pr)}}if(Qe){ne=Dt.join("&");break e}}ne=void 0}return c=c.i.splice(0,y),m.G=c,ne}function Jv(c){if(!c.g&&!c.v){c.Y=1;var m=c.Da;L||S(),V||(L(),V=!0),E.add(m,c),c.A=0}}function Jf(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=Ke(d(c.Da,c),t1(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,Zv(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=Ke(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ye(10),wu(this),Zv(this))};function Zf(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function Zv(c){c.g=new ki(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var m=Rr(c.na);it(m,"RID","rpc"),it(m,"SID",c.M),it(m,"AID",c.K),it(m,"CI",c.F?"0":"1"),!c.F&&c.ia&&it(m,"TO",c.ia),it(m,"TYPE","xmlhttp"),pl(c,m),c.u&&c.o&&Yf(m,c.u,c.o),c.O&&(c.g.H=c.O);var y=c.g;c=c.ba,y.M=1,y.A=yu(Rr(m)),y.u=null,y.R=!0,Cv(y,c)}t.Va=function(){this.C!=null&&(this.C=null,wu(this),Jf(this),ye(19))};function Su(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function e1(c,m){var y=null;if(c.g==m){Su(c),Zf(c),c.g=null;var C=2}else if(Hf(c.h,m))y=m.G,Dv(c.h,m),C=1;else return;if(c.I!=0){if(m.o)if(C==1){y=m.u?m.u.length:0,m=Date.now()-m.F;var O=c.D;C=le(),He(C,new St(C,y)),_u(c)}else Jv(c);else if(O=m.m,O==3||O==0&&m.X>0||!(C==1&&Bk(c,m)||C==2&&Jf(c)))switch(y&&y.length>0&&(m=c.h,m.i=m.i.concat(y)),O){case 1:zs(c,5);break;case 4:zs(c,10);break;case 3:zs(c,6);break;default:zs(c,2)}}}function t1(c,m){let y=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(y*=2),y*m}function zs(c,m){if(c.j.info("Error code "+m),m==2){var y=d(c.bb,c),C=c.Ua;const O=!C;C=new Ai(C||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ol(C,"https"),yu(C),O?Mk(C.toString(),y):Vk(C.toString(),y)}else ye(2);c.I=0,c.l&&c.l.pa(m),n1(c),Qv(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),ye(2)):(this.j.info("Failed to ping google.com"),ye(1))};function n1(c){if(c.I=0,c.ja=[],c.l){const m=jv(c.h);(m.length!=0||c.i.length!=0)&&(x(c.ja,m),x(c.ja,c.i),c.h.i.length=0,g(c.i),c.i.length=0),c.l.oa()}}function r1(c,m,y){var C=y instanceof Ai?Rr(y):new Ai(y);if(C.g!="")m&&(C.g=m+"."+C.g),al(C,C.u);else{var O=o.location;C=O.protocol,m=m?m+"."+O.hostname:O.hostname,O=+O.port;const F=new Ai(null);C&&ol(F,C),m&&(F.g=m),O&&al(F,O),y&&(F.h=y),C=F}return y=c.G,m=c.wa,y&&m&&it(C,y,m),it(C,"VER",c.ka),pl(c,C),C}function i1(c,m,y){if(m&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return m=c.Aa&&!c.ma?new yt(new Qf({ab:y})):new yt(c.ma),m.Fa(c.L),m}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function s1(){}t=s1.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Tu(){}Tu.prototype.g=function(c,m){return new Ln(c,m)};function Ln(c,m){Ne.call(this),this.g=new Kv(m),this.l=c,this.h=m&&m.messageUrlParams||null,c=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(c?c["X-WebChannel-Content-Type"]=m.messageContentType:c={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.sa&&(c?c["X-WebChannel-Client-Profile"]=m.sa:c={"X-WebChannel-Client-Profile":m.sa}),this.g.U=c,(c=m&&m.Qb)&&!b(c)&&(this.g.u=c),this.A=m&&m.supportsCrossDomainXhr||!1,this.v=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!b(m)&&(this.g.G=m,c=this.h,c!==null&&m in c&&(c=this.h,m in c&&delete c[m])),this.j=new Vo(this)}f(Ln,Ne),Ln.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ln.prototype.close=function(){Xf(this.g)},Ln.prototype.o=function(c){var m=this.g;if(typeof c=="string"){var y={};y.__data__=c,c=y}else this.v&&(y={},y.__data__=Ee(c),c=y);m.i.push(new kk(m.Ya++,c)),m.I==3&&_u(m)},Ln.prototype.N=function(){this.g.l=null,delete this.j,Xf(this.g),delete this.g,Ln.Z.N.call(this)};function o1(c){We.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var m=c.__sm__;if(m){e:{for(const y in m){c=y;break e}c=void 0}(this.i=c)&&(c=this.i,m=m!==null&&c in m?m[c]:void 0),this.data=m}else this.data=c}f(o1,We);function a1(){hn.call(this),this.status=1}f(a1,hn);function Vo(c){this.g=c}f(Vo,s1),Vo.prototype.ra=function(){He(this.g,"a")},Vo.prototype.qa=function(c){He(this.g,new o1(c))},Vo.prototype.pa=function(c){He(this.g,new a1)},Vo.prototype.oa=function(){He(this.g,"b")},Tu.prototype.createWebChannel=Tu.prototype.g,Ln.prototype.send=Ln.prototype.o,Ln.prototype.open=Ln.prototype.m,Ln.prototype.close=Ln.prototype.close,p2=function(){return new Tu},f2=function(){return le()},h2=Je,_g={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},mu.NO_ERROR=0,mu.TIMEOUT=8,mu.HTTP_ERROR=6,yd=mu,Tv.COMPLETE="complete",d2=Tv,nt.EventType=rt,rt.OPEN="a",rt.CLOSE="b",rt.ERROR="c",rt.MESSAGE="d",Ne.prototype.listen=Ne.prototype.J,Dl=nt,yt.prototype.listenOnce=yt.prototype.K,yt.prototype.getLastError=yt.prototype.Ha,yt.prototype.getLastErrorCode=yt.prototype.ya,yt.prototype.getStatus=yt.prototype.ca,yt.prototype.getResponseJson=yt.prototype.La,yt.prototype.getResponseText=yt.prototype.la,yt.prototype.send=yt.prototype.ea,yt.prototype.setWithCredentials=yt.prototype.Fa,u2=yt}).apply(typeof Hu<"u"?Hu:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let on=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};on.UNAUTHENTICATED=new on(null),on.GOOGLE_CREDENTIALS=new on("google-credentials-uid"),on.FIRST_PARTY=new on("first-party-uid"),on.MOCK_USER=new on("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ja="12.8.0";function mL(t){Ja=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo=new y0("@firebase/firestore");function Bo(){return wo.logLevel}function ce(t,...e){if(wo.logLevel<=Me.DEBUG){const n=e.map(x0);wo.debug(`Firestore (${Ja}): ${t}`,...n)}}function Ti(t,...e){if(wo.logLevel<=Me.ERROR){const n=e.map(x0);wo.error(`Firestore (${Ja}): ${t}`,...n)}}function Fa(t,...e){if(wo.logLevel<=Me.WARN){const n=e.map(x0);wo.warn(`Firestore (${Ja}): ${t}`,...n)}}function x0(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,m2(t,r,n)}function m2(t,e,n){let r=`FIRESTORE (${Ja}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ti(r),new Error(r)}function $e(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||m2(e,i,r)}function Ce(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oe extends Cr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gL{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(on.UNAUTHENTICATED))}shutdown(){}}class yL{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class vL{constructor(e){this.t=e,this.currentUser=on.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){$e(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new pi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new pi,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new pi)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?($e(typeof r.accessToken=="string",31837,{l:r}),new g2(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $e(e===null||typeof e=="string",2055,{h:e}),new on(e)}}class xL{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=on.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class wL{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new xL(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(on.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Nw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class _L{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Vn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){$e(this.o===void 0,3512);const r=s=>{s.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ce("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Nw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?($e(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Nw(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SL(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=SL(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Ve(t,e){return t<e?-1:t>e?1:0}function Sg(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return Hp(i)===Hp(s)?Ve(i,s):Hp(i)?1:-1}return Ve(t.length,e.length)}const TL=55296,EL=57343;function Hp(t){const e=t.charCodeAt(0);return e>=TL&&e<=EL}function za(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dw="__name__";class jr{constructor(e,n,r){n===void 0?n=0:n>e.length&&Te(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Te(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return jr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof jr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=jr.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Ve(e.length,n.length)}static compareSegments(e,n){const r=jr.isNumericId(e),i=jr.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?jr.extractNumericId(e).compare(jr.extractNumericId(n)):Sg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return gs.fromString(e.substring(4,e.length-2))}}class Ze extends jr{construct(e,n,r){return new Ze(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new oe(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Ze(n)}static emptyPath(){return new Ze([])}}const bL=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Kt extends jr{construct(e,n,r){return new Kt(e,n,r)}static isValidIdentifier(e){return bL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Kt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Dw}static keyField(){return new Kt([Dw])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new oe(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new oe(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new oe(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new oe(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Kt(n)}static emptyPath(){return new Kt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(Ze.fromString(e))}static fromName(e){return new we(Ze.fromString(e).popFirst(5))}static empty(){return new we(Ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ze.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new Ze(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y2(t,e,n){if(!n)throw new oe(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function IL(t,e,n,r){if(e===!0&&r===!0)throw new oe(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function jw(t){if(!we.isDocumentKey(t))throw new oe(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Lw(t){if(we.isDocumentKey(t))throw new oe(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function v2(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function yf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Te(12329,{type:typeof t})}function ar(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new oe(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=yf(t);throw new oe(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(t,e){const n={typeString:t};return e&&(n.value=e),n}function nu(t,e){if(!v2(t))throw new oe(B.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new oe(B.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mw=-62135596800,Vw=1e6;class at{static now(){return at.fromMillis(Date.now())}static fromDate(e){return at.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*Vw);return new at(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new oe(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new oe(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Mw)throw new oe(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new oe(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Vw}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:at._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(nu(e,at._jsonSchema))return new at(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Mw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}at._jsonSchemaVersion="firestore/timestamp/1.0",at._jsonSchema={type:Nt("string",at._jsonSchemaVersion),seconds:Nt("number"),nanoseconds:Nt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{static fromTimestamp(e){return new Ie(e)}static min(){return new Ie(new at(0,0))}static max(){return new Ie(new at(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ic=-1;function CL(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ie.fromTimestamp(r===1e9?new at(n+1,0):new at(n,r));return new Es(i,we.empty(),e)}function kL(t){return new Es(t.readTime,t.key,Ic)}class Es{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Es(Ie.min(),we.empty(),Ic)}static max(){return new Es(Ie.max(),we.empty(),Ic)}}function AL(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=we.comparator(t.documentKey,e.documentKey),n!==0?n:Ve(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RL="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PL{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Za(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==RL)throw t;ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Te(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new q((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof q?n:q.resolve(n)}catch(n){return q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):q.reject(n)}static resolve(e){return new q((n,r)=>{n(e)})}static reject(e){return new q((n,r)=>{r(e)})}static waitFor(e){return new q((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=q.resolve(!1);for(const r of e)n=n.next(i=>i?q.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new q((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new q((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function NL(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function el(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}vf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0=-1;function xf(t){return t==null}function dh(t){return t===0&&1/t==-1/0}function DL(t){return typeof t=="number"&&Number.isInteger(t)&&!dh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2="";function jL(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Ow(e)),e=LL(t.get(n),e);return Ow(e)}function LL(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case x2:n+="";break;default:n+=s}}return n}function Ow(t){return t+x2+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function js(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function w2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e,n){this.comparator=e,this.root=n||Ht.EMPTY}insert(e,n){return new gt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ht.BLACK,null,null))}remove(e){return new gt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ht.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gu(this.root,e,this.comparator,!0)}}class Gu{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ht{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ht.RED,this.left=i??Ht.EMPTY,this.right=s??Ht.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ht(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ht.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ht.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ht.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ht.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Te(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Te(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Te(27949);return e+(this.isRed()?0:1)}}Ht.EMPTY=null,Ht.RED=!0,Ht.BLACK=!1;Ht.EMPTY=new class{constructor(){this.size=0}get key(){throw Te(57766)}get value(){throw Te(16141)}get color(){throw Te(16727)}get left(){throw Te(29726)}get right(){throw Te(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ht(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.comparator=e,this.data=new gt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new zw(this.data.getIterator())}getIteratorFrom(e){return new zw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Vt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Vt(this.comparator);return n.data=e,n}}class zw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.fields=e,e.sort(Kt.comparator)}static empty(){return new Fn([])}unionWith(e){let n=new Vt(Kt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Fn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return za(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new _2("Invalid base64 string: "+s):s}}(e);return new Xt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Xt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xt.EMPTY_BYTE_STRING=new Xt("");const ML=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bs(t){if($e(!!t,39018),typeof t=="string"){let e=0;const n=ML.exec(t);if($e(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Et(t.seconds),nanos:Et(t.nanos)}}function Et(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Is(t){return typeof t=="string"?Xt.fromBase64String(t):Xt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S2="server_timestamp",T2="__type__",E2="__previous_value__",b2="__local_write_time__";function S0(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[T2])==null?void 0:r.stringValue)===S2}function wf(t){const e=t.mapValue.fields[E2];return S0(e)?wf(e):e}function Cc(t){const e=bs(t.mapValue.fields[b2].timestampValue);return new at(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VL{constructor(e,n,r,i,s,o,a,l,d,h,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=h,this.apiKey=f}}const hh="(default)";class kc{constructor(e,n){this.projectId=e,this.database=n||hh}static empty(){return new kc("","")}get isDefaultDatabase(){return this.database===hh}isEqual(e){return e instanceof kc&&e.projectId===this.projectId&&e.database===this.database}}function OL(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new oe(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new kc(t.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2="__type__",C2="__max__",Ku={mapValue:{fields:{__type__:{stringValue:C2}}}},k2="__vector__",fh="value";function Cs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?S0(t)?4:zL(t)?9007199254740991:FL(t)?10:11:Te(28295,{value:t})}function Yr(t,e){if(t===e)return!0;const n=Cs(t);if(n!==Cs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Cc(t).isEqual(Cc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=bs(i.timestampValue),a=bs(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Is(i.bytesValue).isEqual(Is(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Et(i.geoPointValue.latitude)===Et(s.geoPointValue.latitude)&&Et(i.geoPointValue.longitude)===Et(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Et(i.integerValue)===Et(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Et(i.doubleValue),a=Et(s.doubleValue);return o===a?dh(o)===dh(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return za(t.arrayValue.values||[],e.arrayValue.values||[],Yr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Fw(o)!==Fw(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Yr(o[l],a[l])))return!1;return!0}(t,e);default:return Te(52216,{left:t})}}function Ac(t,e){return(t.values||[]).find(n=>Yr(n,e))!==void 0}function Ua(t,e){if(t===e)return 0;const n=Cs(t),r=Cs(e);if(n!==r)return Ve(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ve(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Et(s.integerValue||s.doubleValue),l=Et(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return Uw(t.timestampValue,e.timestampValue);case 4:return Uw(Cc(t),Cc(e));case 5:return Sg(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Is(s),l=Is(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=Ve(a[d],l[d]);if(h!==0)return h}return Ve(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ve(Et(s.latitude),Et(o.latitude));return a!==0?a:Ve(Et(s.longitude),Et(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Bw(t.arrayValue,e.arrayValue);case 10:return function(s,o){var p,g,x,_;const a=s.fields||{},l=o.fields||{},d=(p=a[fh])==null?void 0:p.arrayValue,h=(g=l[fh])==null?void 0:g.arrayValue,f=Ve(((x=d==null?void 0:d.values)==null?void 0:x.length)||0,((_=h==null?void 0:h.values)==null?void 0:_.length)||0);return f!==0?f:Bw(d,h)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ku.mapValue&&o===Ku.mapValue)return 0;if(s===Ku.mapValue)return 1;if(o===Ku.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const p=Sg(l[f],h[f]);if(p!==0)return p;const g=Ua(a[l[f]],d[h[f]]);if(g!==0)return g}return Ve(l.length,h.length)}(t.mapValue,e.mapValue);default:throw Te(23264,{he:n})}}function Uw(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ve(t,e);const n=bs(t),r=bs(e),i=Ve(n.seconds,r.seconds);return i!==0?i:Ve(n.nanos,r.nanos)}function Bw(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Ua(n[i],r[i]);if(s)return s}return Ve(n.length,r.length)}function Ba(t){return Tg(t)}function Tg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=bs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Is(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return we.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Tg(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Tg(n.fields[o])}`;return i+"}"}(t.mapValue):Te(61005,{value:t})}function vd(t){switch(Cs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wf(t);return e?16+vd(e):16;case 5:return 2*t.stringValue.length;case 6:return Is(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+vd(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return js(r.fields,(s,o)=>{i+=s.length+vd(o)}),i}(t.mapValue);default:throw Te(13486,{value:t})}}function $w(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Eg(t){return!!t&&"integerValue"in t}function T0(t){return!!t&&"arrayValue"in t}function Ww(t){return!!t&&"nullValue"in t}function qw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xd(t){return!!t&&"mapValue"in t}function FL(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[I2])==null?void 0:r.stringValue)===k2}function Jl(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return js(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Jl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Jl(t.arrayValue.values[n]);return e}return{...t}}function zL(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===C2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this.value=e}static empty(){return new bn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!xd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Jl(n)}setAll(e){let n=Kt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Jl(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());xd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Yr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];xd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){js(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new bn(Jl(this.value))}}function A2(t){const e=[];return js(t.fields,(n,r)=>{const i=new Kt([n]);if(xd(r)){const s=A2(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ln(e,0,Ie.min(),Ie.min(),Ie.min(),bn.empty(),0)}static newFoundDocument(e,n,r,i){return new ln(e,1,n,Ie.min(),r,i,0)}static newNoDocument(e,n){return new ln(e,2,n,Ie.min(),Ie.min(),bn.empty(),0)}static newUnknownDocument(e,n){return new ln(e,3,n,Ie.min(),Ie.min(),bn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=bn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=bn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ln&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ln(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e,n){this.position=e,this.inclusive=n}}function Hw(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=we.comparator(we.fromName(o.referenceValue),n.key):r=Ua(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Gw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Yr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,n="asc"){this.field=e,this.dir=n}}function UL(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{}class Pt extends R2{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new $L(e,n,r):n==="array-contains"?new HL(e,r):n==="in"?new GL(e,r):n==="not-in"?new KL(e,r):n==="array-contains-any"?new QL(e,r):new Pt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new WL(e,r):new qL(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ua(n,this.value)):n!==null&&Cs(this.value)===Cs(n)&&this.matchesComparison(Ua(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Te(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ir extends R2{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ir(e,n)}matches(e){return P2(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function P2(t){return t.op==="and"}function N2(t){return BL(t)&&P2(t)}function BL(t){for(const e of t.filters)if(e instanceof Ir)return!1;return!0}function bg(t){if(t instanceof Pt)return t.field.canonicalString()+t.op.toString()+Ba(t.value);if(N2(t))return t.filters.map(e=>bg(e)).join(",");{const e=t.filters.map(n=>bg(n)).join(",");return`${t.op}(${e})`}}function D2(t,e){return t instanceof Pt?function(r,i){return i instanceof Pt&&r.op===i.op&&r.field.isEqual(i.field)&&Yr(r.value,i.value)}(t,e):t instanceof Ir?function(r,i){return i instanceof Ir&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&D2(o,i.filters[a]),!0):!1}(t,e):void Te(19439)}function j2(t){return t instanceof Pt?function(n){return`${n.field.canonicalString()} ${n.op} ${Ba(n.value)}`}(t):t instanceof Ir?function(n){return n.op.toString()+" {"+n.getFilters().map(j2).join(" ,")+"}"}(t):"Filter"}class $L extends Pt{constructor(e,n,r){super(e,n,r),this.key=we.fromName(r.referenceValue)}matches(e){const n=we.comparator(e.key,this.key);return this.matchesComparison(n)}}class WL extends Pt{constructor(e,n){super(e,"in",n),this.keys=L2("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class qL extends Pt{constructor(e,n){super(e,"not-in",n),this.keys=L2("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function L2(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>we.fromName(r.referenceValue))}class HL extends Pt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return T0(n)&&Ac(n.arrayValue,this.value)}}class GL extends Pt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ac(this.value.arrayValue,n)}}class KL extends Pt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ac(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Ac(this.value.arrayValue,n)}}class QL extends Pt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!T0(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ac(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Kw(t,e=null,n=[],r=[],i=null,s=null,o=null){return new YL(t,e,n,r,i,s,o)}function E0(t){const e=Ce(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>bg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),xf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ba(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ba(r)).join(",")),e.Te=n}return e.Te}function b0(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!UL(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!D2(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Gw(t.startAt,e.startAt)&&Gw(t.endAt,e.endAt)}function Ig(t){return we.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function XL(t,e,n,r,i,s,o,a){return new ru(t,e,n,r,i,s,o,a)}function _f(t){return new ru(t)}function Qw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function JL(t){return we.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function M2(t){return t.collectionGroup!==null}function Zl(t){const e=Ce(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Vt(Kt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new mh(s,r))}),n.has(Kt.keyField().canonicalString())||e.Ie.push(new mh(Kt.keyField(),r))}return e.Ie}function qr(t){const e=Ce(t);return e.Ee||(e.Ee=ZL(e,Zl(t))),e.Ee}function ZL(t,e){if(t.limitType==="F")return Kw(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new mh(i.field,s)});const n=t.endAt?new ph(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ph(t.startAt.position,t.startAt.inclusive):null;return Kw(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Cg(t,e){const n=t.filters.concat([e]);return new ru(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function kg(t,e,n){return new ru(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Sf(t,e){return b0(qr(t),qr(e))&&t.limitType===e.limitType}function V2(t){return`${E0(qr(t))}|lt:${t.limitType}`}function $o(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>j2(i)).join(", ")}]`),xf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Ba(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Ba(i)).join(",")),`Target(${r})`}(qr(t))}; limitType=${t.limitType})`}function Tf(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):we.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Zl(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const d=Hw(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,Zl(r),i)||r.endAt&&!function(o,a,l){const d=Hw(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,Zl(r),i))}(t,e)}function eM(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function O2(t){return(e,n)=>{let r=!1;for(const i of Zl(t)){const s=tM(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function tM(t,e,n){const r=t.field.isKeyField()?we.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),d=a.data.field(s);return l!==null&&d!==null?Ua(l,d):Te(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Te(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){js(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return w2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nM=new gt(we.comparator);function Ei(){return nM}const F2=new gt(we.comparator);function jl(...t){let e=F2;for(const n of t)e=e.insert(n.key,n);return e}function z2(t){let e=F2;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function no(){return ec()}function U2(){return ec()}function ec(){return new Po(t=>t.toString(),(t,e)=>t.isEqual(e))}const rM=new gt(we.comparator),iM=new Vt(we.comparator);function Oe(...t){let e=iM;for(const n of t)e=e.add(n);return e}const sM=new Vt(Ve);function oM(){return sM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I0(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:dh(e)?"-0":e}}function B2(t){return{integerValue:""+t}}function aM(t,e){return DL(e)?B2(e):I0(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(){this._=void 0}}function lM(t,e,n){return t instanceof Rc?function(i,s){const o={fields:{[T2]:{stringValue:S2},[b2]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&S0(s)&&(s=wf(s)),s&&(o.fields[E2]=s),{mapValue:o}}(n,e):t instanceof Pc?W2(t,e):t instanceof Nc?q2(t,e):function(i,s){const o=$2(i,s),a=Yw(o)+Yw(i.Ae);return Eg(o)&&Eg(i.Ae)?B2(a):I0(i.serializer,a)}(t,e)}function cM(t,e,n){return t instanceof Pc?W2(t,e):t instanceof Nc?q2(t,e):n}function $2(t,e){return t instanceof gh?function(r){return Eg(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Rc extends Ef{}class Pc extends Ef{constructor(e){super(),this.elements=e}}function W2(t,e){const n=H2(e);for(const r of t.elements)n.some(i=>Yr(i,r))||n.push(r);return{arrayValue:{values:n}}}class Nc extends Ef{constructor(e){super(),this.elements=e}}function q2(t,e){let n=H2(e);for(const r of t.elements)n=n.filter(i=>!Yr(i,r));return{arrayValue:{values:n}}}class gh extends Ef{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Yw(t){return Et(t.integerValue||t.doubleValue)}function H2(t){return T0(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(e,n){this.field=e,this.transform=n}}function dM(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Pc&&i instanceof Pc||r instanceof Nc&&i instanceof Nc?za(r.elements,i.elements,Yr):r instanceof gh&&i instanceof gh?Yr(r.Ae,i.Ae):r instanceof Rc&&i instanceof Rc}(t.transform,e.transform)}class hM{constructor(e,n){this.version=e,this.transformResults=n}}class Hr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Hr}static exists(e){return new Hr(void 0,e)}static updateTime(e){return new Hr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class bf{}function G2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Q2(t.key,Hr.none()):new iu(t.key,t.data,Hr.none());{const n=t.data,r=bn.empty();let i=new Vt(Kt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Ls(t.key,r,new Fn(i.toArray()),Hr.none())}}function fM(t,e,n){t instanceof iu?function(i,s,o){const a=i.value.clone(),l=Jw(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ls?function(i,s,o){if(!wd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=Jw(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(K2(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function tc(t,e,n,r){return t instanceof iu?function(s,o,a,l){if(!wd(s.precondition,o))return a;const d=s.value.clone(),h=Zw(s.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ls?function(s,o,a,l){if(!wd(s.precondition,o))return a;const d=Zw(s.fieldTransforms,l,o),h=o.data;return h.setAll(K2(s)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,a){return wd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function pM(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=$2(r.transform,i||null);s!=null&&(n===null&&(n=bn.empty()),n.set(r.field,s))}return n||null}function Xw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&za(r,i,(s,o)=>dM(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class iu extends bf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ls extends bf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function K2(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Jw(t,e,n){const r=new Map;$e(t.length===n.length,32656,{Ve:n.length,de:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,cM(o,a,n[i]))}return r}function Zw(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,lM(s,o,e))}return r}class Q2 extends bf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mM extends bf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gM{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&fM(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=tc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=tc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=U2();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=G2(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(Ie.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Oe())}isEqual(e){return this.batchId===e.batchId&&za(this.mutations,e.mutations,(n,r)=>Xw(n,r))&&za(this.baseMutations,e.baseMutations,(n,r)=>Xw(n,r))}}class C0{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){$e(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return rM}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new C0(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kt,ze;function xM(t){switch(t){case B.OK:return Te(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return Te(15467,{code:t})}}function Y2(t){if(t===void 0)return Ti("GRPC error has no .code"),B.UNKNOWN;switch(t){case kt.OK:return B.OK;case kt.CANCELLED:return B.CANCELLED;case kt.UNKNOWN:return B.UNKNOWN;case kt.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case kt.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case kt.INTERNAL:return B.INTERNAL;case kt.UNAVAILABLE:return B.UNAVAILABLE;case kt.UNAUTHENTICATED:return B.UNAUTHENTICATED;case kt.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case kt.NOT_FOUND:return B.NOT_FOUND;case kt.ALREADY_EXISTS:return B.ALREADY_EXISTS;case kt.PERMISSION_DENIED:return B.PERMISSION_DENIED;case kt.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case kt.ABORTED:return B.ABORTED;case kt.OUT_OF_RANGE:return B.OUT_OF_RANGE;case kt.UNIMPLEMENTED:return B.UNIMPLEMENTED;case kt.DATA_LOSS:return B.DATA_LOSS;default:return Te(39323,{code:t})}}(ze=kt||(kt={}))[ze.OK=0]="OK",ze[ze.CANCELLED=1]="CANCELLED",ze[ze.UNKNOWN=2]="UNKNOWN",ze[ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ze[ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ze[ze.NOT_FOUND=5]="NOT_FOUND",ze[ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",ze[ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",ze[ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",ze[ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ze[ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ze[ze.ABORTED=10]="ABORTED",ze[ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",ze[ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",ze[ze.INTERNAL=13]="INTERNAL",ze[ze.UNAVAILABLE=14]="UNAVAILABLE",ze[ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _M=new gs([4294967295,4294967295],0);function e_(t){const e=wM().encode(t),n=new c2;return n.update(e),new Uint8Array(n.digest())}function t_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new gs([n,r],0),new gs([i,s],0)]}class k0{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ll(`Invalid padding: ${n}`);if(r<0)throw new Ll(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ll(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ll(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=gs.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(gs.fromNumber(r)));return i.compare(_M)===1&&(i=new gs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=e_(e),[r,i]=t_(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new k0(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=e_(e),[r,i]=t_(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ll extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,su.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new If(Ie.min(),i,new gt(Ve),Ei(),Oe())}}class su{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new su(r,n,Oe(),Oe(),Oe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,n,r,i){this.Se=e,this.removedTargetIds=n,this.key=r,this.De=i}}class X2{constructor(e,n){this.targetId=e,this.Ce=n}}class J2{constructor(e,n,r=Xt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class n_{constructor(){this.ve=0,this.Fe=r_(),this.Me=Xt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Oe(),n=Oe(),r=Oe();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Te(38017,{changeType:s})}}),new su(this.Me,this.xe,e,n,r)}Ke(){this.Oe=!1,this.Fe=r_()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,$e(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class SM{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ei(),this.He=Qu(),this.Je=Qu(),this.Ze=new gt(Ve)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Te(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(Ig(s))if(r===0){const o=new we(s.path);this.et(n,o,ln.newNoDocument(o,Ie.min()))}else $e(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Is(r).toUint8Array()}catch(l){if(l instanceof _2)return Fa("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new k0(o,i,s)}catch(l){return Fa(l instanceof Ll?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&Ig(a.target)){const l=new we(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,ln.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.Ke())}});let r=Oe();this.Je.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.ot(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new If(e,n,this.Ze,this.je,r);return this.je=Ei(),this.He=Qu(),this.Je=Qu(),this.Ze=new gt(Ve),i}Ye(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,r),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.qe(n,1):i.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new n_,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new Vt(Ve),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new Vt(Ve),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ce("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new n_),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Qu(){return new gt(we.comparator)}function r_(){return new gt(we.comparator)}const TM=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),EM=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),bM=(()=>({and:"AND",or:"OR"}))();class IM{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ag(t,e){return t.useProto3Json||xf(e)?e:{value:e}}function yh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Z2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function CM(t,e){return yh(t,e.toTimestamp())}function Gr(t){return $e(!!t,49232),Ie.fromTimestamp(function(n){const r=bs(n);return new at(r.seconds,r.nanos)}(t))}function A0(t,e){return Rg(t,e).canonicalString()}function Rg(t,e){const n=function(i){return new Ze(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function eI(t){const e=Ze.fromString(t);return $e(sI(e),10190,{key:e.toString()}),e}function Pg(t,e){return A0(t.databaseId,e.path)}function Gp(t,e){const n=eI(e);if(n.get(1)!==t.databaseId.projectId)throw new oe(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new oe(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new we(nI(n))}function tI(t,e){return A0(t.databaseId,e)}function kM(t){const e=eI(t);return e.length===4?Ze.emptyPath():nI(e)}function Ng(t){return new Ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function nI(t){return $e(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function i_(t,e,n){return{name:Pg(t,e),fields:n.value.mapValue.fields}}function AM(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Te(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,h){return d.useProto3Json?($e(h===void 0||typeof h=="string",58123),Xt.fromBase64String(h||"")):($e(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Xt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?B.UNKNOWN:Y2(d.code);return new oe(h,d.message||"")}(o);n=new J2(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Gp(t,r.document.name),s=Gr(r.document.updateTime),o=r.document.createTime?Gr(r.document.createTime):Ie.min(),a=new bn({mapValue:{fields:r.document.fields}}),l=ln.newFoundDocument(i,s,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new _d(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Gp(t,r.document),s=r.readTime?Gr(r.readTime):Ie.min(),o=ln.newNoDocument(i,s),a=r.removedTargetIds||[];n=new _d([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Gp(t,r.document),s=r.removedTargetIds||[];n=new _d([],s,i,null)}else{if(!("filter"in e))return Te(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new vM(i,s),a=r.targetId;n=new X2(a,o)}}return n}function RM(t,e){let n;if(e instanceof iu)n={update:i_(t,e.key,e.value)};else if(e instanceof Q2)n={delete:Pg(t,e.key)};else if(e instanceof Ls)n={update:i_(t,e.key,e.data),updateMask:FM(e.fieldMask)};else{if(!(e instanceof mM))return Te(16599,{dt:e.type});n={verify:Pg(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Rc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Pc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Nc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof gh)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Te(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:CM(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Te(27497)}(t,e.precondition)),n}function PM(t,e){return t&&t.length>0?($e(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?Gr(i.updateTime):Gr(s);return o.isEqual(Ie.min())&&(o=Gr(s)),new hM(o,i.transformResults||[])}(n,e))):[]}function NM(t,e){return{documents:[tI(t,e.path)]}}function DM(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=tI(t,i);const s=function(d){if(d.length!==0)return iI(Ir.create(d,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(h=>function(p){return{field:Wo(p.field),direction:MM(p.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Ag(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:i}}function jM(t){let e=kM(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){$e(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(f){const p=rI(f);return p instanceof Ir&&N2(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(p=>function(x){return new mh(qo(x.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(p))}(n.orderBy));let a=null;n.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,xf(p)?null:p}(n.limit));let l=null;n.startAt&&(l=function(f){const p=!!f.before,g=f.values||[];return new ph(g,p)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const p=!f.before,g=f.values||[];return new ph(g,p)}(n.endAt)),XL(e,i,o,s,a,"F",l,d)}function LM(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Te(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function rI(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=qo(n.unaryFilter.field);return Pt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=qo(n.unaryFilter.field);return Pt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=qo(n.unaryFilter.field);return Pt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=qo(n.unaryFilter.field);return Pt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Te(61313);default:return Te(60726)}}(t):t.fieldFilter!==void 0?function(n){return Pt.create(qo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Te(58110);default:return Te(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ir.create(n.compositeFilter.filters.map(r=>rI(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Te(1026)}}(n.compositeFilter.op))}(t):Te(30097,{filter:t})}function MM(t){return TM[t]}function VM(t){return EM[t]}function OM(t){return bM[t]}function Wo(t){return{fieldPath:t.canonicalString()}}function qo(t){return Kt.fromServerFormat(t.fieldPath)}function iI(t){return t instanceof Pt?function(n){if(n.op==="=="){if(qw(n.value))return{unaryFilter:{field:Wo(n.field),op:"IS_NAN"}};if(Ww(n.value))return{unaryFilter:{field:Wo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(qw(n.value))return{unaryFilter:{field:Wo(n.field),op:"IS_NOT_NAN"}};if(Ww(n.value))return{unaryFilter:{field:Wo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wo(n.field),op:VM(n.op),value:n.value}}}(t):t instanceof Ir?function(n){const r=n.getFilters().map(i=>iI(i));return r.length===1?r[0]:{compositeFilter:{op:OM(n.op),filters:r}}}(t):Te(54877,{filter:t})}function FM(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function sI(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function oI(t){return!!t&&typeof t._toProto=="function"&&t._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e,n,r,i,s=Ie.min(),o=Ie.min(),a=Xt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ns(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ns(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ns(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ns(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{constructor(e){this.yt=e}}function UM(t){const e=jM({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?kg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BM{constructor(){this.Sn=new $M}addToCollectionParentIndex(e,n){return this.Sn.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve(Es.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve(Es.min())}updateCollectionGroup(e,n,r){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}}class $M{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Vt(Ze.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Vt(Ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},aI=41943040;class Tn{static withCacheSize(e){return new Tn(e,Tn.DEFAULT_COLLECTION_PERCENTILE,Tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tn.DEFAULT_COLLECTION_PERCENTILE=10,Tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tn.DEFAULT=new Tn(aI,Tn.DEFAULT_COLLECTION_PERCENTILE,Tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tn.DISABLED=new Tn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new $a(0)}static ar(){return new $a(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o_="LruGarbageCollector",WM=1048576;function a_([t,e],[n,r]){const i=Ve(t,n);return i===0?Ve(e,r):i}class qM{constructor(e){this.Pr=e,this.buffer=new Vt(a_),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();a_(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class HM{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ce(o_,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){el(n)?ce(o_,"Ignoring IndexedDB error during garbage collection: ",n):await Za(n)}await this.Ar(3e5)})}}class GM{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return q.resolve(vf.ce);const r=new qM(n);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.mr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ce("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(s_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),s_):this.gr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let r,i,s,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),Bo()<=Me.DEBUG&&ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function KM(t,e){return new GM(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(){this.changes=new Po(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ln.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?q.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XM{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&tc(r.mutation,i,Fn.empty(),at.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Oe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Oe()){const i=no();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=jl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=no();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Oe()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Ei();const o=ec(),a=function(){return ec()}();return n.forEach((l,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Ls)?s=s.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),tc(h.mutation,d,h.mutation.getFieldMask(),at.now())):o.set(d.key,Fn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new YM(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=ec();let i=new gt((o,a)=>o-a),s=Oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||Fn.empty();h=a.applyToLocalView(d,h),r.set(l,h);const f=(i.get(a.batchId)||Oe()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,f=U2();h.forEach(p=>{if(!s.has(p)){const g=G2(n.get(p),r.get(p));g!==null&&f.set(p,g),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return q.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return JL(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):M2(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):q.resolve(no());let a=Ic,l=s;return o.next(d=>q.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(h)?q.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{l=l.insert(h,p)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,l,d,Oe())).next(h=>({batchId:a,changes:z2(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new we(n)).next(r=>{let i=jl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=jl();return this.indexManager.getCollectionParents(e,s).next(a=>q.forEach(a,l=>{const d=function(f,p){return new ru(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,ln.newInvalidDocument(h)))});let a=jl();return o.forEach((l,d)=>{const h=s.get(l);h!==void 0&&tc(h.mutation,d,Fn.empty(),at.now()),Tf(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JM{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return q.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Gr(i.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,function(i){return{name:i.name,query:UM(i.bundledQuery),readTime:Gr(i.readTime)}}(n)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(){this.overlays=new gt(we.comparator),this.Lr=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const r=no();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.bt(e,n,s)}),q.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Lr.delete(r)),q.resolve()}getOverlaysForCollection(e,n,r){const i=no(),s=n.length+1,o=new we(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return q.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new gt((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=s.get(d.largestBatchId);h===null&&(h=no(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=no(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=i)););return q.resolve(a)}bt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new yM(n,r));let s=this.Lr.get(n);s===void 0&&(s=Oe(),this.Lr.set(n,s)),this.Lr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(){this.sessionToken=Xt.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(){this.kr=new Vt(Ft.Kr),this.qr=new Vt(Ft.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const r=new Ft(e,n);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new Ft(e,n))}Qr(e,n){e.forEach(r=>this.removeReference(r,n))}Gr(e){const n=new we(new Ze([])),r=new Ft(n,e),i=new Ft(n,e+1),s=[];return this.qr.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new we(new Ze([])),r=new Ft(n,e),i=new Ft(n,e+1);let s=Oe();return this.qr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Ft(e,0),r=this.kr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ft{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return we.comparator(e.key,n.key)||Ve(e.Hr,n.Hr)}static Ur(e,n){return Ve(e.Hr,n.Hr)||we.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new Vt(Ft.Kr)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new gM(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Jr=this.Jr.add(new Ft(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,n){return q.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Xr(r),s=i<0?0:i;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?_0:this.Yn-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ft(n,0),i=new Ft(n,Number.POSITIVE_INFINITY),s=[];return this.Jr.forEachInRange([r,i],o=>{const a=this.Zr(o.Hr);s.push(a)}),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Vt(Ve);return n.forEach(i=>{const s=new Ft(i,0),o=new Ft(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([s,o],a=>{r=r.add(a.Hr)})}),q.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;we.isDocumentKey(s)||(s=s.child(""));const o=new Ft(new we(s),0);let a=new Vt(Ve);return this.Jr.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(a=a.add(l.Hr)),!0)},o),q.resolve(this.Yr(a))}Yr(e){const n=[];return e.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){$e(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return q.forEach(n.mutations,i=>{const s=new Ft(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,n){const r=new Ft(n,0),i=this.Jr.firstAfterOrEqual(r);return q.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e){this.ti=e,this.docs=function(){return new gt(we.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ti(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return q.resolve(r?r.document.mutableCopy():ln.newInvalidDocument(n))}getEntries(e,n){let r=Ei();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ln.newInvalidDocument(i))}),q.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Ei();const o=n.path,a=new we(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||AL(kL(h),r)<=0||(i.has(h.key)||Tf(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Te(9500)}ni(e,n){return q.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new rV(this)}getSize(e){return q.resolve(this.size)}}class rV extends QM{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)}),q.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e){this.persistence=e,this.ri=new Po(n=>E0(n),b0),this.lastRemoteSnapshotVersion=Ie.min(),this.highestTargetId=0,this.ii=0,this.si=new R0,this.targetCount=0,this.oi=$a._r()}forEachTarget(e,n){return this.ri.forEach((r,i)=>n(i)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ii&&(this.ii=n),q.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new $a(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.lr(n),q.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.ri.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),q.waitFor(s).next(()=>i)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const r=this.ri.get(n)||null;return q.resolve(r)}addMatchingKeys(e,n,r){return this.si.$r(n,r),q.resolve()}removeMatchingKeys(e,n,r){this.si.Qr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),q.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const r=this.si.jr(n);return q.resolve(r)}containsKey(e,n){return q.resolve(this.si.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e,n){this._i={},this.overlays={},this.ai=new vf(0),this.ui=!1,this.ui=!0,this.ci=new eV,this.referenceDelegate=e(this),this.li=new iV(this),this.indexManager=new BM,this.remoteDocumentCache=function(i){return new nV(i)}(r=>this.referenceDelegate.hi(r)),this.serializer=new zM(n),this.Pi=new JM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new ZM,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this._i[e.toKey()];return r||(r=new tV(n,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,r){ce("MemoryPersistence","Starting transaction:",e);const i=new sV(this.ai.next());return this.referenceDelegate.Ti(),r(i).next(s=>this.referenceDelegate.Ii(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,n){return q.or(Object.values(this._i).map(r=>()=>r.containsKey(e,n)))}}class sV extends PL{constructor(e){super(),this.currentSequenceNumber=e}}class P0{constructor(e){this.persistence=e,this.Ri=new R0,this.Ai=null}static Vi(e){return new P0(e)}get di(){if(this.Ai)return this.Ai;throw Te(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.di.delete(r.toString()),q.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.di.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),q.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach(i=>this.di.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.di.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.di,r=>{const i=we.fromPath(r);return this.mi(e,i).next(s=>{s||n.removeEntry(i,Ie.min())})}).next(()=>(this.Ai=null,n.apply(e)))}updateLimboDocument(e,n){return this.mi(e,n).next(r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())})}hi(e){return 0}mi(e,n){return q.or([()=>q.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class vh{constructor(e,n){this.persistence=e,this.fi=new Po(r=>jL(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=KM(this,n)}static Vi(e,n){return new vh(e,n)}Ti(){}Ii(e){return q.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}mr(e,n){return q.forEach(this.fi,(r,i)=>this.wr(e,r,i).next(s=>s?q.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ni(e,o=>this.wr(e,o,n).next(a=>{a||(r++,s.removeEntry(o,Ie.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),q.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),q.resolve()}removeReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),q.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=vd(e.data.value)),n}wr(e,n,r){return q.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.fi.get(n);return q.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Ts=r,this.Is=i}static Es(e,n){let r=Oe(),i=Oe();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new N0(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return QD()?8:NL(dn())>0?6:4}()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.gs(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ps(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new oV;return this.ys(e,n,o).next(a=>{if(s.result=a,this.As)return this.ws(e,n,o,a.size)})}).next(()=>s.result)}ws(e,n,r,i){return r.documentReadCount<this.Vs?(Bo()<=Me.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",$o(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),q.resolve()):(Bo()<=Me.DEBUG&&ce("QueryEngine","Query:",$o(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(Bo()<=Me.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",$o(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qr(n))):q.resolve())}gs(e,n){if(Qw(n))return q.resolve(null);let r=qr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=kg(n,null,"F"),r=qr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Oe(...s);return this.fs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.bs(n,a);return this.Ss(n,d,o,l.readTime)?this.gs(e,kg(n,null,"F")):this.Ds(e,d,n,l)}))})))}ps(e,n,r,i){return Qw(n)||i.isEqual(Ie.min())?q.resolve(null):this.fs.getDocuments(e,r).next(s=>{const o=this.bs(n,s);return this.Ss(n,o,r,i)?q.resolve(null):(Bo()<=Me.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),$o(n)),this.Ds(e,o,n,CL(i,Ic)).next(a=>a))})}bs(e,n){let r=new Vt(O2(e));return n.forEach((i,s)=>{Tf(e,s)&&(r=r.add(s))}),r}Ss(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ys(e,n,r){return Bo()<=Me.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",$o(n)),this.fs.getDocumentsMatchingQuery(e,n,Es.min(),r)}Ds(e,n,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D0="LocalStore",lV=3e8;class cV{constructor(e,n,r,i){this.persistence=e,this.Cs=n,this.serializer=i,this.vs=new gt(Ve),this.Fs=new Po(s=>E0(s),b0),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new XM(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.vs))}}function uV(t,e,n,r){return new cV(t,e,n,r)}async function cI(t,e){const n=Ce(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Oe();for(const d of i){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of s){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({Ns:d,removedBatchIds:o,addedBatchIds:a}))})})}function dV(t,e){const n=Ce(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.xs.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const f=d.batch,p=f.keys();let g=q.resolve();return p.forEach(x=>{g=g.next(()=>h.getEntry(l,x)).next(_=>{const k=d.docVersions.get(x);$e(k!==null,48541),_.version.compareTo(k)<0&&(f.applyToRemoteDocument(_,d),_.isValidDocument()&&(_.setReadTime(d.commitVersion),h.addEntry(_)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Oe();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function uI(t){const e=Ce(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.li.getLastRemoteSnapshotVersion(n))}function hV(t,e){const n=Ce(t),r=e.snapshotVersion;let i=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});i=n.vs;const a=[];e.targetChanges.forEach((h,f)=>{const p=i.get(f);if(!p)return;a.push(n.li.removeMatchingKeys(s,h.removedDocuments,f).next(()=>n.li.addMatchingKeys(s,h.addedDocuments,f)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(Xt.EMPTY_BYTE_STRING,Ie.min()).withLastLimboFreeSnapshotVersion(Ie.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,r)),i=i.insert(f,g),function(_,k,T){return _.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=lV?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(p,g,h)&&a.push(n.li.updateTargetData(s,g))});let l=Ei(),d=Oe();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(fV(s,o,e.documentUpdates).next(h=>{l=h.Bs,d=h.Ls})),!r.isEqual(Ie.min())){const h=n.li.getLastRemoteSnapshotVersion(s).next(f=>n.li.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return q.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,d)).next(()=>l)}).then(s=>(n.vs=i,s))}function fV(t,e,n){let r=Oe(),i=Oe();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Ei();return n.forEach((a,l)=>{const d=s.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(Ie.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ce(D0,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{Bs:o,Ls:i}})}function pV(t,e){const n=Ce(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=_0),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function mV(t,e){const n=Ce(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.li.getTargetData(r,e).next(s=>s?(i=s,q.resolve(i)):n.li.allocateTargetId(r).next(o=>(i=new ns(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.li.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.vs=n.vs.insert(r.targetId,r),n.Fs.set(e,r.targetId)),r})}async function Dg(t,e,n){const r=Ce(t),i=r.vs.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!el(o))throw o;ce(D0,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function l_(t,e,n){const r=Ce(t);let i=Ie.min(),s=Oe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const f=Ce(l),p=f.Fs.get(h);return p!==void 0?q.resolve(f.vs.get(p)):f.li.getTargetData(d,h)}(r,o,qr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?i:Ie.min(),n?s:Oe())).next(a=>(gV(r,eM(e),a),{documents:a,ks:s})))}function gV(t,e,n){let r=t.Ms.get(e)||Ie.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Ms.set(e,r)}class c_{constructor(){this.activeTargetIds=oM()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yV{constructor(){this.vo=new c_,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,r){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new c_,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vV{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u_="ConnectivityMonitor";class d_{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ce(u_,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ce(u_,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yu=null;function jg(){return Yu===null?Yu=function(){return 268435456+Math.round(2147483648*Math.random())}():Yu++,"0x"+Yu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kp="RestConnection",xV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class wV{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===hh?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,n,r,i,s){const o=jg(),a=this.Qo(e,n.toUriEncodedString());ce(Kp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,i,s);const{host:d}=new URL(a),h=Jr(d);return this.zo(e,a,l,r,h).then(f=>(ce(Kp,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Fa(Kp,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}jo(e,n,r,i,s,o){return this.Wo(e,n,r,i,s)}Go(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ja}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Qo(e,n){const r=xV[e];let i=`${this.qo}/v1/${n}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn="WebChannelConnection",bl=(t,e,n)=>{t.listen(e,r=>{try{n(r)}catch(i){setTimeout(()=>{throw i},0)}})};class xa extends wV{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!xa.c_){const e=f2();bl(e,h2.STAT_EVENT,n=>{n.stat===_g.PROXY?ce(rn,"STAT_EVENT: detected buffering proxy"):n.stat===_g.NOPROXY&&ce(rn,"STAT_EVENT: detected no buffering proxy")}),xa.c_=!0}}zo(e,n,r,i,s){const o=jg();return new Promise((a,l)=>{const d=new u2;d.setWithCredentials(!0),d.listenOnce(d2.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case yd.NO_ERROR:const f=d.getResponseJson();ce(rn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case yd.TIMEOUT:ce(rn,`RPC '${e}' ${o} timed out`),l(new oe(B.DEADLINE_EXCEEDED,"Request time out"));break;case yd.HTTP_ERROR:const p=d.getStatus();if(ce(rn,`RPC '${e}' ${o} failed with status:`,p,"response text:",d.getResponseText()),p>0){let g=d.getResponseJson();Array.isArray(g)&&(g=g[0]);const x=g==null?void 0:g.error;if(x&&x.status&&x.message){const _=function(T){const v=T.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(v)>=0?v:B.UNKNOWN}(x.status);l(new oe(_,x.message))}else l(new oe(B.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new oe(B.UNAVAILABLE,"Connection failed."));break;default:Te(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ce(rn,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(i);ce(rn,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",h,r,15)})}T_(e,n,r){const i=jg(),s=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const d=s.join("");ce(rn,`Creating RPC '${e}' stream ${i}: ${d}`,a);const h=o.createWebChannel(d,a);this.I_(h);let f=!1,p=!1;const g=new _V({Ho:x=>{p?ce(rn,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(f||(ce(rn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),ce(rn,`RPC '${e}' stream ${i} sending:`,x),h.send(x))},Jo:()=>h.close()});return bl(h,Dl.EventType.OPEN,()=>{p||(ce(rn,`RPC '${e}' stream ${i} transport opened.`),g.i_())}),bl(h,Dl.EventType.CLOSE,()=>{p||(p=!0,ce(rn,`RPC '${e}' stream ${i} transport closed`),g.o_(),this.E_(h))}),bl(h,Dl.EventType.ERROR,x=>{p||(p=!0,Fa(rn,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),g.o_(new oe(B.UNAVAILABLE,"The operation could not be completed")))}),bl(h,Dl.EventType.MESSAGE,x=>{var _;if(!p){const k=x.data[0];$e(!!k,16349);const T=k,v=(T==null?void 0:T.error)||((_=T[0])==null?void 0:_.error);if(v){ce(rn,`RPC '${e}' stream ${i} received error:`,v);const w=v.status;let j=function(E){const S=kt[E];if(S!==void 0)return Y2(S)}(w),L=v.message;j===void 0&&(j=B.INTERNAL,L="Unknown error status: "+w+" with message "+v.message),p=!0,g.o_(new oe(j,L)),h.close()}else ce(rn,`RPC '${e}' stream ${i} received:`,k),g.__(k)}}),xa.u_(),setTimeout(()=>{g.s_()},0),g}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(n=>n===e)}Go(e,n,r){super.Go(e,n,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return p2()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SV(t){return new xa(t)}function Qp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(t){return new IM(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xa.c_=!1;class dI{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Ci=e,this.timerId=n,this.R_=r,this.A_=i,this.V_=s,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ce("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h_="PersistentStream";class hI{constructor(e,n,r,i,s,o,a,l){this.Ci=e,this.b_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new dI(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(Ti(n.toString()),Ti("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new oe(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.H_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ce(h_,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget(()=>this.D_===e?n():(ce(h_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class TV extends hI{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=AM(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ie.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ie.min():o.readTime?Gr(o.readTime):Ie.min()}(e);return this.listener.J_(n,r)}Z_(e){const n={};n.database=Ng(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Ig(l)?{documents:NM(s,l)}:{query:DM(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Z2(s,o.resumeToken);const d=Ag(s,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(Ie.min())>0){a.readTime=yh(s,o.snapshotVersion.toTimestamp());const d=Ag(s,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=LM(this.serializer,e);r&&(n.labels=r),this.K_(n)}X_(e){const n={};n.database=Ng(this.serializer),n.removeTarget=e,this.K_(n)}}class EV extends hI{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return $e(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,$e(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){$e(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=PM(e.writeResults,e.commitTime),r=Gr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Ng(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>RM(this.serializer,r))};this.K_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bV{}class IV extends bV{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new oe(B.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,Rg(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new oe(B.UNKNOWN,s.toString())})}jo(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(e,Rg(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new oe(B.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function CV(t,e,n,r){return new IV(t,e,n,r)}class kV{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ti(n),this.aa=!1):ce("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _o="RemoteStore";class AV{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=s,this.Aa.Mo(o=>{r.enqueueAndForget(async()=>{No(this)&&(ce(_o,"Restarting streams for network reachability change."),await async function(l){const d=Ce(l);d.Ea.add(4),await ou(d),d.Va.set("Unknown"),d.Ea.delete(4),await kf(d)}(this))})}),this.Va=new kV(r,i)}}async function kf(t){if(No(t))for(const e of t.Ra)await e(!0)}async function ou(t){for(const e of t.Ra)await e(!1)}function fI(t,e){const n=Ce(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),V0(n)?M0(n):tl(n).O_()&&L0(n,e))}function j0(t,e){const n=Ce(t),r=tl(n);n.Ia.delete(e),r.O_()&&pI(n,e),n.Ia.size===0&&(r.O_()?r.L_():No(n)&&n.Va.set("Unknown"))}function L0(t,e){if(t.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ie.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}tl(t).Z_(e)}function pI(t,e){t.da.$e(e),tl(t).X_(e)}function M0(t){t.da=new SM({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),tl(t).start(),t.Va.ua()}function V0(t){return No(t)&&!tl(t).x_()&&t.Ia.size>0}function No(t){return Ce(t).Ea.size===0}function mI(t){t.da=void 0}async function RV(t){t.Va.set("Online")}async function PV(t){t.Ia.forEach((e,n)=>{L0(t,e)})}async function NV(t,e){mI(t),V0(t)?(t.Va.ha(e),M0(t)):t.Va.set("Unknown")}async function DV(t,e,n){if(t.Va.set("Online"),e instanceof J2&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.da.removeTarget(a))}(t,e)}catch(r){ce(_o,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await xh(t,r)}else if(e instanceof _d?t.da.Xe(e):e instanceof X2?t.da.st(e):t.da.tt(e),!n.isEqual(Ie.min()))try{const r=await uI(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.da.Tt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(d);h&&s.Ia.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(Xt.EMPTY_BYTE_STRING,h.snapshotVersion)),pI(s,l);const f=new ns(h.target,l,d,h.sequenceNumber);L0(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ce(_o,"Failed to raise snapshot:",r),await xh(t,r)}}async function xh(t,e,n){if(!el(e))throw e;t.Ea.add(1),await ou(t),t.Va.set("Offline"),n||(n=()=>uI(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ce(_o,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await kf(t)})}function gI(t,e){return e().catch(n=>xh(t,n,e))}async function Af(t){const e=Ce(t),n=ks(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:_0;for(;jV(e);)try{const i=await pV(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,LV(e,i)}catch(i){await xh(e,i)}yI(e)&&vI(e)}function jV(t){return No(t)&&t.Ta.length<10}function LV(t,e){t.Ta.push(e);const n=ks(t);n.O_()&&n.Y_&&n.ea(e.mutations)}function yI(t){return No(t)&&!ks(t).x_()&&t.Ta.length>0}function vI(t){ks(t).start()}async function MV(t){ks(t).ra()}async function VV(t){const e=ks(t);for(const n of t.Ta)e.ea(n.mutations)}async function OV(t,e,n){const r=t.Ta.shift(),i=C0.from(r,e,n);await gI(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Af(t)}async function FV(t,e){e&&ks(t).Y_&&await async function(r,i){if(function(o){return xM(o)&&o!==B.ABORTED}(i.code)){const s=r.Ta.shift();ks(r).B_(),await gI(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Af(r)}}(t,e),yI(t)&&vI(t)}async function f_(t,e){const n=Ce(t);n.asyncQueue.verifyOperationInProgress(),ce(_o,"RemoteStore received new credentials");const r=No(n);n.Ea.add(3),await ou(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await kf(n)}async function zV(t,e){const n=Ce(t);e?(n.Ea.delete(2),await kf(n)):e||(n.Ea.add(2),await ou(n),n.Va.set("Unknown"))}function tl(t){return t.ma||(t.ma=function(n,r,i){const s=Ce(n);return s.sa(),new TV(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Zo:RV.bind(null,t),Yo:PV.bind(null,t),t_:NV.bind(null,t),J_:DV.bind(null,t)}),t.Ra.push(async e=>{e?(t.ma.B_(),V0(t)?M0(t):t.Va.set("Unknown")):(await t.ma.stop(),mI(t))})),t.ma}function ks(t){return t.fa||(t.fa=function(n,r,i){const s=Ce(n);return s.sa(),new EV(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:MV.bind(null,t),t_:FV.bind(null,t),ta:VV.bind(null,t),na:OV.bind(null,t)}),t.Ra.push(async e=>{e?(t.fa.B_(),await Af(t)):(await t.fa.stop(),t.Ta.length>0&&(ce(_o,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new O0(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new oe(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function F0(t,e){if(Ti("AsyncQueue",`${e}: ${t}`),el(t))return new oe(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{static emptySet(e){return new wa(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||we.comparator(n.key,r.key):(n,r)=>we.comparator(n.key,r.key),this.keyedMap=jl(),this.sortedSet=new gt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof wa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new wa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(){this.ga=new gt(we.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Te(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Wa{constructor(e,n,r,i,s,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Wa(e,n,wa.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Sf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class BV{constructor(){this.queries=m_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=Ce(n),s=i.queries;i.queries=m_(),s.forEach((o,a)=>{for(const l of a.ba)l.onError(r)})})(this,new oe(B.ABORTED,"Firestore shutting down"))}}function m_(){return new Po(t=>V2(t),Sf)}async function z0(t,e){const n=Ce(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.Sa()&&e.Da()&&(r=2):(s=new UV,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=F0(o,`Initialization of query '${$o(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.ba.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&B0(n)}async function U0(t,e){const n=Ce(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.ba.indexOf(e);o>=0&&(s.ba.splice(o,1),s.ba.length===0?i=e.Da()?0:1:!s.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function $V(t,e){const n=Ce(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.ba)a.Fa(i)&&(r=!0);o.wa=i}}r&&B0(n)}function WV(t,e,n){const r=Ce(t),i=r.queries.get(e);if(i)for(const s of i.ba)s.onError(n);r.queries.delete(e)}function B0(t){t.Ca.forEach(e=>{e.next()})}var Lg,g_;(g_=Lg||(Lg={})).Ma="default",g_.Cache="cache";class $0{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Wa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Wa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Lg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xI{constructor(e){this.key=e}}class wI{constructor(e){this.key=e}}class qV{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Oe(),this.mutatedKeys=Oe(),this.eu=O2(e),this.tu=new wa(this.eu)}get nu(){return this.Za}ru(e,n){const r=n?n.iu:new p_,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const p=i.get(h),g=Tf(this.query,f)?f:null,x=!!p&&this.mutatedKeys.has(p.key),_=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let k=!1;p&&g?p.data.isEqual(g.data)?x!==_&&(r.track({type:3,doc:g}),k=!0):this.su(p,g)||(r.track({type:2,doc:g}),k=!0,(l&&this.eu(g,l)>0||d&&this.eu(g,d)<0)&&(a=!0)):!p&&g?(r.track({type:0,doc:g}),k=!0):p&&!g&&(r.track({type:1,doc:p}),k=!0,(l||d)&&(a=!0)),k&&(g?(o=o.add(g),s=_?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Ss:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(g,x){const _=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Te(20277,{Vt:k})}};return _(g)-_(x)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Ya.size===0&&this.current&&!i?1:0,d=l!==this.Xa;return this.Xa=l,o.length!==0||d?{snapshot:new Wa(this.query,e.tu,s,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new p_,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Za=this.Za.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Za=this.Za.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Oe(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new wI(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new xI(r))}),n}cu(e){this.Za=e.ks,this.Ya=Oe();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Wa.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const W0="SyncEngine";class HV{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class GV{constructor(e){this.key=e,this.hu=!1}}class KV{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Po(a=>V2(a),Sf),this.Iu=new Map,this.Eu=new Set,this.Ru=new gt(we.comparator),this.Au=new Map,this.Vu=new R0,this.du={},this.mu=new Map,this.fu=$a.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function QV(t,e,n=!0){const r=II(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await _I(r,e,n,!0),i}async function YV(t,e){const n=II(t);await _I(n,e,!0,!1)}async function _I(t,e,n,r){const i=await mV(t.localStore,qr(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await XV(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&fI(t.remoteStore,i),a}async function XV(t,e,n,r,i){t.pu=(f,p,g)=>async function(_,k,T,v){let w=k.view.ru(T);w.Ss&&(w=await l_(_.localStore,k.query,!1).then(({documents:E})=>k.view.ru(E,w)));const j=v&&v.targetChanges.get(k.targetId),L=v&&v.targetMismatches.get(k.targetId)!=null,V=k.view.applyChanges(w,_.isPrimaryClient,j,L);return v_(_,k.targetId,V.au),V.snapshot}(t,f,p,g);const s=await l_(t.localStore,e,!0),o=new qV(e,s.ks),a=o.ru(s.documents),l=su.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(a,t.isPrimaryClient,l);v_(t,n,d.au);const h=new HV(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function JV(t,e,n){const r=Ce(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!Sf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Dg(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&j0(r.remoteStore,i.targetId),Mg(r,i.targetId)}).catch(Za)):(Mg(r,i.targetId),await Dg(r.localStore,i.targetId,!0))}async function ZV(t,e){const n=Ce(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),j0(n.remoteStore,r.targetId))}async function e3(t,e,n){const r=a3(t);try{const i=await function(o,a){const l=Ce(o),d=at.now(),h=a.reduce((g,x)=>g.add(x.key),Oe());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let x=Ei(),_=Oe();return l.xs.getEntries(g,h).next(k=>{x=k,x.forEach((T,v)=>{v.isValidDocument()||(_=_.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,x)).next(k=>{f=k;const T=[];for(const v of a){const w=pM(v,f.get(v.key).overlayedDocument);w!=null&&T.push(new Ls(v.key,w,A2(w.value.mapValue),Hr.exists(!0)))}return l.mutationQueue.addMutationBatch(g,d,T,a)}).next(k=>{p=k;const T=k.applyToLocalDocumentSet(f,_);return l.documentOverlayCache.saveOverlays(g,k.batchId,T)})}).then(()=>({batchId:p.batchId,changes:z2(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let d=o.du[o.currentUser.toKey()];d||(d=new gt(Ve)),d=d.insert(a,l),o.du[o.currentUser.toKey()]=d}(r,i.batchId,n),await au(r,i.changes),await Af(r.remoteStore)}catch(i){const s=F0(i,"Failed to persist write");n.reject(s)}}async function SI(t,e){const n=Ce(t);try{const r=await hV(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&($e(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?$e(o.hu,14607):i.removedDocuments.size>0&&($e(o.hu,42227),o.hu=!1))}),await au(n,r,e)}catch(r){await Za(r)}}function y_(t,e,n){const r=Ce(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=Ce(o);l.onlineState=a;let d=!1;l.queries.forEach((h,f)=>{for(const p of f.ba)p.va(a)&&(d=!0)}),d&&B0(l)}(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function t3(t,e,n){const r=Ce(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new gt(we.comparator);o=o.insert(s,ln.newNoDocument(s,Ie.min()));const a=Oe().add(s),l=new If(Ie.min(),new Map,new gt(Ve),o,a);await SI(r,l),r.Ru=r.Ru.remove(s),r.Au.delete(e),q0(r)}else await Dg(r.localStore,e,!1).then(()=>Mg(r,e,n)).catch(Za)}async function n3(t,e){const n=Ce(t),r=e.batch.batchId;try{const i=await dV(n.localStore,e);EI(n,r,null),TI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await au(n,i)}catch(i){await Za(i)}}async function r3(t,e,n){const r=Ce(t);try{const i=await function(o,a){const l=Ce(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(f=>($e(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(d,f))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);EI(r,e,n),TI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await au(r,i)}catch(i){await Za(i)}}function TI(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function EI(t,e,n){const r=Ce(t);let i=r.du[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.du[r.currentUser.toKey()]=i}}function Mg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Vu.Gr(e).forEach(r=>{t.Vu.containsKey(r)||bI(t,r)})}function bI(t,e){t.Eu.delete(e.path.canonicalString());const n=t.Ru.get(e);n!==null&&(j0(t.remoteStore,n),t.Ru=t.Ru.remove(e),t.Au.delete(n),q0(t))}function v_(t,e,n){for(const r of n)r instanceof xI?(t.Vu.addReference(r.key,e),i3(t,r)):r instanceof wI?(ce(W0,"Document no longer in limbo: "+r.key),t.Vu.removeReference(r.key,e),t.Vu.containsKey(r.key)||bI(t,r.key)):Te(19791,{wu:r})}function i3(t,e){const n=e.key,r=n.path.canonicalString();t.Ru.get(n)||t.Eu.has(r)||(ce(W0,"New document in limbo: "+n),t.Eu.add(r),q0(t))}function q0(t){for(;t.Eu.size>0&&t.Ru.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new we(Ze.fromString(e)),r=t.fu.next();t.Au.set(r,new GV(n)),t.Ru=t.Ru.insert(n,r),fI(t.remoteStore,new ns(qr(_f(n.path)),r,"TargetPurposeLimboResolution",vf.ce))}}async function au(t,e,n){const r=Ce(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(d){i.push(d);const f=N0.Es(l.targetId,d);s.push(f)}}))}),await Promise.all(o),r.Pu.J_(i),await async function(l,d){const h=Ce(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>q.forEach(d,p=>q.forEach(p.Ts,g=>h.persistence.referenceDelegate.addReference(f,p.targetId,g)).next(()=>q.forEach(p.Is,g=>h.persistence.referenceDelegate.removeReference(f,p.targetId,g)))))}catch(f){if(!el(f))throw f;ce(D0,"Failed to update sequence numbers: "+f)}for(const f of d){const p=f.targetId;if(!f.fromCache){const g=h.vs.get(p),x=g.snapshotVersion,_=g.withLastLimboFreeSnapshotVersion(x);h.vs=h.vs.insert(p,_)}}}(r.localStore,s))}async function s3(t,e){const n=Ce(t);if(!n.currentUser.isEqual(e)){ce(W0,"User change. New user:",e.toKey());const r=await cI(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new oe(B.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await au(n,r.Ns)}}function o3(t,e){const n=Ce(t),r=n.Au.get(e);if(r&&r.hu)return Oe().add(r.key);{let i=Oe();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function II(t){const e=Ce(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=SI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=o3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=t3.bind(null,e),e.Pu.J_=$V.bind(null,e.eventManager),e.Pu.yu=WV.bind(null,e.eventManager),e}function a3(t){const e=Ce(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=n3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=r3.bind(null,e),e}class wh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return uV(this.persistence,new aV,e.initialUser,this.serializer)}Cu(e){return new lI(P0.Vi,this.serializer)}Du(e){return new yV}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}wh.provider={build:()=>new wh};class l3 extends wh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){$e(this.persistence.referenceDelegate instanceof vh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new HM(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Tn.withCacheSize(this.cacheSizeBytes):Tn.DEFAULT;return new lI(r=>vh.Vi(r,n),this.serializer)}}class Vg{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>y_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=s3.bind(null,this.syncEngine),await zV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BV}()}createDatastore(e){const n=Cf(e.databaseInfo.databaseId),r=SV(e.databaseInfo);return CV(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new AV(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>y_(this.syncEngine,n,0),function(){return d_.v()?new d_:new vV}())}createSyncEngine(e,n){return function(i,s,o,a,l,d,h){const f=new KV(i,s,o,a,l,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ce(i);ce(_o,"RemoteStore shutting down."),s.Ea.add(5),await ou(s),s.Aa.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Vg.provider={build:()=>new Vg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ti("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const As="FirestoreClient";class c3{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this._databaseInfo=i,this.user=on.UNAUTHENTICATED,this.clientId=w0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ce(As,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ce(As,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=F0(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Yp(t,e){t.asyncQueue.verifyOperationInProgress(),ce(As,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await cI(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function x_(t,e){t.asyncQueue.verifyOperationInProgress();const n=await u3(t);ce(As,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>f_(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>f_(e.remoteStore,i)),t._onlineComponents=e}async function u3(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ce(As,"Using user provided OfflineComponentProvider");try{await Yp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===B.FAILED_PRECONDITION||i.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Fa("Error using user provided cache. Falling back to memory cache: "+n),await Yp(t,new wh)}}else ce(As,"Using default OfflineComponentProvider"),await Yp(t,new l3(void 0));return t._offlineComponents}async function CI(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ce(As,"Using user provided OnlineComponentProvider"),await x_(t,t._uninitializedComponentsProvider._online)):(ce(As,"Using default OnlineComponentProvider"),await x_(t,new Vg))),t._onlineComponents}function d3(t){return CI(t).then(e=>e.syncEngine)}async function _h(t){const e=await CI(t),n=e.eventManager;return n.onListen=QV.bind(null,e.syncEngine),n.onUnlisten=JV.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=YV.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=ZV.bind(null,e.syncEngine),n}function h3(t,e,n,r){const i=new H0(r),s=new $0(e,i,n);return t.asyncQueue.enqueueAndForget(async()=>z0(await _h(t),s)),()=>{i.Nu(),t.asyncQueue.enqueueAndForget(async()=>U0(await _h(t),s))}}function f3(t,e,n={}){const r=new pi;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,d){const h=new H0({next:p=>{h.Nu(),o.enqueueAndForget(()=>U0(s,f));const g=p.docs.has(a);!g&&p.fromCache?d.reject(new oe(B.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&l&&l.source==="server"?d.reject(new oe(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(p)},error:p=>d.reject(p)}),f=new $0(_f(a.path),h,{includeMetadataChanges:!0,Ka:!0});return z0(s,f)}(await _h(t),t.asyncQueue,e,n,r)),r.promise}function p3(t,e,n={}){const r=new pi;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,d){const h=new H0({next:p=>{h.Nu(),o.enqueueAndForget(()=>U0(s,f)),p.fromCache&&l.source==="server"?d.reject(new oe(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),f=new $0(a,h,{includeMetadataChanges:!0,Ka:!0});return z0(s,f)}(await _h(t),t.asyncQueue,e,n,r)),r.promise}function m3(t,e){const n=new pi;return t.asyncQueue.enqueueAndForget(async()=>e3(await d3(t),e,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g3="ComponentProvider",w_=new Map;function y3(t,e,n,r,i){return new VL(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,kI(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI="firestore.googleapis.com",__=!0;class S_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new oe(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=AI,this.ssl=__}else this.host=e.host,this.ssl=e.ssl??__;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=aI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WM)throw new oe(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}IL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kI(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new oe(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new oe(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new oe(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Rf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new S_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new oe(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new oe(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new S_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new gL;switch(r.type){case"firstParty":return new wL(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new oe(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=w_.get(n);r&&(ce(g3,"Removing Datastore"),w_.delete(n),r.terminate())}(this),Promise.resolve()}}function v3(t,e,n,r={}){var d;t=ar(t,Rf);const i=Jr(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(pf(`https://${a}`),mf("Firestore",!0)),s.host!==AI&&s.host!==a&&Fa("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!xo(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=on.MOCK_USER;else{h=r2(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new oe(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new on(p)}t._authCredentials=new yL(new g2(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Do(this.firestore,e,this._query)}}class _t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ys(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _t(this.firestore,e,this._key)}toJSON(){return{type:_t._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(nu(n,_t._jsonSchema))return new _t(e,r||null,new we(Ze.fromString(n.referencePath)))}}_t._jsonSchemaVersion="firestore/documentReference/1.0",_t._jsonSchema={type:Nt("string",_t._jsonSchemaVersion),referencePath:Nt("string")};class ys extends Do{constructor(e,n,r){super(e,n,_f(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _t(this.firestore,null,new we(e))}withConverter(e){return new ys(this.firestore,e,this._path)}}function x3(t,e,...n){if(t=ut(t),y2("collection","path",e),t instanceof Rf){const r=Ze.fromString(e,...n);return Lw(r),new ys(t,null,r)}{if(!(t instanceof _t||t instanceof ys))throw new oe(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ze.fromString(e,...n));return Lw(r),new ys(t.firestore,null,r)}}function Ho(t,e,...n){if(t=ut(t),arguments.length===1&&(e=w0.newId()),y2("doc","path",e),t instanceof Rf){const r=Ze.fromString(e,...n);return jw(r),new _t(t,null,new we(r))}{if(!(t instanceof _t||t instanceof ys))throw new oe(B.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ze.fromString(e,...n));return jw(r),new _t(t.firestore,t instanceof ys?t.converter:null,new we(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_="AsyncQueue";class E_{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new dI(this,"async_queue_retry"),this._c=()=>{const r=Qp();r&&ce(T_,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Qp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Qp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new pi;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!el(e))throw e;ce(T_,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Ti("INTERNAL UNHANDLED ERROR: ",b_(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=O0.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&Te(47125,{Pc:b_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function b_(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class So extends Rf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new E_,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new E_(e),this._firestoreClient=void 0,await e}}}function w3(t,e){const n=typeof t=="object"?t:gf(),r=typeof t=="string"?t:e||hh,i=tu(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=g0("firestore");s&&v3(i,...s)}return i}function Pf(t){if(t._terminated)throw new oe(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||_3(t),t._firestoreClient}function _3(t){var r,i,s,o;const e=t._freezeSettings(),n=y3(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,(i=t._app)==null?void 0:i.options.apiKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new c3(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const d=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new nr(Xt.fromBase64String(e))}catch(n){throw new oe(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new nr(Xt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:nr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(nu(e,nr._jsonSchema))return nr.fromBase64String(e.bytes)}}nr._jsonSchemaVersion="firestore/bytes/1.0",nr._jsonSchema={type:Nt("string",nr._jsonSchemaVersion),bytes:Nt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new oe(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new oe(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new oe(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Kr._jsonSchemaVersion}}static fromJSON(e){if(nu(e,Kr._jsonSchema))return new Kr(e.latitude,e.longitude)}}Kr._jsonSchemaVersion="firestore/geoPoint/1.0",Kr._jsonSchema={type:Nt("string",Kr._jsonSchemaVersion),latitude:Nt("number"),longitude:Nt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Tr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(nu(e,Tr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Tr(e.vectorValues);throw new oe(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Tr._jsonSchemaVersion="firestore/vectorValue/1.0",Tr._jsonSchema={type:Nt("string",Tr._jsonSchemaVersion),vectorValues:Nt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S3=/^__.*__$/;class T3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ls(e,this.data,this.fieldMask,n,this.fieldTransforms):new iu(e,this.data,n,this.fieldTransforms)}}class RI{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ls(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function PI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Te(40011,{dataSource:t})}}class K0{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new K0({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Sh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(PI(this.dataSource)&&S3.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class E3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Cf(e)}createContext(e,n,r,i=!1){return new K0({dataSource:e,methodName:n,targetDoc:r,path:Kt.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Q0(t){const e=t._freezeSettings(),n=Cf(t._databaseId);return new E3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function b3(t,e,n,r,i,s={}){const o=t.createContext(s.merge||s.mergeFields?2:0,e,n,i);X0("Data must be an object, but it was:",o,r);const a=NI(r,o);let l,d;if(s.merge)l=new Fn(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const p=qa(e,f,n);if(!o.contains(p))throw new oe(B.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);LI(h,p)||h.push(p)}l=new Fn(h),d=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,d=o.fieldTransforms;return new T3(new bn(a),l,d)}class Df extends Nf{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Df}}class Y0 extends Nf{_toFieldTransform(e){return new uM(e.path,new Rc)}isEqual(e){return e instanceof Y0}}function I3(t,e,n,r){const i=t.createContext(1,e,n);X0("Data must be an object, but it was:",i,r);const s=[],o=bn.empty();js(r,(l,d)=>{const h=jI(e,l,n);d=ut(d);const f=i.childContextForFieldPath(h);if(d instanceof Df)s.push(h);else{const p=lu(d,f);p!=null&&(s.push(h),o.set(h,p))}});const a=new Fn(s);return new RI(o,a,i.fieldTransforms)}function C3(t,e,n,r,i,s){const o=t.createContext(1,e,n),a=[qa(e,r,n)],l=[i];if(s.length%2!=0)throw new oe(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(qa(e,s[p])),l.push(s[p+1]);const d=[],h=bn.empty();for(let p=a.length-1;p>=0;--p)if(!LI(d,a[p])){const g=a[p];let x=l[p];x=ut(x);const _=o.childContextForFieldPath(g);if(x instanceof Df)d.push(g);else{const k=lu(x,_);k!=null&&(d.push(g),h.set(g,k))}}const f=new Fn(d);return new RI(h,f,o.fieldTransforms)}function k3(t,e,n,r=!1){return lu(n,t.createContext(r?4:3,e))}function lu(t,e){if(DI(t=ut(t)))return X0("Unsupported field value:",e,t),NI(t,e);if(t instanceof Nf)return function(r,i){if(!PI(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=lu(a,i.childContextForArray(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ut(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return aM(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=at.fromDate(r);return{timestampValue:yh(i.serializer,s)}}if(r instanceof at){const s=new at(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:yh(i.serializer,s)}}if(r instanceof Kr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof nr)return{bytesValue:Z2(i.serializer,r._byteString)};if(r instanceof _t){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:A0(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Tr)return function(o,a){const l=o instanceof Tr?o.toArray():o;return{mapValue:{fields:{[I2]:{stringValue:k2},[fh]:{arrayValue:{values:l.map(h=>{if(typeof h!="number")throw a.createError("VectorValues must only contain numeric values.");return I0(a.serializer,h)})}}}}}}(r,i);if(oI(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${yf(r)}`)}(t,e)}function NI(t,e){const n={};return w2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):js(t,(r,i)=>{const s=lu(i,e.childContextForField(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function DI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof at||t instanceof Kr||t instanceof nr||t instanceof _t||t instanceof Nf||t instanceof Tr||oI(t))}function X0(t,e,n){if(!DI(n)||!v2(n)){const r=yf(n);throw r==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function qa(t,e,n){if((e=ut(e))instanceof G0)return e._internalPath;if(typeof e=="string")return jI(t,e);throw Sh("Field path arguments must be of type string or ",t,!1,void 0,n)}const A3=new RegExp("[~\\*/\\[\\]]");function jI(t,e,n){if(e.search(A3)>=0)throw Sh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new G0(...e.split("."))._internalPath}catch{throw Sh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Sh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new oe(B.INVALID_ARGUMENT,a+t+l)}function LI(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{convertValue(e,n="none"){switch(Cs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Is(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Te(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return js(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[fh].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>Et(o.doubleValue));return new Tr(n)}convertGeoPoint(e){return new Kr(Et(e.latitude),Et(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=wf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Cc(e));default:return null}}convertTimestamp(e){const n=bs(e);return new at(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ze.fromString(e);$e(sI(r),9688,{name:e});const i=new kc(r.get(1),r.get(3)),s=new we(r.popFirst(5));return i.isEqual(n)||Ti(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0 extends R3{constructor(e){super(),this.firestore=e}convertBytes(e){return new nr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new _t(this.firestore,null,n)}}function Xu(){return new Y0("serverTimestamp")}const I_="@firebase/firestore",C_="4.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new _t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new P3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const n=this._document.data.field(qa("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class P3 extends MI{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new oe(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Z0{}class N3 extends Z0{}function D3(t,e,...n){let r=[];e instanceof Z0&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof ev).length,a=s.filter(l=>l instanceof jf).length;if(o>1||o>0&&a>0)throw new oe(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class jf extends N3{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new jf(e,n,r)}_apply(e){const n=this._parse(e);return OI(e._query,n),new Do(e.firestore,e.converter,Cg(e._query,n))}_parse(e){const n=Q0(e.firestore);return function(s,o,a,l,d,h,f){let p;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new oe(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){R_(f,h);const x=[];for(const _ of f)x.push(A_(l,s,_));p={arrayValue:{values:x}}}else p=A_(l,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||R_(f,h),p=k3(a,o,f,h==="in"||h==="not-in");return Pt.create(d,h,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function uU(t,e,n){const r=e,i=qa("where",t);return jf._create(i,r,n)}class ev extends Z0{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new ev(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ir.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)OI(o,l),o=Cg(o,l)}(e._query,n),new Do(e.firestore,e.converter,Cg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function A_(t,e,n){if(typeof(n=ut(n))=="string"){if(n==="")throw new oe(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!M2(e)&&n.indexOf("/")!==-1)throw new oe(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ze.fromString(n));if(!we.isDocumentKey(r))throw new oe(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return $w(t,new we(r))}if(n instanceof _t)return $w(t,n._key);throw new oe(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${yf(n)}.`)}function R_(t,e){if(!Array.isArray(t)||t.length===0)throw new oe(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function OI(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new oe(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new oe(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function j3(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Ml{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class co extends MI{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Sd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(qa("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new oe(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=co._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}co._jsonSchemaVersion="firestore/documentSnapshot/1.0",co._jsonSchema={type:Nt("string",co._jsonSchemaVersion),bundleSource:Nt("string","DocumentSnapshot"),bundleName:Nt("string"),bundle:Nt("string")};class Sd extends co{data(e={}){return super.data(e)}}class uo{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ml(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Sd(this._firestore,this._userDataWriter,r.key,r,new Ml(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new oe(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Sd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ml(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Sd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ml(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:L3(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new oe(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=uo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=w0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function L3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Te(61501,{type:t})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */uo._jsonSchemaVersion="firestore/querySnapshot/1.0",uo._jsonSchema={type:Nt("string",uo._jsonSchemaVersion),bundleSource:Nt("string","QuerySnapshot"),bundleName:Nt("string"),bundle:Nt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Td(t){t=ar(t,_t);const e=ar(t.firestore,So),n=Pf(e);return f3(n,t._key).then(r=>zI(e,t,r))}function M3(t){t=ar(t,Do);const e=ar(t.firestore,So),n=Pf(e),r=new J0(e);return VI(t._query),p3(n,t._query).then(i=>new uo(e,r,t,i))}function V3(t,e,n){t=ar(t,_t);const r=ar(t.firestore,So),i=j3(t.converter,e,n),s=Q0(r);return FI(r,[b3(s,"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Hr.none())])}function Xp(t,e,n,...r){t=ar(t,_t);const i=ar(t.firestore,So),s=Q0(i);let o;return o=typeof(e=ut(e))=="string"||e instanceof G0?C3(s,"updateDoc",t._key,e,n,r):I3(s,"updateDoc",t._key,e),FI(i,[o.toMutation(t._key,Hr.exists(!0))])}function dU(t,...e){var d,h,f;t=ut(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||k_(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(k_(e[r])){const p=e[r];e[r]=(d=p.next)==null?void 0:d.bind(p),e[r+1]=(h=p.error)==null?void 0:h.bind(p),e[r+2]=(f=p.complete)==null?void 0:f.bind(p)}let s,o,a;if(t instanceof _t)o=ar(t.firestore,So),a=_f(t._key.path),s={next:p=>{e[r]&&e[r](zI(o,t,p))},error:e[r+1],complete:e[r+2]};else{const p=ar(t,Do);o=ar(p.firestore,So),a=p._query;const g=new J0(o);s={next:x=>{e[r]&&e[r](new uo(o,g,p,x))},error:e[r+1],complete:e[r+2]},VI(t._query)}const l=Pf(o);return h3(l,a,i,s)}function FI(t,e){const n=Pf(t);return m3(n,e)}function zI(t,e,n){const r=n.docs.get(e._key),i=new J0(t);return new co(t,i,e._key,r,new Ml(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){mL(Ro),Ts(new _i("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new So(new vL(r.getProvider("auth-internal")),new _L(o,r.getProvider("app-check-internal")),OL(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),or(I_,C_,e),or(I_,C_,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI="firebasestorage.googleapis.com",BI="storageBucket",O3=2*60*1e3,F3=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct extends Cr{constructor(e,n,r=0){super(Jp(e),`Firebase Storage: ${n} (${Jp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ct.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Jp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var It;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(It||(It={}));function Jp(t){return"storage/"+t}function tv(){const t="An unknown error occurred, please check the error payload for server response.";return new Ct(It.UNKNOWN,t)}function z3(t){return new Ct(It.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function U3(t){return new Ct(It.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function B3(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ct(It.UNAUTHENTICATED,t)}function $3(){return new Ct(It.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function W3(t){return new Ct(It.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function q3(){return new Ct(It.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function H3(){return new Ct(It.CANCELED,"User canceled the upload/download.")}function G3(t){return new Ct(It.INVALID_URL,"Invalid URL '"+t+"'.")}function K3(t){return new Ct(It.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Q3(){return new Ct(It.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+BI+"' property when initializing the app?")}function Y3(){return new Ct(It.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function X3(t){return new Ct(It.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Og(t){return new Ct(It.INVALID_ARGUMENT,t)}function $I(){return new Ct(It.APP_DELETED,"The Firebase app was deleted.")}function J3(t){return new Ct(It.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function nc(t,e){return new Ct(It.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Il(t){throw new Ct(It.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=zn.makeFromUrl(e,n)}catch{return new zn(e,"")}if(r.path==="")return r;throw K3(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function d(j){j.path_=decodeURIComponent(j.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",g=new RegExp(`^https?://${f}/${h}/b/${i}/o${p}`,"i"),x={bucket:1,path:3},_=n===UI?"(?:storage.googleapis.com|storage.cloud.google.com)":n,k="([^?#]*)",T=new RegExp(`^https?://${_}/${i}/${k}`,"i"),w=[{regex:a,indices:l,postModify:s},{regex:g,indices:x,postModify:d},{regex:T,indices:{bucket:1,path:2},postModify:d}];for(let j=0;j<w.length;j++){const L=w[j],V=L.regex.exec(e);if(V){const E=V[L.indices.bucket];let S=V[L.indices.path];S||(S=""),r=new zn(E,S),L.postModify(r);break}}if(r==null)throw G3(e);return r}}class Z3{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e6(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...k){d||(d=!0,e.apply(null,k))}function f(k){i=setTimeout(()=>{i=null,t(g,l())},k)}function p(){s&&clearTimeout(s)}function g(k,...T){if(d){p();return}if(k){p(),h.call(null,k,...T);return}if(l()||o){p(),h.call(null,k,...T);return}r<64&&(r*=2);let w;a===1?(a=2,w=0):w=(r+Math.random())*1e3,f(w)}let x=!1;function _(k){x||(x=!0,p(),!d&&(i!==null?(k||(a=2),clearTimeout(i),f(0)):k||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,_(!0)},n),_}function t6(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n6(t){return t!==void 0}function r6(t){return typeof t=="object"&&!Array.isArray(t)}function WI(t){return typeof t=="string"||t instanceof String}function P_(t){return nv()&&t instanceof Blob}function nv(){return typeof Blob<"u"}function N_(t,e,n,r){if(r<e)throw Og(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Og(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qI(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function i6(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var ho;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ho||(ho={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s6(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e,n,r,i,s,o,a,l,d,h,f,p=!0,g=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=p,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,_)=>{this.resolve_=x,this.reject_=_,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Ju(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===ho.NO_ERROR,l=s.getStatus();if(!a||s6(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===ho.ABORT;r(!1,new Ju(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new Ju(d,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());n6(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=tv();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?$I():H3();o(l)}else{const l=q3();o(l)}};this.canceled_?n(!1,new Ju(!1,null,!0)):this.backoffId_=e6(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&t6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ju{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function a6(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function l6(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function c6(t,e){e&&(t["X-Firebase-GMPID"]=e)}function u6(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function d6(t,e,n,r,i,s,o=!0,a=!1){const l=i6(t.urlParams),d=t.url+l,h=Object.assign({},t.headers);return c6(h,e),a6(h,n),l6(h,s),u6(h,r),new o6(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h6(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function f6(...t){const e=h6();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(nv())return new Blob(t);throw new Ct(It.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function p6(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m6(t){if(typeof atob>"u")throw X3("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Zp{constructor(e,n){this.data=e,this.contentType=n||null}}function g6(t,e){switch(t){case zr.RAW:return new Zp(HI(e));case zr.BASE64:case zr.BASE64URL:return new Zp(GI(t,e));case zr.DATA_URL:return new Zp(v6(e),x6(e))}throw tv()}function HI(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function y6(t){let e;try{e=decodeURIComponent(t)}catch{throw nc(zr.DATA_URL,"Malformed data URL.")}return HI(e)}function GI(t,e){switch(t){case zr.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw nc(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case zr.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw nc(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=m6(e)}catch(i){throw i.message.includes("polyfill")?i:nc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class KI{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw nc(zr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=w6(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function v6(t){const e=new KI(t);return e.base64?GI(zr.BASE64,e.rest):y6(e.rest)}function x6(t){return new KI(t).contentType}function w6(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,n){let r=0,i="";P_(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(P_(this.data_)){const r=this.data_,i=p6(r,e,n);return i===null?null:new Hi(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Hi(r,!0)}}static getBlob(...e){if(nv()){const n=e.map(r=>r instanceof Hi?r.data_:r);return new Hi(f6.apply(null,n))}else{const n=e.map(o=>WI(o)?g6(zr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Hi(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _6(t){let e;try{e=JSON.parse(t)}catch{return null}return r6(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S6(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function T6(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function QI(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E6(t,e){return e}class fn{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||E6}}let Zu=null;function b6(t){return!WI(t)||t.length<2?t:QI(t)}function I6(){if(Zu)return Zu;const t=[];t.push(new fn("bucket")),t.push(new fn("generation")),t.push(new fn("metageneration")),t.push(new fn("name","fullPath",!0));function e(s,o){return b6(o)}const n=new fn("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new fn("size");return i.xform=r,t.push(i),t.push(new fn("timeCreated")),t.push(new fn("updated")),t.push(new fn("md5Hash",null,!0)),t.push(new fn("cacheControl",null,!0)),t.push(new fn("contentDisposition",null,!0)),t.push(new fn("contentEncoding",null,!0)),t.push(new fn("contentLanguage",null,!0)),t.push(new fn("contentType",null,!0)),t.push(new fn("metadata","customMetadata",!0)),Zu=t,Zu}function C6(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new zn(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function k6(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return C6(r,t),r}function A6(t,e,n){const r=_6(e);return r===null?null:k6(t,r,n)}function R6(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class YI{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P6(t){if(!t)throw tv()}function N6(t,e){function n(r,i){const s=A6(t,i,e);return P6(s!==null),s}return n}function XI(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=$3():i=B3():n.getStatus()===402?i=U3(t.bucket):n.getStatus()===403?i=W3(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function D6(t){const e=XI(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=z3(t.path)),s.serverResponse=i.serverResponse,s}return n}function j6(t,e,n){const r=e.fullServerUrl(),i=qI(r,t.host,t._protocol)+"?alt=media",s="GET",o=t.maxOperationRetryTime,a=new YI(i,s,(l,d)=>d,o);return a.errorHandler=D6(e),n!==void 0&&(a.headers.Range=`bytes=0-${n}`,a.successCodes=[200,206]),a}function L6(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function M6(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=L6(null,e)),r}function V6(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let w="";for(let j=0;j<2;j++)w=w+Math.random().toString().slice(2);return w}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const d=M6(e,r,i),h=R6(d,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+d.contentType+`\r
\r
`,p=`\r
--`+l+"--",g=Hi.getBlob(f,r,p);if(g===null)throw Y3();const x={name:d.fullPath},_=qI(s,t.host,t._protocol),k="POST",T=t.maxUploadRetryTime,v=new YI(_,k,N6(t,n),T);return v.urlParams=x,v.headers=o,v.body=g.uploadData(),v.errorHandler=XI(e),v}class JI{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ho.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ho.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ho.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i,s){if(this.sent_)throw Il("cannot .send() more than once");if(Jr(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Il("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Il("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Il("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Il("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class O6 extends JI{initXhr(){this.xhr_.responseType="text"}}function F6(){return new O6}class z6 extends JI{initXhr(){this.xhr_.responseType="arraybuffer"}}function U6(){return new z6}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,n){this._service=e,n instanceof zn?this._location=n:this._location=zn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new To(e,n)}get root(){const e=new zn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return QI(this._location.path)}get storage(){return this._service}get parent(){const e=S6(this._location.path);if(e===null)return null;const n=new zn(this._location.bucket,e);return new To(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw J3(e)}}function B6(t,e){t._throwIfRoot("getBytes");const n=j6(t.storage,t._location,e);return t.storage.makeRequestWithTokens(n,U6).then(r=>e!==void 0?r.slice(0,e):r)}function $6(t,e,n){t._throwIfRoot("uploadBytes");const r=V6(t.storage,t._location,I6(),new Hi(e,!0),n);return t.storage.makeRequestWithTokens(r,F6).then(i=>({metadata:i,ref:t}))}function W6(t,e){const n=T6(t._location.path,e),r=new zn(t._location.bucket,n);return new To(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q6(t){return/^[A-Za-z]+:\/\//.test(t)}function H6(t,e){return new To(t,e)}function ZI(t,e){if(t instanceof rv){const n=t;if(n._bucket==null)throw Q3();const r=new To(n,n._bucket);return e!=null?ZI(r,e):r}else return e!==void 0?W6(t,e):t}function G6(t,e){if(e&&q6(e)){if(t instanceof rv)return H6(t,e);throw Og("To use ref(service, url), the first argument must be a Storage instance.")}else return ZI(t,e)}function D_(t,e){const n=e==null?void 0:e[BI];return n==null?null:zn.makeFromBucketSpec(n,t)}function K6(t,e,n,r={}){t.host=`${e}:${n}`;const i=Jr(e);i&&(pf(`https://${t.host}/b`),mf("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:r2(s,t.app.options.projectId))}class rv{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=UI,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=O3,this._maxUploadRetryTime=F3,this._requests=new Set,i!=null?this._bucket=zn.makeFromBucketSpec(i,this._host):this._bucket=D_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=zn.makeFromBucketSpec(this._url,e):this._bucket=D_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){N_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){N_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Vn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new To(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new Z3($I());{const o=d6(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const j_="@firebase/storage",L_="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC="storage";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hU(t,e){return t=ut(t),B6(t,e)}function fU(t,e,n){return t=ut(t),$6(t,e,n)}function pU(t,e){return t=ut(t),G6(t,e)}function Q6(t=gf(),e){t=ut(t);const r=tu(t,eC).getImmediate({identifier:e}),i=g0("storage");return i&&Y6(r,...i),r}function Y6(t,e,n,r={}){K6(t,e,n,r)}function X6(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new rv(n,r,i,e,Ro)}function J6(){Ts(new _i(eC,X6,"PUBLIC").setMultipleInstances(!0)),or(j_,L_,""),or(j_,L_,"esm2020")}J6();function tC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Z6=tC,nC=new Zc("auth","Firebase",tC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Th=new y0("@firebase/auth");function eO(t,...e){Th.logLevel<=Me.WARN&&Th.warn(`Auth (${Ro}): ${t}`,...e)}function Ed(t,...e){Th.logLevel<=Me.ERROR&&Th.error(`Auth (${Ro}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(t,...e){throw sv(t,...e)}function Er(t,...e){return sv(t,...e)}function iv(t,e,n){const r={...Z6(),[e]:n};return new Zc("auth","Firebase",r).create(e,{appName:t.name})}function fo(t){return iv(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tO(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Xr(t,"argument-error"),iv(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function sv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return nC.create(t,...e)}function be(t,e,...n){if(!t)throw sv(e,...n)}function ci(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ed(e),new Error(e)}function bi(t,e){t||ci(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function nO(){return M_()==="http:"||M_()==="https:"}function M_(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nO()||HD()||"connection"in navigator)?navigator.onLine:!0}function iO(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e,n){this.shortDelay=e,this.longDelay=n,bi(n>e,"Short delay should be less than long delay!"),this.isMobile=$D()||GD()}get(){return rO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ov(t,e){bi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ci("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ci("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ci("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],aO=new cu(3e4,6e4);function av(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function nl(t,e,n,r,i={}){return iC(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=eu({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:l,...s};return qD()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Jr(t.emulatorConfig.host)&&(d.credentials="include"),rC.fetch()(await sC(t,t.config.apiHost,n,a),d)})}async function iC(t,e,n){t._canInitEmulator=!1;const r={...sO,...e};try{const i=new cO(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw ed(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ed(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw ed(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw ed(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw iv(t,h,d);Xr(t,h)}}catch(i){if(i instanceof Cr)throw i;Xr(t,"network-request-failed",{message:String(i)})}}async function lO(t,e,n,r,i={}){const s=await nl(t,e,n,r,i);return"mfaPendingCredential"in s&&Xr(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function sC(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?ov(t.config,i):`${t.config.apiScheme}://${i}`;return oO.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class cO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Er(this.auth,"network-request-failed")),aO.get())})}}function ed(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Er(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uO(t,e){return nl(t,"POST","/v1/accounts:delete",e)}async function Eh(t,e){return nl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function dO(t,e=!1){const n=ut(t),r=await n.getIdToken(e),i=lv(r);be(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:rc(em(i.auth_time)),issuedAtTime:rc(em(i.iat)),expirationTime:rc(em(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function em(t){return Number(t)*1e3}function lv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ed("JWT malformed, contained fewer than 3 sections"),null;try{const i=Zb(n);return i?JSON.parse(i):(Ed("Failed to decode base64 JWT payload"),null)}catch(i){return Ed("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function V_(t){const e=lv(t);return be(e,"internal-error"),be(typeof e.exp<"u","internal-error"),be(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Cr&&hO(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function hO({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=rc(this.lastLoginAt),this.creationTime=rc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bh(t){var f;const e=t.auth,n=await t.getIdToken(),r=await Dc(t,Eh(e,{idToken:n}));be(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(f=i.providerUserInfo)!=null&&f.length?oC(i.providerUserInfo):[],o=mO(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),d=a?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new zg(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function pO(t){const e=ut(t);await bh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mO(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function oC(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gO(t,e){const n=await iC(t,{},async()=>{const r=eu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await sC(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Jr(t.emulatorConfig.host)&&(l.credentials="include"),rC.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function yO(t,e){return nl(t,"POST","/v2/accounts:revokeToken",av(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){be(e.idToken,"internal-error"),be(typeof e.idToken<"u","internal-error"),be(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):V_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){be(e.length!==0,"internal-error");const n=V_(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(be(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await gO(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new _a;return r&&(be(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(be(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(be(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new _a,this.toJSON())}_performRefresh(){return ci("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(t,e){be(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class wr{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new fO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new zg(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Dc(this,this.stsTokenManager.getToken(this.auth,e));return be(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return dO(this,e)}reload(){return pO(this)}_assign(e){this!==e&&(be(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new wr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){be(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await bh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Vn(this.auth.app))return Promise.reject(fo(this.auth));const e=await this.getIdToken();return await Dc(this,uO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:p,isAnonymous:g,providerData:x,stsTokenManager:_}=n;be(f&&_,e,"internal-error");const k=_a.fromJSON(this.name,_);be(typeof f=="string",e,"internal-error"),Li(r,e.name),Li(i,e.name),be(typeof p=="boolean",e,"internal-error"),be(typeof g=="boolean",e,"internal-error"),Li(s,e.name),Li(o,e.name),Li(a,e.name),Li(l,e.name),Li(d,e.name),Li(h,e.name);const T=new wr({uid:f,auth:e,email:i,emailVerified:p,displayName:r,isAnonymous:g,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:k,createdAt:d,lastLoginAt:h});return x&&Array.isArray(x)&&(T.providerData=x.map(v=>({...v}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,n,r=!1){const i=new _a;i.updateFromServerResponse(n);const s=new wr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await bh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];be(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?oC(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new _a;a.updateFromIdToken(r);const l=new wr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new zg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_=new Map;function ui(t){bi(t instanceof Function,"Expected a class definition");let e=O_.get(t);return e?(bi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,O_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}aC.type="NONE";const F_=aC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bd(t,e,n){return`firebase:${t}:${e}:${n}`}class Sa{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=bd(this.userKey,i.apiKey,s),this.fullPersistenceKey=bd("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Eh(this.auth,{idToken:e}).catch(()=>{});return n?wr._fromGetAccountInfoResponse(this.auth,n,e):null}return wr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Sa(ui(F_),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||ui(F_);const o=bd(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const p=await Eh(e,{idToken:h}).catch(()=>{});if(!p)break;f=await wr._fromGetAccountInfoResponse(e,p,h)}else f=wr._fromJSON(e,h);d!==s&&(a=f),s=d;break}}catch{}const l=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Sa(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new Sa(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(fC(e))return"Blackberry";if(pC(e))return"Webos";if(cC(e))return"Safari";if((e.includes("chrome/")||uC(e))&&!e.includes("edge/"))return"Chrome";if(hC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function lC(t=dn()){return/firefox\//i.test(t)}function cC(t=dn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function uC(t=dn()){return/crios\//i.test(t)}function dC(t=dn()){return/iemobile/i.test(t)}function hC(t=dn()){return/android/i.test(t)}function fC(t=dn()){return/blackberry/i.test(t)}function pC(t=dn()){return/webos/i.test(t)}function cv(t=dn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function vO(t=dn()){var e;return cv(t)&&!!((e=window.navigator)!=null&&e.standalone)}function xO(){return KD()&&document.documentMode===10}function mC(t=dn()){return cv(t)||hC(t)||pC(t)||fC(t)||/windows phone/i.test(t)||dC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(t,e=[]){let n;switch(t){case"Browser":n=z_(dn());break;case"Worker":n=`${z_(dn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ro}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _O(t,e={}){return nl(t,"GET","/v2/passwordPolicy",av(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SO=6;class TO{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??SO,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new U_(this),this.idTokenSubscription=new U_(this),this.beforeStateQueue=new wO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ui(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Sa.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Eh(this,{idToken:e}),r=await wr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Vn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return be(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await bh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=iO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Vn(this.app))return Promise.reject(fo(this));const n=e?ut(e):null;return n&&be(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&be(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Vn(this.app)?Promise.reject(fo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Vn(this.app)?Promise.reject(fo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ui(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await _O(this),n=new TO(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Zc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await yO(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ui(e)||this._popupRedirectResolver;be(n,this,"argument-error"),this.redirectPersistenceManager=await Sa.create(this,[ui(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(be(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return be(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=gC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Vn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&eO(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function uu(t){return ut(t)}class U_{constructor(e){this.auth=e,this.observer=null,this.addObserver=nj(n=>this.observer=n)}get next(){return be(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bO(t){uv=t}function IO(t){return uv.loadJS(t)}function CO(){return uv.gapiScript}function kO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AO(t,e){const n=tu(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(xo(s,e??{}))return i;Xr(i,"already-initialized")}return n.initialize({options:e})}function RO(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ui);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function PO(t,e,n){const r=uu(t);be(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=yC(e),{host:o,port:a}=NO(e),l=a===null?"":`:${a}`,d={url:`${s}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){be(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),be(xo(d,r.config.emulator)&&xo(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Jr(o)?(pf(`${s}//${o}${l}`),mf("Auth",!0)):i||DO()}function yC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function NO(t){const e=yC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:B_(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:B_(o)}}}function B_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function DO(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ci("not implemented")}_getIdTokenResponse(e){return ci("not implemented")}_linkToIdToken(e,n){return ci("not implemented")}_getReauthenticationResolver(e){return ci("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ta(t,e){return lO(t,"POST","/v1/accounts:signInWithIdp",av(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO="http://localhost";class Eo extends vC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Eo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Xr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new Eo(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ta(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ta(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ta(e,n)}buildRequest(){const e={requestUri:jO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=eu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du extends dv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi extends du{constructor(){super("facebook.com")}static credential(e){return Eo._fromParams({providerId:Gi.PROVIDER_ID,signInMethod:Gi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gi.credentialFromTaggedObject(e)}static credentialFromError(e){return Gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gi.credential(e.oauthAccessToken)}catch{return null}}}Gi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Gi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr extends du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Eo._fromParams({providerId:rr.PROVIDER_ID,signInMethod:rr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return rr.credentialFromTaggedObject(e)}static credentialFromError(e){return rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return rr.credential(n,r)}catch{return null}}}rr.GOOGLE_SIGN_IN_METHOD="google.com";rr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki extends du{constructor(){super("github.com")}static credential(e){return Eo._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ki.credential(e.oauthAccessToken)}catch{return null}}}Ki.GITHUB_SIGN_IN_METHOD="github.com";Ki.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi extends du{constructor(){super("twitter.com")}static credential(e,n){return Eo._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Qi.credential(n,r)}catch{return null}}}Qi.TWITTER_SIGN_IN_METHOD="twitter.com";Qi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await wr._fromIdTokenResponse(e,r,i),o=$_(r);return new Ha({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=$_(r);return new Ha({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function $_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih extends Cr{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Ih.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Ih(e,n,r,i)}}function xC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Ih._fromErrorAndOperation(t,s,e,r):s})}async function LO(t,e,n=!1){const r=await Dc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ha._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MO(t,e,n=!1){const{auth:r}=t;if(Vn(r.app))return Promise.reject(fo(r));const i="reauthenticate";try{const s=await Dc(t,xC(r,i,e,t),n);be(s.idToken,r,"internal-error");const o=lv(s.idToken);be(o,r,"internal-error");const{sub:a}=o;return be(t.uid===a,r,"user-mismatch"),Ha._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Xr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VO(t,e,n=!1){if(Vn(t.app))return Promise.reject(fo(t));const r="signIn",i=await xC(t,r,e),s=await Ha._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function OO(t,e,n,r){return ut(t).onIdTokenChanged(e,n,r)}function FO(t,e,n){return ut(t).beforeAuthStateChanged(e,n)}function zO(t){return ut(t).signOut()}const Ch="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ch,"1"),this.storage.removeItem(Ch),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UO=1e3,BO=10;class _C extends wC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=mC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);xO()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,BO):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},UO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}_C.type="LOCAL";const $O=_C;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC extends wC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}SC.type="SESSION";const TC=SC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Lf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async d=>d(n.origin,s)),l=await WO(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Lf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const d=hv("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const p=f;if(p.data.eventId===d)switch(p.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(){return window}function HO(t){Qr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EC(){return typeof Qr().WorkerGlobalScope<"u"&&typeof Qr().importScripts=="function"}async function GO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function KO(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function QO(){return EC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bC="firebaseLocalStorageDb",YO=1,kh="firebaseLocalStorage",IC="fbase_key";class hu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Mf(t,e){return t.transaction([kh],e?"readwrite":"readonly").objectStore(kh)}function XO(){const t=indexedDB.deleteDatabase(bC);return new hu(t).toPromise()}function Ug(){const t=indexedDB.open(bC,YO);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(kh,{keyPath:IC})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(kh)?e(r):(r.close(),await XO(),e(await Ug()))})})}async function W_(t,e,n){const r=Mf(t,!0).put({[IC]:e,value:n});return new hu(r).toPromise()}async function JO(t,e){const n=Mf(t,!1).get(e),r=await new hu(n).toPromise();return r===void 0?null:r.value}function q_(t,e){const n=Mf(t,!0).delete(e);return new hu(n).toPromise()}const ZO=800,eF=3;class CC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ug(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>eF)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return EC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Lf._getInstance(QO()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await GO(),!this.activeServiceWorker)return;this.sender=new qO(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||KO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ug();return await W_(e,Ch,"1"),await q_(e,Ch),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>W_(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>JO(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>q_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Mf(i,!1).getAll();return new hu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ZO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}CC.type="LOCAL";const tF=CC;new cu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kC(t,e){return e?ui(e):(be(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv extends vC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ta(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ta(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ta(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function nF(t){return VO(t.auth,new fv(t),t.bypassAuthState)}function rF(t){const{auth:e,user:n}=t;return be(n,e,"internal-error"),MO(n,new fv(t),t.bypassAuthState)}async function iF(t){const{auth:e,user:n}=t;return be(n,e,"internal-error"),LO(n,new fv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return nF;case"linkViaPopup":case"linkViaRedirect":return iF;case"reauthViaPopup":case"reauthViaRedirect":return rF;default:Xr(this.auth,"internal-error")}}resolve(e){bi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){bi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sF=new cu(2e3,1e4);async function H_(t,e,n){if(Vn(t.app))return Promise.reject(Er(t,"operation-not-supported-in-this-environment"));const r=uu(t);tO(t,e,dv);const i=kC(r,n);return new ro(r,"signInViaPopup",e,i).executeNotNull()}class ro extends AC{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,ro.currentPopupAction&&ro.currentPopupAction.cancel(),ro.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return be(e,this.auth,"internal-error"),e}async onExecution(){bi(this.filter.length===1,"Popup operations only handle one event");const e=hv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Er(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Er(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ro.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Er(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,sF.get())};e()}}ro.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF="pendingRedirect",Id=new Map;class aF extends AC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Id.get(this.auth._key());if(!e){try{const r=await lF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Id.set(this.auth._key(),e)}return this.bypassAuthState||Id.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function lF(t,e){const n=dF(e),r=uF(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function cF(t,e){Id.set(t._key(),e)}function uF(t){return ui(t._redirectPersistence)}function dF(t){return bd(oF,t.config.apiKey,t.name)}async function hF(t,e){return await uu(t)._initializationPromise,RC(t,e,!1)}async function RC(t,e,n=!1){if(Vn(t.app))return Promise.reject(fo(t));const r=uu(t),i=kC(r,e),o=await new aF(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fF=10*60*1e3;class pF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!mF(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!PC(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Er(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=fF&&this.cachedEventUids.clear(),this.cachedEventUids.has(G_(e))}saveEventToCache(e){this.cachedEventUids.add(G_(e)),this.lastProcessedEventTime=Date.now()}}function G_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function PC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function mF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gF(t,e={}){return nl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vF=/^https?/;async function xF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await gF(t);for(const n of e)try{if(wF(n))return}catch{}Xr(t,"unauthorized-domain")}function wF(t){const e=Fg(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!vF.test(n))return!1;if(yF.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _F=new cu(3e4,6e4);function K_(){const t=Qr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function SF(t){return new Promise((e,n)=>{var i,s,o;function r(){K_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{K_(),n(Er(t,"network-request-failed"))},timeout:_F.get()})}if((s=(i=Qr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Qr().gapi)!=null&&o.load)r();else{const a=kO("iframefcb");return Qr()[a]=()=>{gapi.load?r():n(Er(t,"network-request-failed"))},IO(`${CO()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Cd=null,e})}let Cd=null;function TF(t){return Cd=Cd||SF(t),Cd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EF=new cu(5e3,15e3),bF="__/auth/iframe",IF="emulator/auth/iframe",CF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function AF(t){const e=t.config;be(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ov(e,IF):`https://${t.config.authDomain}/${bF}`,r={apiKey:e.apiKey,appName:t.name,v:Ro},i=kF.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${eu(r).slice(1)}`}async function RF(t){const e=await TF(t),n=Qr().gapi;return be(n,t,"internal-error"),e.open({where:document.body,url:AF(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:CF,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Er(t,"network-request-failed"),a=Qr().setTimeout(()=>{s(o)},EF.get());function l(){Qr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},NF=500,DF=600,jF="_blank",LF="http://localhost";class Q_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function MF(t,e,n,r=NF,i=DF){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...PF,width:r.toString(),height:i.toString(),top:s,left:o},d=dn().toLowerCase();n&&(a=uC(d)?jF:n),lC(d)&&(e=e||LF,l.scrollbars="yes");const h=Object.entries(l).reduce((p,[g,x])=>`${p}${g}=${x},`,"");if(vO(d)&&a!=="_self")return VF(e||"",a),new Q_(null);const f=window.open(e||"",a,h);be(f,t,"popup-blocked");try{f.focus()}catch{}return new Q_(f)}function VF(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OF="__/auth/handler",FF="emulator/auth/handler",zF=encodeURIComponent("fac");async function Y_(t,e,n,r,i,s){be(t.config.authDomain,t,"auth-domain-config-required"),be(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ro,eventId:i};if(e instanceof dv){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",tj(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries(s||{}))o[h]=f}if(e instanceof du){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${zF}=${encodeURIComponent(l)}`:"";return`${UF(t)}?${eu(a).slice(1)}${d}`}function UF({config:t}){return t.emulator?ov(t,FF):`https://${t.authDomain}/${OF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tm="webStorageSupport";class BF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=TC,this._completeRedirectFn=RC,this._overrideRedirectResult=cF}async _openPopup(e,n,r,i){var o;bi((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await Y_(e,n,r,Fg(),i);return MF(e,s,hv())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await Y_(e,n,r,Fg(),i);return HO(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(bi(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await RF(e),r=new pF(e);return n.register("authEvent",i=>(be(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(tm,{type:tm},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[tm];s!==void 0&&n(!!s),Xr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=xF(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return mC()||cC()||cv()}}const $F=BF;var X_="@firebase/auth",J_="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){be(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function HF(t){Ts(new _i("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;be(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:gC(t)},d=new EO(r,i,s,l);return RO(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ts(new _i("auth-internal",e=>{const n=uu(e.getProvider("auth").getImmediate());return(r=>new WF(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),or(X_,J_,qF(t)),or(X_,J_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF=5*60,KF=n2("authIdTokenMaxAge")||GF;let Z_=null;const QF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>KF)return;const i=n==null?void 0:n.token;Z_!==i&&(Z_=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function YF(t=gf()){const e=tu(t,"auth");if(e.isInitialized())return e.getImmediate();const n=AO(t,{popupRedirectResolver:$F,persistence:[tF,$O,TC]}),r=n2("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=QF(s.toString());FO(n,o,()=>o(n.currentUser)),OO(n,a=>o(a))}}const i=e2("auth");return i&&PO(n,`http://${i}`),n}function XF(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}bO({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Er("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",XF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});HF("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF="type.googleapis.com/google.protobuf.Int64Value",ZF="type.googleapis.com/google.protobuf.UInt64Value";function NC(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Ah(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Ah(e));if(typeof t=="function"||typeof t=="object")return NC(t,e=>Ah(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Ga(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case JF:case ZF:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Ga(e)):typeof t=="function"||typeof t=="object"?NC(t,e=>Ga(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class An extends Cr{constructor(e,n,r){super(`${pv}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,An.prototype)}}function e8(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Rh(t,e){let n=e8(t),r=n,i;try{const s=e&&e.error;if(s){const o=s.status;if(typeof o=="string"){if(!eS[o])return new An("internal","internal");n=eS[o],r=o}const a=s.message;typeof a=="string"&&(r=a),i=s.details,i!==void 0&&(i=Ga(i))}}catch{}return n==="ok"?null:new An(n,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t8{constructor(e,n,r,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Vn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||i==null||i.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bg="us-central1",n8=/^data: (.*?)(?:\n|$)/;function r8(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new An("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class i8{constructor(e,n,r,i,s=Bg,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new t8(e,n,r,i),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(s);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=Bg}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function s8(t,e,n){const r=Jr(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(pf(t.emulatorOrigin+"/backends"),mf("Functions",!0))}function o8(t,e,n){const r=i=>l8(t,e,i,n||{});return r.stream=(i,s)=>u8(t,e,i,s),r}function DC(t){return t.emulatorOrigin&&Jr(t.emulatorOrigin)?"include":void 0}async function a8(t,e,n,r,i){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n,credentials:DC(i)})}catch{return{status:0,json:null}}let o=null;try{o=await s.json()}catch{}return{status:s.status,json:o}}async function jC(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function l8(t,e,n,r){const i=t._url(e);return c8(t,i,n,r)}async function c8(t,e,n,r){n=Ah(n);const i={data:n},s=await jC(t,r),o=r.timeout||7e4,a=r8(o),l=await Promise.race([a8(e,i,s,t.fetchImpl,t),a.promise,t.cancelAllRequests]);if(a.cancel(),!l)throw new An("cancelled","Firebase Functions instance was deleted.");const d=Rh(l.status,l.json);if(d)throw d;if(!l.json)throw new An("internal","Response is not valid JSON object.");let h=l.json.data;if(typeof h>"u"&&(h=l.json.result),typeof h>"u")throw new An("internal","Response is missing data field.");return{data:Ga(h)}}function u8(t,e,n,r){const i=t._url(e);return d8(t,i,n,r||{})}async function d8(t,e,n,r){var p;n=Ah(n);const i={data:n},s=await jC(t,r);s["Content-Type"]="application/json",s.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:s,signal:r==null?void 0:r.signal,credentials:DC(t)})}catch(g){if(g instanceof Error&&g.name==="AbortError"){const _=new An("cancelled","Request was cancelled.");return{data:Promise.reject(_),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(_)}}}}}}const x=Rh(0,null);return{data:Promise.reject(x),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(x)}}}}}}let a,l;const d=new Promise((g,x)=>{a=g,l=x});(p=r==null?void 0:r.signal)==null||p.addEventListener("abort",()=>{const g=new An("cancelled","Request was cancelled.");l(g)});const h=o.body.getReader(),f=h8(h,a,l,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const g=f.getReader();return{async next(){const{value:x,done:_}=await g.read();return{value:x,done:_}},async return(){return await g.cancel(),{done:!0,value:void 0}}}}},data:d}}function h8(t,e,n,r){const i=(o,a)=>{const l=o.match(n8);if(!l)return;const d=l[1];try{const h=JSON.parse(d);if("result"in h){e(Ga(h.result));return}if("message"in h){a.enqueue(Ga(h.message));return}if("error"in h){const f=Rh(0,h);a.error(f),n(f);return}}catch(h){if(h instanceof An){a.error(h),n(h);return}}},s=new TextDecoder;return new ReadableStream({start(o){let a="";return l();async function l(){if(r!=null&&r.aborted){const d=new An("cancelled","Request was cancelled");return o.error(d),n(d),Promise.resolve()}try{const{value:d,done:h}=await t.read();if(h){a.trim()&&i(a.trim(),o),o.close();return}if(r!=null&&r.aborted){const p=new An("cancelled","Request was cancelled");o.error(p),n(p),await t.cancel();return}a+=s.decode(d,{stream:!0});const f=a.split(`
`);a=f.pop()||"";for(const p of f)p.trim()&&i(p.trim(),o);return l()}catch(d){const h=d instanceof An?d:Rh(0,null);o.error(h),n(h)}}},cancel(){return t.cancel()}})}const tS="@firebase/functions",nS="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f8="auth-internal",p8="app-check-internal",m8="messaging-internal";function g8(t){const e=(n,{instanceIdentifier:r})=>{const i=n.getProvider("app").getImmediate(),s=n.getProvider(f8),o=n.getProvider(m8),a=n.getProvider(p8);return new i8(i,s,o,a,r)};Ts(new _i(pv,e,"PUBLIC").setMultipleInstances(!0)),or(tS,nS,t),or(tS,nS,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y8(t=gf(),e=Bg){const r=tu(ut(t),pv).getImmediate({identifier:e}),i=g0("functions");return i&&v8(r,...i),r}function v8(t,e,n){s8(ut(t),e,n)}function Go(t,e,n){return o8(ut(t),e,n)}g8();const x8={apiKey:"AIzaSyCbQY1wxVEoQVGdnylLPMq1-_4sNgucxg0",authDomain:"mindcraft-admin.firebaseapp.com",projectId:"mindcraft-admin",storageBucket:"mindcraft-admin.firebasestorage.app",messagingSenderId:"375110192152",appId:"1:375110192152:web:ade8d56b867b194944076d"},Vf=o2(x8),Ys=w3(Vf),mU=Q6(Vf),Vr=YF(Vf),Ko=y8(Vf);var fr,Vc,ri,Xs;class $g{constructor(e="cic_",n=null){Fe(this,ri);Fe(this,fr,void 0);Fe(this,Vc,void 0);st(this,fr,e),st(this,Vc,n)}get(e,n=null){var r;try{const i=(r=Z(this,ri,Xs))==null?void 0:r.getItem(Z(this,fr)+e);return i==null?n:JSON.parse(i)}catch(i){return console.error(`[StorageStore] Read error for "${e}":`,i),n}}set(e,n){var r,i;try{const s=JSON.stringify(n,(o,a)=>{if(!(o.startsWith("_")||o.startsWith("$"))&&!(typeof a=="function"||a instanceof Element))return a});(r=Z(this,ri,Xs))==null||r.setItem(Z(this,fr)+e,s)}catch(s){console.error(`[StorageStore] Write error for "${e}":`,s);try{const o=JSON.parse(JSON.stringify(n,w8()));(i=Z(this,ri,Xs))==null||i.setItem(Z(this,fr)+e,JSON.stringify(o))}catch{console.error(`[StorageStore] Total failure for "${e}"`)}}}remove(e){var n;(n=Z(this,ri,Xs))==null||n.removeItem(Z(this,fr)+e)}purge(){const e=Z(this,ri,Xs);if(!e)return;const n=[];for(let r=0;r<e.length;r++){const i=e.key(r);i!=null&&i.startsWith(Z(this,fr))&&n.push(i)}n.forEach(r=>e.removeItem(r))}keys(){const e=Z(this,ri,Xs);if(!e)return[];const n=[];for(let r=0;r<e.length;r++){const i=e.key(r);i!=null&&i.startsWith(Z(this,fr))&&n.push(i.replace(Z(this,fr),""))}return n}}fr=new WeakMap,Vc=new WeakMap,ri=new WeakSet,Xs=function(){return Z(this,Vc)||(typeof window<"u"?window.localStorage:null)};function w8(){const t=new WeakSet;return(e,n)=>{if(typeof n=="object"&&n!==null){if(t.has(n))return;t.add(n)}return n}}const Mi=new $g("cic_v1_");var ba,pr,Oc,Lh,LC;const da=class da{constructor(){Fe(this,Lh);Fe(this,pr,null);Fe(this,Oc,void 0);if(Z(da,ba))return Z(da,ba);st(this,Oc,new $g("cic_global_")),this.startSession=this.startSession.bind(this),this.endSession=this.endSession.bind(this),st(da,ba,this)}startSession(e){if(!e)throw new Error("Security Violation: Attempted to start session without UID");Z(this,pr)&&Z(this,pr).uid!==e&&(console.warn("[SessionManager] Hot-swapping sessions. Purging previous."),this.endSession()),vt(this,Lh,LC).call(this,e);const n=`cic_user_${e}_`;st(this,pr,{uid:e,store:new $g(n)}),console.info(`[SessionManager] Secure session initialized for ${e}`)}endSession(){if(!Z(this,pr))return;const e=Z(this,pr).uid;console.info(`[SessionManager] Ending session for ${e} and executing Aggressive Wipe.`);const n=window.localStorage,r=`cic_user_${e}_`,i=[];for(let s=0;s<n.length;s++){const o=n.key(s);o&&o.startsWith(r)&&i.push(o)}i.forEach(s=>n.removeItem(s)),console.info(`[SessionManager] Wiped ${i.length} session keys.`),st(this,pr,null)}get userStore(){if(!Z(this,pr))throw new Error("Security Violation: Attempted to access user storage without active session");return Z(this,pr).store}get globalStore(){return Z(this,Oc)}static purgeAllUserSessions(){console.info("[SessionManager] Executing FULL Manual Purge...");const e=window.localStorage,n=[];for(let r=0;r<e.length;r++){const i=e.key(r);i&&(i.startsWith("cic_user_")||i.startsWith("cic_lesson_")||i.startsWith("cic_v1_lessons"))&&n.push(i)}n.forEach(r=>e.removeItem(r)),console.info(`[SessionManager] Purged ${n.length} sensitive keys.`)}};ba=new WeakMap,pr=new WeakMap,Oc=new WeakMap,Lh=new WeakSet,LC=function(e){const n=window.localStorage,r=[],i=`cic_user_${e}_`;for(let s=0;s<n.length;s++){const o=n.key(s);o&&(o.startsWith("cic_user_")&&!o.startsWith(i)&&r.push(o),(o.startsWith("cic_lesson_")||o.startsWith("cic_v1_lessons"))&&r.push(o))}r.length>0&&(console.info(`[SessionManager] Cleaning up ${r.length} stale/legacy session keys.`),r.forEach(s=>n.removeItem(s)))},Fe(da,ba,void 0);let Wg=da;const jc=new Wg,gn={IDLE:"IDLE",INITIALIZING:"INITIALIZING",READY:"READY",AUTHENTICATING:"AUTHENTICATING",SUCCESS:"SUCCESS",ERROR:"ERROR"},_8=["https://www.googleapis.com/auth/drive.file"];var Ia,Xi,ii,Ca,Ji,mn,io,Mh,Fc,Hg,Vh,MC,zc,Gg,Lr,zi,Oh,VC,Fh,OC;const ha=class ha{constructor(){Fe(this,Fc);Fe(this,Vh);Fe(this,zc);Fe(this,Lr);Fe(this,Oh);Fe(this,Fh);Fe(this,Xi,gn.IDLE);Fe(this,ii,null);Fe(this,Ca,new Set);Fe(this,Ji,null);Fe(this,mn,null);Fe(this,io,null);Fe(this,Mh,!1);if(Z(ha,Ia))return Z(ha,Ia);st(ha,Ia,this)}subscribe(e){return Z(this,Ca).add(e),e(this.getSnapshot()),()=>Z(this,Ca).delete(e)}getSnapshot(){var e;return{user:this.user,status:Z(this,Xi),error:Z(this,ii),token:(e=Z(this,mn))==null?void 0:e.token,hasDrive:this.hasDriveAccess}}get state(){return Z(this,Xi)}get error(){return Z(this,ii)}get user(){var e;return Z(this,Xi)!==gn.SUCCESS||!((e=Z(this,mn))!=null&&e.token)?null:{...Z(this,Ji),token:Z(this,mn).token}}get token(){var e;return(e=Z(this,mn))==null?void 0:e.token}get uid(){var e,n;return((e=Vr.currentUser)==null?void 0:e.uid)||((n=Z(this,Ji))==null?void 0:n.id)}get hasDriveAccess(){var e;return!!((e=Z(this,mn))!=null&&e.token)}async initialize(){return Z(this,io)?Z(this,io):(st(this,io,(async()=>{vt(this,Lr,zi).call(this,gn.INITIALIZING);try{const e=await hF(Vr);if(e){const n=rr.credentialFromResult(e);await vt(this,Fc,Hg).call(this,e.user,n)}else Vr.currentUser&&console.info("[IdentityManager] User detected. Waiting for manual login to acquire access token.")}catch(e){console.error("[IdentityManager] Initialization Error:",e),vt(this,zc,Gg).call(this,e)}st(this,Mh,!0),Z(this,Xi)===gn.INITIALIZING&&vt(this,Lr,zi).call(this,Z(this,Ji)?gn.SUCCESS:gn.READY)})()),Z(this,io))}async ensureDriveAccess(){var e,n;if((e=Z(this,mn))!=null&&e.token&&Z(this,mn).expiresAt>Date.now()+3e5)return Z(this,mn).token;console.info("[IdentityManager] Drive token missing/stale. Re-acquiring...");try{return await this.signIn({prompt:"none"}),(n=Z(this,mn))==null?void 0:n.token}catch(r){throw console.warn("[IdentityManager] Silent re-acquisition failed."),r}}async signIn(e={prompt:"select_account"}){var r;vt(this,Lr,zi).call(this,gn.AUTHENTICATING);const n=new rr;_8.forEach(i=>n.addScope(i)),e.prompt&&e.prompt!=="none"&&n.setCustomParameters({prompt:e.prompt});try{let i,s;if(e.prompt==="none"){const o=await H_(Vr,n);i=o.user,s=rr.credentialFromResult(o)}else{const o=await H_(Vr,n);i=o.user,s=rr.credentialFromResult(o)}await vt(this,Fc,Hg).call(this,i,s)}catch(i){throw console.error("[IdentityManager] Sign-In Failed:",i.code,i.message),e.prompt==="none"&&(i.code==="auth/popup-blocked"||((r=i.message)==null?void 0:r.includes("popup")))?console.warn("[IdentityManager] Suppressing UI error for blocked silent sign-in."):vt(this,zc,Gg).call(this,i),i}}async signOut(){vt(this,Lr,zi).call(this,gn.AUTHENTICATING);try{await zO(Vr),console.info("[IdentityManager] Signed out from Firebase.")}catch(e){console.error("[IdentityManager] Sign-out failed:",e)}finally{vt(this,Fh,OC).call(this)}}};Ia=new WeakMap,Xi=new WeakMap,ii=new WeakMap,Ca=new WeakMap,Ji=new WeakMap,mn=new WeakMap,io=new WeakMap,Mh=new WeakMap,Fc=new WeakSet,Hg=async function(e,n){if(n!=null&&n.accessToken||console.warn("[IdentityManager] Success without token. Attempting immediate repair..."),st(this,Ji,vt(this,Vh,MC).call(this,e)),st(this,mn,n!=null&&n.accessToken?{token:n.accessToken,expiresAt:Date.now()+3600*1e3}:null),!Z(this,mn))throw new Error("DRIVE_TOKEN_MISSING");jc.startSession(e.uid),vt(this,Lr,zi).call(this,gn.SUCCESS),console.info("[IdentityManager] Atomic Login Success:",e.uid)},Vh=new WeakSet,MC=function(e){return e?{id:e.uid,name:e.displayName,email:e.email,picture:e.photoURL,uid:e.uid}:null},zc=new WeakSet,Gg=function(e){st(this,ii,`Authentication Error: ${e.message||String(e)}`),vt(this,Lr,zi).call(this,gn.ERROR,Z(this,ii))},Lr=new WeakSet,zi=function(e,n=null){st(this,Xi,e),n&&st(this,ii,n),vt(this,Oh,VC).call(this)},Oh=new WeakSet,VC=function(){const e=this.getSnapshot();Z(this,Ca).forEach(n=>n(e))},Fh=new WeakSet,OC=function(){st(this,Ji,null),st(this,mn,null),st(this,ii,null),jc.endSession(),vt(this,Lr,zi).call(this,gn.IDLE)},Fe(ha,Ia,null);let qg=ha;const si=new qg,S8=t=>si.signIn(t),T8=()=>si.requestDriveAccess(),FC=R.createContext(null),zC=({children:t})=>{const[e,n]=R.useState(si.getSnapshot());R.useEffect(()=>{const o=si.subscribe(a=>{n(a)});return si.initialize().catch(a=>{console.error("[AuthProvider] Identity Initialization Failed:",a)}),()=>o()},[]);const r=R.useCallback((o="select_account")=>si.signIn({prompt:o}),[]),i=R.useCallback(()=>{si.signOut()},[]),s={user:e.user,authStatus:e.status,error:e.error,token:e.token,hasDrive:e.hasDrive,signIn:r,signOut:i,isLoading:e.status===gn.INITIALIZING||e.status===gn.AUTHENTICATING,isReady:e.status!==gn.IDLE&&e.status!==gn.INITIALIZING};return u.jsx(FC.Provider,{value:s,children:t})},Ms=()=>{const t=R.useContext(FC);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},E8="modulepreload",b8=function(t){return"/chethan-in-cardland/"+t},rS={},yr=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=b8(s),s in rS)return;rS[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let h=i.length-1;h>=0;h--){const f=i[h];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const d=document.createElement("link");if(d.rel=o?"stylesheet":E8,o||(d.as="script",d.crossOrigin=""),d.href=s,document.head.appendChild(d),o)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},iS=3,sS=1e3,vs=async(t,e={},n=0)=>{var r,i,s,o,a,l,d,h;try{const f=await fetch(t,e);if(f.ok)return f;if(f.status===401&&n<1){console.info("[Network] Token invalid. Attempting silent refresh...");try{const g=await si.acquireToken({prompt:"none",elevated:e._isElevated}),x={...e,headers:{...e.headers,Authorization:`Bearer ${g}`}};return await vs(t,x,n+1)}catch(g){throw console.error("[Network] Refresh failed.",g),new Error("REAUTH_NEEDED")}}if(f.status===403){const g=await f.json().catch(()=>({})),x=((s=(i=(r=g.error)==null?void 0:r.errors)==null?void 0:i[0])==null?void 0:s.reason)||"unknown",_=((o=g.error)==null?void 0:o.message)||"No detailed message";if(console.error("[Audit] 403 Forbidden detected.",{url:t,reason:x,message:_,tokenPrefix:((l=(a=e.headers)==null?void 0:a.Authorization)==null?void 0:l.substring(0,17))+"...",fullError:g}),x==="accessNotConfigured")console.error("[Audit] ROOT CAUSE: Google Drive API is likely DISABLED in the Google Cloud Console for this project.");else if(x==="insufficientPermissions"){console.error("[Audit] ROOT CAUSE: OAuth token is missing required scopes (drive.file or drive).");try{const k=(h=(d=e.headers)==null?void 0:d.Authorization)==null?void 0:h.replace("Bearer ","");if(k){const v=await(await fetch(`https://www.googleapis.com/oauth2/v3/tokeninfo?access_token=${k}`)).json();console.info("[Audit] Token Scope Info:",{scopes:v.scope,expires_in:v.expires_in,email:v.email})}}catch(k){console.warn("[Audit] Could not verify token scopes:",k)}}throw new Error(`REAUTH_NEEDED: ${x}: ${_}`)}if((f.status>=500||f.status===429)&&n<iS){const g=sS*Math.pow(2,n);return console.warn(`[Network] Transient error ${f.status}. Retrying in ${g}ms...`),await new Promise(x=>setTimeout(x,g)),await vs(t,e,n+1)}return f}catch(f){if(n<iS){const p=sS*Math.pow(2,n);return await new Promise(g=>setTimeout(g,p)),await vs(t,e,n+1)}throw f}},Ph="https://www.googleapis.com/drive/v3/files",oS="https://www.googleapis.com/upload/drive/v3/files",UC="lesson_content_cache",BC=()=>{try{const t=jc.userStore.get(UC,{});return new Map(Object.entries(t))}catch{return new Map}},$C=t=>{try{t.size>50&&Array.from(t.keys()).slice(0,t.size-50).forEach(i=>t.delete(i));const e=Object.fromEntries(t);jc.userStore.set(UC,e)}catch(e){console.warn("Failed to save cache:",e)}},Lc=t=>({Authorization:`Bearer ${t}`,"Content-Type":"application/json"}),I8=async t=>{const e="mimeType = 'application/json' and (name contains 'cic_lesson_' or name contains 'cic_progress_' or name contains 'flashcard_stack_') and trashed = false",n="files(id, name, owners, permissions, ownedByMe, sharingUser, starred, createdTime, modifiedTime, appProperties)",r=`${Ph}?q=${encodeURIComponent(e)}&fields=${n}&supportsAllDrives=true&includeItemsFromAllDrives=true&spaces=drive&t=${Date.now()}`,i=await vs(r,{headers:Lc(t),_isElevated:!0});if(i.status===401)throw new Error("REAUTH_NEEDED");const o=(await i.json()).files||[],a=new Map,l=[];return o.forEach(d=>{var f;let h=(f=d.appProperties)==null?void 0:f.id;if(!h){const p=d.name;p.startsWith("cic_lesson_")?h=p.replace("cic_lesson_","").replace(".json",""):p.startsWith("cic_progress_")?h=p.replace(".json",""):p.startsWith("flashcard_stack_")&&(h=p.replace("flashcard_stack_","").replace(".json",""))}if(h)if(a.has(h)){const p=a.get(h),g=new Date(p.modifiedTime).getTime();new Date(d.modifiedTime).getTime()>g?(l.push(p.id),a.set(h,d)):l.push(d.id)}else a.set(h,d)}),l.length>0&&(console.warn(`[Drive] Cleaning up ${l.length} duplicate files...`),Promise.allSettled(l.map(d=>vs(`${Ph}/${d}`,{method:"DELETE",headers:Lc(t),_isElevated:!0})))),Array.from(a.values())},C8=async(t,e)=>{const n=await vs(`${Ph}/${e}`,{method:"DELETE",headers:Lc(t),_isElevated:!0});if(!n.ok&&n.status!==404)throw new Error(`Drive Delete Failed: ${n.status}`);if(e){const r=BC();r.delete(e),$C(r)}return!0},aS=async(t,e,n,r=null,i="application/json",s=null,o=null)=>{var x;const a={name:e,mimeType:i};o&&(a.appProperties=o),s&&!r&&(a.parents=[s]);const l=r?`${oS}/${r}?uploadType=multipart`:`${oS}?uploadType=multipart`,d=r?"PATCH":"POST",h="-------314159265358979323846",f=`\r
--`+h+`\r
`,p=`\r
--`+h+"--",g=f+`Content-Type: application/json; charset=UTF-8\r
\r
`+JSON.stringify(a)+f+`Content-Type: application/json\r
\r
`+(typeof n=="string"?n:JSON.stringify(n))+p;try{const _=await vs(l,{method:d,headers:{...Lc(t),"Content-Type":`multipart/related; boundary=${h}`},body:g,_isElevated:!0});if(_.status===401)throw new Error("REAUTH_NEEDED");if(!_.ok){const v=await _.json();throw new Error(((x=v.error)==null?void 0:x.message)||"Failed to save to Google Drive")}const k=await _.json(),T=BC();return T.set(k.id,{content:n,modifiedTime:k.modifiedTime||new Date().toISOString()}),$C(T),k}catch(_){throw _}},k8=async(t,e,n)=>{let r=`name = '${e}' and trashed = false`;n&&(r+=` and '${n}' in parents`);const i=`${Ph}?q=${encodeURIComponent(r)}&fields=files(id, name)&t=${Date.now()}`,s=await vs(i,{headers:Lc(t),_isElevated:!0});if(s.status===401)throw new Error("REAUTH_NEEDED");if(!s.ok)return null;const o=await s.json();return o.files&&o.files.length>0?o.files[0].id:null},A8="DC3xQSHS3NL1vuxaPknC7KQI8mSv4VptXtLlKNBkJFE=",mv="AES-GCM",lS="PBKDF2",R8="SHA-256",P8=1e5,nm=async(t,e="cic_default_salt")=>{const n=new TextEncoder,r=await crypto.subtle.importKey("raw",n.encode(A8+t),{name:lS},!1,["deriveBits","deriveKey"]),i=n.encode(e);return await crypto.subtle.deriveKey({name:lS,salt:i,iterations:P8,hash:R8},r,{name:mv,length:256},!1,["encrypt","decrypt"])},cS=async(t,e)=>{const n=new TextEncoder,r=typeof t=="string"?t:JSON.stringify(t),i=crypto.getRandomValues(new Uint8Array(12)),s=await crypto.subtle.encrypt({name:mv,iv:i},e,n.encode(r)),o=new Uint8Array(i.length+s.byteLength);o.set(i),o.set(new Uint8Array(s),i.length);const a=8192;let l="";for(let d=0;d<o.length;d+=a)l+=String.fromCharCode.apply(null,o.subarray(d,d+a));return btoa(l)},rm=async(t,e)=>{try{let n,r;if(t.startsWith("v1:")){const o=t.split(":"),a=o[1],l=o[2];n=new Uint8Array(a.match(/.{1,2}/g).map(h=>parseInt(h,16)));const d=atob(l);r=new Uint8Array(d.length);for(let h=0;h<d.length;h++)r[h]=d.charCodeAt(h)}else{const o=new Uint8Array(atob(t).split("").map(a=>a.charCodeAt(0)));n=o.slice(0,12),r=o.slice(12)}const i=await crypto.subtle.decrypt({name:mv,iv:n},e,r),s=new TextDecoder().decode(i);try{return JSON.parse(s)}catch{return s}}catch(n){throw console.error("[LessonCrypto] Decryption failed:",n),new Error("Lesson decryption failed. This content might be owned by another user or corrupted.")}},uS=t=>String(t||"").replace(/[^a-zA-Z0-9-_]/g,""),dS=(t,e)=>{if(!t||!e)throw new Error("Storage Error: Missing Identity Binding (UID or LessonID)");return`${uS(t)}_${uS(e)}`},im=t=>{var r,i;if(!t)return!1;const e=((r=t.questions)==null?void 0:r.length)||0,n=((i=t.cards)==null?void 0:i.length)||0;return e>0||n>0};var Mr,Uc,zh;class N8{constructor(e){Fe(this,Mr,new Map);Fe(this,Uc,void 0);Fe(this,zh,3e3);st(this,Uc,e)}enqueue(e,n){Z(this,Mr).has(e)&&clearTimeout(Z(this,Mr).get(e));const r=setTimeout(async()=>{Z(this,Mr).delete(e);try{await Z(this,Uc).executeDriveSync(e,n)}catch(i){console.warn(`[SyncQueue] Failed for ${e}:`,i.message)}},Z(this,zh));Z(this,Mr).set(e,r)}async flush(){Array.from(Z(this,Mr).keys()),Z(this,Mr).forEach(e=>clearTimeout(e)),Z(this,Mr).clear()}}Mr=new WeakMap,Uc=new WeakMap,zh=new WeakMap;const Cl=()=>{try{return jc.userStore}catch{return{get:(e,n)=>n,set:()=>{},remove:()=>{}}}};var Zi,Sn,ka,Bc,so,oo,Vl,$c,Kg,Uh,WC,Aa,kd;class D8{constructor(){Fe(this,oo);Fe(this,$c);Fe(this,Uh);Fe(this,Aa);Fe(this,Zi,!1);Fe(this,Sn,null);Fe(this,ka,void 0);Fe(this,Bc,new Map);Fe(this,so,!1);st(this,ka,new N8(this))}getStore(){return Cl()}setDriveAccess(e,n=null){st(this,Zi,e),st(this,Sn,n),console.info(`[Storage] Mode: ${e?"Cloud (Drive)":"Local (Offline/Recruiter)"}`)}async listLessons(e={}){const{includeDeleted:n=!1}=e,r=Cl(),i=Z(this,oo,Vl);if(!i)return[];let s=r.get(`meta_${i}`,[]);if(s.length===0){const o=r.get("lessons",[]);o.length>0&&(console.info("[Storage] Migrating legacy data to secure key..."),s=o,r.set(`meta_${i}`,s))}if(!Z(this,Zi)||!Z(this,Sn))return n?s:s.filter(o=>!o._isDeleted);try{const o=await I8(Z(this,Sn)),a=new Map,l=new Map;st(this,so,!0),o.forEach(f=>{const p=f.appProperties||{},g=f.name;if(g.startsWith("cic_lesson_")||g.startsWith("flashcard_stack_")){const x=p.id||g.replace("cic_lesson_","").replace("flashcard_stack_","").replace(".json","");a.set(x,{id:x,driveFileId:f.id,title:p.title||g,modifiedTime:f.modifiedTime,lastMarks:p.lastMarks,questionCount:p.questionCount})}else if(g.startsWith("cic_progress_")){const x=g.replace("cic_progress_","").replace(".json","").split("_");if(x.length>=2&&x[0]===i){const _=x.slice(1).join("_");l.set(_,{fileId:f.id,modifiedTime:f.modifiedTime}),console.info(`[Storage] Discovered cloud progress for ${_}`)}}}),st(this,Bc,l);const d=[],h=new Map(s.map(f=>[f.id,f]));return a.forEach((f,p)=>{const g=h.get(p);g?(g._isDeleted?d.push(g):d.push({...f,...g,driveFileId:f.driveFileId}),h.delete(p)):d.push(f)}),h.forEach(f=>d.push(f)),r.set(`meta_${i}`,d),n?d:d.filter(f=>!f._isDeleted)}catch(o){return console.warn("[Storage] List failed, using local.",o),n?s:s.filter(a=>!a._isDeleted)}}async getLessonContent(e){const n=Z(this,oo,Vl);if(!n)return e;const r=dS(n,e.id),i=Cl();let s=i.get(`content_${r}`,null),o=i.get(`progress_${r}`,{});if(Z(this,Zi)&&Z(this,Sn)){if(!s||e.modifiedTime&&(!s.updatedAt||new Date(e.modifiedTime)>new Date(s.updatedAt)))try{const l=await(void 0)(Z(this,Sn),{id:e.driveFileId,modifiedTime:e.modifiedTime});if(l.encryptedContent){const d=await nm(n),h=await rm(l.encryptedContent,d);Object.assign(l,h),delete l.encryptedContent}if(im(l)){s={...l,updatedAt:new Date().toISOString()},i.set(`content_${r}`,s);const d=vt(this,$c,Kg).call(this,l);o=vt(this,Aa,kd).call(this,o,d)}}catch(l){console.warn("[Storage] Content fetch failed",l)}try{const l=Z(this,Bc).get(e.id);if(l){console.info(`[Storage] Hydrating progress for ${e.id} from cloud truth...`);let d=await(void 0)(Z(this,Sn),l.fileId);if(d.iv&&d.data){const h=await nm(n);d=await rm(d,h)}o=vt(this,Aa,kd).call(this,o,d),i.set(`progress_${r}`,o)}}catch(l){console.warn("[Storage] Remote progress sync failed",l)}}if(st(this,so,!1),!s)return e;const a=(s.questions||[]).map(l=>{var f,p;const d=l.id||((f=l.question)==null?void 0:f.text),h=(p=o.ratings)==null?void 0:p[d];return h!==void 0?{...l,lastRating:h}:l});return{...s,questions:a,lastReviewed:o.lastReviewed||s.lastReviewed,reviewStage:o.reviewStage??s.reviewStage,lastMarks:o.lastMarks??s.lastMarks,lastSessionIndex:o.lastSessionIndex??s.lastSessionIndex,showSectionNotes:o.showSectionNotes??s.showSectionNotes}}async saveLesson(e,n=null){var g;const r=Z(this,oo,Vl);if(!r)throw new Error("Cannot save without User ID");if(e.questions&&e.questions.length===0)return console.error("[Storage] BLOCKED SAVE: Attempted to save empty question array."),e;const i=dS(r,e.id),s=Cl(),o=vt(this,$c,Kg).call(this,e),a=vt(this,Uh,WC).call(this,e),d={...s.get(`progress_${i}`,{}),...o,updatedAt:new Date().toISOString()};s.set(`progress_${i}`,d),im(a)&&s.set(`content_${i}`,{...a,updatedAt:new Date().toISOString()});const h=s.get(`meta_${r}`,[]),f=h.findIndex(x=>x.id===e.id),p={id:e.id,title:e.title,questionCount:((g=a.questions)==null?void 0:g.length)||0,lastMarks:d.lastMarks,nextReview:d.nextReview};return f>=0?h[f]={...h[f],...p}:h.push(p),s.set(`meta_${r}`,h),Z(this,Zi)&&!Z(this,so)?Z(this,ka).enqueue(i,{lessonId:e.id,content:a,progress:d,folderId:n,driveFileId:e.driveFileId}):Z(this,so)&&console.warn(`[Storage] Write Blocked: Initial hydration in progress for ${e.id}`),e}async executeDriveSync(e,n){const{lessonId:r,content:i,progress:s,folderId:o,driveFileId:a}=n,l=Z(this,oo,Vl);if(!(!Z(this,Sn)||!Z(this,Zi)))try{const d=`cic_progress_${l}_${r}.json`,h=await nm(l),f=await k8(Z(this,Sn),d,o||"root");if(f){const g=await(void 0)(Z(this,Sn),f);let x=g;g.iv&&g.data&&(x=await rm(g,h));const _=vt(this,Aa,kd).call(this,s,x);if(JSON.stringify(_.ratings)!==JSON.stringify(s.ratings)){console.info(`[Storage] Cloud-Truth Conflict Detected for ${r}. Syncing back to local.`),Cl().set(`progress_${e}`,_);return}}const p=await cS(s,h);if(await aS(Z(this,Sn),d,p,f,"application/json",o),im(i)){const g=`cic_lesson_${l}_${r}.json`,x=await cS(i,h);await aS(Z(this,Sn),g,x,a,"application/json",o,{id:r,title:i.title,questionCount:String(i.questions.length),lastMarks:String(s.lastMarks||""),nextReview:s.nextReview||""})}}catch(d){console.error("[Storage] Sync Exec Failed:",d)}}async shutdown(){await Z(this,ka).flush()}}Zi=new WeakMap,Sn=new WeakMap,ka=new WeakMap,Bc=new WeakMap,so=new WeakMap,oo=new WeakSet,Vl=function(){return si.uid},$c=new WeakSet,Kg=function(e){const n={};return(e.questions||[]).forEach(r=>{var s;const i=r.id||((s=r.question)==null?void 0:s.text);r.lastRating!==void 0&&(n[i]=r.lastRating)}),{ratings:n,lastReviewed:e.lastReviewed,reviewStage:e.reviewStage,lastMarks:e.lastMarks,lastSessionIndex:e.lastSessionIndex,showSectionNotes:e.showSectionNotes,nextReview:e.nextReview}},Uh=new WeakSet,WC=function(e){const n=(e.questions||[]).map(r=>{const{lastRating:i,...s}=r;return s});return{id:e.id,title:e.title,questions:n,cards:e.cards,description:e.description}},Aa=new WeakSet,kd=function(e,n){if(!n)return e;const r=n.updatedAt?new Date(n.updatedAt).getTime():0,i=e.updatedAt?new Date(e.updatedAt).getTime():0;return r>=i?{...e,...n,ratings:{...e.ratings,...n.ratings},lastSessionIndex:n.lastSessionIndex??0,updatedAt:n.updatedAt||new Date().toISOString()}:{...n,...e,updatedAt:e.updatedAt}};const In=new D8,gv="/chethan-in-cardland/assets/logo-423dc48b.png",Ii={}.VITE_ADMIN_EMAIL||"chethanincardland@gmail.com",j8="https://us-central1-mindcraft-admin.cloudfunctions.net/decryptPublicLesson",L8={}.VITE_UPI_ID||"vinayarajh1-1@okhdfcbank",M8={}.VITE_SUPPORT_PHONE||"919497449115",V8="ChethanInCardland",Fo={id:"demo-lesson",title:"General Knowledge (Demo)",titleImage:gv,label:"Science",questions:[{id:1,question:{text:"What is the role of red blood cells?",image:"",audio:""},answer:{text:"They carry oxygen to body tissues.",image:"",audio:""}},{id:2,question:{text:"Why do we need sleep?",image:"",audio:""},answer:{text:"Sleep helps the body and brain recover and function properly.",image:"",audio:""}},{id:3,type:"mcq",question:{text:"Which part of the human body has no blood supply?",image:"",audio:""},options:[{id:"a",text:"Retina",isCorrect:!1},{id:"b",text:"Cornea",isCorrect:!0},{id:"c",text:"Brain",isCorrect:!1},{id:"d",text:"Liver",isCorrect:!1}],answer:{text:"Cornea",image:"",audio:""}},{id:4,question:{text:"Who was known as the Iron Man of India?",image:"",audio:""},answer:{text:"Sardar Vallabhbhai Patel was known as the Iron Man of India.",image:"",audio:""}},{id:5,type:"mcq",question:{text:"Which planet spins backwards compared to others?",image:"",audio:""},options:[{id:"a",text:"Mars",isCorrect:!1},{id:"b",text:"Earth",isCorrect:!1},{id:"c",text:"Venus",isCorrect:!0},{id:"d",text:"Jupiter",isCorrect:!1}],answer:{text:"Venus",image:"",audio:""}}],owner:Ii,ownerName:"Demo User",avgRating:4.8,lastReviewed:"Jan 7, 2026",nextReview:new Date(Date.now()+3*24*60*60*1e3).toISOString(),reviewStage:0,isPublic:!1},O8=(t,e,n)=>{const[r,i]=R.useState([Fo]),[s,o]=R.useState([]),[a,l]=R.useState(!1),[d,h]=R.useState(!1),f=R.useRef(0),p=R.useRef([]),g=R.useRef(null),x=R.useCallback(async v=>{i(w=>{const j=w.findIndex(L=>L.id===v.id);if(j>=0){const L=[...w];return L[j]={...L[j],...v},L}return[v,...w]});try{await In.saveLesson(v)}catch(w){console.error("[Lessons] Failed to persist update:",w),n==null||n("Auto-save failed","error")}},[n]),_=R.useCallback(async()=>{console.log("[Lessons] Public lessons are now real-time synced.")},[]);R.useEffect(()=>{let v=()=>{},w=!0;return(async()=>{h(!0);try{const[L,V]=await Promise.all([yr(()=>import("./localLessonsService-b405e72b.js"),[]),yr(()=>import("./publicDrive-5c32f71c.js"),[])]);if(!w)return;const E=await L.listLocalLessons();v=V.subscribeToPublicLessons(S=>{if(!w)return;const I=new Set(S.map(P=>P.id)),A=[...S,...E.filter(P=>!I.has(P.id))];console.log(`[Lessons] Synced ${S.length} Cloud + ${E.length} Local`),o(A),h(!1)})}catch(L){console.error("[Lessons] Subscription failed:",L),w&&h(!1)}})(),()=>{w=!1,v()}},[]);const k=R.useCallback(async(v=!1)=>{if(!t){i([Fo]);return}if(!(!v&&Date.now()-f.current<6e4)){f.current=Date.now(),l(!0);try{const w=await In.listLessons(),j=[],L=new Set,V=w.find(A=>A.id===Fo.id),E=V?{...Fo,...V}:Fo;w.forEach(A=>{A.id!==Fo.id&&!L.has(A.id)&&(L.add(A.id),j.push(A))}),i([E,...j]),l(!1),g.current&&clearInterval(g.current),p.current=[],g.current=setInterval(()=>{const A=p.current.splice(0,p.current.length);A.length>0&&i(P=>{const N=[...P];return A.forEach(b=>{const W=N.findIndex(de=>de.id===b.id);W>=0&&(N[W]={...N[W],...b,loading:!1})}),N})},500);const S=[...j],I=async()=>{if(S.length===0)return;const A=S.shift();try{const P=await In.getLessonContent(A);P&&p.current.push(P)}catch{}await I()};if(await Promise.all([I(),I(),I(),I()]),p.current.length>0){const A=p.current.splice(0,p.current.length);i(P=>{const N=[...P];return A.forEach(b=>{const W=N.findIndex(de=>de.id===b.id);W>=0&&(N[W]={...N[W],...b,loading:!1})}),N})}g.current&&(clearInterval(g.current),g.current=null)}catch(w){console.error("[Lessons] Load failed:",w),l(!1)}}},[t]);R.useEffect(()=>{In.setDriveAccess(e,t==null?void 0:t.token),e&&(t!=null&&t.token)&&t&&(console.log("[Lessons] Drive token active. Syncing My Lessons..."),k(!0));const v=()=>{document.visibilityState==="visible"&&e&&(t!=null&&t.token)&&(console.log("[Lessons] Window focused. Checking cloud for roaming progress..."),k(!1))};return window.addEventListener("visibilitychange",v),()=>window.removeEventListener("visibilitychange",v)},[e,t==null?void 0:t.token,t,k]);const T=R.useCallback(async v=>{if(v){l(!0);try{const w=(t==null?void 0:t.email)===Ii,j=v.source==="firestore"||v.isPublic&&!v.isLocal;if(w&&j){const{deletePublicLesson:L}=await yr(()=>import("./publicDrive-5c32f71c.js"),[]);await L(v.id),o(V=>V.filter(E=>E.id!==v.id))}else await In.deleteLesson(v),i(L=>L.filter(V=>V.id!==v.id))}catch(w){throw console.error(w),w}finally{l(!1)}}},[n]);return{lessons:r,publicLessons:s,loading:a,publicLoading:d,setLessons:i,setPublicLessons:o,fetchLessons:k,fetchPublicLessons:_,handleUpdateLocalLesson:x,deleteLesson:T}};var F8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const z8=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),U8=(t,e)=>{const n=R.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,children:a,...l},d)=>R.createElement("svg",{ref:d,...F8,width:i,height:i,stroke:r,strokeWidth:o?Number(s)*24/Number(i):s,className:`lucide lucide-${z8(t)}`,...l},[...e.map(([h,f])=>R.createElement(h,f)),...(Array.isArray(a)?a:[a])||[]]));return n.displayName=`${t}`,n};var ve=U8;const qC=ve("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),B8=ve("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),HC=ve("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Nh=ve("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),$8=ve("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),W8=ve("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),q8=ve("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),H8=ve("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),bo=ve("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),G8=ve("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),K8=ve("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]),yv=ve("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),Q8=ve("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),GC=ve("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),KC=ve("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),QC=ve("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Y8=ve("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),X8=ve("Gift",[["polyline",{points:"20 12 20 22 4 22 4 12",key:"nda8fc"}],["rect",{width:"20",height:"5",x:"2",y:"7",key:"wkgdzj"}],["line",{x1:"12",x2:"12",y1:"22",y2:"7",key:"1n8zgp"}],["path",{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z",key:"zighg4"}],["path",{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z",key:"1pa5tk"}]]),Qg=ve("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),J8=ve("Keyboard",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",ry:"2",key:"15u882"}],["path",{d:"M6 8h.001",key:"1ej0i3"}],["path",{d:"M10 8h.001",key:"1x2st2"}],["path",{d:"M14 8h.001",key:"1vkmyp"}],["path",{d:"M18 8h.001",key:"kfsenl"}],["path",{d:"M8 12h.001",key:"1sjpby"}],["path",{d:"M12 12h.001",key:"al75ts"}],["path",{d:"M16 12h.001",key:"931bgk"}],["path",{d:"M7 16h10",key:"wp8him"}]]),Yg=ve("Layers",[["polygon",{points:"12 2 2 7 12 12 22 7 12 2",key:"1b0ttc"}],["polyline",{points:"2 17 12 22 22 17",key:"imjtdl"}],["polyline",{points:"2 12 12 17 22 12",key:"5dexcv"}]]),Z8=ve("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),e9=ve("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),t9=ve("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),n9=ve("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]),YC=ve("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),r9=ve("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]),rs=ve("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),Dh=ve("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),i9=ve("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]),s9=ve("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),o9=ve("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),a9=ve("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]),vv=ve("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),Of=ve("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Yi=ve("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Mc=ve("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),ic=ve("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),l9=ve("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]),c9=ve("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Xg=ve("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),u9=ve("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),XC=ve("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),d9=ve("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),JC=ve("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),h9=ve("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]),Jg=ve("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),f9=ve("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),mi=ve("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),p9=ve("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Ad=ve("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ZC=ve("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),m9=ve("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),g9=ve("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),cn=ve("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),y9=ve("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),v9=ve("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),x9=ve("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),w9=({message:t,type:e="info",onUndo:n,onClose:r,duration:i=5e3})=>(R.useEffect(()=>{if(i){const s=setTimeout(()=>{r()},i);return()=>clearTimeout(s)}},[i,r]),u.jsxs(Ue.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95,transition:{duration:.2}},className:"neo-flat toast-container",style:{position:"fixed",bottom:"1.5rem",left:"0.5rem",right:"0.5rem",margin:"0 auto",width:"fit-content",maxWidth:"calc(100% - 2rem)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"space-between",gap:"1rem",padding:"0.6rem 1rem",borderRadius:"50px",background:"var(--bg-color)",color:"var(--text-color)",boxShadow:"8px 8px 16px var(--shadow-dark), -8px -8px 16px var(--shadow-light)",border:"1px solid var(--shadow-light)"},children:[u.jsx("span",{style:{flex:1,fontSize:"0.85rem",fontWeight:"600",paddingLeft:"0.5rem",wordBreak:"break-word",lineHeight:"1.2",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexShrink:0},children:[e==="undo"&&n&&u.jsxs("button",{onClick:s=>{s.stopPropagation(),n(),r()},className:"neo-button",style:{padding:"0.3rem 0.7rem",fontSize:"0.7rem",background:"var(--accent-color)",color:"white",border:"none",borderRadius:"20px",display:"flex",alignItems:"center",gap:"4px",boxShadow:"2px 2px 5px rgba(0,0,0,0.2)",cursor:"pointer",fontWeight:"700"},children:[u.jsx(ic,{size:12}),"Undo"]}),u.jsx("button",{onClick:r,style:{background:"transparent",border:"none",color:"var(--text-color)",opacity:.3,cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%"},children:u.jsx(cn,{size:16})})]})]})),ek=R.createContext(null),_9=({children:t})=>{const[e,n]=R.useState(null),[r,i]=R.useState(null),[s,o]=R.useState({showMenu:!1,showAddModal:!1,showFeedback:!1,showKnowMore:!1,showReferral:!1,showAdminPanel:!1,showCoinModal:!1,showNamePrompt:!1}),[a,l]=R.useState(!1),[d,h]=R.useState(null),[f,p]=R.useState(null),[g,x]=R.useState(null),[_,k]=R.useState(null),T=R.useCallback(()=>{o({showMenu:!1,showAddModal:!1,showFeedback:!1,showKnowMore:!1,showReferral:!1,showAdminPanel:!1,showCoinModal:!1,showNamePrompt:!1}),p(null),x(null),k(null)},[]),v=R.useCallback((I,A=null)=>{o(P=>({...P,[I]:A!==null?A:!P[I]}))},[]),w=R.useCallback((I,A,P=null)=>{n({type:I,message:A,onConfirm:P})},[]),j=R.useCallback(()=>{n(null)},[]),L=R.useCallback(({message:I,type:A="info",onUndo:P=null,duration:N=5e3,onClose:b=null})=>{i({id:Date.now(),message:I,type:A,onUndo:P,duration:N,onCloseCallback:b})},[]),V=R.useCallback(()=>{i(I=>(I!=null&&I.onCloseCallback&&I.onCloseCallback(),null))},[]),E=R.useCallback((I,A=3e3)=>{const P=Date.now();h({id:P,message:I}),setTimeout(()=>{h(N=>(N==null?void 0:N.id)===P?null:N)},A)},[]),S=R.useCallback(()=>{h(null)},[]);return u.jsxs(ek.Provider,{value:{modals:s,toggleModal:v,closeAllModals:T,activeLesson:f,setActiveLesson:p,reviewLesson:g,setReviewLesson:x,noteLesson:_,setNoteLesson:k,notification:e,showNotification:w,clearNotification:j,toast:r,showToast:L,hideToast:V,headerLoading:a,setHeaderLoading:l,headerNotice:d,showHeaderNotice:E,clearHeaderNotice:S},children:[t,u.jsx(kn,{children:r&&u.jsx(w9,{message:r.message,type:r.type,onUndo:r.onUndo,duration:r.duration,onClose:V},r.id)})]})},jo=()=>{const t=R.useContext(ek);if(!t)throw new Error("useUI must be used within a UIProvider");return t},tk=R.createContext(null),S9=({children:t})=>{const{user:e,hasDrive:n}=Ms(),{showNotification:r}=jo(),i=R.useCallback(o=>{o&&r(o.type,o.message,o.onConfirm)},[r]),s=O8(e,n,i);return u.jsx(tk.Provider,{value:s,children:t})},nk=()=>{const t=R.useContext(tk);if(!t)throw new Error("useLesson must be used within a LessonProvider");return t},zo="users",Un={async syncProfile(t,e=!1){if(!(t!=null&&t.uid))return null;const n=Ho(Ys,zo,t.uid),r=await Td(n),i={uid:t.uid,email:t.email,displayName:t.displayName||"Learner",photoURL:t.photoURL||null,lastSeen:Xu()};if(r.exists()){const s=r.data(),o={...i,loginCount:e?(s.loginCount||0)+1:s.loginCount||1};return await Xp(n,o),{...s,...o}}else{const s={...i,coins:0,totalReviews:0,loginCount:1,createdAt:Xu()};return await V3(n,s),{...s,id:t.uid}}},async getProfile(t){if(!t)return null;const e=await Td(Ho(Ys,zo,t));return e.exists()?{...e.data(),id:e.id}:null},async getEntitlements(t){if(!t)return{};const e=await Td(Ho(Ys,zo,t));return e.exists()?e.data().purchasedLessons||{}:{}},async archiveLesson(t,e){if(!t||!e)return;const n=Ho(Ys,zo,t);await Xp(n,{[`purchasedLessons.${e}.archived`]:!0,[`purchasedLessons.${e}.archivedAt`]:Xu()})},async restoreLesson(t,e){if(!t||!e)return;const n=Ho(Ys,zo,t);await Xp(n,{[`purchasedLessons.${e}.archived`]:!1,[`purchasedLessons.${e}.restoredAt`]:Xu()})},async purchaseLesson(t,e,n,r){return(await Go(Ko,"purchaseLesson")({lessonId:e,cost:n,title:r})).data},async checkDailyBonus(t){return(await Go(Ko,"checkDailyBonus")()).data},async applyReferral(t,e){return(await Go(Ko,"applyReferral")({referralCode:e})).data},async checkReferralCompletion(t,e,n,r){return(await Go(Ko,"checkReferralCompletion")({lessonId:e,isDemo:n,isUserCreated:r})).data},async updateBalance(t,e){throw new Error("Direct balance updates are disabled for security. Use specific action functions.")},async adminAddCoins(t,e){return(await Go(Ko,"grantCoins")({uid:t,amount:e})).data},async listUsers(){const t=D3(x3(Ys,zo));return(await M3(t)).docs.map(n=>({...n.data(),id:n.id}))}},T9=(t,e,n)=>{const[r,i]=R.useState(null),[s,o]=R.useState(!1),[a,l]=R.useState(0),d=R.useRef(0),h=R.useRef(null);R.useEffect(()=>{if(!(t!=null&&t.uid)){i(null);return}let p=!0;const g=async()=>{r||o(!0);try{const _=h.current!==t.uid,k=await Un.syncProfile(t,_);if(!p)return;_&&(h.current=t.uid);const T=localStorage.getItem("pendingReferral");if(T&&!k.referredBy&&await Un.applyReferral(t.uid,T)){localStorage.removeItem("pendingReferral"),e&&e({type:"alert",message:"Referral bonus applied!"});const j=await Un.syncProfile(t,!1);p&&i(j);return}const v=await Un.checkDailyBonus(t.uid);if(!p)return;if(v.awarded&&(n&&n({amount:v.bonus,type:"Daily Login"}),k.coins=v.newBalance),k.coins>d.current&&d.current>0){const w=k.coins-d.current;n&&n({amount:w,type:"Gift Received"})}d.current=k.coins,i(k)}catch(_){console.error("[useUserProfile] Sync Failed:",_)}finally{p&&o(!1)}};g();const x=()=>{document.visibilityState==="visible"&&(t!=null&&t.uid)&&g()};return window.addEventListener("visibilitychange",x),()=>{p=!1,window.removeEventListener("visibilitychange",x)}},[t==null?void 0:t.uid,e,n,a]);const f=R.useCallback(p=>{!t||!r||i(g=>({...g,coins:p}))},[t,r]);return{userProfile:r,setUserProfile:i,isProfileLoading:s,handleUpdateCoins:f,loadProfile:R.useCallback(()=>l(p=>p+1),[])}},E9=(t,e="")=>{const n=R.useRef(!1);R.useEffect(()=>{const i=s=>{if(t&&!n.current)return s.preventDefault(),s.returnValue=e,e};return window.addEventListener("beforeunload",i),()=>window.removeEventListener("beforeunload",i)},[t,e]);const r=R.useCallback(()=>{n.current=!0},[]);return R.useEffect(()=>{var i;t&&!n.current&&((i=window.history.state)==null?void 0:i.guard)!=="active"&&window.history.pushState({guard:"active"},"")},[t]),{allowExit:r}},rk=R.createContext(null),ik=({children:t})=>{const[e,n]=R.useState({isActive:!1,currentStep:1,isComplete:localStorage.getItem("tour_complete")==="true",isDemoGracePeriod:!1,eventQueue:[]}),r=R.useRef(null);R.useEffect(()=>{e.isComplete&&localStorage.setItem("tour_complete","true")},[e.isComplete]);const i=R.useCallback(()=>{n(f=>({...f,isActive:!0,currentStep:1}))},[]),s=R.useCallback(()=>{n(f=>({...f,isActive:!1,currentStep:1}))},[]),o=R.useCallback(()=>{n(f=>({...f,currentStep:f.currentStep+1}))},[]),a=R.useCallback(f=>{n(p=>({...p,currentStep:f}))},[]),l=R.useCallback(f=>{n(p=>({...p,eventQueue:[...p.eventQueue,f]}))},[]),d=R.useCallback(()=>{if(e.eventQueue.length===0)return;const[f,...p]=e.eventQueue;f(),n(g=>({...g,eventQueue:p}))},[e.eventQueue]);R.useEffect(()=>{if(e.eventQueue.length===0||e.isActive)return;const f=()=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{d()},3e3)};return window.addEventListener("mousemove",f),window.addEventListener("keydown",f),window.addEventListener("click",f),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("keydown",f),window.removeEventListener("click",f),r.current&&clearTimeout(r.current)}},[e.eventQueue,e.isActive,d]);const h={...e,startTour:i,endTour:s,nextStep:o,setStep:a,queuePostTourEvent:l,setIsDemoGracePeriod:f=>n(p=>({...p,isDemoGracePeriod:f}))};return u.jsx(rk.Provider,{value:h,children:t})},fu=()=>{const t=R.useContext(rk);if(!t)throw new Error("useTour must be used within a TourProvider");return t},sk={decryptPublicLesson:async(t,e,n)=>{if(!n)throw new Error("User must be authenticated to decrypt lessons.");if(!e)throw new Error("Lesson ID is required for secure decryption.");try{const r=await fetch(j8,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({lessonId:e,data:t})});if(!r.ok){let s=r.statusText;try{const o=await r.json();s=o.error||o.message||s}catch{}throw r.status===401?new Error(`Unauthorized: ${s}`):r.status===403?new Error(`Forbidden: ${s}`):r.status===429?new Error("Rate Limit Exceeded. Please try again later."):new Error(`Decryption Server Error: ${s}`)}const i=await r.json();return i.data||i}catch(r){throw console.error("[DecryptionService] Remote decryption failed:",r),r}}},sm=Object.freeze(Object.defineProperty({__proto__:null,decryptionService:sk},Symbol.toStringTag,{value:"Module"})),b9=()=>{const{user:t,token:e}=Ms(),{showToast:n}=jo(),r=R.useRef(!1),i=R.useCallback(async(s=!1,o=null)=>{var a,l;if(!(!t||!e||r.current)){r.current=!0,console.log(`[EntitlementSync] ${s?"Manual":"Auto"} audit started...`);try{const d=await Un.getEntitlements(t.uid);if(!d||Object.keys(d).length===0){s&&n({message:"No purchased lessons found to restore.",type:"info"}),r.current=!1;return}const h=await In.listLessons({includeDeleted:!0}),f=new Set(h.map(_=>_.id)),p=Object.keys(d).filter(_=>!(d[_].archived||f.has(_)));if(p.length===0){console.log("[EntitlementSync] All clear. No missing lessons."),s&&n({message:"Your library is already up to date.",type:"success"}),r.current=!1;return}console.log(`[EntitlementSync] Found ${p.length} missing lessons. Initiating restore...`,p),s&&n({message:`Restoring ${p.length} purchased lesson(s)...`,type:"info",duration:4e3});const{getPublicFileContent:g}=await yr(()=>import("./publicDrive-5c32f71c.js"),[]);let x=0;for(const _ of p)try{const k=Ho(Ys,"lessons",_),T=await Td(k);if(!T.exists()){console.error(`[EntitlementSync] Cannot restore ${_}: Metadata missing from catalog.`);continue}const v=T.data(),w=v.storagePath||`lessons/${v.type==="premium"?"premium":"free"}/${_}.enc`,j=await g(w);let L;if(typeof j=="string"){const I=await((a=Vr.currentUser)==null?void 0:a.getIdToken(!0));L=await sk.decryptPublicLesson(j,_,I)}else L=j;if(L.id=_,(I=>!I||!I.questions&&!I.cards||I.error)(L))throw new Error("RESTORATION_INTEGRITY_FAILURE: Restored lesson is missing content.");const E=In.getStore(),S=E.get(`meta_${t.uid}`,[]);S.find(I=>I.id===L.id)||(S.push({id:L.id,title:L.title,questionCount:((l=L.questions)==null?void 0:l.length)||0}),E.set(`meta_${t.uid}`,S)),x++,console.log(`[EntitlementSync] Restored ${_} successfully.`)}catch(k){console.error(`[EntitlementSync] Failed to restore ${_}:`,k)}x>0&&o&&await o(),s&&n({message:x>0?`Successfully restored ${x} lesson(s).`:"No lessons were restored.",type:x>0?"success":"info"})}catch(d){console.error("[EntitlementSync] Audit failed:",d),s&&n({message:"Failed to restore purchases. Please try again.",type:"error"})}finally{r.current=!1}}},[t,e,n]);return R.useEffect(()=>{if(!t||!e)return;const s=setTimeout(()=>i(!1),2e3);return()=>clearTimeout(s)},[t,e,i]),{performSync:i}},Zg=(t,e=["image/","audio/"])=>{if(!t||typeof t!="string"||t.toLowerCase().startsWith("javascript:")||t.toLowerCase().startsWith("data:text/html"))return!1;if(t.startsWith("data:")){const n=t.match(/^data:([^;,]+)/);if(!n)return!1;const r=n[1].toLowerCase();if(!e.some(s=>r.startsWith(s)))return!1}return!0},Ea=(t,e=1e4)=>{if(!t||typeof t!="string")return"";let n=t.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"");return n.length>e&&(n=n.substring(0,e)),n},I9=t=>{if(!t||typeof t!="string")return"Untitled";let e=t.replace(/[\x00-\x1F\x7F]/g,"");return e=e.trim(),e.length>50&&(e=e.substring(0,50)),e=e.replace(/[&=?#]/g,""),e||"Untitled"},C9=t=>{if(!t||typeof t!="string")return"";let e=t.substring(0,500);return e=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,""),e=e.replace(/[*_~`]/g,""),e.trim()},k9=t=>!t||typeof t!="string"?!1:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),A9=t=>{if(!t)return{text:"New",isOverdue:!1,color:"inherit"};const e=new Date,i=(new Date(t)-e)/(1e3*60*60*24);if(i<0){const s=Math.ceil(Math.abs(i));return s===0?{text:"Due: Today",isOverdue:!0,color:"#ef4444"}:{text:`Due: ${s} day${s===1?"":"s"} ago`,isOverdue:!0,color:"#ef4444"}}else{const s=Math.ceil(i);return s===0?{text:"Due: Today",isOverdue:!0,color:"#ef4444"}:s===1?{text:"Review: Tomorrow",isOverdue:!1,color:"var(--text-color)"}:{text:`Review: in ${s} days`,isOverdue:!1,color:"var(--text-color)"}}},hS=({lesson:t,onReview:e,onEdit:n,onImport:r,user:i,onDelete:s,showConfirm:o})=>{var f,p,g,x,_,k,T,v,w;const a=I9(t.title),d=(i==null?void 0:i.email)===Ii||!t.isPublic;let h=null;return t.titleImage&&Zg(t.titleImage,["image/"])?h=t.titleImage:(g=(p=(f=t.questions)==null?void 0:f[0])==null?void 0:p.question)!=null&&g.image&&Zg(t.questions[0].question.image,["image/"])?h=t.questions[0].question.image:h=`https://ui-avatars.com/api/?name=${encodeURIComponent(a)}&background=random&color=fff&size=128`,t.loading?u.jsxs("div",{className:"neo-flat lesson-card",style:{height:"100%",position:"relative",overflow:"hidden"},children:[u.jsxs("div",{className:"shimmer-wrapper",children:[u.jsx("div",{className:"shimmer",style:{width:"40px",height:"20px",borderRadius:"12px",marginBottom:"1rem"}}),u.jsx("div",{className:"shimmer",style:{width:"100%",height:"140px",borderRadius:"12px",marginBottom:"1rem"}}),t.title&&t.title!=="Loading..."?u.jsx("div",{style:{marginBottom:"0.5rem",height:"40px",fontWeight:"600",fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.title}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"shimmer",style:{width:"80%",height:"20px",borderRadius:"4px",marginBottom:"0.5rem"}}),u.jsx("div",{className:"shimmer",style:{width:"60%",height:"20px",borderRadius:"4px"}})]})]}),u.jsx("style",{children:`
                    .shimmer-wrapper { padding: 0.5rem; width: 100%; height: 100%; }
                    .shimmer {
                        background: linear-gradient(90deg, var(--bg-color) 0%, var(--neo-shadow-light) 50%, var(--bg-color) 100%);
                        background-size: 200% 100%;
                        animation: shimmer 1.5s infinite;
                    }
                    @keyframes shimmer {
                        0% { background-position: -200% 0; }
                        100% { background-position: 200% 0; }
                    }
                `})]}):u.jsxs("div",{className:"neo-flat lesson-card",id:t.id==="demo-lesson"?"lesson-card-demo-lesson":void 0,onClick:()=>e(t),style:{position:"relative",display:"flex",flexDirection:"column",height:"100%"},children:[d&&u.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:2,display:"flex",gap:"8px"},children:[u.jsx("button",{className:"neo-button icon-btn",onClick:j=>{j.stopPropagation(),n(t)},style:{background:"var(--bg-color)",opacity:.8},title:"Edit Lesson",children:u.jsx(vv,{size:18,color:"var(--accent-color)"})}),u.jsx("button",{className:"neo-button icon-btn",onClick:j=>{j.stopPropagation(),s(t)},style:{background:"var(--bg-color)",opacity:.8,color:"#ef4444"},title:"Delete Lesson",children:u.jsx(mi,{size:18})})]}),u.jsxs("div",{className:"neo-flat",style:{position:"absolute",top:"12px",left:"12px",zIndex:2,display:"flex",alignItems:"center",gap:"4px",fontSize:"0.8rem",fontWeight:"600",padding:"4px 8px",borderRadius:"12px",opacity:.9},children:[u.jsx(Yg,{size:14}),t.questionCount!==void 0?t.questionCount:((x=t.questions)==null?void 0:x.length)||((_=t.cards)==null?void 0:_.length)||0]}),u.jsx("img",{src:h,alt:t.title,style:{width:"100%",height:"140px",objectFit:"contain",borderRadius:"12px",background:"var(--bg-color)"}}),u.jsx("div",{style:{marginTop:"0.8rem"},children:u.jsx("h3",{style:{fontSize:"0.95rem",fontWeight:"600",marginBottom:"0.2rem",display:"-webkit-box",WebkitLineClamp:5,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"1.35",minHeight:"2.7em",textAlign:"left",color:"var(--text-color)",opacity:.9,padding:"0 2px"},title:t.title,children:t.title})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"auto",gap:"1rem",paddingTop:"1rem"},children:[t.isPublic&&u.jsxs("button",{className:`neo-button ${t.isOwned?"owned-btn":""}`,style:{flex:1,padding:"0.6rem",background:t.isOwned?"#16a34a":t.cost>0?"#f59e0b":"var(--accent-color)",color:"white",border:"none",fontSize:"0.85rem",display:"flex",gap:"6px",alignItems:"center",justifyContent:"center",borderRadius:"12px",cursor:t.isOwned?"default":"pointer",opacity:t.isOwned?.9:1},onClick:j=>{j.stopPropagation(),!t.isOwned&&(i?r(t):e(t))},children:[t.isOwned?u.jsx(Yg,{size:14}):i?t.cost>0?u.jsx(yv,{size:14}):u.jsx(Yi,{size:14}):null,t.isOwned?"Owned":i?t.cost>0?`Buy for ${t.cost}`:"Free - Add to My Lessons":"Login with Google to Open"]}),!t.isPublic&&u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.6rem",flex:1,minWidth:0},children:t.lastMarks!==void 0?u.jsxs("div",{className:"neo-flat",style:{padding:"6px 10px",borderRadius:"12px",textAlign:"center",fontSize:"0.8rem",color:"var(--accent-color)",fontWeight:"700"},children:["Marks: ",t.lastMarks,"/",(t.questionCountAtLastReview||((k=t.questions)==null?void 0:k.length)||((T=t.cards)==null?void 0:T.length)||0)*2]}):t.lastSessionIndex!==void 0?u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("div",{className:"neo-inset",style:{height:"6px",width:"100%",borderRadius:"3px",overflow:"hidden",padding:"0"},children:u.jsx("div",{style:{height:"100%",width:`${t.lastSessionIndex/(((v=t.questions)==null?void 0:v.length)||((w=t.cards)==null?void 0:w.length)||1)*100}%`,background:"var(--accent-color)"}})}),u.jsx("button",{className:"neo-button",style:{width:"100%",padding:"0.4rem",fontSize:"0.75rem",fontWeight:"800",background:"var(--accent-color)",color:"white",border:"none",justifyContent:"center"},children:"RESUME"})]}):u.jsx("div",{className:"neo-flat",style:{padding:"6px 10px",borderRadius:"12px",textAlign:"center",fontSize:"0.8rem",opacity:.5,fontWeight:"700"},children:"New"})}),!t.isPublic&&u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center",gap:"0.1rem",fontSize:"0.7rem",opacity:.8,flexShrink:0,textAlign:"right"},children:[t.nextReview&&u.jsx("div",{style:{display:"flex",alignItems:"center",gap:"3px",opacity:.7},children:u.jsx(W8,{size:10})}),u.jsx("div",{id:t.id==="demo-lesson"?"next-review-indicator-demo-lesson":void 0,style:{whiteSpace:"nowrap"},children:u.jsx(R9,{nextReview:t.nextReview})})]})]}),u.jsx("style",{children:`
        .lesson-card:hover { transform: translateY(-5px); }
      `})]})},R9=({nextReview:t})=>{const{text:e,isOverdue:n,color:r}=A9(t);return u.jsx("span",{style:{color:r,fontWeight:n?"700":"600",fontSize:n?"0.85rem":"0.9rem"},children:e})},vr=({label:t,value:e,options:n,onChange:r,placeholder:i="Select...",displayValue:s=l=>l,style:o={},children:a})=>{const[l,d]=R.useState(!1),h=R.useRef(null);return R.useEffect(()=>{const f=p=>{h.current&&!h.current.contains(p.target)&&d(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]),u.jsxs("div",{ref:h,style:{display:"flex",flexDirection:"column",gap:"0.4rem",position:"relative",width:"100%",...o},children:[t&&u.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontWeight:"600",marginLeft:"4px"},children:t}),u.jsxs("button",{className:"neo-select",style:{textAlign:"left",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",width:"100%",position:"relative",height:"48px"},onClick:()=>d(!l),children:[u.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e?s(e):i}),u.jsx(G8,{size:18,style:{transform:l?"rotate(180deg)":"none",transition:"transform 0.3s",marginLeft:"8px",flexShrink:0}})]}),l&&u.jsxs("div",{className:"neo-flat neo-popup",style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"8px",zIndex:1e3,padding:"8px",display:"flex",flexDirection:"column",gap:"4px",maxHeight:"300px",overflowY:"auto",boxShadow:"10px 10px 20px var(--shadow-dark), -10px -10px 20px var(--shadow-light)"},children:[a,n.map((f,p)=>{const g=e===f.value;return u.jsx("button",{className:`neo-button ${g?"neo-inset":""}`,style:{padding:"10px 14px",fontSize:"0.9rem",cursor:"pointer",boxShadow:g?"inset 2px 2px 5px var(--shadow-dark), inset -2px -2px 5px var(--shadow-light)":"none",background:g?"var(--accent-soft)":"transparent",border:"none",borderRadius:"8px",width:"100%",textAlign:"left",justifyContent:"flex-start",color:g?"var(--accent-color)":"var(--text-color)",fontWeight:g?"700":"500"},onClick:()=>{r(f.value),d(!1)},children:f.label},p)})]})]})},P9=({activeTab:t,setActiveTab:e,lessons:n,publicLessons:r,loading:i,publicLoading:s,onReview:o,onEdit:a,onImport:l,searchQuery:d,setSearchQuery:h,onShowFeedback:f,filters:p,setFilters:g,user:x,onLogin:_,sortBy:k,onSortChange:T,filterLabel:v,onLabelChange:w,availableLabels:j,onShowKnowMore:L,onDelete:V,showConfirm:E,onAddLesson:S,onRefresh:I})=>{const{isActive:A,startTour:P}=fu(),{error:N,isReady:b,user:W}=Ms(),de=t==="my-lessons"?i:s,re=t==="my-lessons"&&!i&&!x&&!A,[se,z]=R.useState(!1),G=lr.useRef(null),M=lr.useMemo(()=>{const $={standards:new Set,syllabuses:new Set,mediums:new Set,subjects:new Set};return r.forEach(ae=>{ae.standard&&$.standards.add(ae.standard),ae.syllabus&&$.syllabuses.add(ae.syllabus),ae.medium&&$.mediums.add(ae.medium),ae.subject&&$.subjects.add(ae.subject)}),{standards:Array.from($.standards).sort(),syllabuses:Array.from($.syllabuses).sort(),mediums:Array.from($.mediums).sort(),subjects:Array.from($.subjects).sort()}},[r]),{standards:D,syllabuses:H,mediums:J,subjects:te}=M,ie=new Set(n.map($=>$.lessonId||$.storagePath||$.driveFileId||$.id)),ee=r.filter($=>{if(!$||!$.title)return!1;const ae=d.toLowerCase().trim(),ke=/^\d+\.$/.test(ae),Ge=$.title.toLowerCase(),Ye=ke?new RegExp(`(^|\\s)${ae.replace(".","\\.")}(\\s|$)`).test(Ge):Ge.includes(ae),Xe=!p.standard||$.standard===p.standard,dt=!p.syllabus||$.syllabus===p.syllabus,Ne=!p.medium||$.medium===p.medium,He=!p.subject||$.subject===p.subject;return Ye&&Xe&&dt&&Ne&&He}).map($=>({...$,isOwned:ie.has($.lessonId||$.storagePath||$.id)})).sort(($,ae)=>k==="Title"?$.title.localeCompare(ae.title):(parseInt(ae.id||0)||0)-(parseInt($.id||0)||0)),U=t==="my-lessons"?n:ee,Y=($,ae)=>{g(ke=>({...ke,[$]:ae}))},pe=()=>u.jsxs("div",{style:{position:"relative",display:"inline-flex"},ref:G,children:[u.jsx("button",{className:`icon-btn ${se?"active":""}`,onClick:$=>{$.stopPropagation(),z(!se)},style:{background:"none",border:"none",boxShadow:"none",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)",cursor:"pointer",opacity:.6,padding:0},title:"Settings",children:se?u.jsx(cn,{size:20}):u.jsx(XC,{size:20})}),se&&u.jsxs("div",{className:"neo-flat settings-dropdown neo-popup",style:{position:"absolute",top:"calc(100% + 10px)",right:0,width:"280px",padding:"2rem 1.5rem",zIndex:2e3,borderRadius:"24px",display:"flex",flexDirection:"column",gap:"1.75rem"},children:[u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem"},children:u.jsxs("div",{style:{position:"relative"},children:[u.jsx(Xg,{size:16,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",opacity:.5}}),u.jsx("input",{className:"neo-input",placeholder:"Search...",value:d,onChange:$=>h($.target.value),style:{width:"100%",paddingLeft:"38px",fontSize:"0.9rem",height:"44px",boxShadow:"inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light)"}})]})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:700,opacity:.5,marginLeft:"4px"},children:"Sort By"}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem"},children:(t==="my-lessons"?[{label:"Date",value:"Creation Date"},{label:"Title",value:"Title"},{label:"Marks",value:"Average Rating"},{label:"Reviews",value:"Upcoming Review"}]:[{label:"Newest",value:"Creation Date"},{label:"Title",value:"Title"}]).map($=>u.jsx("button",{className:`neo-button ${k===$.value?"neo-glow-blue":""}`,onClick:()=>T($.value),style:{padding:"0.6rem 0.4rem",fontSize:"0.8rem",borderRadius:"10px",justifyContent:"center"},children:$.label},$.value))})]}),u.jsxs("button",{className:"neo-button",onClick:()=>{I==null||I(),z(!1)},style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",padding:"0.9rem",borderRadius:"14px"},children:[u.jsx(Mc,{size:18})," Refresh Lessons"]})]})]}),_e=()=>u.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"2rem",gap:"0.5rem",alignItems:"center"},children:u.jsxs("div",{id:"tabs-container",className:"neo-tabs-container",style:{margin:0},children:[u.jsx("button",{id:"tab-my-lessons",className:`neo-tab-item ${t==="my-lessons"?"active":""}`,onClick:()=>e("my-lessons"),children:"My Lessons"}),u.jsx("button",{id:"tab-lessons",className:`neo-tab-item ${t==="lessons"?"active":""}`,onClick:()=>e("lessons"),children:"Lessons"})]})}),ge=()=>{const $=[{label:"All Labels",value:null},...j.map(ae=>({label:ae,value:ae}))];return u.jsxs("div",{style:{marginBottom:"2rem",padding:"0 0.5rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginLeft:"4px",paddingRight:"10px"},children:[u.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontWeight:"600"},children:"Filter by Label"}),pe()]}),u.jsx(vr,{value:v,options:$,onChange:w,placeholder:"All Labels",displayValue:ae=>ae||"All Labels"})]})},Ae=()=>u.jsxs("div",{className:"filter-bar neo-inset",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(130px, 1fr))",gap:"1.25rem",padding:"1.25rem",paddingTop:"2.5rem",marginBottom:"2.5rem",borderRadius:"20px",position:"relative"},children:[u.jsx("div",{style:{position:"absolute",top:"12px",right:"10px",zIndex:10},children:pe()}),u.jsx(vr,{label:"Medium",value:p.medium,options:[{label:"All Mediums",value:""},...J.map($=>({label:$,value:$}))],onChange:$=>Y("medium",$),placeholder:"All Mediums",displayValue:$=>$||"All Mediums"}),u.jsx(vr,{label:"Syllabus",value:p.syllabus,options:[{label:"All Syllabuses",value:""},...H.map($=>({label:$,value:$}))],onChange:$=>Y("syllabus",$),placeholder:"All Syllabuses",displayValue:$=>$||"All Syllabuses"}),u.jsx(vr,{label:"Standard",value:p.standard,options:[{label:"All Standards",value:""},...D.map($=>({label:`Standard ${$}`,value:$}))],onChange:$=>Y("standard",$),placeholder:"All Standards",displayValue:$=>$?`Standard ${$}`:"All Standards"}),u.jsx(vr,{label:"Subject",value:p.subject,options:[{label:"All Subjects",value:""},...te.map($=>({label:$,value:$}))],onChange:$=>Y("subject",$),placeholder:"All Subjects",displayValue:$=>$||"All Subjects"})]});return u.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[(!re||de)&&u.jsxs(u.Fragment,{children:[_e(),t==="my-lessons"&&ge(),t==="lessons"&&Ae()]}),re&&!de&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"3rem 1rem",textAlign:"center",minHeight:"50vh"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem",marginBottom:"1rem"},children:[u.jsxs("h1",{style:{fontSize:"clamp(2.5rem, 8vw, 3.5rem)",fontWeight:"800",lineHeight:"1.1",color:"#4f46e5",margin:0},children:["Study smarter.",u.jsx("br",{}),"Remember longer."]}),u.jsxs("p",{style:{fontSize:"clamp(1rem, 3vw, 1.15rem)",fontWeight:"500",opacity:.9,marginTop:"1.5rem",maxWidth:"650px",margin:"1.5rem auto 0 auto",lineHeight:"1.7",padding:"0 10px"},children:["Powered by scientifically proven strategies such as spaced repetition and active recall, this app makes learning easier and helps you remember longer.",u.jsx("button",{onClick:L,style:{background:"rgba(79, 70, 229, 0.1)",border:"none",color:"#4f46e5",cursor:"pointer",padding:"2px 8px",fontSize:"0.8rem",fontWeight:"700",display:"inline-block",marginLeft:"8px",borderRadius:"6px",verticalAlign:"middle",boxShadow:"inset 1px 1px 2px rgba(255,255,255,0.5), inset -1px -1px 2px rgba(0,0,0,0.05)"},children:"know more"})]})]}),u.jsxs("div",{className:"hero-cta-container",children:[u.jsxs("div",{className:"hero-btn-group",children:[u.jsx("button",{className:"hero-btn primary-btn",onClick:P,children:"Beginners Guide"}),W&&!(x!=null&&x.hasDrive)?u.jsxs("button",{className:"hero-btn primary-btn neo-glow-blue",onClick:()=>_("consent"),style:{background:"var(--accent-color)",color:"white"},children:[u.jsx(Mc,{size:20,className:i?"spin":""}),"Complete Sync Setup"]}):W?null:u.jsx("button",{className:"hero-btn hero-btn-google",onClick:()=>_("consent"),style:{color:"var(--text-color)"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",whiteSpace:"nowrap"},children:["Continue with",u.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"1px",fontWeight:"700",fontSize:"1.2rem",letterSpacing:"-0.02em",marginLeft:"2px"},children:[u.jsx("span",{style:{color:"#4285F4"},children:"G"}),u.jsx("span",{style:{color:"#EA4335"},children:"o"}),u.jsx("span",{style:{color:"#FBBC05"},children:"o"}),u.jsx("span",{style:{color:"#4285F4"},children:"g"}),u.jsx("span",{style:{color:"#34A853"},children:"l"}),u.jsx("span",{style:{color:"#EA4335"},children:"e"})]})]})})]}),N&&u.jsxs("div",{style:{padding:"1rem",background:"var(--error-soft)",borderRadius:"16px",border:"1px solid var(--error-color)",color:"var(--error-color)",fontSize:"0.85rem",marginTop:"1rem",maxWidth:"350px",textAlign:"left"},children:[u.jsx("strong",{children:"Connectivity Notice:"})," ",N]})]})]}),u.jsxs("div",{style:{padding:"0 1rem",maxWidth:"1200px",margin:"0 auto",width:"100%"},children:[u.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"2rem",position:"relative",minHeight:"48px"},children:u.jsx("h2",{className:"responsive-heading",style:{fontSize:"2rem",fontWeight:"800",color:"var(--accent-color)",flex:1},children:"Lessons"})}),Ae(),s?u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem"},children:[u.jsxs("div",{className:"card-loader-container",children:[u.jsx("div",{className:"card-loader-item"}),u.jsx("div",{className:"card-loader-item"}),u.jsx("div",{className:"card-loader-item"})]}),u.jsx("p",{style:{marginTop:"1rem",opacity:.6,fontSize:"0.9rem",fontWeight:500},children:"Loading lessons..."})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"lessons-grid",style:{padding:"0 1.25rem"},children:ee.map($=>u.jsx(hS,{lesson:$,onReview:o,onEdit:a,onImport:l,user:x,onDelete:V,showConfirm:E},$.driveFileId||$.id))}),ee.length===0&&u.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem 2rem",textAlign:"center",gap:"2rem"},children:u.jsxs("div",{style:{maxWidth:"500px",display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem"},children:[u.jsx("div",{className:"neo-flat",style:{padding:"2rem",borderRadius:"24px",opacity:.8},children:u.jsx(rs,{size:64,color:"var(--accent-color)"})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("h3",{style:{fontSize:"1.4rem"},children:"No lessons found"}),u.jsx("p",{style:{opacity:.7},children:"This filter does not have any files. You can request lessons to the developer via the feedback option."})]}),u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:f,style:{padding:"0.8rem 2rem",gap:"8px"},children:[u.jsx(rs,{size:18})," Request Lessons"]})]})})]})]})]}),de?u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem"},children:[u.jsxs("div",{className:"card-loader-container",children:[u.jsx("div",{className:"card-loader-item"}),u.jsx("div",{className:"card-loader-item"}),u.jsx("div",{className:"card-loader-item"})]}),u.jsx("p",{style:{marginTop:"1rem",opacity:.6,fontSize:"0.9rem",fontWeight:500},children:"Loading lessons..."})]}):!re&&u.jsxs(u.Fragment,{children:[U.length===0&&t==="my-lessons"&&u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem 2rem",textAlign:"center",gap:"2rem"},children:[u.jsx("div",{className:"neo-flat",style:{padding:"3rem",borderRadius:"32px"},children:u.jsx("img",{src:gv,alt:"Welcome",style:{width:"120px",height:"auto"}})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("h3",{style:{fontSize:"1.4rem"},children:"Welcome to Chethan in Cardland!"}),u.jsx("p",{style:{opacity:.7},children:"You don't have any lessons yet. Create your own or explore our Lessons collection."})]}),u.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",justifyContent:"center"},children:[u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:S,style:{padding:"0.8rem 2rem",gap:"8px"},children:[u.jsx(Yi,{size:18})," Create New Lesson"]}),u.jsxs("button",{className:"neo-button",onClick:()=>e("lessons"),style:{padding:"0.8rem 2rem",gap:"8px"},children:[u.jsx(Xg,{size:18})," Browse Lessons"]})]})]}),U.length===0&&t==="lessons"&&u.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem 2rem",textAlign:"center",gap:"2rem"},children:u.jsxs("div",{style:{maxWidth:"500px",display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem"},children:[u.jsx("div",{className:"neo-flat",style:{padding:"2rem",borderRadius:"24px",opacity:.8},children:u.jsx(rs,{size:64,color:"var(--accent-color)"})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("h3",{style:{fontSize:"1.4rem"},children:"No lessons found"}),u.jsx("p",{style:{opacity:.7},children:"This filter does not have any files. You can request lessons to the developer via the feedback option."})]}),u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:f,style:{padding:"0.8rem 2rem",gap:"8px"},children:[u.jsx(rs,{size:18})," Request Lessons"]})]})}),U.length>0&&u.jsx("div",{className:"lessons-grid",children:U.map($=>u.jsx(hS,{lesson:$,onReview:o,onEdit:a,onImport:l,user:x,onDelete:V,showConfirm:E},$.driveFileId||$.id))})]})]})},N9=({coins:t,isUnlimited:e})=>u.jsxs("div",{className:"neo-inset",style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 12px",borderRadius:"20px",color:"#FFB800",fontWeight:"800",marginRight:"8px",position:"relative"},children:[u.jsx(yv,{size:18,fill:"currentColor"}),u.jsx("span",{style:{opacity:e?.5:1},children:t}),e&&u.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255, 255, 255, 0.9)",borderRadius:"10px",padding:"0 4px",color:"#8b5cf6",fontSize:"1.2rem",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:""})]}),D9=({user:t,userProfile:e,isUnlimited:n,isAdmin:r,isTourActive:i,onShowCoinModal:s,onShowMenu:o,onAddLesson:a,onLogin:l,isProfileLoading:d,headerLoading:h,children:f})=>{const{headerNotice:p,clearHeaderNotice:g,toast:x,hideToast:_,notification:k,clearNotification:T}=jo();return lr.useEffect(()=>{if(x&&x.duration){const v=setTimeout(()=>{_()},x.duration);return()=>clearTimeout(v)}},[x,_]),u.jsxs("div",{className:"app-layout",children:[u.jsx("header",{className:"main-header",style:{position:"relative"},children:u.jsx(kn,{mode:"wait",children:h?u.jsx(Ue.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{position:"absolute",left:"1rem",right:"1rem",top:"0.5rem",bottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--bg-color)",zIndex:10,borderRadius:"16px",boxShadow:"5px 5px 10px var(--shadow-dark), -5px -5px 10px var(--shadow-light)"},children:u.jsxs("div",{className:"card-loader-small",children:[u.jsx("div",{className:"card-loader-item-small"}),u.jsx("div",{className:"card-loader-item-small"}),u.jsx("div",{className:"card-loader-item-small"})]})},"loader"):k?u.jsxs(Ue.div,{className:k.type==="confirm"?"neo-glow-header-confirm":"neo-glow-blue",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{position:"absolute",left:"1rem",right:"1rem",top:"0.5rem",bottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"space-between",zIndex:11,borderRadius:"16px",padding:"0 1rem"},children:[u.jsx("span",{style:{fontWeight:"700",fontSize:"0.95rem",color:"var(--text-color)",flex:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:k.message}),u.jsx("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center"},children:k.type==="confirm"?u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"neo-button",onClick:v=>{v.stopPropagation(),k.onConfirm&&k.onConfirm(),T()},style:{padding:"0.4rem 1.2rem",fontSize:"0.85rem",fontWeight:"800",height:"auto",minHeight:"unset",background:"var(--accent-color)",color:"white",border:"none",boxShadow:"0 4px 12px rgba(var(--accent-rgb), 0.4)"},children:"Confirm"}),u.jsx("button",{className:"neo-button icon-btn",onClick:v=>{v.stopPropagation(),T()},style:{padding:"4px",width:"28px",height:"28px",minWidth:"28px",background:"var(--bg-color)",border:"none",boxShadow:"2px 2px 5px var(--shadow-dark), -2px -2px 5px var(--shadow-light)"},children:u.jsx(cn,{size:14,color:"#ef4444"})})]}):u.jsx("button",{className:"neo-button",onClick:v=>{v.stopPropagation(),T()},style:{padding:"0.4rem 1rem",fontSize:"0.85rem",fontWeight:"700",height:"auto",minHeight:"unset",color:"var(--accent-color)"},children:"Got it"})})]},"notification"):p?u.jsxs(Ue.div,{className:"neo-glow-header",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{position:"absolute",left:"1rem",right:"1rem",top:"0.5rem",bottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)",zIndex:10,borderRadius:"16px",fontWeight:"700",fontSize:"1rem",padding:"0 1.5rem",textAlign:"center"},children:[u.jsx("span",{children:p.message}),u.jsx("button",{className:"neo-button icon-btn",onClick:v=>{v.stopPropagation(),g()},style:{position:"absolute",right:"0.5rem",padding:"4px",width:"28px",height:"28px",minWidth:"28px",background:"var(--bg-color)",display:"flex",alignItems:"center",justifyContent:"center",border:"none",boxShadow:"2px 2px 5px var(--shadow-dark), -2px -2px 5px var(--shadow-light)"},children:u.jsx(cn,{size:14,color:"#ef4444"})})]},"notice"):u.jsxs(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("img",{src:gv,alt:"Chethan",className:"app-logo"}),u.jsxs("div",{className:"header-actions",children:[t&&u.jsx("div",{onClick:s,style:{display:"flex",alignItems:"center",gap:"4px"},children:u.jsx(N9,{coins:(e==null?void 0:e.coins)||0,isUnlimited:n})}),u.jsx("button",{className:"neo-button icon-btn",onClick:o,children:u.jsx(YC,{size:24})})]})]},"content")})}),u.jsxs("div",{className:"app-container",children:[u.jsx("main",{className:"main-content",children:f}),(t||i)&&u.jsx("button",{id:"fab-add-lesson",className:"neo-button neo-glow-blue fab-add-button",onClick:a,children:u.jsx(Yi,{size:32})})]}),u.jsx("style",{children:`
                .app-layout {
                    display: flex;
                    flex-direction: column;
                    height: 100dvh;
                    overflow: hidden;
                    background: var(--bg-color);
                }
                .main-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 1rem 1.5rem;
                    background: var(--bg-color);
                    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
                    z-index: 1000;
                    position: sticky;
                    top: 0;
                }
                .header-actions {
                    display: flex;
                    gap: 0.75rem;
                    align-items: center;
                }
                .app-logo {
                    height: 4.5rem;
                    width: auto;
                    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
                }
                .main-content {
                    flex: 1;
                    padding-bottom: 5rem; /* Space for FAB */
                }
                
                @media (max-width: 480px) {
                    .main-header {
                        padding: 0.75rem 1rem;
                    }
                    .app-logo {
                        height: 3.5rem;
                    }
                }
            `})]})},Zr=({onClick:t,style:e,size:n=20,className:r=""})=>u.jsx("button",{onClick:t,className:`neo-button ${r}`,style:{width:"36px",height:"36px",padding:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#ef4444",background:"var(--bg-color)",borderRadius:"12px",border:"none",cursor:"pointer",boxShadow:"4px 4px 8px var(--shadow-dark), -4px -4px 8px var(--shadow-light), 0 0 4px rgba(239, 68, 68, 0.2)",transition:"all 0.2s ease",...e},onMouseEnter:i=>{i.currentTarget.style.boxShadow="4px 4px 8px var(--shadow-dark), -4px -4px 8px var(--shadow-light), 0 0 8px rgba(239, 68, 68, 0.4)",i.currentTarget.style.transform="scale(1.05)"},onMouseLeave:i=>{i.currentTarget.style.boxShadow="4px 4px 8px var(--shadow-dark), -4px -4px 8px var(--shadow-light), 0 0 4px rgba(239, 68, 68, 0.2)",i.currentTarget.style.transform="scale(1)"},title:"Close",children:u.jsx(cn,{size:n})}),j9=({user:t,theme:e,onToggleTheme:n,soundsEnabled:r,onToggleSounds:i,onShowFeedback:s,onClose:o,onLogout:a,onLogin:l,onDeleteData:d,onShowAdminPanel:h,onShowReferral:f,onShowTour:p,onRestorePurchases:g,appVersion:x})=>{const[_,k]=R.useState(!!document.fullscreenElement);lr.useEffect(()=>{const v=()=>k(!!document.fullscreenElement);return document.addEventListener("fullscreenchange",v),()=>document.removeEventListener("fullscreenchange",v)},[]);const T=()=>{window.confirm("Check for updates? This will refresh the page.")&&window.location.reload(!0)};return u.jsxs("div",{className:"fixed inset-0",style:{position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:5e3,pointerEvents:"none",display:"flex",justifyContent:"flex-end"},children:[u.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.3)",backdropFilter:"blur(4px)",pointerEvents:"auto"},onClick:o}),u.jsxs("div",{className:"relative w-80 h-full bg-white dark:bg-gray-800 shadow-2xl p-6 flex flex-col gap-6 overflow-y-auto",style:{position:"relative",width:"320px",height:"100%",background:"var(--bg-color)",boxShadow:"-5px 0 25px rgba(0,0,0,0.1)",padding:"2rem",paddingBottom:"2rem",display:"flex",flexDirection:"column",gap:"1.25rem",pointerEvents:"auto",borderLeft:"1px solid var(--border-color)",animation:"slideIn 0.3s ease-out",overflowY:"auto",WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",touchAction:"pan-y"},onClick:v=>v.stopPropagation(),children:[u.jsxs("div",{className:"flex justify-between items-center",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"700",margin:0},children:"Menu"}),u.jsx(Zr,{onClick:o})]}),t?u.jsxs("div",{className:"neo-card flex items-center gap-3 p-3",style:{padding:"1rem",display:"flex",alignItems:"center",gap:"1rem"},children:[u.jsxs("div",{style:{position:"relative",width:"48px",height:"48px",flexShrink:0},children:[t.picture?u.jsx("img",{src:t.picture,alt:t.name,style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"},onError:v=>{v.target.style.display="none",v.target.nextSibling.style.display="flex"}}):null,u.jsx("div",{style:{width:"100%",height:"100%",borderRadius:"50%",background:"var(--accent-soft)",display:t.picture?"none":"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)"},children:u.jsx(Ad,{size:24})})]}),u.jsxs("div",{style:{overflow:"hidden",flex:1},children:[u.jsx("div",{style:{fontWeight:"600",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),u.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-color)",opacity:.6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.email})]})]}):u.jsxs("button",{className:"neo-button",style:{width:"100%",padding:"0.75rem 1rem",display:"flex",alignItems:"center",gap:"1rem",textAlign:"left"},onClick:()=>{o(),l()},children:[u.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"var(--bg-secondary)"},children:u.jsx(Ad,{size:20})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[u.jsx("span",{style:{fontWeight:"600",fontSize:"1rem"},children:"Guest User"}),u.jsx("span",{style:{fontSize:"0.75rem",opacity:.8},children:"Sign in to save progress"})]})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{children:e==="dark"?"Eye Care On":"Eye Care Off"}),u.jsx("button",{className:`neo-button icon-btn ${e==="dark"?"neo-glow-blue":""}`,onClick:n,children:e==="dark"?u.jsx(QC,{size:20}):u.jsx(KC,{size:20})})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{children:r?"Sounds On":"Sounds Off"}),u.jsx("button",{className:`neo-button icon-btn ${r?"neo-glow-blue":""}`,onClick:i,children:r?u.jsx(m9,{size:20}):u.jsx(g9,{size:20})})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{children:"Full Screen"}),u.jsx("button",{className:`neo-button icon-btn ${_?"neo-glow-blue":""}`,onClick:()=>{_?document.exitFullscreen():document.documentElement.requestFullscreen().catch(v=>console.error(v))},children:_?u.jsx(i9,{size:20}):u.jsx(n9,{size:20})})]}),u.jsx("div",{style:{flex:1}}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(t==null?void 0:t.email)===Ii&&u.jsxs("button",{className:"neo-button neo-glow-blue",style:{width:"100%",color:"var(--accent-color)",fontWeight:"bold"},onClick:h,children:[u.jsx(XC,{size:18})," Admin Panel"]}),u.jsxs("button",{className:"neo-button",style:{width:"100%",color:"var(--accent-color)"},onClick:s,children:[u.jsx(rs,{size:18})," Help/Feedback"]}),t&&u.jsxs("button",{className:"neo-button",style:{width:"100%",color:"#f59e0b"},onClick:f,children:[u.jsx(ZC,{size:18})," Refer a Friend"]}),t?u.jsxs(u.Fragment,{children:[u.jsxs("button",{className:"neo-button",style:{width:"100%",color:"#8b5cf6"},onClick:p,children:[u.jsx(JC,{size:18})," Beginner's Guide"]}),u.jsxs("button",{className:"neo-button",style:{width:"100%",color:"var(--accent-color)"},onClick:()=>{o(),g()},children:[u.jsx(ic,{size:18})," Restore Purchased"]}),u.jsxs("button",{className:"neo-button",style:{width:"100%"},onClick:a,children:[u.jsx(t9,{size:18})," Logout"]}),u.jsxs("button",{className:"neo-button neo-glow-red",style:{width:"100%",color:"var(--error-color)"},onClick:d,children:[u.jsx(mi,{size:18})," Delete Data"]})]}):u.jsxs("button",{className:"neo-button neo-glow-blue",style:{width:"100%",backgroundColor:"var(--accent-color)",color:"white"},onClick:()=>{o(),l()},children:[u.jsx(Ad,{size:18})," Sign in with Google"]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",marginTop:"0.5rem",opacity:.5},children:[u.jsxs("span",{style:{fontSize:"0.7rem",fontWeight:"500"},children:["v",x]}),u.jsx("button",{onClick:T,style:{background:"none",border:"none",color:"var(--accent-color)",fontSize:"0.65rem",textDecoration:"underline",cursor:"pointer",padding:"4px"},children:"Check for updates"})]})]}),u.jsx("style",{children:`
            @keyframes slideIn {
                from { transform: translateX(100%); }
                to { transform: translateX(0); }
            }
            `})]})},Vi=(t,e)=>{if(!e)return"";const n=String(e).trim();switch(t){case"standard":const r=n.toUpperCase().replace(/^(STANDARD|STD|CLASS|GRADE)\s*/i,"");return{5:"V",V:"V",6:"VI",VI:"VI",7:"VII",VII:"VII",8:"VIII",VIII:"VIII",9:"IX",IX:"IX",10:"X",X:"X"}[r]||r;case"syllabus":const s=n.toUpperCase();return s.includes("NCERT")?"NCERT":s.includes("KERALA")?"Kerala":n;case"medium":const o=n.toLowerCase();return o.includes("malayalam")?"Malayalam":o.includes("english")?"English":n.charAt(0).toUpperCase()+n.slice(1);case"subject":const a=n.toLowerCase();return a.includes("math")?"Maths":a.includes("social")?"Social Science":a.includes("science")?"Science":a.includes("malayalam")?"Malayalam":a.includes("hindi")?"Hindi":a.includes("english")?"English":n.charAt(0).toUpperCase()+n.slice(1);default:return n}},L9=t=>{if(!t||!t.trim())return{title:"",label:"",importantNote:"",questions:[],sections:[]};let e=null,n="",r="",i="",s=[],o="",a="",l="",d="",h=0,f=[];try{const _=t.match(/\[[\s\S]*\]|\{[\s\S]*\}/);_&&(e=JSON.parse(_[0]))}catch{}if(e)Array.isArray(e)?s=e:(n=e.title||"",r=e.label||e.tag||"",i=e.importantNote||e.note||"",o=Vi("standard",e.standard||e.Standard),a=Vi("syllabus",e.syllabus||e.Syllabus),l=Vi("medium",e.medium||e.Medium),d=Vi("subject",e.subject||e.Subject),h=e.cost||e.Cost||0,f=e.sections||[],s=e.questions||e.cards||[]);else{const _=t.match(/^(?:Title|Lesson Title|Stack Title|Name):\s*(.*)$/im),k=t.match(/^(?:Label|Category|Tag):\s*(.*)$/im),T=t.match(/^(?:Important Note|Note|Description):\s*(.*)$/im);n=_?_[1].trim():"",r=k?k[1].trim():"",i=T?T[1].trim():"";const v=t.match(/^(?:Standard|Class|Grade):\s*(.*)$/im),w=t.match(/^(?:Syllabus|Board):\s*(.*)$/im),j=t.match(/^(?:Medium|Language):\s*(.*)$/im),L=t.match(/^(?:Subject):\s*(.*)$/im),V=t.match(/^(?:Cost|Coins|Price):\s*(\d+)$/im);o=Vi("standard",v?v[1].trim():""),a=Vi("syllabus",w?w[1].trim():""),l=Vi("medium",j?j[1].trim():""),d=Vi("subject",L?L[1].trim():""),h=V?parseInt(V[1],10):0,t.split(/(?=Q:|Question:|Q\d+:|Question \d+:)/i).forEach(S=>{if(!S.trim())return;const I=S.match(/(?:Q:|Question:|Q\d+:|Question \d+:)\s*([\s\S]*?)(?=A:|Answer:|A\d+:|Answer \d+:|$)/i),A=S.match(/(?:A:|Answer:|A\d+:|Answer \d+:)\s*([\s\S]*?)(?=Q:|Question:|Q\d+:|Question \d+:|$)/i);I&&A&&s.push({question:I[1].trim(),answer:A[1].trim()})})}const p=_=>{var V,E,S,I;const k=_.choices||_.options||[],T=_.type==="mcq"||k&&Array.isArray(k)&&k.length>0,v=T?"mcq":"flashcard";let w=[];if(T){const A=_.correctAnswer||_.answer;w=k.map((P,N)=>{const b=typeof P=="string"?P:P.text||"";let W=!1;return typeof A=="number"?W=N===A:typeof P=="object"&&P.isCorrect!==void 0?W=P.isCorrect:A&&(W=b.trim().toLowerCase()===String(A).trim().toLowerCase()),{id:Math.random(),text:b,isCorrect:W}})}const j=()=>{var A;return typeof _.question=="string"?_.question:typeof _.question=="object"&&((A=_.question)!=null&&A.text)?_.question.text:typeof _.q=="string"?_.q:""},L=()=>{var A;return typeof _.answer=="string"?_.answer:typeof _.answer=="object"&&((A=_.answer)!=null&&A.text)?_.answer.text:typeof _.a=="string"?_.a:""};return{id:Math.random(),type:v,question:{text:j(),image:((V=_.question)==null?void 0:V.image)||"",audio:((E=_.question)==null?void 0:E.audio)||""},answer:{text:L(),image:((S=_.answer)==null?void 0:S.image)||"",audio:((I=_.answer)==null?void 0:I.audio)||""},options:w}},g=f.map(_=>({noteSegment:_.noteSegment||"",questions:(_.questions||_.cards||[]).map(p)})),x=g.length>0?g.flatMap(_=>_.questions):s.map(p);return{title:n,label:r,importantNote:i,standard:o,syllabus:a,medium:l,subject:d,cost:parseInt(h)||0,sections:g,questions:x,cards:x}},om=t=>{if(!t)return t;const e=i=>{var f,p,g,x;if(i.question&&typeof i.question=="object"&&"text"in i.question)return i;const s=i.choices||i.options||[],o=i.type==="mcq"||s&&Array.isArray(s)&&s.length>0,a=o?"mcq":"flashcard";let l=[];if(o){const _=i.correctAnswer||(typeof i.answer=="string"?i.answer:null);l=s.map((k,T)=>{const v=typeof k=="string"?k:k.text||"";let w=!1;return typeof _=="number"?w=T===_:typeof k=="object"&&k.isCorrect!==void 0?w=k.isCorrect:_&&(w=v.trim().toLowerCase()===String(_).trim().toLowerCase()),{id:i.id?`${i.id}-opt-${T}`:Math.random(),text:v,isCorrect:w}})}const d=()=>{var _;return typeof i.question=="string"?i.question:typeof i.question=="object"&&((_=i.question)!=null&&_.text)?i.question.text:typeof i.q=="string"?i.q:""},h=()=>{var _;return typeof i.answer=="string"?i.answer:typeof i.answer=="object"&&((_=i.answer)!=null&&_.text)?i.answer.text:typeof i.a=="string"?i.a:""};return{id:i.id||Math.random(),type:a,question:{text:d(),image:((f=i.question)==null?void 0:f.image)||"",audio:((p=i.question)==null?void 0:p.audio)||""},answer:{text:h(),image:((g=i.answer)==null?void 0:g.image)||"",audio:((x=i.answer)==null?void 0:x.audio)||""},options:l,lastRating:i.lastRating}};let n=[],r=[];return t.sections&&Array.isArray(t.sections)&&t.sections.length>0?(n=t.sections.map((i,s)=>{const o=i.noteSegment||"",a=(i.questions||i.cards||[]).map((l,d)=>({...e(l),sectionIndex:s,sectionNoteSegment:o,isFirstInSection:d===0&&o}));return{noteSegment:o,questions:a}}),r=n.flatMap(i=>i.questions)):(t.questions||t.cards)&&(r=(t.questions||t.cards||[]).map(e)),{...t,sections:n,questions:r,cards:r}},ok=({imageUrl:t,onClose:e})=>{const[n,r]=R.useState(1),[i,s]=R.useState(0),[o,a]=R.useState({x:0,y:0}),l=()=>{r(g=>Math.min(g+.5,5))},d=()=>{const g=Math.max(n-.5,.5);r(g),g<=1&&a({x:0,y:0})},h=()=>{s(g=>(g+90)%360)},f=()=>{r(1),s(0),a({x:0,y:0})},p=(g,x)=>{n>1&&a({x:o.x+x.offset.x,y:o.y+x.offset.y})};return u.jsxs(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"image-viewer-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.95)",zIndex:9999,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"2rem",overflow:"hidden"},onClick:e,children:[u.jsxs("div",{style:{position:"absolute",top:"1rem",right:"1rem",display:"flex",gap:"0.5rem",zIndex:1e4},onClick:g=>g.stopPropagation(),children:[u.jsx("button",{className:"neo-button icon-btn",onClick:l,title:"Zoom In",style:{background:"var(--bg-color)"},children:u.jsx(v9,{size:20})}),u.jsx("button",{className:"neo-button icon-btn",onClick:d,title:"Zoom Out",style:{background:"var(--bg-color)"},children:u.jsx(x9,{size:20})}),u.jsx("button",{className:"neo-button icon-btn",onClick:h,title:"Rotate",style:{background:"var(--bg-color)"},children:u.jsx(l9,{size:20})}),u.jsx("button",{className:"neo-button icon-btn",onClick:f,title:"Reset",style:{background:"var(--bg-color)",fontSize:"0.8rem",padding:"8px 12px"},children:"Reset"}),u.jsx(Zr,{onClick:e,size:20})]}),u.jsxs("div",{style:{position:"absolute",bottom:"2rem",left:"50%",transform:"translateX(-50%)",background:"var(--bg-color)",padding:"0.5rem 1rem",borderRadius:"20px",fontSize:"0.9rem",fontWeight:"bold",boxShadow:"4px 4px 8px var(--shadow-dark), -4px -4px 8px var(--shadow-light)"},onClick:g=>g.stopPropagation(),children:[Math.round(n*100),"% ",n>1&&" Drag to pan"]}),u.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},onClick:g=>g.stopPropagation(),children:u.jsx(Ue.img,{src:t,alt:"Full screen view",drag:n>1,dragConstraints:{left:0,right:0,top:0,bottom:0},dragElastic:.1,dragMomentum:!1,onDragEnd:p,animate:{scale:n,rotate:i,x:o.x,y:o.y},transition:{type:"spring",stiffness:200,damping:20},style:{maxWidth:n<=1?"90vw":"none",maxHeight:n<=1?"90vh":"none",width:n>1?"auto":void 0,height:n>1?"90vh":void 0,objectFit:"contain",cursor:n>1?"grab":"zoom-in",userSelect:"none"},whileDrag:{cursor:"grabbing"},onClick:g=>{g.stopPropagation(),n===1&&l()},draggable:!1})})]})},jh=({value:t,onChange:e,placeholder:n,style:r={},...i})=>{const s=R.useRef(null),o=a=>{a&&(a.style.height="auto",a.style.height=`${a.scrollHeight}px`)};return R.useEffect(()=>{o(s.current)},[t]),u.jsx("textarea",{ref:s,className:"neo-input",placeholder:n,value:t,onChange:a=>{e(a),o(a.target)},style:{...r,overflow:"hidden",resize:"none",minHeight:"40px",display:"block"},...i})},fS=({question:t,index:e,totalQuestions:n,onUpdate:r,onRemove:i,onMove:s,recording:o,startRecording:a,stopRecording:l,cancelRecording:d,recordingTime:h,handleFileUpload:f,handleOptionChange:p,setViewingImage:g,showSplitUI:x,selectedQuestions:_,toggleQuestionSelection:k})=>{var v;const T=w=>{const j=Math.floor(w/60),L=w%60;return`${j}:${L.toString().padStart(2,"0")}`};return u.jsxs("div",{className:"neo-inset",style:{padding:"1.5rem",display:"flex",flexDirection:"column",gap:"1rem",position:"relative"},children:[x&&u.jsx("div",{style:{position:"absolute",top:"10px",left:"10px",zIndex:5},children:u.jsx("input",{type:"checkbox",className:"neo-checkbox",checked:_==null?void 0:_.has(t.id),onChange:()=>k==null?void 0:k(t.id)})}),u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[u.jsx("div",{style:{fontSize:"0.9rem",fontWeight:"bold",opacity:.5,display:"flex",alignItems:"center",gap:"0.5rem"},children:u.jsxs("span",{children:[t.type==="mcq"?"MCQ":"QUESTION"," ",e+1]})}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:"var(--bg-color)",padding:"4px 8px",borderRadius:"8px",boxShadow:"inset 2px 2px 4px var(--shadow-dark), inset -2px -2px 4px var(--shadow-light)"},children:[u.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"Pos:"}),u.jsx("input",{type:"number",className:"neo-input",style:{width:"40px",padding:"2px",textAlign:"center",boxShadow:"none",background:"transparent",height:"auto",fontSize:"0.9rem",fontWeight:"bold"},placeholder:"#",onBlur:w=>{w.target.value&&(s(w.target.value),w.target.value="")},onKeyDown:w=>{w.key==="Enter"&&w.target.value&&(s(w.target.value),w.target.value="")}})]}),u.jsx("button",{className:"neo-button icon-btn",style:{width:"32px",height:"32px",color:"var(--error-color)",boxShadow:"none"},onClick:i,title:"Delete Question",children:u.jsx(mi,{size:16})})]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"bold"},children:"QUESTION"}),u.jsxs("div",{style:{display:"flex",gap:"5px"},children:[o?o.id===t.id&&o.field==="question"?u.jsxs("div",{className:"neo-flat",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:10,borderRadius:"12px",display:"flex",alignItems:"center",padding:"0 1rem",gap:"1rem",background:"var(--bg-color)"},children:[u.jsx("div",{style:{width:"10px",height:"10px",background:"red",borderRadius:"50%",animation:"pulse 1s infinite"}}),u.jsxs("span",{style:{flex:1,fontWeight:"600"},children:["Recording... ",T(h)]}),u.jsx("button",{className:"neo-button icon-btn",title:"Cancel",style:{width:"32px",height:"32px"},onClick:d,children:u.jsx(cn,{size:14,color:"var(--error-color)"})}),u.jsx("button",{className:"neo-button icon-btn",title:"Stop & Save",style:{width:"32px",height:"32px"},onClick:l,children:u.jsx(bo,{size:14,color:"var(--accent-color)"})})]}):null:u.jsxs("div",{style:{display:"flex",gap:"5px"},children:[u.jsx("button",{className:"neo-button icon-btn",style:{width:"32px",height:"32px",color:t.question.audio?"var(--accent-color)":"currentColor"},onClick:()=>a(t.id,"question"),children:u.jsx(Dh,{size:14})}),t.question.audio&&u.jsx("button",{className:"neo-button icon-btn",style:{width:"32px",height:"32px"},onClick:()=>r("question",{...t.question,audio:""}),children:u.jsx(mi,{size:12,color:"var(--error-color)"})})]}),u.jsxs("label",{className:"neo-button icon-btn",style:{width:"32px",height:"32px",cursor:"pointer"},children:[u.jsx(Qg,{size:14,color:t.question.image?"var(--accent-color)":"currentColor"}),u.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:w=>f(w,j=>r("question",{...t.question,image:j}))})]})]})]}),t.question.image&&u.jsxs("div",{style:{position:"relative",width:"100%",maxHeight:"150px"},children:[u.jsx("img",{src:t.question.image,style:{width:"100%",height:"100%",maxHeight:"150px",objectFit:"contain",borderRadius:"8px",cursor:"pointer"},onClick:()=>g(t.question.image)}),u.jsx("button",{className:"neo-button icon-btn",style:{position:"absolute",top:"5px",right:"5px",width:"24px",height:"24px"},onClick:()=>r("question",{...t.question,image:""}),children:u.jsx(cn,{size:12})})]}),u.jsx("div",{style:{position:"relative"},children:u.jsx(jh,{placeholder:"The question... ",value:t.question.text,onChange:w=>r("question",{...t.question,text:Ea(w.target.value)}),style:{paddingRight:"30px"}})})]}),t.type==="mcq"?u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"bold"},children:"OPTIONS"}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:(v=t.options)==null?void 0:v.map((w,j)=>u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("input",{type:"radio",name:`correct-${t.id}`,checked:w.isCorrect,onChange:()=>p(w.id,"isCorrect",!0),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"var(--accent-color)"}}),u.jsx("input",{className:"neo-input",placeholder:`Option ${String.fromCharCode(65+j)}`,value:w.text,onChange:L=>p(w.id,"text",Ea(L.target.value)),style:{borderColor:w.isCorrect?"var(--accent-color)":"transparent",borderWidth:w.isCorrect?"2px":"1px"}})]},w.id))})]}):u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"bold"},children:"ANSWER"}),u.jsxs("div",{style:{display:"flex",gap:"5px"},children:[o?o.id===t.id&&o.field==="answer"?u.jsxs("div",{className:"neo-flat",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:10,borderRadius:"12px",display:"flex",alignItems:"center",padding:"0 1rem",gap:"1rem",background:"var(--bg-color)"},children:[u.jsx("div",{style:{width:"10px",height:"10px",background:"red",borderRadius:"50%",animation:"pulse 1s infinite"}}),u.jsxs("span",{style:{flex:1,fontWeight:"600"},children:["Recording... ",T(h)]}),u.jsx("button",{className:"neo-button icon-btn",title:"Cancel",style:{width:"32px",height:"32px"},onClick:d,children:u.jsx(cn,{size:14,color:"var(--error-color)"})}),u.jsx("button",{className:"neo-button icon-btn",title:"Stop & Save",style:{width:"32px",height:"32px"},onClick:l,children:u.jsx(bo,{size:14,color:"var(--accent-color)"})})]}):null:u.jsxs("div",{style:{display:"flex",gap:"5px"},children:[u.jsx("button",{className:"neo-button icon-btn",style:{width:"32px",height:"32px",color:t.answer.audio?"var(--accent-color)":"currentColor"},onClick:()=>a(t.id,"answer"),children:u.jsx(Dh,{size:14})}),t.answer.audio&&u.jsx("button",{className:"neo-button icon-btn",style:{width:"32px",height:"32px"},onClick:()=>r("answer",{...t.answer,audio:""}),children:u.jsx(mi,{size:12,color:"var(--error-color)"})})]}),u.jsxs("label",{className:"neo-button icon-btn",style:{width:"32px",height:"32px",cursor:"pointer"},children:[u.jsx(Qg,{size:14,color:t.answer.image?"var(--accent-color)":"currentColor"}),u.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:w=>f(w,j=>r("answer",{...t.answer,image:j}))})]})]})]}),t.answer.image&&u.jsxs("div",{style:{position:"relative",width:"100%",maxHeight:"150px"},children:[u.jsx("img",{src:t.answer.image,style:{width:"100%",height:"100%",maxHeight:"150px",objectFit:"contain",borderRadius:"8px",cursor:"pointer"},onClick:()=>g(t.answer.image)}),u.jsx("button",{className:"neo-button icon-btn",style:{position:"absolute",top:"5px",right:"5px",width:"24px",height:"24px"},onClick:()=>r("answer",{...t.answer,image:""}),children:u.jsx(cn,{size:12})})]}),u.jsx(jh,{placeholder:"The answer... ",value:t.answer.text,onChange:w=>r("answer",{...t.answer,text:Ea(w.target.value)})})]})]},t.id)},M9=({user:t,lesson:e,onClose:n,onSave:r,onDelete:i,showAlert:s,showConfirm:o,availableLabels:a,allLessons:l,activeTab:d,defaultMetadata:h})=>{const[f,p]=R.useState((e==null?void 0:e.title)||""),[g,x]=R.useState((e==null?void 0:e.titleImage)||""),[_,k]=R.useState((e==null?void 0:e.label)||"No label"),[T,v]=R.useState((e==null?void 0:e.importantNote)||""),[w,j]=R.useState(""),[L,V]=R.useState((e==null?void 0:e.questions)||(e==null?void 0:e.cards)||[{id:Date.now(),question:{text:"",image:"",audio:""},answer:{text:"",image:"",audio:""}}]),[E,S]=R.useState((e==null?void 0:e.standard)||(e?"":(h==null?void 0:h.standard)||"")),[I,A]=R.useState((e==null?void 0:e.syllabus)||(e?"":(h==null?void 0:h.syllabus)||"")),[P,N]=R.useState((e==null?void 0:e.medium)||(e?"":(h==null?void 0:h.medium)||"")),[b,W]=R.useState((e==null?void 0:e.subject)||(e?"":(h==null?void 0:h.subject)||"")),[de,re]=R.useState((e==null?void 0:e.cost)||0),[se,z]=R.useState((e==null?void 0:e.sections)||[]),[G,M]=R.useState(d==="lessons"&&(t==null?void 0:t.email)===Ii),[D,H]=R.useState(null);R.useRef(null);const[J,te]=R.useState(!1),[ie,ee]=R.useState(new Set),[U,Y]=R.useState(!1),[pe,_e]=R.useState(""),[ge,Ae]=R.useState(!1),$=R.useRef(null),ae=R.useRef(null),[ke,Ge]=R.useState(null),[Ye,Xe]=R.useState(0),[dt,Ne]=R.useState(null),He=R.useRef(null),Kn=()=>{const K={id:Date.now(),type:"flashcard",question:{text:"",image:"",audio:""},answer:{text:"",image:"",audio:""}};if(se.length>0){const le=se.length-1,me=[...se];me[le].questions=me[le].questions||me[le].cards||[],me[le].questions.push(K),z(me),V(me.flatMap(X=>X.questions||X.cards))}else V([...L,K]);kr()},Qn=()=>{const K={id:Date.now(),type:"mcq",question:{text:"",image:"",audio:""},options:[{id:Date.now()+1,text:"",isCorrect:!1},{id:Date.now()+2,text:"",isCorrect:!1},{id:Date.now()+3,text:"",isCorrect:!1},{id:Date.now()+4,text:"",isCorrect:!1}],answer:{text:"",image:"",audio:""}};if(se.length>0){const le=se.length-1,me=[...se];me[le].questions=me[le].questions||me[le].cards||[],me[le].questions.push(K),z(me),V(me.flatMap(X=>X.questions||X.cards))}else V([...L,K]);kr()},jn=()=>{z([...se,{noteSegment:"",questions:[]}])},kr=()=>{setTimeout(()=>{ae.current&&ae.current.scrollTo({top:ae.current.scrollHeight,behavior:"smooth"})},100)},Jt=(K,le,me=null)=>{const X=parseInt(le)-1;if(me!==null){const xe=[...se],ye=xe[me].questions||xe[me].cards||[];if(isNaN(X)||X<0||X>=ye.length||X===K)return;const[St]=ye.splice(K,1);ye.splice(X,0,St),xe[me].questions=ye,z(xe),V(xe.flatMap(Ke=>Ke.questions||Ke.cards))}else{if(isNaN(X)||X<0||X>=L.length||X===K)return;const xe=[...L],[ye]=xe.splice(K,1);xe.splice(X,0,ye),V(xe)}},Zt=(K,le,me,X)=>{V(L.map(xe=>xe.id!==K?xe:me==="isCorrect"?{...xe,options:xe.options.map(ye=>({...ye,isCorrect:ye.id===le}))}:{...xe,options:xe.options.map(ye=>ye.id===le?{...ye,[me]:X}:ye)}))},Ar=K=>{L.length>1&&V(L.filter(le=>le.id!==K))},Ee=(K,le,me)=>{V(L.map(X=>X.id===K?{...X,[le]:me}:X))},he=(K,le,me="image")=>{const X=K.target.files[0];if(!X)return;const xe=new FileReader;xe.onloadend=()=>{const ye=xe.result;if(!Zg(ye,me==="image"?["image/"]:["audio/"])){s(`Invalid ${me} file. Only ${me} files are allowed.`);return}le(ye)},xe.readAsDataURL(X)},fe=async(K,le)=>{Ge({id:K,field:le}),Xe(0);try{const me=await navigator.mediaDevices.getUserMedia({audio:!0}),X=new MediaRecorder(me),xe=[];X.ondataavailable=ye=>xe.push(ye.data),X.onstop=()=>{const ye=new Blob(xe,{type:"audio/webm"}),St=new FileReader;St.onloadend=()=>{V(Ke=>Ke.map(je=>je.id===K?{...je,[le]:{...je[le],audio:St.result}}:je))},St.readAsDataURL(ye),me.getTracks().forEach(Ke=>Ke.stop()),clearInterval(He.current),Xe(0)},X.start(),Ne(X),He.current=setInterval(()=>Xe(ye=>ye+1),1e3)}catch{s("Could not access microphone."),Ge(null),Xe(0)}},De=()=>{dt&&(dt.stop(),Ne(null),Ge(null))},nt=()=>{dt&&(dt.onstop=()=>{clearInterval(He.current),Xe(0),Ne(null),Ge(null)},dt.stop())},rt=async()=>{var me;if(!f.trim())return s("Please enter a title");const K=se.length>0?se.flatMap(X=>X.questions||X.cards):L;for(let X=0;X<K.length;X++){const xe=K[X],ye=xe.question.text.trim()||xe.question.image||xe.question.audio,St=xe.answer.text.trim()||xe.answer.image||xe.answer.audio;if(xe.type==="mcq"){const Ke=(me=xe.options)==null?void 0:me.some(je=>je.isCorrect);if(!ye)return s(`Question is required for MCQ ${X+1}`);if(!Ke)return s(`Please select a correct answer for MCQ ${X+1}`)}else{if(!ye)return s(`Question is required for question ${X+1}`);if(!St)return s(`Answer is required for question ${X+1}`)}}const le={id:(e==null?void 0:e.id)||Date.now().toString(),title:f,titleImage:g,label:_,standard:E,syllabus:I,medium:P,subject:b,importantNote:T,questions:K,sections:se,owner:t.email,avgRating:(e==null?void 0:e.avgRating)||null,lastReviewed:(e==null?void 0:e.lastReviewed)||null,cost:parseInt(de)||0,questionCount:K.length};try{Ae(!0);let X;if(G){const{savePublicLesson:ye}=await yr(()=>import("./publicDrive-5c32f71c.js"),[]);X=await ye(le)}else X=await In.saveLesson(le);const xe=X.driveFileId||X.id;r({...X,driveFileId:xe},!0,G)}catch(X){if(Ae(!1),X.message==="REAUTH_NEEDED"||X.message.includes("REAUTH_NEEDED")){s("Please reconnect to Google Drive to save.");try{await S8({prompt:"consent"}),await rt()}catch(xe){console.error("Re-auth failed/cancelled",xe)}}else console.error("Save failed:",X),X.code==="storage/unknown"||X.message.includes("storage/unknown")?s('Cloud upload failed (likely CORS). Please use the "Download" button to save locally.'):s(`Failed to save lesson: ${X.message}`)}},We=()=>{if(ie.size===0)return s("Please select at least one question to split.");if(ie.size===L.length)return s("Cannot split all questions.");o(`Split ${ie.size} question(s) into a new lesson?`,async()=>{const K=L.filter(X=>ie.has(X.id)),le=L.filter(X=>!ie.has(X.id)),me={id:Date.now().toString(),title:`${f} (Split)`,titleImage:g,label:_,questions:K,owner:t.email,questionCount:K.length};try{const X=await In.saveLesson(me);r({...X,driveFileId:X.driveFileId||X.id},!1),V(le),ee(new Set),te(!1),s("Lesson split successfully!"),await rt()}catch{s("Failed to split lesson.")}})},hn=async()=>{if(!pe)return s("Please select a lesson to merge with.");const K=l==null?void 0:l.find(le=>le.id===pe);if(!K)return s("Target lesson not found.");o(`Merge "${f}" into "${K.title}"?`,async()=>{try{const le=K.questions||K.cards||[],me={...K,questions:[...le,...L],questionCount:le.length+L.length};await In.saveLesson(me),e!=null&&e.driveFileId&&await C8(t.token,e.driveFileId),s("Lessons merged successfully!"),n()}catch{s("Failed to merge lessons.")}})},Je=K=>{ee(le=>{const me=new Set(le);return me.has(K)?me.delete(K):me.add(K),me})};return u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)",background:"rgba(255,255,255,0.01)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:u.jsxs("div",{ref:$,className:"modal-content neo-flat neo-popup",style:{width:"100%",maxWidth:"600px",height:window.innerWidth<768?"100%":"90vh",maxHeight:"100%",padding:0,display:"flex",flexDirection:"column",position:"relative",overflow:"hidden",borderRadius:window.innerWidth<768?0:"24px"},children:[u.jsxs("div",{style:{padding:"1.5rem 2rem",borderBottom:"1px solid var(--shadow-dark)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-color)",zIndex:10},children:[u.jsx("h2",{style:{fontSize:"1.5rem",margin:0},children:e?"Edit Lesson":"New Lesson"}),u.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:u.jsx(Zr,{onClick:n,size:18})})]}),u.jsxs("div",{ref:ae,style:{padding:"2rem",flex:1,overflowY:"auto",display:"flex",flexDirection:"column",gap:"1.5rem"},children:[u.jsx("div",{style:{display:"flex",gap:"1.5rem",alignItems:"flex-start"},children:u.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.8rem"},children:[u.jsx("label",{style:{fontWeight:"600",opacity:.7},children:"Title & Cover Image"}),u.jsxs("div",{style:{display:"flex",gap:"10px"},children:[u.jsxs("div",{style:{position:"relative",flex:1},children:[u.jsx("input",{id:"lesson-modal-title-input",className:"neo-input",placeholder:"Lesson Title ",value:f,onChange:K=>p(Ea(K.target.value)),style:{paddingRight:"30px"}}),!f&&u.jsx("span",{style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",color:"red",pointerEvents:"none"},children:"*"})]}),u.jsxs("div",{style:{display:"flex",gap:"8px"},children:[u.jsxs("label",{className:"neo-button icon-btn",style:{cursor:"pointer",flexShrink:0,color:g?"var(--accent-color)":"currentColor"},children:[u.jsx(Qg,{size:18}),u.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:K=>he(K,x)})]}),g&&u.jsx("button",{className:"neo-button icon-btn",style:{flexShrink:0},onClick:()=>x(""),children:u.jsx(mi,{size:16,color:"var(--error-color)"})})]})]}),u.jsx(vr,{label:"Label",value:_,options:[{label:"No label",value:"No label"},...a.filter(K=>K!=="No label").map(K=>({label:K,value:K}))],onChange:k,placeholder:"Select label...",children:u.jsxs("div",{style:{display:"flex",gap:"8px",padding:"8px",borderBottom:"1px solid var(--shadow-dark)",marginBottom:"4px"},children:[u.jsx("input",{className:"neo-input",placeholder:"Create new label...",value:w,onChange:K=>j(Ea(K.target.value)),onKeyPress:K=>{K.key==="Enter"&&w.trim()&&(k(w.trim()),j(""))},style:{flex:1,fontSize:"0.85rem",padding:"8px 12px",height:"36px"}}),u.jsx("button",{className:"neo-button",style:{padding:"8px 12px",fontSize:"0.85rem",height:"36px"},onClick:()=>{w.trim()&&(k(w.trim()),j(""))},children:u.jsx(Yi,{size:14})})]})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem",marginTop:"0.5rem"},children:[u.jsx("label",{style:{fontWeight:"600",opacity:.7},children:"Important Note (Optional)"}),u.jsx(jh,{placeholder:"Add an important note...",value:T,onChange:K=>v(Ea(K.target.value))})]})]})}),(t==null?void 0:t.email)===Ii&&u.jsxs("div",{className:"neo-inset",style:{padding:"1.5rem",display:"flex",flexDirection:"column",gap:"1.25rem",borderRadius:"16px"},children:[u.jsx("h3",{style:{fontSize:"0.9rem",fontWeight:"bold",opacity:.6},children:"COMMUNITY METADATA"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.25rem"},children:[u.jsx(vr,{label:"Standard",value:E,options:["V","VI","VII","VIII","IX","X"].map(K=>({label:`Standard ${K}`,value:K})),onChange:S,placeholder:"Select Standard"}),u.jsx(vr,{label:"Syllabus",value:I,options:["NCERT","Kerala"].map(K=>({label:K,value:K})),onChange:A,placeholder:"Select Syllabus"}),u.jsx(vr,{label:"Medium",value:P,options:["Malayalam","English"].map(K=>({label:K,value:K})),onChange:N,placeholder:"Select Medium"}),u.jsx(vr,{label:"Subject",value:b,options:["Maths","Social Science","Science","English","Malayalam","Hindi"].map(K=>({label:K,value:K})),onChange:W,placeholder:"Select Subject"}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem"},children:[u.jsx("label",{style:{fontSize:"0.7rem",fontWeight:"700",color:"#94a3b8",textTransform:"uppercase"},children:"Cost (Coins)"}),u.jsx("input",{type:"number",className:"neo-input",value:de,onChange:K=>re(K.target.value),placeholder:"0 for free",style:{padding:"10px 12px"}})]})]}),u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"1rem",cursor:"pointer",padding:"0.5rem",borderRadius:"8px",background:G?"var(--accent-soft)":"transparent"},children:[u.jsx("input",{type:"checkbox",checked:G,onChange:K=>M(K.target.checked),style:{width:"18px",height:"18px"}}),u.jsx("span",{style:{fontSize:"0.9rem",fontWeight:"600",color:G?"var(--accent-color)":"inherit"},children:"Publish to Community Pool"})]})]}),u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:se&&se.length>0?se.map((K,le)=>{const me=K.questions||K.cards||[];return u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",padding:"1rem",borderRadius:"12px",border:"1px solid var(--shadow-dark)"},children:[u.jsxs("div",{className:"neo-flat",style:{padding:"1rem",borderLeft:"4px solid var(--accent-color)",borderRadius:"8px"},children:[u.jsx("label",{style:{fontSize:"0.7rem",fontWeight:"bold",opacity:.5,textTransform:"uppercase",display:"block",marginBottom:"4px"},children:"Section Note"}),u.jsx(jh,{value:K.noteSegment,onChange:X=>{const xe=[...se];xe[le].noteSegment=X.target.value,z(xe)},placeholder:"Enter section note...",style:{minHeight:"40px",background:"transparent",boxShadow:"none"}})]}),u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:me.map((X,xe)=>u.jsx(fS,{question:X,index:xe,totalQuestions:me.length,onUpdate:(ye,St)=>{const Ke=[...se],je=Ke[le].questions||Ke[le].cards||[];je[xe]={...X,[ye]:St},Ke[le].questions=je,z(Ke),V(Ke.flatMap(Bt=>Bt.questions||Bt.cards))},onRemove:()=>{const ye=[...se],St=ye[le].questions||ye[le].cards||[];St.splice(xe,1),ye[le].questions=St,z(ye),V(ye.flatMap(Ke=>Ke.questions||Ke.cards))},onMove:ye=>Jt(xe,ye,le),recording:ke,startRecording:fe,stopRecording:De,cancelRecording:nt,recordingTime:Ye,handleFileUpload:he,handleOptionChange:(ye,St,Ke)=>{const je=[...se],Bt=je[le].questions||je[le].cards||[],$t=Bt[xe];St==="isCorrect"?$t.options=$t.options.map(en=>({...en,isCorrect:en.id===ye})):$t.options=$t.options.map(en=>en.id===ye?{...en,[St]:Ke}:en),je[le].questions=Bt,z(je),V(je.flatMap(en=>en.questions||en.cards))},setViewingImage:H,showSplitUI:J,selectedQuestions:ie,toggleQuestionSelection:Je},X.id))}),u.jsxs("button",{className:"neo-button",style:{alignSelf:"center",fontSize:"0.8rem",opacity:.6},onClick:()=>{const X=[...se];X.splice(le+1,0,{noteSegment:"",questions:[]}),z(X)},children:[u.jsx(Yi,{size:14})," Insert Section Here"]})]},le)}):L.map((K,le)=>u.jsx(fS,{question:K,index:le,totalQuestions:L.length,onUpdate:(me,X)=>Ee(K.id,me,X),onRemove:()=>Ar(K.id),onMove:me=>Jt(le,me),recording:ke,startRecording:fe,stopRecording:De,cancelRecording:nt,recordingTime:Ye,handleFileUpload:he,handleOptionChange:(me,X,xe)=>Zt(K.id,me,X,xe),setViewingImage:H,showSplitUI:J,selectedQuestions:ie,toggleQuestionSelection:Je},K.id))}),u.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[u.jsxs("button",{className:"neo-button neo-glow-blue",style:{flex:1,justifyContent:"center",background:"var(--accent-soft)",color:"var(--accent-color)"},onClick:Kn,children:[u.jsx(Yi,{size:18})," Add Question"]}),u.jsxs("button",{className:"neo-button neo-glow-blue",style:{flex:1,justifyContent:"center",background:"var(--accent-soft)",color:"var(--accent-color)"},onClick:Qn,children:[u.jsx(Yi,{size:18})," Add MCQ"]}),u.jsxs("button",{className:"neo-button neo-glow-blue",style:{flex:1,justifyContent:"center",background:"var(--bg-color)",color:"var(--accent-color)"},onClick:jn,children:[u.jsx(Yi,{size:18})," Add Section"]})]}),e&&L.length>1&&u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[u.jsxs("button",{className:`neo-button ${J?"neo-inset":""}`,style:{flex:1,justifyContent:"center",fontSize:"0.9rem"},onClick:()=>{te(!J),Y(!1),ee(new Set)},children:[u.jsx(h9,{size:16})," ",J?"Cancel Split":"Split Lesson"]}),l&&l.filter(K=>K.id!==(e==null?void 0:e.id)).length>0&&u.jsxs("button",{className:`neo-button ${U?"neo-inset":""}`,style:{flex:1,justifyContent:"center",fontSize:"0.9rem"},onClick:()=>{Y(!U),te(!1),ee(new Set)},children:[u.jsx(r9,{size:16})," ",U?"Cancel Merge":"Merge Lesson"]})]}),J&&u.jsxs("div",{className:"neo-inset",style:{padding:"1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("p",{style:{fontSize:"0.9rem",opacity:.7},children:"Select questions to move to a new lesson:"}),u.jsxs("button",{className:"neo-button neo-glow-blue",style:{background:"var(--accent-color)",color:"white",border:"none",justifyContent:"center"},onClick:We,children:["Create New Lesson with ",ie.size," Selected Question(s)"]})]}),U&&u.jsxs("div",{className:"neo-inset",style:{padding:"1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("p",{style:{fontSize:"0.9rem",opacity:.7},children:"Select lesson to merge into:"}),u.jsx(vr,{value:pe,options:l==null?void 0:l.filter(K=>K.id!==(e==null?void 0:e.id)).map(K=>{var le,me;return{label:`${K.title} (${((le=K.questions)==null?void 0:le.length)||((me=K.cards)==null?void 0:me.length)||0} questions)`,value:K.id}}),onChange:_e,placeholder:"-- Select Lesson --",displayValue:K=>{var le;return(le=l.find(me=>me.id===K))==null?void 0:le.title}}),u.jsx("button",{className:"neo-button neo-glow-blue",style:{background:"var(--accent-color)",color:"white",border:"none",justifyContent:"center"},onClick:hn,disabled:!pe,children:"Merge Into Selected Lesson"})]})]})]}),u.jsx("div",{style:{padding:"1.5rem",borderTop:"1px solid var(--shadow-dark)",display:"flex",flexDirection:"column",gap:"1rem",background:"var(--bg-color)",zIndex:10},children:u.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:[e&&u.jsxs("button",{className:"neo-button neo-glow-red",style:{flex:"1 1 8.75rem",justifyContent:"center",color:"var(--error-color)",padding:"0.8rem"},onClick:()=>i(e),children:[u.jsx(mi,{size:18})," Delete Lesson"]}),u.jsx("button",{className:"neo-button",style:{flex:"1 1 6.25rem",justifyContent:"center",padding:"0.8rem"},onClick:n,children:"Cancel"}),u.jsx("button",{className:`neo-button ${ge?"neo-inset":""}`,style:{flex:"2 1 12.5rem",justifyContent:"center",background:ge?"var(--bg-color)":"var(--accent-color)",color:ge?"var(--accent-color)":"white",border:"none",padding:"0.8rem",cursor:ge?"not-allowed":"pointer",opacity:ge?.8:1},onClick:rt,disabled:ge,children:ge?u.jsxs(u.Fragment,{children:[u.jsx(Mc,{size:18,className:"spin",style:{marginRight:"8px"}})," Saving..."]}):u.jsxs(u.Fragment,{children:[u.jsx(c9,{size:18,style:{marginRight:"8px"}})," ",e?"Save Changes":"Create Lesson"]})})]})}),u.jsx(kn,{children:D&&u.jsx(ok,{imageUrl:D,onClose:()=>H(null)})})]})})},xv="/chethan-in-cardland/assets/avatar_guide_new-9cb767fe.png",V9="/chethan-in-cardland/assets/congratulations-565fc759.png",O9=({currentIndex:t,totalQuestions:e,masteredCount:n,totalOriginalQuestions:r,rating:i,onClose:s,user:o,lesson:a})=>u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[u.jsxs("div",{className:"neo-button",style:{height:"2.25rem",padding:"0 1rem",fontSize:"1rem",justifyContent:"center",minWidth:"5rem"},children:[t+1," / ",e]}),u.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"0 20px"},children:u.jsxs("div",{style:{width:"100%",maxWidth:"14rem",height:"1rem",background:"rgba(0,0,0,0.05)",borderRadius:"0.625rem",position:"relative",display:"flex",alignItems:"center",boxShadow:"inset 0.125rem 0.125rem 0.25rem var(--shadow-dark), inset -0.1rem -0.1rem 0.2rem var(--shadow-light)"},children:[u.jsx(Ue.div,{animate:{left:`${r>0?n/r*100:0}%`,y:i===2?[0,-15,0]:i===1?[0,-5,0]:0},transition:{left:{type:"spring",stiffness:50,damping:15},y:{duration:.4,ease:"easeOut"}},style:{position:"absolute",left:0,top:-4,zIndex:10,x:"-50%"},children:u.jsx($8,{size:24,color:i===2?"#22c55e":"var(--accent-color)",fill:i===2?"#dcfce7":"none"})}),u.jsx("div",{style:{width:`${r>0?n/r*100:0}%`,height:"100%",background:i===2?"linear-gradient(90deg, var(--accent-color), #22c55e)":"var(--accent-color)",borderRadius:"10px",transition:"width 0.5s cubic-bezier(0.4, 0, 0.2, 1), background 0.3s ease",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),u.jsx("div",{style:{position:"absolute",right:-12,top:-4,opacity:.9},children:u.jsx(Nh,{size:24,color:"var(--accent-color)",fill:"var(--bg-color)"})})]})}),u.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:u.jsx(Zr,{onClick:s,size:18})})]}),am=({audioData:t})=>{const[e,n]=R.useState(!1),[r,i]=R.useState(0),s=R.useRef(null),o=R.useRef(),a=R.useRef();s.current||(s.current=new Audio(t)),R.useEffect(()=>{const f=s.current;f.src!==t&&(f.pause(),f.src=t,f.load(),i(0),n(!1))},[t]),R.useEffect(()=>{const f=s.current,p=()=>{f.duration&&i(f.currentTime/f.duration*100),o.current=requestAnimationFrame(p)},g=()=>{n(!0),o.current=requestAnimationFrame(p)},x=()=>{n(!1),cancelAnimationFrame(o.current)},_=()=>{n(!1),i(0),cancelAnimationFrame(o.current)};return f.addEventListener("play",g),f.addEventListener("pause",x),f.addEventListener("ended",_),()=>{f.pause(),f.removeEventListener("play",g),f.removeEventListener("pause",x),f.removeEventListener("ended",_),cancelAnimationFrame(o.current)}},[]);const l=f=>{f.stopPropagation();const p=s.current;e?p.pause():p.play()},d=f=>{f.stopPropagation();const p=s.current;p.pause(),p.currentTime=0,i(0)},h=f=>{f.stopPropagation();const p=a.current.getBoundingClientRect(),g=f.clientX-p.left,x=Math.max(0,Math.min(100,g/p.width*100)),_=s.current;_.duration&&(_.currentTime=x/100*_.duration,i(x))};return u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"0.5rem",width:"100%",maxWidth:"250px"},onClick:f=>f.stopPropagation(),children:[u.jsx("button",{className:"neo-button icon-btn",onClick:l,style:{width:"30px",height:"30px",background:"var(--accent-soft)",color:"var(--accent-color)",borderRadius:"50%",flexShrink:0},children:e?u.jsx(s9,{size:12,fill:"currentColor"}):u.jsx(Of,{size:12,fill:"currentColor"})}),u.jsx("button",{className:"neo-button icon-btn",onClick:d,style:{width:"30px",height:"30px",borderRadius:"50%",flexShrink:0},children:u.jsx(Jg,{size:10,fill:"currentColor"})}),u.jsx("div",{ref:a,className:"neo-inset",onClick:h,style:{flex:1,height:"6px",borderRadius:"3px",overflow:"hidden",position:"relative",cursor:"pointer"},children:u.jsx("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:`${r}%`,background:"var(--accent-color)",transition:"width 0.1s linear"}})})]})},F9=t=>t?t.split(`
`).map((e,n)=>{const i=e.split(/(\*\*[^*]+\*\*)/g).map((s,o)=>s.startsWith("**")&&s.endsWith("**")?u.jsx("strong",{children:s.slice(2,-2)},o):s);return u.jsxs("span",{children:[i,n<t.split(`
`).length-1&&u.jsx("br",{})]},n)}):null,z9=({noteText:t,onStart:e})=>t?u.jsx("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},"data-testid":"section-note-card",children:u.jsxs("div",{className:"neo-flat",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",padding:"1.5rem",position:"relative",overflow:"hidden"},children:[u.jsx("div",{style:{flex:1,width:"100%",display:"flex",flexDirection:"column",overflowY:"auto",paddingRight:"0.25rem"},className:"custom-scrollbar",children:u.jsx("div",{style:{padding:"0.5rem 0.5rem 2rem",flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:u.jsx("div",{style:{fontSize:"1.2rem",lineHeight:"1.6",color:"var(--text-color)",textAlign:"center"},children:F9(t)})})}),u.jsx("div",{style:{width:"100%",marginTop:"auto",display:"flex",justifyContent:"center",paddingTop:"1rem"},children:u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:e,style:{width:"100%",padding:"1rem",fontSize:"1.1rem",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",background:"var(--accent-color)",color:"white",border:"none",borderRadius:"1rem"},children:[u.jsx("span",{children:"Start Questions"}),u.jsx(HC,{size:20})]})})]})}):null,U9=({currentQuestion:t,isFlipped:e,setIsFlipped:n,setViewingImage:r,onRateMCQ:i,feedback:s,showSectionNotes:o=!1})=>{var h;const[a,l]=R.useState(!1);return R.useEffect(()=>{t&&t.isFirstInSection&&l(!1)},[t==null?void 0:t.id,t==null?void 0:t.isFirstInSection]),t?o&&t.isFirstInSection&&t.sectionNoteSegment&&!a?u.jsx(z9,{noteText:t.sectionNoteSegment,onStart:()=>l(!0)}):t.type==="mcq"?u.jsx("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},"data-testid":"question-card-mcq",children:u.jsxs("div",{className:"neo-flat",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",padding:"1.5rem",position:"relative",overflow:"hidden"},children:[u.jsx("div",{style:{flex:1,width:"100%",display:"flex",flexDirection:"column",overflowY:"auto",paddingRight:"0.25rem"},className:"custom-scrollbar",children:u.jsxs("div",{style:{padding:"0.5rem 0.5rem 2rem",flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[t.question.image&&u.jsx("img",{src:t.question.image,style:{maxWidth:"100%",maxHeight:"12rem",objectFit:"contain",borderRadius:"0.75rem",marginBottom:"1.5rem",cursor:"pointer"},alt:"Q",onClick:()=>r(t.question.image)}),u.jsx("h2",{style:{fontSize:"1.3rem",fontWeight:"800",margin:0,textAlign:"center",lineHeight:"1.4"},children:t.question.text}),t.question.audio&&u.jsx("div",{style:{marginTop:"1rem"},children:u.jsx(am,{audioData:t.question.audio})})]})}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"0.75rem",width:"100%",marginTop:"auto",paddingTop:"1rem"},children:(h=t.options)==null?void 0:h.map((f,p)=>{const g=s&&f.isCorrect;return u.jsx("button",{disabled:!!s,className:"neo-button",onClick:()=>i(f),style:{padding:"1rem",justifyContent:"flex-start",textAlign:"left",minHeight:"3.5rem",background:"var(--bg-color)",borderColor:g?"#22c55e":"var(--border-color)",boxShadow:g?"0 0 15px rgba(34, 197, 94, 0.4)":void 0,color:g?"#16a34a":void 0,opacity:s&&!g?.5:1,fontSize:"0.95rem",lineHeight:"1.3",fontWeight:g?"bold":"500"},children:f.text},f.id||p)})})]})}):u.jsx("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},"data-testid":"question-card-flashcard",children:u.jsx("div",{style:{perspective:"62.5rem",flex:1,minHeight:0,cursor:"pointer"},onClick:()=>{e&&n(!1)},children:u.jsxs(Ue.div,{style:{width:"100%",height:"100%",position:"relative",transformStyle:"preserve-3d"},animate:{rotateY:e?180:0},transition:{type:"spring",stiffness:260,damping:20},children:[u.jsxs("div",{className:"neo-flat",style:{position:"absolute",width:"100%",height:"100%",backfaceVisibility:"hidden",display:"flex",flexDirection:"column",padding:"1.5rem",overflow:"hidden"},children:[u.jsx("div",{style:{flex:1,width:"100%",overflowY:"auto",paddingRight:"0.25rem",display:"flex",flexDirection:"column"},className:"custom-scrollbar",children:u.jsxs("div",{style:{padding:"0.5rem 0.5rem 2rem",flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[t&&t.question.image&&u.jsx("img",{src:t.question.image,style:{maxWidth:"100%",maxHeight:"14rem",objectFit:"contain",borderRadius:"0.75rem",marginBottom:"1.5rem",cursor:"pointer"},alt:"Q",onClick:f=>{f.stopPropagation(),r(t.question.image)}}),u.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"800",textAlign:"center",lineHeight:"1.4"},children:t?t.question.text:"No more questions"}),t&&t.question.audio&&u.jsx("div",{style:{marginTop:"1.5rem"},onClick:f=>f.stopPropagation(),children:u.jsx(am,{audioData:t.question.audio})})]})}),u.jsx("div",{style:{textAlign:"center",opacity:.3,fontSize:"0.75rem",marginTop:"1rem",fontWeight:"bold"},children:'TAP "SHOW ANSWER" AT THE BOTTOM'})]}),u.jsxs("div",{className:"neo-flat",style:{position:"absolute",width:"100%",height:"100%",backfaceVisibility:"hidden",transform:"rotateY(180deg)",display:"flex",flexDirection:"column",padding:"1.5rem",overflow:"hidden"},children:[u.jsx("div",{style:{flex:1,width:"100%",overflowY:"auto",paddingRight:"0.25rem",display:"flex",flexDirection:"column"},className:"custom-scrollbar",children:u.jsxs("div",{style:{padding:"0.5rem 0.5rem 2rem",flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[t&&t.answer.image&&u.jsx("img",{src:t.answer.image,style:{maxWidth:"100%",maxHeight:"14rem",objectFit:"contain",borderRadius:"0.75rem",marginBottom:"1.5rem",cursor:"pointer"},alt:"A",onClick:f=>{f.stopPropagation(),r(t.answer.image)}}),u.jsx("h2",{style:{fontSize:"1.6rem",color:"var(--accent-color)",fontWeight:"800",textAlign:"center",lineHeight:"1.4"},children:t?t.answer.text:""}),t&&t.answer.audio&&u.jsx("div",{style:{marginTop:"1.5rem"},onClick:f=>f.stopPropagation(),children:u.jsx(am,{audioData:t.answer.audio})})]})}),u.jsx("div",{style:{textAlign:"center",opacity:.3,fontSize:"0.75rem",marginTop:"1rem",fontWeight:"bold"},children:"RATE YOURSELF AT THE BOTTOM"})]})]})})}):null};let lm=null;const Lo=()=>(lm||(lm=new(window.AudioContext||window.webkitAudioContext)),lm),rl=()=>localStorage.getItem("soundsEnabled")!=="false",Ka=(t,e,n,r,i=.1)=>{const s=Lo(),o=s.createOscillator(),a=s.createGain();o.type=t,o.frequency.setValueAtTime(e,n),o.connect(a),a.connect(s.destination),a.gain.setValueAtTime(0,n),a.gain.linearRampToValueAtTime(i,n+.05),a.gain.exponentialRampToValueAtTime(.001,n+r),o.start(n),o.stop(n+r)},B9=()=>{if(!rl())return;const t=Lo();t.state==="suspended"&&t.resume();const e=t.currentTime;[523.25,659.25,783.99,1046.5].forEach((r,i)=>{Ka("sine",r,e+i*.1,.6,.1)})},$9=()=>{if(!rl())return;const t=Lo();t.state==="suspended"&&t.resume();const e=t.currentTime,n=.5,r=t.sampleRate*n,i=t.createBuffer(1,r,t.sampleRate),s=i.getChannelData(0);for(let d=0;d<r;d++)s[d]=Math.random()*2-1;const o=t.createBufferSource();o.buffer=i;const a=t.createBiquadFilter();a.type="lowpass",a.frequency.setValueAtTime(200,e),a.frequency.exponentialRampToValueAtTime(4e3,e+n);const l=t.createGain();l.gain.setValueAtTime(.05,e),l.gain.linearRampToValueAtTime(.1,e+n/2),l.gain.linearRampToValueAtTime(0,e+n),o.connect(a),a.connect(l),l.connect(t.destination),o.start(e)},W9=()=>{if(!rl())return;const t=Lo();t.state==="suspended"&&t.resume();const e=t.currentTime;Ka("sine",1975.53,e,.8,.15),Ka("sine",3951.07,e,.4,.05)},q9=()=>{if(!rl())return;const t=Lo();t.state==="suspended"&&t.resume();const e=t.currentTime;[{freq:392,time:0,dur:.15},{freq:523.25,time:.15,dur:.15},{freq:659.25,time:.3,dur:.15},{freq:783.99,time:.45,dur:.4}].forEach(({freq:r,time:i,dur:s})=>{const o=t.createOscillator(),a=t.createGain(),l=t.createBiquadFilter();o.type="sawtooth",o.frequency.value=r,l.type="lowpass",l.Q.value=2,o.connect(l),l.connect(a),a.connect(t.destination);const d=e+i,h=d+s;l.frequency.setValueAtTime(500,d),l.frequency.linearRampToValueAtTime(3e3,d+.05),l.frequency.exponentialRampToValueAtTime(500,h),a.gain.setValueAtTime(0,d),a.gain.linearRampToValueAtTime(.2,d+.02),a.gain.linearRampToValueAtTime(.15,d+.05),a.gain.exponentialRampToValueAtTime(.001,h),o.start(d),o.stop(h+.1)})},H9=()=>{if(!rl())return;const t=Lo();t.state==="suspended"&&t.resume();const e=t.currentTime;[{freq:523.25,delay:0,vol:.1},{freq:659.25,delay:.05,vol:.1},{freq:783.99,delay:.1,vol:.1},{freq:1046.5,delay:.15,vol:.08}].forEach(({freq:r,delay:i,vol:s})=>{Ka("sine",r,e+i,1,s)})},G9=()=>{if(!rl())return;const t=Lo();t.state==="suspended"&&t.resume();const e=t.currentTime;Ka("triangle",440,e,.3,.04),Ka("sine",554.37,e,.3,.04)},K9=({isFlipped:t,currentQuestion:e,isRecording:n,recordedAudio:r,isPlayingRecorded:i,startRecording:s,stopRecording:o,deleteRecording:a,toggleRecordedPlayback:l,setIsFlipped:d,handleRating:h,feedback:f})=>!e||e.type==="mcq"?null:t?f?null:u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",width:"100%",minHeight:"5rem",justifyContent:"center"},children:u.jsx(kn,{mode:"wait",children:u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",width:"100%"},children:[u.jsxs("div",{className:"neo-flat",style:{padding:"0.75rem",display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",borderRadius:"1rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[u.jsx("div",{style:{width:"0.6rem",height:"0.6rem",borderRadius:"50%",background:"var(--accent-color)",opacity:.6}}),u.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"bold",opacity:.7},children:"SELECT MATCHING ANSWER"})]}),u.jsx("div",{style:{display:"flex",gap:"0.75rem"},children:r&&u.jsx("button",{className:"neo-button icon-btn",onClick:l,style:{color:"var(--accent-color)",width:"2.25rem",height:"2.25rem"},children:i?u.jsx(Jg,{size:16,fill:"currentColor"}):u.jsx(Of,{size:16,fill:"currentColor"})})})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:"10px",width:"100%",justifyContent:"center"},children:[u.jsx("button",{className:"neo-button",style:{flex:1,flexDirection:"column",padding:"0.75rem 0.25rem",background:"#fee2e2",color:"#dc2626",border:"1px solid #fecaca",minWidth:"4rem",borderRadius:"0.75rem",minHeight:"3.75rem"},onClick:p=>{p.stopPropagation(),h(-1)},children:u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"bold"},children:"Wrong"})}),u.jsx("button",{className:"neo-button",style:{flex:1,flexDirection:"column",padding:"0.75rem 0.25rem",background:"#f3f4f6",color:"#4b5563",border:"1px solid #e5e7eb",minWidth:"4rem",borderRadius:"0.75rem",minHeight:"3.75rem"},onClick:p=>{p.stopPropagation(),h(0)},children:u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"bold"},children:"Unsure"})}),u.jsx("button",{className:"neo-button",style:{flex:1,flexDirection:"column",padding:"0.75rem 0.25rem",background:"#e0f2fe",color:"#0284c7",border:"1px solid #bae6fd",minWidth:"4rem",borderRadius:"0.75rem",minHeight:"3.75rem"},onClick:p=>{p.stopPropagation(),h(1)},children:u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"bold"},children:"Partly"})}),u.jsx("button",{className:"neo-button",style:{flex:1,flexDirection:"column",padding:"0.75rem 0.25rem",background:"#dcfce7",color:"#16a34a",border:"1px solid #bbf7d0",minWidth:"4rem",borderRadius:"0.75rem",minHeight:"3.75rem"},onClick:p=>{p.stopPropagation(),h(2)},children:u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"bold"},children:"By heart"})})]})]})})}):u.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsxs("div",{className:"neo-flat",style:{padding:"0.75rem",display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",borderRadius:"1rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[u.jsx("div",{style:{width:"0.6rem",height:"0.6rem",borderRadius:"50%",background:n?"#ff4444":"#ccc",boxShadow:n?"0 0 0.5rem #ff4444":"none",animation:n?"pulse 1.5s infinite":"none"}}),u.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"bold",opacity:.7},children:n?"RECORDING ANSWER...":r?"ANSWER RECORDED":"RECORD YOUR ANSWER"})]}),u.jsx("div",{style:{display:"flex",gap:"0.75rem"},children:!n&&!r?u.jsx("button",{className:"neo-button icon-btn",onClick:s,style:{color:"var(--accent-color)",width:"2.25rem",height:"2.25rem"},children:u.jsx(Dh,{size:18})}):n?u.jsx("button",{className:"neo-button icon-btn",onClick:o,style:{color:"#ff4444",width:"2.25rem",height:"2.25rem"},children:u.jsx(Jg,{size:18,fill:"currentColor"})}):u.jsx(u.Fragment,{children:u.jsx("button",{className:"neo-button icon-btn",onClick:a,style:{color:"#ff4444",width:"2.25rem",height:"2.25rem"},children:u.jsx(mi,{size:18})})})})]}),u.jsx("button",{className:"neo-button neo-glow-blue",style:{width:"100%",justifyContent:"center",padding:"1rem",fontSize:"1.1rem",background:"var(--accent-color)",color:"white",minHeight:"3.75rem",borderRadius:"1rem"},onClick:()=>{$9(),d(!0),r&&setTimeout(()=>l(),300)},children:"Show Answer"})]});var wv={};(function t(e,n,r,i){var s=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),o=typeof Path2D=="function"&&typeof DOMMatrix=="function",a=function(){if(!e.OffscreenCanvas)return!1;try{var M=new OffscreenCanvas(1,1),D=M.getContext("2d");D.fillRect(0,0,1,1);var H=M.transferToImageBitmap();D.createPattern(H,"no-repeat")}catch{return!1}return!0}();function l(){}function d(M){var D=n.exports.Promise,H=D!==void 0?D:e.Promise;return typeof H=="function"?new H(M):(M(l,l),null)}var h=function(M,D){return{transform:function(H){if(M)return H;if(D.has(H))return D.get(H);var J=new OffscreenCanvas(H.width,H.height),te=J.getContext("2d");return te.drawImage(H,0,0),D.set(H,J),J},clear:function(){D.clear()}}}(a,new Map),f=function(){var M=Math.floor(16.666666666666668),D,H,J={},te=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(D=function(ie){var ee=Math.random();return J[ee]=requestAnimationFrame(function U(Y){te===Y||te+M-1<Y?(te=Y,delete J[ee],ie()):J[ee]=requestAnimationFrame(U)}),ee},H=function(ie){J[ie]&&cancelAnimationFrame(J[ie])}):(D=function(ie){return setTimeout(ie,M)},H=function(ie){return clearTimeout(ie)}),{frame:D,cancel:H}}(),p=function(){var M,D,H={};function J(te){function ie(ee,U){te.postMessage({options:ee||{},callback:U})}te.init=function(U){var Y=U.transferControlToOffscreen();te.postMessage({canvas:Y},[Y])},te.fire=function(U,Y,pe){if(D)return ie(U,null),D;var _e=Math.random().toString(36).slice(2);return D=d(function(ge){function Ae($){$.data.callback===_e&&(delete H[_e],te.removeEventListener("message",Ae),D=null,h.clear(),pe(),ge())}te.addEventListener("message",Ae),ie(U,_e),H[_e]=Ae.bind(null,{data:{callback:_e}})}),D},te.reset=function(){te.postMessage({reset:!0});for(var U in H)H[U](),delete H[U]}}return function(){if(M)return M;if(!r&&s){var te=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{M=new Worker(URL.createObjectURL(new Blob([te])))}catch(ie){return typeof console<"u"&&typeof console.warn=="function"&&console.warn(" Could not load worker",ie),null}J(M)}return M}}(),g={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function x(M,D){return D?D(M):M}function _(M){return M!=null}function k(M,D,H){return x(M&&_(M[D])?M[D]:g[D],H)}function T(M){return M<0?0:Math.floor(M)}function v(M,D){return Math.floor(Math.random()*(D-M))+M}function w(M){return parseInt(M,16)}function j(M){return M.map(L)}function L(M){var D=String(M).replace(/[^0-9a-f]/gi,"");return D.length<6&&(D=D[0]+D[0]+D[1]+D[1]+D[2]+D[2]),{r:w(D.substring(0,2)),g:w(D.substring(2,4)),b:w(D.substring(4,6))}}function V(M){var D=k(M,"origin",Object);return D.x=k(D,"x",Number),D.y=k(D,"y",Number),D}function E(M){M.width=document.documentElement.clientWidth,M.height=document.documentElement.clientHeight}function S(M){var D=M.getBoundingClientRect();M.width=D.width,M.height=D.height}function I(M){var D=document.createElement("canvas");return D.style.position="fixed",D.style.top="0px",D.style.left="0px",D.style.pointerEvents="none",D.style.zIndex=M,D}function A(M,D,H,J,te,ie,ee,U,Y){M.save(),M.translate(D,H),M.rotate(ie),M.scale(J,te),M.arc(0,0,1,ee,U,Y),M.restore()}function P(M){var D=M.angle*(Math.PI/180),H=M.spread*(Math.PI/180);return{x:M.x,y:M.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:M.startVelocity*.5+Math.random()*M.startVelocity,angle2D:-D+(.5*H-Math.random()*H),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:M.color,shape:M.shape,tick:0,totalTicks:M.ticks,decay:M.decay,drift:M.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:M.gravity*3,ovalScalar:.6,scalar:M.scalar,flat:M.flat}}function N(M,D){D.x+=Math.cos(D.angle2D)*D.velocity+D.drift,D.y+=Math.sin(D.angle2D)*D.velocity+D.gravity,D.velocity*=D.decay,D.flat?(D.wobble=0,D.wobbleX=D.x+10*D.scalar,D.wobbleY=D.y+10*D.scalar,D.tiltSin=0,D.tiltCos=0,D.random=1):(D.wobble+=D.wobbleSpeed,D.wobbleX=D.x+10*D.scalar*Math.cos(D.wobble),D.wobbleY=D.y+10*D.scalar*Math.sin(D.wobble),D.tiltAngle+=.1,D.tiltSin=Math.sin(D.tiltAngle),D.tiltCos=Math.cos(D.tiltAngle),D.random=Math.random()+2);var H=D.tick++/D.totalTicks,J=D.x+D.random*D.tiltCos,te=D.y+D.random*D.tiltSin,ie=D.wobbleX+D.random*D.tiltCos,ee=D.wobbleY+D.random*D.tiltSin;if(M.fillStyle="rgba("+D.color.r+", "+D.color.g+", "+D.color.b+", "+(1-H)+")",M.beginPath(),o&&D.shape.type==="path"&&typeof D.shape.path=="string"&&Array.isArray(D.shape.matrix))M.fill(se(D.shape.path,D.shape.matrix,D.x,D.y,Math.abs(ie-J)*.1,Math.abs(ee-te)*.1,Math.PI/10*D.wobble));else if(D.shape.type==="bitmap"){var U=Math.PI/10*D.wobble,Y=Math.abs(ie-J)*.1,pe=Math.abs(ee-te)*.1,_e=D.shape.bitmap.width*D.scalar,ge=D.shape.bitmap.height*D.scalar,Ae=new DOMMatrix([Math.cos(U)*Y,Math.sin(U)*Y,-Math.sin(U)*pe,Math.cos(U)*pe,D.x,D.y]);Ae.multiplySelf(new DOMMatrix(D.shape.matrix));var $=M.createPattern(h.transform(D.shape.bitmap),"no-repeat");$.setTransform(Ae),M.globalAlpha=1-H,M.fillStyle=$,M.fillRect(D.x-_e/2,D.y-ge/2,_e,ge),M.globalAlpha=1}else if(D.shape==="circle")M.ellipse?M.ellipse(D.x,D.y,Math.abs(ie-J)*D.ovalScalar,Math.abs(ee-te)*D.ovalScalar,Math.PI/10*D.wobble,0,2*Math.PI):A(M,D.x,D.y,Math.abs(ie-J)*D.ovalScalar,Math.abs(ee-te)*D.ovalScalar,Math.PI/10*D.wobble,0,2*Math.PI);else if(D.shape==="star")for(var ae=Math.PI/2*3,ke=4*D.scalar,Ge=8*D.scalar,Ye=D.x,Xe=D.y,dt=5,Ne=Math.PI/dt;dt--;)Ye=D.x+Math.cos(ae)*Ge,Xe=D.y+Math.sin(ae)*Ge,M.lineTo(Ye,Xe),ae+=Ne,Ye=D.x+Math.cos(ae)*ke,Xe=D.y+Math.sin(ae)*ke,M.lineTo(Ye,Xe),ae+=Ne;else M.moveTo(Math.floor(D.x),Math.floor(D.y)),M.lineTo(Math.floor(D.wobbleX),Math.floor(te)),M.lineTo(Math.floor(ie),Math.floor(ee)),M.lineTo(Math.floor(J),Math.floor(D.wobbleY));return M.closePath(),M.fill(),D.tick<D.totalTicks}function b(M,D,H,J,te){var ie=D.slice(),ee=M.getContext("2d"),U,Y,pe=d(function(_e){function ge(){U=Y=null,ee.clearRect(0,0,J.width,J.height),h.clear(),te(),_e()}function Ae(){r&&!(J.width===i.width&&J.height===i.height)&&(J.width=M.width=i.width,J.height=M.height=i.height),!J.width&&!J.height&&(H(M),J.width=M.width,J.height=M.height),ee.clearRect(0,0,J.width,J.height),ie=ie.filter(function($){return N(ee,$)}),ie.length?U=f.frame(Ae):ge()}U=f.frame(Ae),Y=ge});return{addFettis:function(_e){return ie=ie.concat(_e),pe},canvas:M,promise:pe,reset:function(){U&&f.cancel(U),Y&&Y()}}}function W(M,D){var H=!M,J=!!k(D||{},"resize"),te=!1,ie=k(D,"disableForReducedMotion",Boolean),ee=s&&!!k(D||{},"useWorker"),U=ee?p():null,Y=H?E:S,pe=M&&U?!!M.__confetti_initialized:!1,_e=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,ge;function Ae(ae,ke,Ge){for(var Ye=k(ae,"particleCount",T),Xe=k(ae,"angle",Number),dt=k(ae,"spread",Number),Ne=k(ae,"startVelocity",Number),He=k(ae,"decay",Number),Kn=k(ae,"gravity",Number),Qn=k(ae,"drift",Number),jn=k(ae,"colors",j),kr=k(ae,"ticks",Number),Jt=k(ae,"shapes"),Zt=k(ae,"scalar"),Ar=!!k(ae,"flat"),Ee=V(ae),he=Ye,fe=[],De=M.width*Ee.x,nt=M.height*Ee.y;he--;)fe.push(P({x:De,y:nt,angle:Xe,spread:dt,startVelocity:Ne,color:jn[he%jn.length],shape:Jt[v(0,Jt.length)],ticks:kr,decay:He,gravity:Kn,drift:Qn,scalar:Zt,flat:Ar}));return ge?ge.addFettis(fe):(ge=b(M,fe,Y,ke,Ge),ge.promise)}function $(ae){var ke=ie||k(ae,"disableForReducedMotion",Boolean),Ge=k(ae,"zIndex",Number);if(ke&&_e)return d(function(Ne){Ne()});H&&ge?M=ge.canvas:H&&!M&&(M=I(Ge),document.body.appendChild(M)),J&&!pe&&Y(M);var Ye={width:M.width,height:M.height};U&&!pe&&U.init(M),pe=!0,U&&(M.__confetti_initialized=!0);function Xe(){if(U){var Ne={getBoundingClientRect:function(){if(!H)return M.getBoundingClientRect()}};Y(Ne),U.postMessage({resize:{width:Ne.width,height:Ne.height}});return}Ye.width=Ye.height=null}function dt(){ge=null,J&&(te=!1,e.removeEventListener("resize",Xe)),H&&M&&(document.body.contains(M)&&document.body.removeChild(M),M=null,pe=!1)}return J&&!te&&(te=!0,e.addEventListener("resize",Xe,!1)),U?U.fire(ae,Ye,dt):Ae(ae,Ye,dt)}return $.reset=function(){U&&U.reset(),ge&&ge.reset()},$}var de;function re(){return de||(de=W(null,{useWorker:!0,resize:!0})),de}function se(M,D,H,J,te,ie,ee){var U=new Path2D(M),Y=new Path2D;Y.addPath(U,new DOMMatrix(D));var pe=new Path2D;return pe.addPath(Y,new DOMMatrix([Math.cos(ee)*te,Math.sin(ee)*te,-Math.sin(ee)*ie,Math.cos(ee)*ie,H,J])),pe}function z(M){if(!o)throw new Error("path confetti are not supported in this browser");var D,H;typeof M=="string"?D=M:(D=M.path,H=M.matrix);var J=new Path2D(D),te=document.createElement("canvas"),ie=te.getContext("2d");if(!H){for(var ee=1e3,U=ee,Y=ee,pe=0,_e=0,ge,Ae,$=0;$<ee;$+=2)for(var ae=0;ae<ee;ae+=2)ie.isPointInPath(J,$,ae,"nonzero")&&(U=Math.min(U,$),Y=Math.min(Y,ae),pe=Math.max(pe,$),_e=Math.max(_e,ae));ge=pe-U,Ae=_e-Y;var ke=10,Ge=Math.min(ke/ge,ke/Ae);H=[Ge,0,0,Ge,-Math.round(ge/2+U)*Ge,-Math.round(Ae/2+Y)*Ge]}return{type:"path",path:D,matrix:H}}function G(M){var D,H=1,J="#000000",te='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof M=="string"?D=M:(D=M.text,H="scalar"in M?M.scalar:H,te="fontFamily"in M?M.fontFamily:te,J="color"in M?M.color:J);var ie=10*H,ee=""+ie+"px "+te,U=new OffscreenCanvas(ie,ie),Y=U.getContext("2d");Y.font=ee;var pe=Y.measureText(D),_e=Math.ceil(pe.actualBoundingBoxRight+pe.actualBoundingBoxLeft),ge=Math.ceil(pe.actualBoundingBoxAscent+pe.actualBoundingBoxDescent),Ae=2,$=pe.actualBoundingBoxLeft+Ae,ae=pe.actualBoundingBoxAscent+Ae;_e+=Ae+Ae,ge+=Ae+Ae,U=new OffscreenCanvas(_e,ge),Y=U.getContext("2d"),Y.font=ee,Y.fillStyle=J,Y.fillText(D,$,ae);var ke=1/H;return{type:"bitmap",bitmap:U.transferToImageBitmap(),matrix:[ke,0,0,ke,-_e*ke/2,-ge*ke/2]}}n.exports=function(){return re().apply(this,arguments)},n.exports.reset=function(){re().reset()},n.exports.create=W,n.exports.shapeFromPath=z,n.exports.shapeFromText=G})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),wv,!1);const Q9=wv.exports;wv.exports.create;const Y9=["Off to a flying start!","Great beginning!","First one down, perfectly done!","Strong start!","Excellent opener!","That's how we start!","Right out of the gate - perfect!","Setting a great pace!","Boom! First one nailed!","You're ready for this!"],X9=["You're on fire!","Unstoppable!","Look at you go!","Nothing can stop you now!","Incredible momentum!","You're crushing this!","Back-to-back brilliance!","Another one! Perfect!","You're in the zone!","Keeping the streak alive!"],pS=["Great job!","Very good!","Super!","Excellent work!","Spot on!","You've got this by heart!","Brilliant!","Fantastic!","Wonderful progress!","You're doing amazing!","Perfectly done!","That's the spirit!","Keep it up, champion!","You're a natural!","Masterful!","Impressive memory!","You nailed it!","Outstanding!","Way to go!","Incredible focus!","Gold star for you!","You're making this look easy!","Top notch!","Simply superb!","Bravo!","Pure genius!","Love that confidence!","Right on the money!","You're a star student!","Marvelous!","High five!","That's exactly right!","Spectacular!","So proud of your progress!","You're really shining today!","Unbeatable!","You've mastered this one!","Clear and confident - well done!","Your hard work is paying off!","Solid effort, perfect result!","You're built for this!","A-plus performance!","Victory is yours!"],J9=["Almost there! A quick review will help.","Good effort! Just missed a detail.","On the right track, let's polish it.","Refining this will make it perfect.","You're getting close, keep going!","A little bit more practice on this one.","Not quite 100%, but good try!","Let's turn that 'almost' into 'perfect'.","Close! We'll nail it next time.","Good recall, just needs sharpening."],Z9=["Every mistake is a step toward mastery. Reviewing now!","Give it another careful read; well revisit this question.","Take your time and read it again  Ill ask it once more.","No worries! Let's try this one again in a bit.","Let's keep this one in the loop for a little longer.","Practice makes perfect! We'll come back to this.","Don't lose heart, let's give it another look together.","Slow and steady wins the race. Read it once more.","I'll ask this again soon to help you remember.","It's okay! Even the best need a second look sometimes.","Let's refine this one. Read carefully and we'll retry.","A little more focus here will do wonders.","Let's polish this answer together. See you again soon!","Deep breaths! Read it again, and we'll revisit.","Learning takes time. Let's keep this one active.","You're doing great, just need to master this specific one.","Give it one more glance. I'll be back with this question.","Let's solidify this. A quick revisit is coming up.","Don't rush! Read it again to let it sink in.","We'll get this one right next time, I promise!","Keep your chin up! Let's re-study this card.","It's just a hurdle, not a wall. Re-reading helps!","Let's refresh your memory on this one shortly.","Stay positive! We'll tackle this again very soon.","A quick recap, and you'll have it in no time.","Let's keep this card in the 'must-know' pile for now.","Reviewing is the key to success. Let's do it again.","One more read-through will make all the difference.","Persistence pays off! We'll cycle back to this.","It's trial and error. Let's try one more trial.","Let's give this one a second chance to shine.","Focus on the details this time. Re-visiting shortly!","You're learning! Let's re-confirm this one later.","A bit more practice is all you need here.","I believe in you! Let's re-read and try again.","Let's not let this one slip away. Re-asking soon!","Each review makes your brain stronger. Ready for round 2?","Patience is a virtue in learning. Re-reading now.","Let's keep the conversation going on this card.","Small steps lead to big jumps. Let's re-step this one.","Almost caught it! Let's throw the question again later.","It's on the tip of your tongue! Let's review to be sure.","Constructive repetition! We'll be back for this.","Let's strengthen this connection in your memory.","Honesty is the first step to learning. Re-trying soon!","A moment of focus now saves a lot of time later.","Let's bridge the gap on this one. Re-reading...","Your friend is here to help! Let's look at this again.","Final check is coming soon. Give it a good read now!"],ez=({type:t,isFirstQuestion:e=!1,streakCount:n=0}={})=>{let r=[];return t==="success"?e?r=Y9:n>=3?r=Math.random()>.4?X9:pS:r=pS:t==="partial"?r=J9:r=Z9,r[Math.floor(Math.random()*r.length)]},tz=({lesson:t,user:e,onUpdate:n,onClose:r,showAlert:i,onReviewStart:s})=>{(t.questions||t.cards||[]).some(Ee=>Ee.lastRating!==void 0);const a=t.lastSessionIndex!==void 0,[l,d]=R.useState(!0),[h,f]=R.useState(!1),[p,g]=R.useState(0),[x,_]=R.useState(!1),[k,T]=R.useState(0),[v,w]=R.useState([]),[j,L]=R.useState([]),[V,E]=R.useState(null),[S,I]=R.useState(null),[A,P]=R.useState(null),[N,b]=R.useState(0),[W,de]=R.useState({}),[re,se]=R.useState(0),[z,G]=R.useState(0),[M,D]=R.useState(t.showSectionNotes!==void 0?t.showSectionNotes:!t.lastReviewed),[H,J]=R.useState(!1),[te,ie]=R.useState(null),[ee,U]=R.useState(!1),Y=R.useRef(null),pe=R.useRef(null),_e=R.useRef([]),ge=R.useRef(!1),Ae=R.useRef({lesson:t,firstRatings:W,reviewedCountSession:z,currentIndex:p,rating:k,showSectionNotes:M,onUpdate:n});R.useEffect(()=>{Ae.current={lesson:t,firstRatings:W,reviewedCountSession:z,currentIndex:p,rating:k,showSectionNotes:M,onUpdate:n}},[t,W,z,p,k,M,n]);const $=j[p],ke=(t.questions||t.cards||[]).filter(Ee=>Ee.lastRating!==void 0&&Ee.lastRating<2).length,Ge=R.useCallback(()=>{if(z<1||t.isPublic)return;const Ee=k!==0?p+1:p,he=(t.questions||t.cards||[]).map(De=>{var We;const nt=De.id||((We=De.question)==null?void 0:We.text),rt=W[nt];return rt!==void 0?{...De,lastRating:rt}:De}),fe={...t,questions:he,lastSessionIndex:Ee,partialReviewDate:new Date().toISOString(),showSectionNotes:M};n(fe)},[t,W,z,p,k,M,n]),Ye=R.useCallback(()=>{ge.current||(Ge(),ge.current=!0),r()},[Ge,r]);R.useEffect(()=>{v.length>0&&s&&s()},[v,s]),R.useEffect(()=>()=>{Y.current&&(Y.current.pause(),Y.current=null)},[]),R.useEffect(()=>{const Ee=()=>{const fe=Ae.current;if(fe.reviewedCountSession>=1&&!fe.lesson.isPublic&&!ge.current){const De=fe.rating!==0?fe.currentIndex+1:fe.currentIndex,nt=(fe.lesson.questions||fe.lesson.cards||[]).map(We=>{var K;const hn=We.id||((K=We.question)==null?void 0:K.text),Je=fe.firstRatings[hn];return Je!==void 0?{...We,lastRating:Je}:We}),rt={...fe.lesson,questions:nt,lastSessionIndex:De,partialReviewDate:new Date().toISOString(),showSectionNotes:fe.showSectionNotes};fe.onUpdate&&fe.onUpdate(rt),ge.current=!0}},he=fe=>{var De;Ee(),((De=storageService.hasPendingSyncs)!=null&&De.call(storageService)||Ae.current.reviewedCountSession>0&&!ge.current)&&(fe.preventDefault(),fe.returnValue="")};return window.addEventListener("beforeunload",he),()=>{window.removeEventListener("beforeunload",he),Ee()}},[]),R.useEffect(()=>{!l&&!h&&j.length>0&&B9()},[l,h,j.length]);const Xe=R.useCallback((Ee,he={})=>{const{resumeFromIndex:fe=0}=he,De=[...t.questions||t.cards||[]];De.sort((We,hn)=>{const Je=We.lastRating!==void 0?We.lastRating:-2,K=hn.lastRating!==void 0?hn.lastRating:-2;return Je-K});let nt=[];Ee==="all"||Ee==="resume"?nt=De:Ee==="difficult"&&(nt=De.filter(We=>We.lastRating!==void 0&&We.lastRating<2));const rt=Ee==="resume"?Math.min(fe,nt.length-1):0;if(L(nt),se(nt.length),d(!1),f(!1),g(rt),w([]),E(null),b(Ee==="resume"?rt:0),de({}),P(null),G(0),ge.current=!1,Ee==="all"&&t.lastSessionIndex!==void 0){const We={...t,lastSessionIndex:void 0};n(We)}},[t,n]),dt=Ee=>{const he=[1,3,7,30];return Ee>=he.length-1?30:he[Ee+1]},Ne=async()=>{const he=k===2;P(null);const fe=he?N+1:N;if(he&&b(fe),fe===re){const We=j.slice(0,re).map(je=>{const Bt=je.id||je.question.text;return W[Bt]??0}).reduce((je,Bt)=>je+Bt,0),hn=re*2,Je=re>0?(We/re).toFixed(1):0,K=We===hn,le=t.questions||t.cards||[],me=le.filter(je=>{const Bt=je.id||je.question.text,$t=W[Bt];return $t!==void 0&&$t<2}),X=t.reviewStage||-1;let xe=new Date,ye=X;if(Je>=1.5){ye=X+1;const je=dt(ye);xe.setDate(xe.getDate()+je)}else ye=-1;if(E({avg:Je,totalMarks:We,maxPossibleMarks:hn,fullMarks:K,lowRatedQuestions:me,nextReviewDate:xe.toLocaleDateString()}),q9(),K&&Q9({particleCount:200,spread:160,origin:{y:.6},colors:["#FFD700","#FF4500","#00FF7F","#00BFFF","#FF1493"],zIndex:2001}),t.isPublic||re<le.length)return;const St=le.map(je=>{const Bt=je.id||je.question.text,$t=W[Bt];return $t!==void 0?{...je,lastRating:$t}:je}),Ke={...t,questions:St,lastMarks:We,questionCountAtLastReview:re,lastReviewed:new Date().toLocaleDateString(),nextReview:xe.toISOString(),reviewStage:ye,showSectionNotes:!1};if(n(Ke),e!=null&&e.uid){const je=t.id==="demo-lesson",Bt=!t.lessonId&&!t.storagePath;try{const $t=await Un.checkReferralCompletion(e.uid,t.id||t.lessonId,je,Bt);$t.rewarded&&i&&i({type:"success",message:`Congratulations! Your referrer received ${$t.bonus} coins for your first lesson completion! `})}catch($t){console.error("[ReferralCheck] Error:",$t)}}}else _(!1),T(0),Zt(),setTimeout(()=>{g(p+1)},100)},He=Ee=>{L(Ee),se(Ee.length),g(0),_(!1),T(0),w([]),E(null),b(0),de({}),P(null),Zt(),D(!1)},[Kn,Qn]=R.useState(0),jn=(Ee,he=null)=>{const fe=Ee===2,De=Ee===1;fe?(H9(),Qn(Je=>Je+1)):De?(G9(),Qn(0)):(W9(),Qn(0)),T(Ee);const nt=$.id||$.question.text;W[nt]===void 0&&de(Je=>({...Je,[nt]:Ee})),fe||L(Je=>[...Je,$]);let rt="retry";fe?rt="success":De&&(rt="partial");const We={type:rt,isFirstQuestion:p===0&&z===0,streakCount:fe?Kn+1:0},hn=he||ez(We);P({message:hn,type:fe?"success":"retry"}),G(Je=>Je+1),Ge()},kr=async()=>{try{const Ee=await navigator.mediaDevices.getUserMedia({audio:!0}),he=new MediaRecorder(Ee);pe.current=he,_e.current=[],he.ondataavailable=fe=>{fe.data.size>0&&_e.current.push(fe.data)},he.onstop=()=>{const fe=new Blob(_e.current,{type:"audio/webm"}),De=URL.createObjectURL(fe);ie(De),Y.current=new Audio(De),Y.current.onended=()=>U(!1),Ee.getTracks().forEach(nt=>nt.stop())},he.start(),J(!0)}catch{i("Microphone access denied or not available.")}},Jt=()=>{pe.current&&H&&(pe.current.stop(),J(!1))},Zt=()=>{te&&(Y.current&&(Y.current.pause(),Y.current=null),URL.revokeObjectURL(te),ie(null),U(!1))},Ar=Ee=>{Ee&&Ee.stopPropagation(),Y.current&&(ee?(Y.current.pause(),U(!1)):(Y.current.play(),U(!0)))};return{showStartScreen:l,showModeSelection:h,currentIndex:p,currentQuestion:$,isFlipped:x,rating:k,sessionResult:V,viewingImage:S,feedback:A,masteredCount:N,totalOriginalQuestions:re,studyQuestions:j,showSectionNotes:M,hasInterruptedSession:a,lessonTitle:t.title||"Untitled Lesson",lastSessionIndex:t.lastSessionIndex,handleStartReview:Xe,handleNextSession:Ne,restartSession:He,handleRating:jn,setIsFlipped:_,setViewingImage:I,handleCloseWithSave:Ye,setShowSectionNotes:D,isRecording:H,recordedAudio:te,isPlayingRecorded:ee,startRecording:kr,stopRecording:Jt,deleteRecording:Zt,toggleRecordedPlayback:Ar,difficultQuestionsCount:ke}},nz=({lesson:t,user:e,onClose:n,onEdit:r,onUpdate:i,showAlert:s,userCoins:o,onDeductCoins:a,onReviewStart:l,displayName:d})=>{var U;const{showStartScreen:h,showModeSelection:f,currentIndex:p,currentQuestion:g,isFlipped:x,rating:_,sessionResult:k,viewingImage:T,feedback:v,masteredCount:w,totalOriginalQuestions:j,studyQuestions:L,difficultQuestionsCount:V,handleStartReview:E,handleNextSession:S,restartSession:I,handleRating:A,setIsFlipped:P,setViewingImage:N,isRecording:b,recordedAudio:W,isPlayingRecorded:de,startRecording:re,stopRecording:se,deleteRecording:z,toggleRecordedPlayback:G,handleCloseWithSave:M,showSectionNotes:D,setShowSectionNotes:H,hasInterruptedSession:J,lessonTitle:te,lastSessionIndex:ie}=tz({lesson:t,user:e,onUpdate:i,onClose:n,showAlert:s,onReviewStart:l}),ee=(t.questions||t.cards||[]).length;return h?u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",background:"rgba(255,255,255,0.01)",zIndex:2e3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"max(1rem, 2vh)"},children:u.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsxs(Ue.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"neo-flat neo-popup",style:{width:"100%",maxWidth:"420px",padding:"2rem",position:"relative"},children:[u.jsx(Zr,{onClick:M,theme:"light"}),u.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[u.jsx("div",{style:{width:"5rem",height:"5rem",background:"linear-gradient(135deg, var(--accent-color), var(--primary-color))",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1.25rem",color:"white",boxShadow:"0 8px 20px rgba(var(--accent-rgb), 0.3)"},children:u.jsx(Nh,{size:36})}),u.jsx("h2",{style:{fontSize:"1.6rem",fontWeight:"bold",marginBottom:"0.5rem",background:"linear-gradient(135deg, var(--text-color), var(--accent-color))",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:te}),u.jsxs("p",{style:{opacity:.6,fontSize:"0.95rem"},children:[ee," questions"]})]}),u.jsx("div",{style:{marginBottom:"1rem",padding:"1rem",background:"var(--bg-color)",borderRadius:"1rem",boxShadow:"inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light)"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[D?u.jsx(QC,{size:20,color:"var(--accent-color)"}):u.jsx(KC,{size:20,style:{opacity:.5}}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"600",fontSize:"0.95rem"},children:"Show Important Notes"}),u.jsx("div",{style:{fontSize:"0.8rem",opacity:.6},children:"Display short notes for quick review"})]})]}),u.jsx("button",{onClick:()=>H(!D),style:{width:"52px",height:"28px",borderRadius:"14px",border:"none",background:D?"var(--accent-color)":"var(--shadow-dark)",position:"relative",cursor:"pointer",transition:"background 0.3s ease",boxShadow:D?"0 0 12px rgba(var(--accent-rgb), 0.5)":"inset 2px 2px 4px var(--shadow-dark)"},children:u.jsx(Ue.div,{animate:{x:D?24:2},transition:{type:"spring",stiffness:500,damping:30},style:{width:"22px",height:"22px",borderRadius:"50%",background:"white",position:"absolute",top:"3px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"}})})]})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.875rem"},children:[t.lastReviewed&&V>0&&u.jsxs("button",{className:"neo-button",onClick:()=>E("all"),style:{padding:"1.1rem 1rem",display:"flex",alignItems:"center",gap:"1rem",border:"2px solid var(--border-color)",justifyContent:"flex-start"},children:[u.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",overflow:"hidden",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",background:"var(--accent-soft)"},children:u.jsx(ic,{size:22,color:"var(--accent-color)"})}),u.jsxs("div",{style:{textAlign:"left"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1.05rem"},children:"Start From Beginning"}),u.jsxs("div",{style:{fontSize:"0.8rem",opacity:.6},children:["Go through all ",ee," questions"]})]})]}),J&&!(t.lastReviewed&&V>0)&&u.jsxs("button",{className:"neo-button",onClick:()=>E("all"),style:{padding:"1.1rem 1rem",display:"flex",alignItems:"center",gap:"1rem",border:"2px solid var(--border-color)",justifyContent:"flex-start"},children:[u.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",overflow:"hidden",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",background:"var(--accent-soft)"},children:u.jsx(ic,{size:22,color:"var(--accent-color)"})}),u.jsxs("div",{style:{textAlign:"left"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1.05rem"},children:"Start From Beginning"}),u.jsxs("div",{style:{fontSize:"0.8rem",opacity:.6},children:["Go through all ",ee," questions"]})]})]}),t.lastReviewed&&V>0?u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:()=>E("difficult"),style:{padding:"1.1rem 1rem",display:"flex",alignItems:"center",gap:"1rem",border:"none",justifyContent:"flex-start",background:"var(--accent-color)",color:"white"},children:[u.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",overflow:"hidden",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255,255,255,0.2)"},children:u.jsx(qC,{size:22,color:"white"})}),u.jsxs("div",{style:{textAlign:"left"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1.05rem"},children:"Review Tough Cards Only"}),u.jsxs("div",{style:{fontSize:"0.8rem",opacity:.9},children:["Focus on ",V," challenging questions"]})]})]}):J?ie!==void 0&&u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:()=>E("resume",{resumeFromIndex:ie}),style:{padding:"1.1rem 1rem",display:"flex",alignItems:"center",gap:"1rem",justifyContent:"flex-start",background:"var(--accent-color)",color:"white",border:"none"},children:[u.jsx("div",{style:{padding:"0.6rem",background:"rgba(255,255,255,0.2)",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsx(Of,{size:22,fill:"white"})}),u.jsxs("div",{style:{textAlign:"left"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1.05rem"},children:"Continue Where You Left"}),u.jsxs("div",{style:{fontSize:"0.8rem",opacity:.85},children:["Resume from question ",ie+1]})]})]}):u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:()=>E("all"),style:{padding:"1.1rem 1rem",display:"flex",alignItems:"center",gap:"1rem",border:"none",justifyContent:"flex-start",background:"var(--accent-color)",color:"white"},children:[u.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",overflow:"hidden",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255,255,255,0.2)"},children:u.jsx(ic,{size:22,color:"white"})}),u.jsxs("div",{style:{textAlign:"left"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1.05rem"},children:"Start Review"}),u.jsxs("div",{style:{fontSize:"0.8rem",opacity:.9},children:["Go through all ",ee," questions"]})]})]})]})]})})}):(!L||L.length===0)&&!k?u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",background:"rgba(255,255,255,0.01)",zIndex:2e3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"max(1rem, 2vh)"},children:u.jsxs(Ue.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"neo-flat",style:{width:"100%",maxWidth:"400px",padding:"2.5rem",display:"flex",flexDirection:"column",gap:"2rem",textAlign:"center"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",alignItems:"center"},children:[u.jsx("div",{className:"neo-inset",style:{padding:"20px",borderRadius:"50%",color:"#94a3b8"},children:u.jsx(Yg,{size:48})}),u.jsx("h2",{style:{fontSize:"1.5rem"},children:"No Questions Found"}),u.jsx("p",{style:{opacity:.6},children:"This lesson appears to be empty. Would you like to add some questions?"})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsxs("button",{className:"neo-button neo-glow-blue",style:{justifyContent:"center",padding:"1rem"},onClick:r,children:[u.jsx(vv,{size:18,style:{marginRight:"8px"}})," Add Questions Now"]}),u.jsx("button",{className:"neo-button",style:{justifyContent:"center",opacity:.6},onClick:n,children:"Close"})]})]},"empty-lesson")}):k?u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",background:"rgba(255,255,255,0.01)",zIndex:2e3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"max(1rem, 2vh)"},children:u.jsxs(Ue.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"neo-flat neo-popup",style:{width:"100%",maxWidth:"420px",maxHeight:"90vh",overflowY:"auto",padding:"2rem",textAlign:"center",display:"flex",flexDirection:"column",gap:"1.5rem"},children:[u.jsx("h2",{style:{fontSize:"1.8rem"},children:"Study Summary"}),u.jsxs("div",{className:"neo-flat",style:{padding:"1.5rem",borderRadius:"24px"},children:[u.jsx("div",{style:{fontSize:"0.9rem",opacity:.6,marginBottom:"0.5rem",fontWeight:"bold"},children:"SESSION MARKS"}),u.jsxs("div",{style:{fontSize:"3rem",fontWeight:"bold",color:"var(--accent-color)",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[k.totalMarks," ",u.jsxs("span",{style:{fontSize:"1.5rem",opacity:.5},children:["/ ",k.maxPossibleMarks]})]}),k.nextReviewDate&&u.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.9rem",color:"var(--accent-color)",fontWeight:"600"},children:["Recommended next review: ",k.nextReviewDate]})]}),k.fullMarks?u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem",width:"100%"},children:[u.jsxs("div",{style:{position:"relative"},children:[u.jsx(Ue.div,{initial:{scale:0},animate:{scale:[0,1.2,1],rotate:[0,-10,10,0]},transition:{duration:.8,ease:"backOut"},children:u.jsx(Nh,{size:64,color:"var(--accent-color)"})}),[...Array(8)].map((Y,pe)=>u.jsx(Ue.div,{initial:{opacity:0,x:0,y:0,scale:0},animate:{opacity:[0,1,0],x:(Math.random()-.5)*100,y:(Math.random()-.5)*100-50,scale:[0,1,0]},transition:{duration:1.5,delay:.5+Math.random()*.5,repeat:1/0,repeatDelay:1},style:{position:"absolute",top:"50%",left:"50%",zIndex:0,pointerEvents:"none"},children:u.jsx(JC,{size:20,color:["#FFD700","#FF4500","#00FF7F"][Math.floor(Math.random()*3)]})},pe))]}),u.jsx(Ue.img,{src:V9,alt:"Congratulations",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:12,delay:.3},style:{maxWidth:"80%",height:"auto",borderRadius:"12px"}}),u.jsx("div",{className:"neo-inset",style:{padding:"1.5rem",color:"var(--accent-color)",borderRadius:"16px",width:"100%",textAlign:"center"},children:u.jsxs("p",{style:{fontWeight:"bold",fontSize:"1.2rem",lineHeight:"1.6"},children:["Congratulations. ",u.jsx("br",{}),"By royal decree, I name you Master of ",u.jsx("br",{}),u.jsx("span",{style:{color:"var(--accent-color)",fontSize:"1.4rem"},children:t.title})]})})]}):u.jsxs("div",{style:{padding:"1rem",background:"rgba(59, 130, 246, 0.1)",borderRadius:"16px",border:"1px solid #3b82f6"},children:[u.jsx("p",{style:{fontWeight:"bold",color:"#1d4ed8",marginBottom:"0.5rem",fontSize:"1.1rem"},children:"Don't give up!"}),u.jsxs("p",{style:{opacity:.8,fontSize:"0.95rem"},children:["Mastery takes patience. ",u.jsx("br",{}),"Why not try the tough questions again right now?"]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginTop:"0.5rem"},children:[!k.fullMarks&&u.jsxs("button",{className:"neo-button",style:{justifyContent:"center",background:"var(--accent-color)",color:"white",border:"none",padding:"1rem"},onClick:()=>I(k.lowRatedQuestions),children:["Focus on Weak Questions (",k.lowRatedQuestions.length,")"]}),u.jsx("button",{className:"neo-button",style:{justifyContent:"center",padding:"1rem",background:k.fullMarks?"var(--accent-color)":"transparent",color:k.fullMarks?"white":"inherit",border:k.fullMarks?"none":"1px solid var(--border-color)"},onClick:()=>I(t.questions||t.cards||[]),children:"Try All Questions Again"}),u.jsx("button",{className:"neo-button",style:{justifyContent:"center",padding:"1rem",opacity:.7},onClick:n,children:"Done for now"})]})]},"session-result")}):u.jsxs("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(1.2rem)",WebkitBackdropFilter:"blur(1.2rem)",background:"rgba(255,255,255,0.01)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center",padding:0,height:"100dvh",overflow:"hidden"},children:[u.jsx(kn,{mode:"wait",children:u.jsxs("div",{className:"review-container",style:{width:"100%",maxWidth:"35rem",height:"100%",display:"flex",flexDirection:"column",position:"relative",padding:"10px 1rem",background:"var(--bg-color)"},children:[u.jsx(O9,{currentIndex:p,totalQuestions:L.length,masteredCount:w,totalOriginalQuestions:j,rating:_,onClose:M,user:e,lesson:t}),u.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",margin:"10px 0",position:"relative",minHeight:0},children:u.jsx(kn,{mode:"wait",children:u.jsx(Ue.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:u.jsx(U9,{currentQuestion:g,isFlipped:x,setIsFlipped:P,setViewingImage:N,showSectionNotes:D,onRateMCQ:Y=>{var pe;if(Y!=null&&Y.isCorrect)A(2);else{const _e=((pe=g.options.find(ge=>ge.isCorrect))==null?void 0:pe.text)||"Unknown";A(0,`Incorrect. The right answer is "${_e}". I shall ask this again.`)}},feedback:v})},g?g.id||((U=g.question)==null?void 0:U.text):"end")})}),u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",width:"100%",paddingBottom:"0"},children:u.jsx(kn,{mode:"wait",children:v?u.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"neo-flat",style:{width:"100%",padding:"1rem",borderRadius:"1.5rem",background:"var(--bg-color)",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",border:"1px solid var(--border-color)",boxShadow:"var(--neo-box-shadow)"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",width:"100%"},children:[u.jsx("img",{src:xv,alt:"Guide",style:{width:"2rem",height:"2rem",borderRadius:"50%",flexShrink:0,border:"1.5px solid var(--accent-color)"}}),u.jsx("h3",{style:{fontSize:"0.9rem",color:v.type==="success"?"#16a34a":"#dc2626",margin:0,flex:1,fontWeight:"800"},children:v.message})]}),u.jsx("button",{className:"neo-button neo-glow-blue",onClick:S,style:{width:"100%",justifyContent:"center",padding:"1rem",fontSize:"1.1rem",background:v.type==="success"?"#16a34a":"var(--accent-color)",color:"white",fontWeight:"bold",borderRadius:"1rem",minHeight:"3.5rem"},children:"Next Question"})]},"feedback-actions"):u.jsx(K9,{isFlipped:x,currentQuestion:g,isRecording:b,recordedAudio:W,isPlayingRecorded:de,startRecording:re,stopRecording:se,deleteRecording:z,toggleRecordedPlayback:G,setIsFlipped:P,handleRating:(Y,pe)=>A(Y,pe),feedback:v})})})]})}),u.jsx(kn,{children:T&&u.jsx(ok,{imageUrl:T,onClose:()=>N(null)})})]})},rz=({user:t,onClose:e,showAlert:n})=>{const[r,i]=R.useState(""),[s,o]=R.useState(!1),a=async()=>{if(!r.trim())return n("Please provide some feedback text.");o(!0);try{const l=C9(r),d=k9(t.email)?t.email:"Unknown";let f=`*New Feedback for Chethan in Cardland*

*From:* ${t.name||"Anonymous"} (${d})

*Feedback:* ${l}`;const p=`https://wa.me/919497449115?text=${encodeURIComponent(f)}`;window.open(p,"_blank"),n("Thank you! Redirecting to WhatsApp to send your feedback."),e()}catch{n("Failed to open WhatsApp. Please try again.")}finally{o(!1)}};return u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)",background:"rgba(255,255,255,0.01)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:u.jsxs("div",{className:"modal-content neo-flat neo-popup",style:{width:"100%",maxWidth:"500px",maxHeight:"90vh",overflowY:"auto",padding:"2rem",display:"flex",flexDirection:"column",gap:"1.5rem",position:"relative"},children:[u.jsx(Zr,{onClick:e,style:{position:"absolute",top:"1.5rem",right:"1.5rem"},size:18}),u.jsx("h2",{style:{fontSize:"1.5rem"},children:"Help & Feedback"}),u.jsx("p",{style:{opacity:.7,fontSize:"0.9rem"},children:"Help us improve Chethan in Cardland! Your feedback will be sent via WhatsApp."}),u.jsxs("div",{className:"neo-inset",style:{padding:"1rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsx("label",{style:{fontWeight:"600",opacity:.7,fontSize:"0.9rem"},children:"Feedback"}),u.jsxs("div",{style:{position:"relative"},children:[u.jsx("textarea",{className:"neo-input",rows:"6",placeholder:"What's on your mind? ",style:{width:"100%",resize:"none",paddingRight:"30px"},value:r,onChange:l=>i(l.target.value)}),u.jsx("span",{style:{position:"absolute",right:"12px",top:"12px",color:"red",pointerEvents:"none",visibility:r?"hidden":"visible"},children:"*"})]})]}),u.jsx("button",{className:"neo-button neo-glow-blue",style:{justifyContent:"center",background:"var(--accent-color)",color:"white",border:"none",padding:"1rem",opacity:s?.7:1,cursor:s?"not-allowed":"pointer",gap:"10px"},onClick:a,disabled:s,children:s?"Redirecting...":u.jsxs(u.Fragment,{children:[u.jsx(u9,{size:18})," Send via WhatsApp"]})})]})})},iz=({isOpen:t,onClose:e,onLogin:n})=>{const r=[{icon:u.jsx("img",{src:xv,alt:"Chethan",style:{width:"32px",height:"32px",objectFit:"contain"}}),title:"Built for how you learn",text:"Science-based learning, designed to keep you focused and motivated."},{icon:u.jsx(y9,{size:28}),title:"Learns how you remember",text:"A smart algorithm understands your memory, tracks progress, and adapts automatically."},{icon:u.jsx(f9,{size:28}),title:"Learns. Adapts. Guides.",text:"The app creates a personalised learning path that adapts to your memory and progress."},{icon:u.jsx(a9,{size:28}),title:"Create lessons your way",content:u.jsxs("div",{children:[u.jsx("p",{style:{margin:"0 0 1rem 0",lineHeight:"1.5",fontSize:"0.95rem",opacity:.8},children:"Make lessons using one or more options:"}),u.jsxs("div",{style:{display:"flex",gap:"2.5rem",justifyContent:"flex-start",marginBottom:"0.5rem",marginTop:"1rem"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[u.jsx("div",{className:"neo-inset",style:{width:"50px",height:"50px",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)"},children:u.jsx(J8,{size:22})}),u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"500",opacity:.8},children:"Typing"})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[u.jsx("div",{className:"neo-inset",style:{width:"50px",height:"50px",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)"},children:u.jsx(Dh,{size:22})}),u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"500",opacity:.8},children:"Voice"})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[u.jsx("div",{className:"neo-inset",style:{width:"50px",height:"50px",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)"},children:u.jsx(q8,{size:22})}),u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"500",opacity:.8},children:"Photo"})]})]})]})},{icon:u.jsx(Nh,{size:28}),title:"Expert Lesson Content",text:"Study curated lessons built from real previous question papers and exam patterns."}];return u.jsx(kn,{children:t&&u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",background:"rgba(255,255,255,0.01)",zIndex:4e3,display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsxs(Ue.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"neo-flat neo-popup",style:{width:"95vw",maxWidth:"600px",maxHeight:"90vh",display:"flex",flexDirection:"column",position:"relative",padding:0,overflow:"hidden",borderRadius:"32px"},children:[u.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid rgba(0,0,0,0.05)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsx("h2",{style:{margin:0,fontSize:"1.5rem",fontWeight:"800",color:"var(--accent-color)"},children:"How it Works"}),u.jsx(Zr,{onClick:e})]}),u.jsx("div",{style:{padding:"2rem 1.5rem",overflowY:"auto",flex:1,display:"flex",flexDirection:"column",gap:"2rem"},children:r.map((i,s)=>u.jsxs("div",{style:{display:"flex",gap:"1.5rem",alignItems:"flex-start"},children:[u.jsx("div",{className:"neo-flat",style:{padding:"0.8rem",borderRadius:"16px",color:"var(--accent-color)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:i.icon}),u.jsxs("div",{style:{flex:1},children:[i.title&&u.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1.1rem",fontWeight:"700",color:"var(--text-color)"},children:i.title}),i.text&&u.jsx("p",{style:{margin:0,lineHeight:"1.5",fontSize:"0.95rem",opacity:.8},children:i.text}),i.content]})]},s))}),u.jsx("div",{style:{padding:"1.5rem",textAlign:"center",borderTop:"1px solid rgba(0,0,0,0.05)"},children:u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:n,style:{width:"100%",justifyContent:"center",padding:"1rem",gap:"12px",background:"var(--accent-color)",color:"white"},children:[u.jsx(e9,{size:20}),u.jsx("span",{style:{fontWeight:"600"},children:"Get Started with Google"})]})})]})})})};var Ff={},ak={exports:{}},sz="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",oz=sz,az=oz;function lk(){}function ck(){}ck.resetWarningCache=lk;var lz=function(){function t(r,i,s,o,a,l){if(l!==az){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:ck,resetWarningCache:lk};return n.PropTypes=n,n};ak.exports=lz();var uk=ak.exports,dk={L:1,M:0,Q:3,H:2},hk={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},cz=hk;function fk(t){this.mode=cz.MODE_8BIT_BYTE,this.data=t}fk.prototype={getLength:function(t){return this.data.length},write:function(t){for(var e=0;e<this.data.length;e++)t.put(this.data.charCodeAt(e),8)}};var uz=fk,td=dk;function Fr(t,e){this.totalCount=t,this.dataCount=e}Fr.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];Fr.getRSBlocks=function(t,e){var n=Fr.getRsBlockTable(t,e);if(n==null)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var r=n.length/3,i=new Array,s=0;s<r;s++)for(var o=n[s*3+0],a=n[s*3+1],l=n[s*3+2],d=0;d<o;d++)i.push(new Fr(a,l));return i};Fr.getRsBlockTable=function(t,e){switch(e){case td.L:return Fr.RS_BLOCK_TABLE[(t-1)*4+0];case td.M:return Fr.RS_BLOCK_TABLE[(t-1)*4+1];case td.Q:return Fr.RS_BLOCK_TABLE[(t-1)*4+2];case td.H:return Fr.RS_BLOCK_TABLE[(t-1)*4+3];default:return}};var dz=Fr;function pk(){this.buffer=new Array,this.length=0}pk.prototype={get:function(t){var e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)==1},put:function(t,e){for(var n=0;n<e;n++)this.putBit((t>>>e-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var hz=pk,xr={glog:function(t){if(t<1)throw new Error("glog("+t+")");return xr.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return xr.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var Gt=0;Gt<8;Gt++)xr.EXP_TABLE[Gt]=1<<Gt;for(var Gt=8;Gt<256;Gt++)xr.EXP_TABLE[Gt]=xr.EXP_TABLE[Gt-4]^xr.EXP_TABLE[Gt-5]^xr.EXP_TABLE[Gt-6]^xr.EXP_TABLE[Gt-8];for(var Gt=0;Gt<255;Gt++)xr.LOG_TABLE[xr.EXP_TABLE[Gt]]=Gt;var mk=xr,$s=mk;function Rd(t,e){if(t.length==null)throw new Error(t.length+"/"+e);for(var n=0;n<t.length&&t[n]==0;)n++;this.num=new Array(t.length-n+e);for(var r=0;r<t.length-n;r++)this.num[r]=t[r+n]}Rd.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var r=0;r<t.getLength();r++)e[n+r]^=$s.gexp($s.glog(this.get(n))+$s.glog(t.get(r)));return new Rd(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=$s.glog(this.get(0))-$s.glog(t.get(0)),n=new Array(this.getLength()),r=0;r<this.getLength();r++)n[r]=this.get(r);for(var r=0;r<t.getLength();r++)n[r]^=$s.gexp($s.glog(t.get(r))+e);return new Rd(n,0).mod(t)}};var gk=Rd,Xn=hk,mS=gk,fz=mk,Oi={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},Wt={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;Wt.getBCHDigit(e)-Wt.getBCHDigit(Wt.G15)>=0;)e^=Wt.G15<<Wt.getBCHDigit(e)-Wt.getBCHDigit(Wt.G15);return(t<<10|e)^Wt.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;Wt.getBCHDigit(e)-Wt.getBCHDigit(Wt.G18)>=0;)e^=Wt.G18<<Wt.getBCHDigit(e)-Wt.getBCHDigit(Wt.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;t!=0;)e++,t>>>=1;return e},getPatternPosition:function(t){return Wt.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case Oi.PATTERN000:return(e+n)%2==0;case Oi.PATTERN001:return e%2==0;case Oi.PATTERN010:return n%3==0;case Oi.PATTERN011:return(e+n)%3==0;case Oi.PATTERN100:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case Oi.PATTERN101:return e*n%2+e*n%3==0;case Oi.PATTERN110:return(e*n%2+e*n%3)%2==0;case Oi.PATTERN111:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new mS([1],0),n=0;n<t;n++)e=e.multiply(new mS([1,fz.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case Xn.MODE_NUMBER:return 10;case Xn.MODE_ALPHA_NUM:return 9;case Xn.MODE_8BIT_BYTE:return 8;case Xn.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case Xn.MODE_NUMBER:return 12;case Xn.MODE_ALPHA_NUM:return 11;case Xn.MODE_8BIT_BYTE:return 16;case Xn.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else if(e<41)switch(t){case Xn.MODE_NUMBER:return 14;case Xn.MODE_ALPHA_NUM:return 13;case Xn.MODE_8BIT_BYTE:return 16;case Xn.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}else throw new Error("type:"+e)},getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,r=0;r<e;r++)for(var i=0;i<e;i++){for(var s=0,o=t.isDark(r,i),a=-1;a<=1;a++)if(!(r+a<0||e<=r+a))for(var l=-1;l<=1;l++)i+l<0||e<=i+l||a==0&&l==0||o==t.isDark(r+a,i+l)&&s++;s>5&&(n+=3+s-5)}for(var r=0;r<e-1;r++)for(var i=0;i<e-1;i++){var d=0;t.isDark(r,i)&&d++,t.isDark(r+1,i)&&d++,t.isDark(r,i+1)&&d++,t.isDark(r+1,i+1)&&d++,(d==0||d==4)&&(n+=3)}for(var r=0;r<e;r++)for(var i=0;i<e-6;i++)t.isDark(r,i)&&!t.isDark(r,i+1)&&t.isDark(r,i+2)&&t.isDark(r,i+3)&&t.isDark(r,i+4)&&!t.isDark(r,i+5)&&t.isDark(r,i+6)&&(n+=40);for(var i=0;i<e;i++)for(var r=0;r<e-6;r++)t.isDark(r,i)&&!t.isDark(r+1,i)&&t.isDark(r+2,i)&&t.isDark(r+3,i)&&t.isDark(r+4,i)&&!t.isDark(r+5,i)&&t.isDark(r+6,i)&&(n+=40);for(var h=0,i=0;i<e;i++)for(var r=0;r<e;r++)t.isDark(r,i)&&h++;var f=Math.abs(100*h/e/e-50)/5;return n+=f*10,n}},pz=Wt,mz=uz,yk=dz,vk=hz,Vs=pz,gz=gk;function Ur(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var Gn=Ur.prototype;Gn.addData=function(t){var e=new mz(t);this.dataList.push(e),this.dataCache=null};Gn.isDark=function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]};Gn.getModuleCount=function(){return this.moduleCount};Gn.make=function(){if(this.typeNumber<1){var t=1;for(t=1;t<40;t++){for(var e=yk.getRSBlocks(t,this.errorCorrectLevel),n=new vk,r=0,i=0;i<e.length;i++)r+=e[i].dataCount;for(var i=0;i<this.dataList.length;i++){var s=this.dataList[i];n.put(s.mode,4),n.put(s.getLength(),Vs.getLengthInBits(s.mode,t)),s.write(n)}if(n.getLengthInBits()<=r*8)break}this.typeNumber=t}this.makeImpl(!1,this.getBestMaskPattern())};Gn.makeImpl=function(t,e){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++)this.modules[n][r]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),this.typeNumber>=7&&this.setupTypeNumber(t),this.dataCache==null&&(this.dataCache=Ur.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)};Gn.setupPositionProbePattern=function(t,e){for(var n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(var r=-1;r<=7;r++)e+r<=-1||this.moduleCount<=e+r||(0<=n&&n<=6&&(r==0||r==6)||0<=r&&r<=6&&(n==0||n==6)||2<=n&&n<=4&&2<=r&&r<=4?this.modules[t+n][e+r]=!0:this.modules[t+n][e+r]=!1)};Gn.getBestMaskPattern=function(){for(var t=0,e=0,n=0;n<8;n++){this.makeImpl(!0,n);var r=Vs.getLostPoint(this);(n==0||t>r)&&(t=r,e=n)}return e};Gn.createMovieClip=function(t,e,n){var r=t.createEmptyMovieClip(e,n),i=1;this.make();for(var s=0;s<this.modules.length;s++)for(var o=s*i,a=0;a<this.modules[s].length;a++){var l=a*i,d=this.modules[s][a];d&&(r.beginFill(0,100),r.moveTo(l,o),r.lineTo(l+i,o),r.lineTo(l+i,o+i),r.lineTo(l,o+i),r.endFill())}return r};Gn.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)this.modules[t][6]==null&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)this.modules[6][e]==null&&(this.modules[6][e]=e%2==0)};Gn.setupPositionAdjustPattern=function(){for(var t=Vs.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var r=t[e],i=t[n];if(this.modules[r][i]==null)for(var s=-2;s<=2;s++)for(var o=-2;o<=2;o++)s==-2||s==2||o==-2||o==2||s==0&&o==0?this.modules[r+s][i+o]=!0:this.modules[r+s][i+o]=!1}};Gn.setupTypeNumber=function(t){for(var e=Vs.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var r=!t&&(e>>n&1)==1;this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=r}for(var n=0;n<18;n++){var r=!t&&(e>>n&1)==1;this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=r}};Gn.setupTypeInfo=function(t,e){for(var n=this.errorCorrectLevel<<3|e,r=Vs.getBCHTypeInfo(n),i=0;i<15;i++){var s=!t&&(r>>i&1)==1;i<6?this.modules[i][8]=s:i<8?this.modules[i+1][8]=s:this.modules[this.moduleCount-15+i][8]=s}for(var i=0;i<15;i++){var s=!t&&(r>>i&1)==1;i<8?this.modules[8][this.moduleCount-i-1]=s:i<9?this.modules[8][15-i-1+1]=s:this.modules[8][15-i-1]=s}this.modules[this.moduleCount-8][8]=!t};Gn.mapData=function(t,e){for(var n=-1,r=this.moduleCount-1,i=7,s=0,o=this.moduleCount-1;o>0;o-=2)for(o==6&&o--;;){for(var a=0;a<2;a++)if(this.modules[r][o-a]==null){var l=!1;s<t.length&&(l=(t[s]>>>i&1)==1);var d=Vs.getMask(e,r,o-a);d&&(l=!l),this.modules[r][o-a]=l,i--,i==-1&&(s++,i=7)}if(r+=n,r<0||this.moduleCount<=r){r-=n,n=-n;break}}};Ur.PAD0=236;Ur.PAD1=17;Ur.createData=function(t,e,n){for(var r=yk.getRSBlocks(t,e),i=new vk,s=0;s<n.length;s++){var o=n[s];i.put(o.mode,4),i.put(o.getLength(),Vs.getLengthInBits(o.mode,t)),o.write(i)}for(var a=0,s=0;s<r.length;s++)a+=r[s].dataCount;if(i.getLengthInBits()>a*8)throw new Error("code length overflow. ("+i.getLengthInBits()+">"+a*8+")");for(i.getLengthInBits()+4<=a*8&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(!1);for(;!(i.getLengthInBits()>=a*8||(i.put(Ur.PAD0,8),i.getLengthInBits()>=a*8));)i.put(Ur.PAD1,8);return Ur.createBytes(i,r)};Ur.createBytes=function(t,e){for(var n=0,r=0,i=0,s=new Array(e.length),o=new Array(e.length),a=0;a<e.length;a++){var l=e[a].dataCount,d=e[a].totalCount-l;r=Math.max(r,l),i=Math.max(i,d),s[a]=new Array(l);for(var h=0;h<s[a].length;h++)s[a][h]=255&t.buffer[h+n];n+=l;var f=Vs.getErrorCorrectPolynomial(d),p=new gz(s[a],f.getLength()-1),g=p.mod(f);o[a]=new Array(f.getLength()-1);for(var h=0;h<o[a].length;h++){var x=h+g.getLength()-o[a].length;o[a][h]=x>=0?g.get(x):0}}for(var _=0,h=0;h<e.length;h++)_+=e[h].totalCount;for(var k=new Array(_),T=0,h=0;h<r;h++)for(var a=0;a<e.length;a++)h<s[a].length&&(k[T++]=s[a][h]);for(var h=0;h<i;h++)for(var a=0;a<e.length;a++)h<o[a].length&&(k[T++]=o[a][h]);return k};var yz=Ur,_v={};Object.defineProperty(_v,"__esModule",{value:!0});var vz=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xz=uk,Jn=wk(xz),xk=R,nd=wk(xk);function wk(t){return t&&t.__esModule?t:{default:t}}function wz(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}var _z={bgColor:Jn.default.oneOfType([Jn.default.object,Jn.default.string]).isRequired,bgD:Jn.default.string.isRequired,fgColor:Jn.default.oneOfType([Jn.default.object,Jn.default.string]).isRequired,fgD:Jn.default.string.isRequired,size:Jn.default.number.isRequired,title:Jn.default.string,viewBoxSize:Jn.default.number.isRequired,xmlns:Jn.default.string},Sv=(0,xk.forwardRef)(function(t,e){var n=t.bgColor,r=t.bgD,i=t.fgD,s=t.fgColor,o=t.size,a=t.title,l=t.viewBoxSize,d=t.xmlns,h=d===void 0?"http://www.w3.org/2000/svg":d,f=wz(t,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return nd.default.createElement("svg",vz({},f,{height:o,ref:e,viewBox:"0 0 "+l+" "+l,width:o,xmlns:h}),a?nd.default.createElement("title",null,a):null,nd.default.createElement("path",{d:r,fill:n}),nd.default.createElement("path",{d:i,fill:s}))});Sv.displayName="QRCodeSvg";Sv.propTypes=_z;_v.default=Sv;Object.defineProperty(Ff,"__esModule",{value:!0});Ff.QRCode=void 0;var Sz=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Tz=uk,ei=pu(Tz),Ez=dk,bz=pu(Ez),Iz=yz,Cz=pu(Iz),_k=R,kz=pu(_k),Az=_v,Rz=pu(Az);function pu(t){return t&&t.__esModule?t:{default:t}}function Pz(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}var Nz={bgColor:ei.default.oneOfType([ei.default.object,ei.default.string]),fgColor:ei.default.oneOfType([ei.default.object,ei.default.string]),level:ei.default.string,size:ei.default.number,value:ei.default.string.isRequired},zf=(0,_k.forwardRef)(function(t,e){var n=t.bgColor,r=n===void 0?"#FFFFFF":n,i=t.fgColor,s=i===void 0?"#000000":i,o=t.level,a=o===void 0?"L":o,l=t.size,d=l===void 0?256:l,h=t.value,f=Pz(t,["bgColor","fgColor","level","size","value"]),p=new Cz.default(-1,bz.default[a]);p.addData(h),p.make();var g=p.modules;return kz.default.createElement(Rz.default,Sz({},f,{bgColor:r,bgD:g.map(function(x,_){return x.map(function(k,T){return k?"":"M "+T+" "+_+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:s,fgD:g.map(function(x,_){return x.map(function(k,T){return k?"M "+T+" "+_+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:e,size:d,viewBoxSize:g.length}))});Ff.QRCode=zf;zf.displayName="QRCode";zf.propTypes=Nz;var Dz=Ff.default=zf;const jz=({user:t,onClose:e,userCoins:n,onShare:r,onShowFeedback:i})=>{const[s,o]=R.useState(null),a=d=>{const h=(t==null?void 0:t.email)||"UserPayment";return`upi://pay?pa=${L8}&pn=${V8}&am=${d}&cu=INR&tn=${encodeURIComponent(h)}`},l=d=>{const h=a(d);window.innerWidth>768?o({amount:d,link:h}):window.location.href=h};return u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)",background:"rgba(0,0,0,0.4)",zIndex:3e3,display:"flex",alignItems:"center",justifyContent:"center"},onClick:e,children:u.jsxs(Ue.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"neo-flat neo-popup",onClick:d=>d.stopPropagation(),style:{width:"90%",maxWidth:"420px",padding:"0",borderRadius:"24px",overflow:"hidden",display:"flex",flexDirection:"column",maxHeight:"90vh",margin:"20px 0",background:"var(--bg-color)",position:"relative"},children:[u.jsx(kn,{children:s&&u.jsxs(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"var(--bg-color)",zIndex:10,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"2rem"},children:[u.jsx("button",{onClick:()=>o(null),className:"neo-button icon-btn",style:{position:"absolute",top:"15px",right:"15px"},children:u.jsx(cn,{size:24})}),u.jsxs("h3",{style:{margin:"0 0 1.5rem 0",color:"var(--text-primary)"},children:["Scan to Pay ",s.amount]}),u.jsx("div",{style:{background:"white",padding:"16px",borderRadius:"16px"},children:u.jsx(Dz,{value:s.link,size:200})}),u.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",opacity:.7,fontSize:"0.9rem"},children:"Scan this QR code using GPay, PhonePe, or Paytm on your mobile."})]})}),u.jsxs("div",{style:{padding:"1.25rem 1.5rem",background:"var(--bg-color)",borderBottom:"1px solid rgba(0,0,0,0.05)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("div",{children:[u.jsx("h2",{style:{fontSize:"1.4rem",margin:0,fontWeight:"700",color:"var(--text-color)"},children:"Coin Store"}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"4px"},children:[u.jsx("span",{style:{fontSize:"0.9rem",opacity:.7},children:"Balance:"}),u.jsxs("span",{style:{fontSize:"1.1rem",fontWeight:"800",background:"rgba(99, 102, 241, 0.1)",padding:"2px 8px",borderRadius:"8px",color:"var(--accent-color)"},children:[n," "]})]})]}),u.jsxs("div",{style:{display:"flex",gap:"12px"},children:[i&&u.jsxs("button",{className:"neo-button",onClick:i,style:{padding:"0 16px",height:"36px",display:"flex",alignItems:"center",gap:"8px",fontSize:"0.9rem",fontWeight:"600",borderRadius:"12px",color:"var(--accent-color)",border:"none",cursor:"pointer"},title:"Help & Feedback",children:[u.jsx(rs,{size:18}),u.jsx("span",{children:"Help"})]}),u.jsx(Zr,{onClick:e})]})]}),u.jsxs("div",{style:{padding:"1.5rem",display:"flex",flexDirection:"column",gap:"1.5rem",overflowY:"auto",flex:1},children:[u.jsxs("div",{children:[u.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"0.8rem"},children:u.jsx("h4",{style:{margin:0,fontSize:"0.9rem",fontWeight:"700",textTransform:"uppercase",letterSpacing:"1px",opacity:.6},children:"Ways to Earn"})}),u.jsxs("div",{className:"neo-flat",style:{padding:"1.5rem",borderRadius:"20px",border:"none",background:"linear-gradient(135deg, rgba(59,130,246,0.08) 0%, rgba(255,255,255,0.05) 100%)",position:"relative",overflow:"hidden",boxShadow:"0 0 15px rgba(59, 130, 246, 0.5), 0 10px 25px -5px rgba(59, 130, 246, 0.15)"},children:[u.jsx("div",{style:{position:"absolute",top:0,right:0,background:"#3b82f6",color:"white",padding:"4px 12px",borderRadius:"0 0 0 16px",fontWeight:"700",fontSize:"0.75rem",letterSpacing:"0.5px"},children:"LAUNCH OFFER"}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.2rem",marginTop:"0.5rem"},children:[u.jsxs("div",{children:[u.jsx("h3",{style:{fontSize:"1.4rem",margin:"0 0 4px 0",color:"#1d4ed8",fontWeight:"800"},children:"Invite a Friend"}),u.jsx("p",{style:{margin:0,opacity:.8,fontSize:"0.9rem"},children:"Grow our community"})]}),u.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"800",color:"#f59e0b",textShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"+50"})]}),u.jsxs("button",{className:"neo-button",onClick:r,style:{width:"100%",justifyContent:"center",padding:"1rem",background:"#3b82f6",color:"white",border:"none",fontSize:"1rem",fontWeight:"700",borderRadius:"14px",gap:"8px",boxShadow:"0 4px 6px -1px rgba(59, 130, 246, 0.4)"},children:[u.jsx(d9,{size:18})," Invite Now"]})]}),u.jsxs("div",{className:"neo-flat",style:{marginTop:"1rem",padding:"1rem",borderRadius:"16px",border:"none",display:"flex",alignItems:"center",justifyContent:"space-between",background:"rgba(16, 185, 129, 0.05)",boxShadow:"0 0 10px rgba(16, 185, 129, 0.2)"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[u.jsx("div",{style:{background:"#10b981",color:"white",padding:"10px",borderRadius:"12px",boxShadow:"0 2px 5px rgba(16, 185, 129, 0.3)"},children:u.jsx(bo,{size:20,strokeWidth:3})}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"700",color:"var(--text-primary)",fontSize:"1rem"},children:"Daily Login"}),u.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:"Streak bonus active"})]})]}),u.jsx("div",{style:{fontWeight:"800",color:"#10b981",fontSize:"1.2rem"},children:"+5"})]}),u.jsxs("div",{className:"neo-flat",style:{marginTop:"1rem",padding:"1rem",borderRadius:"16px",border:"none",display:"flex",alignItems:"center",justifyContent:"space-between",background:"rgba(236, 72, 153, 0.05)",boxShadow:"0 0 10px rgba(236, 72, 153, 0.2)",cursor:"pointer"},onClick:i,children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[u.jsx("div",{style:{background:"#ec4899",color:"white",padding:"10px",borderRadius:"12px",boxShadow:"0 2px 5px rgba(236, 72, 153, 0.3)"},children:u.jsx(rs,{size:20,strokeWidth:2})}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"700",color:"var(--text-primary)",fontSize:"1rem"},children:"Find Mistakes"}),u.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:"Report errors to get free coins"})]})]}),u.jsx("div",{style:{fontWeight:"800",color:"#ec4899",fontSize:"0.9rem"},children:"Bonus"})]})]}),u.jsx("div",{style:{width:"100%",height:"1px",background:"var(--border-color)",opacity:.3}}),u.jsxs("div",{children:[u.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"0.8rem"},children:u.jsx("h4",{style:{margin:0,fontSize:"0.9rem",fontWeight:"700",textTransform:"uppercase",letterSpacing:"1px",opacity:.6},children:"Store"})}),u.jsxs("div",{className:"neo-flat",style:{padding:"1.2rem",borderRadius:"18px",border:"none",background:"linear-gradient(135deg, rgba(59,130,246,0.08) 0%, rgba(255,255,255,0) 100%)",marginBottom:"1rem",position:"relative",cursor:"pointer",boxShadow:"0 0 15px rgba(59, 130, 246, 0.3)"},onClick:()=>l(79),children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("div",{children:[u.jsx("h3",{style:{fontSize:"1.2rem",margin:"0 0 4px 0",color:"#1d4ed8",fontWeight:"700"},children:"50 Coins"}),u.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.85rem"},children:"Basic Pack"})]}),u.jsx("div",{style:{textAlign:"right"},children:u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"800",color:"#3b82f6"},children:"79"})})]}),u.jsxs("div",{style:{marginTop:"1rem",paddingTop:"0.8rem",borderTop:"1px dashed rgba(59,130,246,0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",color:"#1d4ed8",fontWeight:"600",fontSize:"0.9rem"},children:[u.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/f/f2/Google_Pay_Logo.svg",alt:"GPay",style:{height:"16px"}}),u.jsx("span",{children:"Tap to Pay"})]})]}),u.jsxs("div",{className:"neo-flat",style:{padding:"1.2rem",borderRadius:"18px",border:"none",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.08) 0%, rgba(255,255,255,0) 100%)",marginBottom:"1rem",position:"relative",cursor:"pointer",boxShadow:"0 0 15px rgba(16, 185, 129, 0.3)"},onClick:()=>l(299),children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("div",{children:[u.jsx("h3",{style:{fontSize:"1.2rem",margin:"0 0 4px 0",color:"#059669",fontWeight:"700"},children:"200 Coins"}),u.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.85rem"},children:"Popular Choice"})]}),u.jsx("div",{style:{textAlign:"right"},children:u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"800",color:"#10b981"},children:"299"})})]}),u.jsxs("div",{style:{marginTop:"1rem",paddingTop:"0.8rem",borderTop:"1px dashed rgba(16, 185, 129, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",color:"#059669",fontWeight:"600",fontSize:"0.9rem"},children:[u.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/f/f2/Google_Pay_Logo.svg",alt:"GPay",style:{height:"16px"}}),u.jsx("span",{children:"Tap to Pay"})]})]}),u.jsxs("div",{className:"neo-flat",style:{padding:"1.2rem",borderRadius:"18px",border:"none",background:"linear-gradient(135deg, rgba(245,158,11,0.08) 0%, rgba(255,255,255,0) 100%)",position:"relative",cursor:"pointer",boxShadow:"0 0 15px rgba(245, 158, 11, 0.5)"},onClick:()=>l(479),children:[u.jsx("div",{style:{position:"absolute",top:-10,left:20,background:"#f59e0b",color:"white",padding:"4px 10px",borderRadius:"8px",fontSize:"0.7rem",fontWeight:"700"},children:"BEST VALUE"}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("div",{children:[u.jsx("h3",{style:{fontSize:"1.2rem",margin:"0 0 4px 0",color:"#b45309",fontWeight:"700"},children:"500 Coins"}),u.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.85rem"},children:"Master Study Pack"})]}),u.jsx("div",{style:{textAlign:"right"},children:u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"800",color:"#f59e0b"},children:"479"})})]}),u.jsxs("div",{style:{marginTop:"1rem",paddingTop:"0.8rem",borderTop:"1px dashed rgba(245,158,11,0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",color:"#b45309",fontWeight:"600",fontSize:"0.9rem"},children:[u.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/f/f2/Google_Pay_Logo.svg",alt:"GPay",style:{height:"16px"}}),u.jsx("span",{children:"Tap to Pay"})]})]})]}),u.jsxs("div",{style:{background:"rgba(0,0,0,0.03)",padding:"1rem",borderRadius:"12px",fontSize:"0.85rem",opacity:.8,marginTop:"0.5rem"},children:[u.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"600"},children:"Alternative Payment Method:"}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[u.jsx("span",{children:"GPay to:"}),u.jsx("span",{style:{fontFamily:"monospace",fontWeight:"bold",fontSize:"1rem"},children:M8.replace("91","")})]}),u.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.8},children:"After payment, send the screenshot to the same number on WhatsApp to receive your coins."})]})]})]})})},Lz=({user:t,userProfile:e,onClose:n,onUpdateProfile:r,showAlert:i,onShowFeedback:s})=>{const[o,a]=R.useState(""),[l,d]=R.useState(!1),h=`${window.location.origin}/?ref=${(e==null?void 0:e.referralCode)||""}`,f=`Study smarter.
Remember longer.

${t.name} invites you to join Cardland to start easy, efficient and personalised learning journey.

${h}`,p=()=>{navigator.clipboard.writeText(e.referralCode),i("Referral code copied!")},g=()=>{const _=`https://wa.me/?text=${encodeURIComponent(f)}`;window.open(_,"_blank")},x=async()=>{if(o.trim()){if(o.trim()===e.referralCode){i("You can't refer yourself!");return}d(!0);try{const _=await Un.applyReferral(t.uid,o.trim());i(_.message||"Referral code applied successfully!"),n(),window.location.reload()}catch(_){const k=_.message||"Failed to apply referral code.";i(k)}finally{d(!1)}}};return u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(8px)",background:"rgba(0,0,0,0.5)",zIndex:3e3,display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsxs(Ue.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"neo-flat neo-popup",style:{padding:"2rem",maxWidth:"400px",width:"90%",position:"relative"},children:[u.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",display:"flex",gap:"8px"},children:[s&&u.jsxs("button",{className:"neo-button",onClick:s,style:{padding:"0 12px",height:"36px",display:"flex",alignItems:"center",gap:"8px",fontSize:"0.85rem",fontWeight:"600",borderRadius:"12px",color:"var(--accent-color)",border:"none",cursor:"pointer"},title:"Help & Feedback",children:[u.jsx(rs,{size:16}),u.jsx("span",{children:"Help"})]}),u.jsx(Zr,{onClick:n,size:20})]}),u.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[u.jsx("div",{className:"neo-inset",style:{width:"60px",height:"60px",borderRadius:"50%",margin:"0 auto 1rem",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)"},children:u.jsx(X8,{size:32})}),u.jsx("h2",{style:{margin:0},children:"Refer a Friend"}),u.jsxs("p",{style:{opacity:.7,marginTop:"0.5rem",fontSize:"0.95rem",lineHeight:"1.6"},children:["Invite a ",u.jsx("strong",{children:"first-time user"})," and earn ",u.jsx("strong",{style:{color:"#f59e0b"},children:"50 Coins"})," when they complete their first lesson!"]}),u.jsx("p",{style:{opacity:.6,marginTop:"0.75rem",fontSize:"0.85rem",fontStyle:"italic"},children:"Note: The referred user must be new to the app and complete a published lesson (demo and user-created lessons don't count)."})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[u.jsxs("button",{className:"neo-button",onClick:g,style:{background:"#25D366",color:"white",border:"none",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",padding:"12px",fontSize:"1.1rem"},children:[u.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),"Share Invite via WhatsApp"]}),u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"10px"},children:[u.jsx("div",{style:{height:"1px",flex:1,background:"var(--border-color)"}}),u.jsx("span",{style:{fontSize:"0.8rem",opacity:.5},children:"OR USE CODE"}),u.jsx("div",{style:{height:"1px",flex:1,background:"var(--border-color)"}})]}),u.jsxs("div",{className:"neo-inset",style:{marginTop:"15px",padding:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:"12px",fontSize:"1.2rem",fontWeight:"bold",letterSpacing:"1px"},children:[u.jsx("span",{children:(e==null?void 0:e.referralCode)||"----"}),u.jsx("button",{className:"neo-button icon-btn",onClick:p,title:"Copy Code",children:u.jsx(Q8,{size:20})})]})]}),!(e!=null&&e.referredBy)&&u.jsx("div",{style:{marginTop:"10px"},children:u.jsxs("details",{children:[u.jsx("summary",{style:{cursor:"pointer",fontSize:"0.9rem",opacity:.7,listStyle:"none",textAlign:"center"},children:"Have a referral code? Enter it here"}),u.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[u.jsx("input",{className:"neo-input",style:{flex:1},placeholder:"Enter code",value:o,onChange:_=>a(_.target.value)}),u.jsx("button",{className:"neo-button neo-glow-blue",onClick:x,disabled:l||!o,style:{background:"var(--accent-color)",color:"white"},children:l?"...":u.jsx(bo,{size:20})})]})]})}),(e==null?void 0:e.referredBy)&&u.jsxs("div",{className:"neo-inset",style:{padding:"0.8rem",textAlign:"center",fontSize:"0.9rem",color:"green"},children:["Referred by: ",e.referredBy]})]})]})})};class Mz{static async getUsers(e,n,r=!1){try{return console.log("[AdminService] Fetching authoritative registry from Firestore..."),(await Un.listUsers()).map(s=>{var o,a,l;return{id:s.id||s.uid||s.email,uid:s.uid||s.id,email:s.email,displayName:s.displayName||"Guest User",lastLogin:((l=(a=(o=s.lastSeen)==null?void 0:o.toDate)==null?void 0:a.call(o))==null?void 0:l.toISOString())||null,coins:s.coins||0,loginCount:s.loginCount||0}})}catch(i){throw console.error("[AdminService] Registry Sync Failed:",i),i}}static async grantCoins(e,n,r){let i=n.uid;if(!i&&n.id&&!n.id.includes("@")&&(i=n.id),!i&&n.email){console.log(`[AdminService] UID missing for ${n.email}, performing lookup...`);const s=await Un.getProfileByEmail(n.email);i=(s==null?void 0:s.uid)||(s==null?void 0:s.id)}if(!i)throw new Error("Could not identify user ID for transaction.");console.log(`[AdminService] Granting ${r} coins to ${i} via Secure Cloud Function...`);try{const o=await Go(Ko,"grantCoins")({uid:i,amount:r}),{newBalance:a}=o.data;return{success:!0,newBalance:a,email:n.email}}catch(s){console.error("[AdminService] Grant Coins failed:",s);const o=s.message||"Unknown error occurred";throw o.includes("permission-denied")?new Error("Permission Denied: You are not authorized to grant coins."):new Error(`Grant failed: ${o}`)}}static async getPrompts(){return[]}}const gS=Mz,Sk=R.createContext(null),Vz=({children:t})=>{const{user:e}=Ms(),{showToast:n}=jo(),[r,i]=R.useState([]),[s,o]=R.useState(!1),[a,l]=R.useState(new Set),[d,h]=R.useState(new Set),[f,p]=R.useState(null),[g,x]=R.useState({totalReceived:0,lastSync:null}),_=R.useCallback(async()=>{if(!e){p("AUTH_REQUIRED");return}o(!0),p(null);try{const k=await gS.getUsers(e.token);i(k||[]),x({totalReceived:(k==null?void 0:k.length)||0,lastSync:new Date().toLocaleTimeString()})}catch(k){console.error("[AdminContext] Discovery Failed:",k),p(k.message||"Failed to synchronize registry.")}finally{o(!1)}},[e]);return R.useEffect(()=>{e&&_()},[_,e]),u.jsx(Sk.Provider,{value:{users:r,loading:s,error:f,stats:g,processingIds:a,recentlyGranted:d,refresh:()=>_(),grantCoins:async(k,T)=>{const v=k.id||k.uid||k.email,w=k.coins||0;let j=!1;i(L=>L.map(V=>(V.id||V.uid||V.email)===v?{...V,coins:(V.coins||0)+T}:V)),n({message:`Granted ${T} coins to ${k.email}`,type:"undo",duration:1e4,onUndo:()=>{j=!0,i(L=>L.map(V=>(V.id||V.uid||V.email)===v?{...V,coins:w}:V))},onClose:async()=>{if(!j){l(L=>new Set(L).add(v));try{const L=await gS.grantCoins(e.token,k,T);L&&L.newBalance!==void 0&&i(V=>V.map(E=>(E.id||E.uid||E.email)===v?{...E,coins:L.newBalance}:E))}catch(L){console.error("[AdminContext] Grant failed",L),i(V=>V.map(E=>(E.id||E.uid||E.email)===v?{...E,coins:w}:E))}finally{l(L=>{const V=new Set(L);return V.delete(v),V})}}}})}},children:t})},Oz=()=>{const t=R.useContext(Sk);if(!t)throw new Error("useAdmin must be used within AdminProvider");return t},Fz=({children:t,activeSection:e,onNavigate:n,onClose:r})=>{const[i,s]=R.useState(!1),[o,a]=R.useState(!1),[l,d]=R.useState(!1);R.useEffect(()=>{const f=()=>a(window.innerWidth<=768);return f(),window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]);const h=()=>s(!i);return u.jsxs("div",{style:Tt.shell,children:[o&&u.jsxs("div",{style:Tt.mobileHeader,children:[u.jsx("button",{onClick:h,style:Tt.iconBtn,children:i?u.jsx(cn,{size:20}):u.jsx(YC,{size:20})}),u.jsx("span",{style:Tt.storeName,children:"Admin Workspace"}),u.jsx("button",{onClick:r,style:{...Tt.exitBtnTopRight,background:l?"#f1f2f3":"transparent"},onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),title:"Exit Admin",children:u.jsx(cn,{size:20})})]}),u.jsxs("aside",{style:{...Tt.sidebar,transform:o?i?"translateX(0)":"translateX(-100%)":"none",position:o?"absolute":"relative",height:"100%"},className:"admin-sidebar",children:[!o&&u.jsxs("div",{style:Tt.sidebarHeader,children:[u.jsx("div",{style:Tt.logoBadge,children:"A"}),u.jsx("span",{style:Tt.storeName,children:"Admin Workspace"})]}),u.jsxs("nav",{style:Tt.nav,children:[u.jsx("div",{style:Tt.sectionLabel,children:"GENERAL"}),u.jsx(cm,{icon:u.jsx(ZC,{size:18}),label:"Registry",active:e==="users",onClick:()=>{n("users"),o&&s(!1)}}),u.jsx(cm,{icon:u.jsx(GC,{size:18}),label:"Smart Paste",active:e==="smart_paste",onClick:()=>{n("smart_paste"),o&&s(!1)}}),u.jsx(cm,{icon:u.jsx(Y8,{size:18}),label:"Prompts",active:e==="prompts",onClick:()=>{n("prompts"),o&&s(!1)}})]})]}),o&&i&&u.jsx("div",{style:Tt.backdrop,onClick:()=>s(!1)}),u.jsxs("main",{style:{...Tt.main,paddingTop:o?"60px":"0"},children:[!o&&u.jsxs("header",{style:Tt.topBar,children:[u.jsxs("div",{style:Tt.searchWrapper,children:[u.jsx(Xg,{size:16,style:{opacity:.5}}),u.jsx("input",{type:"text",placeholder:"Search",style:Tt.globalSearch})]}),u.jsxs("div",{style:Tt.userMenu,children:[u.jsx("div",{style:Tt.avatar,children:"A"}),u.jsx("button",{onClick:r,style:{...Tt.exitBtnTopRight,background:l?"#f1f2f3":"transparent"},onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),title:"Exit Admin",children:u.jsx(cn,{size:20})})]})]}),u.jsx("div",{style:Tt.contentFrame,children:t})]})]})},cm=({icon:t,label:e,active:n,onClick:r})=>u.jsxs("button",{onClick:r,style:{...Tt.navItem,background:n?"#ffffff":"transparent",color:n?"#008060":"#5c5f62",fontWeight:n?600:500,boxShadow:n?"0 1px 3px rgba(0,0,0,0.1)":"none"},children:[t,u.jsx("span",{children:e})]}),Tt={shell:{position:"fixed",inset:0,background:"#f6f6f7",zIndex:5e3,display:"flex",fontFamily:'-apple-system, BlinkMacSystemFont, "San Francisco", "Segoe UI", Roboto, "Helvetica Neue", sans-serif'},mobileHeader:{position:"absolute",top:0,left:0,right:0,height:"56px",background:"white",borderBottom:"1px solid #e1e3e5",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 1rem",zIndex:20},sidebar:{width:"240px",background:"#ebebeb",borderRight:"1px solid #e1e3e5",display:"flex",flexDirection:"column",zIndex:30,transition:"transform 0.3s ease-in-out",boxShadow:"2px 0 8px rgba(0,0,0,0.1)"},backdrop:{position:"absolute",inset:0,background:"rgba(0,0,0,0.5)",zIndex:25},sidebarHeader:{padding:"1rem",display:"flex",alignItems:"center",gap:"0.75rem",borderBottom:"1px solid rgba(0,0,0,0.05)"},logoBadge:{width:"32px",height:"32px",background:"#5c5f62",color:"white",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700},storeName:{fontWeight:600,fontSize:"0.9rem",color:"#202223"},nav:{padding:"1rem 0.5rem",flex:1,display:"flex",flexDirection:"column",gap:"0.25rem"},sectionLabel:{fontSize:"0.75rem",fontWeight:600,color:"#444",padding:"0.5rem 0.75rem",marginTop:"0.5rem"},navItem:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.5rem 0.75rem",border:"none",borderRadius:"4px",cursor:"pointer",textAlign:"left",fontSize:"0.9rem",marginBottom:"2px"},exitBtnTopRight:{background:"transparent",border:"none",cursor:"pointer",padding:"8px",display:"flex",alignItems:"center",justifyContent:"center",color:"#5c5f62",borderRadius:"4px",transition:"background 0.2s ease"},main:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},topBar:{height:"56px",background:"white",borderBottom:"1px solid #e1e3e5",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 1rem"},searchWrapper:{width:"400px",height:"36px",background:"#f1f2f3",borderRadius:"4px",display:"flex",alignItems:"center",padding:"0 0.75rem",gap:"0.5rem",border:"1px solid #e1e3e5"},globalSearch:{border:"none",background:"transparent",outline:"none",width:"100%",fontSize:"0.9rem"},contentFrame:{flex:1,overflowY:"auto",padding:"2rem",maxWidth:"1100px",margin:"0 auto",width:"100%"},userMenu:{display:"flex",alignItems:"center",gap:"1rem"},avatar:{width:"32px",height:"32px",borderRadius:"50%",background:"#008060",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.8rem",fontWeight:600},iconBtn:{background:"none",border:"none",cursor:"pointer",padding:"4px"}},zz=({user:t,isOpen:e,onClose:n,onGrant:r})=>{const[i,s]=R.useState("");R.useState("Manual Grant");const[o,a]=R.useState(!1);if(!e||!t)return null;const l=[50,200,500],d=async h=>{if(h.preventDefault(),!(!i||i<=0)){a(!0);try{await r(t,parseInt(i)),n()}catch(f){console.error("Grant failed:",f)}finally{a(!1),s("")}}};return u.jsx("div",{style:pn.overlay,onClick:n,children:u.jsxs("div",{style:pn.modal,onClick:h=>h.stopPropagation(),children:[u.jsxs("div",{style:pn.header,children:[u.jsx("h3",{style:pn.title,children:"Grant Coins"}),u.jsx("button",{onClick:n,style:pn.closeBtn,children:u.jsx(cn,{size:20})})]}),u.jsxs("div",{style:pn.body,children:[u.jsxs("p",{style:pn.userText,children:["To: ",u.jsx("strong",{children:t.email})]}),u.jsx("div",{style:pn.quickGrid,children:l.map(h=>u.jsx("button",{type:"button",onClick:()=>s(h),style:{...pn.optionBtn,background:i===h?"#e3f1df":"white",borderColor:i===h?"#008060":"#e1e3e5",color:i===h?"#008060":"#202223"},children:h},h))}),u.jsxs("form",{onSubmit:d,style:pn.form,children:[u.jsxs("label",{style:pn.label,children:["Custom Amount",u.jsx("input",{type:"number",min:"1",value:i,onChange:h=>s(h.target.value),style:pn.input,placeholder:"Enter coin amount..."})]}),u.jsxs("div",{style:pn.actions,children:[u.jsx("button",{type:"button",onClick:n,style:pn.cancelBtn,disabled:o,children:"Cancel"}),u.jsx("button",{type:"submit",disabled:!i||o,style:{...pn.submitBtn,opacity:!i||o?.5:1,cursor:!i||o?"not-allowed":"pointer"},children:o?"Granting...":`Grant ${i||"..."} Coins`})]})]})]})]})})},pn={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},modal:{background:"white",borderRadius:"8px",width:"100%",maxWidth:"400px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},header:{padding:"1rem",borderBottom:"1px solid #e1e3e5",display:"flex",justifyContent:"space-between",alignItems:"center"},title:{margin:0,fontSize:"1rem",fontWeight:600},closeBtn:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#5c5f62",display:"flex"},body:{padding:"1.5rem"},userText:{marginTop:0,marginBottom:"1.5rem",color:"#5c5f62"},quickGrid:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.75rem",marginBottom:"1.5rem"},optionBtn:{padding:"0.75rem",border:"1px solid #e1e3e5",borderRadius:"4px",fontWeight:600,cursor:"pointer",fontSize:"0.9rem",transition:"all 0.2s"},form:{display:"flex",flexDirection:"column",gap:"1.5rem"},label:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.9rem",fontWeight:500},input:{padding:"0.75rem",border:"1px solid #e1e3e5",borderRadius:"4px",fontSize:"1rem"},actions:{display:"flex",justifyContent:"flex-end",gap:"0.75rem"},cancelBtn:{padding:"0.75rem 1rem",background:"white",border:"1px solid #e1e3e5",borderRadius:"4px",fontWeight:600,cursor:"pointer"},submitBtn:{padding:"0.75rem 1rem",background:"#008060",color:"white",border:"none",borderRadius:"4px",fontWeight:600,boxShadow:"0 1px 0 rgba(0,0,0,0.05)"}},Uz=()=>{const{users:t,loading:e,error:n,stats:r,refresh:i,grantCoins:s,processingIds:o,recentlyGranted:a}=Oz(),[l,d]=lr.useState(null);return e&&t.length===0?u.jsx($z,{}):n==="AUTH_REQUIRED"?u.jsx(Bz,{}):n?u.jsx(Wz,{error:n,retry:i}):u.jsxs("div",{style:Pe.container,children:[u.jsxs("div",{style:Pe.header,children:[u.jsx("h1",{style:Pe.title,children:"Users"}),u.jsxs("div",{style:Pe.actions,children:[u.jsxs("span",{style:Pe.badge,children:[t.length," Records"]}),u.jsx("button",{onClick:i,style:Pe.iconBtn,title:"Refresh Index",children:u.jsx(Mc,{size:16})})]})]}),r.lastSync&&u.jsxs("div",{style:Pe.diagnosticBanner,children:[u.jsx(H8,{size:14,color:"#008060"}),u.jsxs("span",{children:["Directory Synced at ",r.lastSync,". Status: Live from Firestore"]})]}),t.length===0?u.jsx(qz,{retry:i}):u.jsx("div",{style:Pe.card,children:u.jsx("div",{className:"table-responsive",children:u.jsxs("table",{style:Pe.table,children:[u.jsx("thead",{children:u.jsxs("tr",{style:Pe.theadRow,children:[u.jsx("th",{style:Pe.th,children:"Name"}),u.jsx("th",{style:Pe.th,children:"Email"}),u.jsx("th",{style:Pe.th,children:"Last Active"}),u.jsx("th",{style:Pe.th,children:"Logins"}),u.jsx("th",{style:Pe.th,children:"Coins"}),u.jsx("th",{style:Pe.th,children:"Actions"})]})}),u.jsx("tbody",{children:t.map(h=>{const f=h.id||h.uid||h.email,p=o==null?void 0:o.has(f);return u.jsxs("tr",{style:Pe.tr,children:[u.jsx("td",{style:Pe.td,children:u.jsx("span",{style:Pe.nameText,children:h.displayName})}),u.jsx("td",{style:Pe.td,children:h.email}),u.jsx("td",{style:Pe.td,children:h.lastLogin?new Date(h.lastLogin).toLocaleDateString():"-"}),u.jsx("td",{style:Pe.td,children:h.loginCount||0}),u.jsx("td",{style:Pe.td,children:u.jsx("span",{style:{color:"#008060",fontWeight:700,background:"#e3f1df",padding:"2px 8px",borderRadius:"10px",fontSize:"0.85rem"},children:h.coins||0})}),u.jsx("td",{style:Pe.td,children:u.jsx("button",{disabled:p,onClick:()=>d(h),style:{...Pe.actionLink,color:p?"#6d7175":"#008060",opacity:p?.5:1,cursor:p?"wait":"pointer",textDecoration:p?"none":"underline",display:"flex",alignItems:"center",gap:"4px"},children:p?"Store...":"Grant Coins"})})]},f)})})]})})}),u.jsx(zz,{user:l,isOpen:!!l,onClose:()=>d(null),onGrant:s}),u.jsx("style",{children:`
                .table-responsive { overflow-x: auto; }
                @media (max-width: 600px) {
                    /* Mobile styles can be enhanced here */
                }
            `})]})},Bz=()=>{const[t,e]=lr.useState(!1);return u.jsxs("div",{style:Pe.errorBox,children:[u.jsx(Z8,{size:32,color:"#5c5f62"}),u.jsx("h3",{style:Pe.errorTitle,children:"Authorization Required"}),u.jsx("p",{style:Pe.errorDesc,children:"Admin access requires Google Drive permissions."}),u.jsx("button",{disabled:t,onClick:async()=>{e(!0);try{console.log("[AdminAuth] Requesting Drive Access..."),await T8(),console.log("[AdminAuth] Access Granted. Refreshing context...")}catch(n){console.error("[AdminAuth] Access Denied:",n),alert(`Authorization Failed: ${n.message||n}`)}finally{e(!1)}},style:{...Pe.primaryBtn,opacity:t?.7:1,cursor:t?"wait":"pointer"},children:t?"Authorizing...":"Authorize Admin Access"})]})},$z=()=>u.jsxs("div",{style:Pe.centerBox,children:[u.jsx("div",{className:"polaris-spinner",style:Pe.spinner}),u.jsx("p",{style:{marginTop:"1rem",color:"#6d7175"},children:"Loading Users from Firestore..."})]}),Wz=({error:t,retry:e})=>u.jsxs("div",{style:Pe.errorBox,children:[u.jsx(B8,{size:32,color:"#d82c0d"}),u.jsx("h3",{style:Pe.errorTitle,children:"Directory Access Failed"}),u.jsx("p",{style:Pe.errorDesc,children:t}),u.jsx("button",{onClick:e,style:Pe.primaryBtn,children:"Retry Sync"})]}),qz=({retry:t})=>{const{user:e}=Ms(),[n,r]=lr.useState(!1),i=async()=>{if(e){r(!0);try{await Un.syncProfile(e),t()}catch(s){console.error(s),alert("Registration failed: "+s.message)}finally{r(!1)}}};return u.jsxs("div",{style:Pe.centerBox,children:[u.jsx(GC,{size:48,color:"#babec3"}),u.jsx("h2",{style:Pe.emptyTitle,children:"No Users Found"}),u.jsx("p",{style:Pe.emptyDesc,children:"The user directory is currently empty."}),u.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[u.jsxs("button",{onClick:t,style:Pe.primaryBtn,children:[u.jsx(Mc,{size:14,style:{marginRight:"8px"}})," Refresh List"]}),u.jsxs("button",{onClick:i,disabled:n||!e,style:{...Pe.primaryBtn,background:"white",color:"#008060",border:"1px solid #008060",display:"flex",alignItems:"center"},children:[u.jsx(p9,{size:14,style:{marginRight:"8px"}}),n?"Registering...":"Register Me"]})]})]})},Pe={container:{display:"flex",flexDirection:"column",gap:"1rem"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},title:{fontSize:"1.5rem",fontWeight:700,color:"#202223",margin:0},actions:{display:"flex",gap:"1rem",alignItems:"center"},badge:{background:"#dfe3e8",color:"#202223",padding:"0.25rem 0.75rem",borderRadius:"12px",fontSize:"0.8rem",fontWeight:600},iconBtn:{background:"white",border:"1px solid #e1e3e5",borderRadius:"4px",padding:"0.5rem",cursor:"pointer",color:"#5c5f62"},diagnosticBanner:{background:"#e3f1df",color:"#008060",padding:"0.75rem 1rem",borderRadius:"4px",fontSize:"0.85rem",display:"flex",alignItems:"center",gap:"0.5rem",border:"1px solid #1a1a1a0d"},card:{background:"white",borderRadius:"8px",boxShadow:"0 0 0 1px rgba(63, 63, 68, 0.05), 0 1px 3px 0 rgba(63, 63, 68, 0.15)",overflow:"hidden"},table:{width:"100%",borderCollapse:"collapse",textAlign:"left"},theadRow:{background:"#f9fafb",borderBottom:"1px solid #e1e3e5"},th:{padding:"1rem",fontSize:"0.8rem",fontWeight:600,color:"#6d7175",textTransform:"uppercase"},tr:{borderBottom:"1px solid #e1e3e5"},td:{padding:"1rem",fontSize:"0.9rem",color:"#202223"},nameText:{fontWeight:600},actionLink:{background:"none",border:"none",color:"#008060",fontWeight:600,cursor:"pointer",fontSize:"0.85rem",textDecoration:"underline"},centerBox:{padding:"4rem",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},primaryBtn:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:"#008060",color:"white",border:"none",borderRadius:"4px",fontWeight:600,cursor:"pointer"},errorBox:{padding:"2rem",background:"#fff4f4",border:"1px solid #eecaca",borderRadius:"8px",display:"flex",flexDirection:"column",alignItems:"center",color:"#8f2316"},errorTitle:{marginTop:"1rem",fontSize:"1.2rem"},errorDesc:{opacity:.8}},Hz=({onClose:t,showAlert:e,onEditLesson:n,initialSection:r="users"})=>{var T;const{user:i}=Ms(),[s,o]=R.useState(r),[a,l]=R.useState(""),[d,h]=R.useState(null),[f,p]=R.useState(null),g=v=>{o(v),p(null)},x=()=>{var v;try{p(null);const w=L9(a),j=w.questions||w.cards||[];if(!w.title&&j.length===0&&(((v=w.sections)==null?void 0:v.length)||0)===0)throw new Error("Could not find any valid lesson data in the paste.");h(w),e("Content processed successfully!")}catch(w){p(w.message)}},_=()=>{if(d&&n){const v={...d,questions:d.questions||d.cards||[],id:`draft-${Date.now()}`,isPublic:!0,owner:i==null?void 0:i.email};n(v),t()}},k=d?d.questions||d.cards||[]:[];return u.jsx(Vz,{children:u.jsxs(Fz,{activeSection:s,onNavigate:g,onClose:t,children:[s==="users"&&u.jsx(Uz,{}),s==="smart_paste"&&u.jsxs("div",{style:jt.card,children:[u.jsx("h2",{style:jt.cardTitle,children:"Smart Paste (New Schema Support)"}),u.jsx("p",{style:jt.cardDesc,children:"Paste lesson JSON following the new hierarchical schema (sections, noteSegments, etc.). The system will automatically recognize the structure."}),u.jsxs("div",{style:jt.pasteWrapper,children:[u.jsx("textarea",{style:jt.textarea,placeholder:"Paste JSON here...",value:a,onChange:v=>l(v.target.value)}),u.jsxs("div",{style:jt.pasteActions,children:[u.jsxs("button",{onClick:x,style:jt.primaryBtn,disabled:!a.trim(),children:[u.jsx(K8,{size:16,style:{marginRight:"8px"}}),"Analyze & Process"]}),a&&u.jsx("button",{onClick:()=>{l(""),h(null)},style:jt.secondaryBtn,children:"Clear"})]})]}),f&&u.jsxs("div",{style:jt.errorBanner,children:[u.jsx(qC,{size:18}),u.jsx("span",{children:f})]}),d&&u.jsxs("div",{style:jt.previewBox,children:[u.jsxs("div",{style:jt.previewHeader,children:[u.jsx(bo,{size:18,color:"#008060"}),u.jsx("h3",{style:jt.previewTitle,children:"Analysis Complete"})]}),u.jsxs("div",{style:jt.metaGrid,children:[u.jsx(Uo,{label:"Title",value:d.title}),u.jsx(Uo,{label:"Subject",value:d.subject}),u.jsx(Uo,{label:"Standard",value:d.standard}),u.jsx(Uo,{label:"Syllabus",value:d.syllabus}),u.jsx(Uo,{label:"Questions",value:k.length}),u.jsx(Uo,{label:"Sections",value:(T=d.sections)==null?void 0:T.length})]}),u.jsxs("button",{onClick:_,style:jt.editBtn,children:[u.jsx(o9,{size:16}),"Open in Lesson Editor"]})]})]}),s==="prompts"&&u.jsxs("div",{style:jt.card,children:[u.jsx("h2",{style:jt.cardTitle,children:"Prompt Library"}),u.jsx("p",{children:"Manage system prompts for AI generation."})]})]})})},Uo=({label:t,value:e})=>u.jsxs("div",{style:jt.metaItem,children:[u.jsxs("span",{style:jt.metaLabel,children:[t,":"]}),u.jsx("span",{style:jt.metaValue,children:e||"N/A"})]}),jt={card:{background:"white",padding:"2rem",borderRadius:"8px",border:"1px solid #e1e3e5",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},cardTitle:{marginBottom:"0.5rem",fontSize:"1.25rem",fontWeight:600,color:"#202223"},cardDesc:{marginBottom:"1.5rem",fontSize:"0.9rem",color:"#6d7175"},pasteWrapper:{display:"flex",flexDirection:"column",gap:"1rem"},textarea:{width:"100%",height:"200px",padding:"1rem",borderRadius:"4px",border:"1.5px solid #dcdfe3",fontFamily:"monospace",fontSize:"0.85rem",outline:"none",resize:"vertical"},pasteActions:{display:"flex",gap:"1rem"},primaryBtn:{padding:"0.75rem 1.5rem",background:"#008060",color:"white",border:"none",borderRadius:"4px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center"},secondaryBtn:{padding:"0.75rem 1rem",background:"transparent",color:"#5c5f62",border:"1px solid #c9cccf",borderRadius:"4px",cursor:"pointer"},errorBanner:{marginTop:"1rem",padding:"1rem",background:"#fff4f4",color:"#8f2316",borderRadius:"4px",display:"flex",alignItems:"center",gap:"0.75rem",fontSize:"0.9rem"},previewBox:{marginTop:"2rem",padding:"1.5rem",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e1e3e5"},previewHeader:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},previewTitle:{margin:0,fontSize:"1rem",fontWeight:600,color:"#008060"},metaGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},metaItem:{display:"flex",flexDirection:"column",gap:"0.25rem"},metaLabel:{fontSize:"0.75rem",fontWeight:600,color:"#6d7175",textTransform:"uppercase"},metaValue:{fontSize:"0.95rem",fontWeight:500,color:"#202223"},editBtn:{width:"100%",padding:"0.75rem",background:"white",color:"#2c6ecb",border:"1px solid #2c6ecb",borderRadius:"4px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"}},Gz=({lesson:t,user:e,onStart:n,onClose:r,onEdit:i,onDelete:s,showConfirm:o})=>{const a=R.useRef(null),l=e&&(t.ownedByMe||e.email===Ii);return!t||!t.importantNote?null:(R.useEffect(()=>{a.current&&(a.current.scrollTop=0)},[t]),u.jsxs(Ue.div,{ref:a,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"var(--bg-color)",zIndex:1500,display:"flex",flexDirection:"column",padding:window.innerWidth<768?"1rem":"2rem",overflowY:"auto",overscrollBehavior:"contain"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",flexShrink:0},children:[u.jsx("h2",{style:{fontSize:window.innerWidth<768?"1.5rem":"1.8rem",margin:0},children:"Important Note"}),u.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[l&&u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"neo-button icon-btn",onClick:()=>o(`Delete "${t.title}"?`,s),title:"Delete Lesson",style:{color:"#ef4444"},children:u.jsx(mi,{size:20})}),u.jsx("button",{className:"neo-button icon-btn",onClick:i,title:"Edit Lesson",children:u.jsx(vv,{size:20})})]}),u.jsx(Zr,{onClick:r,size:20})]})]}),u.jsx("div",{className:"neo-inset",style:{flex:1,padding:window.innerWidth<768?"1.25rem":"2rem",whiteSpace:"pre-wrap",fontSize:window.innerWidth<768?"1rem":"1.1rem",lineHeight:"1.6",color:"var(--text-color)",marginBottom:"8rem",borderRadius:"16px"},children:t.importantNote}),u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:n,style:{position:"fixed",bottom:"2rem",left:"50%",transform:"translateX(-50%)",padding:"1rem 2.5rem",fontSize:"1.2rem",background:"var(--accent-color)",color:"white",border:"none",borderRadius:"50px",display:"flex",alignItems:"center",gap:"10px",zIndex:1600,boxShadow:"0 4px 15px rgba(0,0,0,0.3)",width:"max-content",maxWidth:"90%"},children:[u.jsx(Of,{size:24,fill:"currentColor"}),"Start Review"]})]}))},Kz=({onSave:t})=>{const[e,n]=R.useState(""),r=i=>{i.preventDefault(),e.trim()&&t(e.trim())};return u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",background:"rgba(255,255,255,0.01)",zIndex:3e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},children:u.jsxs(Ue.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},className:"neo-flat",style:{width:"100%",maxWidth:"400px",padding:"2.5rem",textAlign:"center",display:"flex",flexDirection:"column",gap:"2rem"},children:[u.jsxs("div",{children:[u.jsx("div",{className:"neo-inset",style:{width:"64px",height:"64px",borderRadius:"50%",margin:"0 auto 1.5rem",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)"},children:u.jsx(Ad,{size:32})}),u.jsx("h2",{style:{fontSize:"1.8rem",marginBottom:"0.5rem"},children:"Welcome, Friend!"}),u.jsx("p",{style:{opacity:.6},children:"I want to be your well-wisher on this learning journey. What should I call you?"})]}),u.jsxs("form",{onSubmit:r,style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[u.jsx("div",{className:"neo-inset",style:{padding:"4px 15px",borderRadius:"12px",display:"flex",alignItems:"center"},children:u.jsx("input",{autoFocus:!0,type:"text",value:e,onChange:i=>n(i.target.value),placeholder:"Your name...",style:{width:"100%",padding:"12px 5px",background:"transparent",border:"none",fontSize:"1.1rem",color:"inherit",outline:"none"}})}),u.jsxs("button",{type:"submit",disabled:!e.trim(),className:"neo-button neo-glow-blue",style:{padding:"1.2rem",justifyContent:"center",gap:"0.8rem",background:"var(--accent-color)",color:"white",opacity:e.trim()?1:.5},children:[u.jsx(bo,{size:20}),"Get Started"]})]})]})})},Qz=({user:t,lessons:e,publicLessons:n,userProfile:r,activeLesson:i,reviewLesson:s,noteLesson:o,theme:a,onToggleTheme:l,soundsEnabled:d,onToggleSounds:h,onLogout:f,onDeleteData:p,onShowTour:g,onSaveLesson:x,onDeleteLesson:_,onImportLesson:k,onUpdateCoins:T,isUnlimited:v,signIn:w,onReviewStart:j,handleEditLesson:L,handleReviewLaunch:V,activeTab:E,fetchPublicLessons:S,fetchLessons:I,ADMIN_EMAIL:A,APP_VERSION:P,showNotification:N,setUserProfile:b,saveUserProfile:W,refreshProfile:de,onRestorePurchases:re})=>{const{modals:se,toggleModal:z,setReviewLesson:G,setNoteLesson:M,setActiveLesson:D}=jo(),{isActive:H,endTour:J,startTour:te}=fu(),ie=()=>{G(null),M(null),z("showAddModal",!1)},ee=lr.useRef({});return lr.useEffect(()=>{const U=["showMenu","showCoinModal","showReferral","showAdminPanel"];let Y=!1;U.forEach(pe=>{const _e=se[pe],ge=ee.current[pe];_e&&!ge&&(Y=!0)}),ee.current={...se},Y&&de&&(console.log("[ModalRegistry] Syncing profile on modal open."),de())},[se,de]),u.jsxs(kn,{children:[se.showMenu&&u.jsx(j9,{user:t,theme:a,onToggleTheme:l,soundsEnabled:d,onToggleSounds:h,onShowFeedback:()=>{z("showMenu",!1),window.history.pushState({modal:"active"},"",window.location.pathname),z("showFeedback",!0)},onShowReferral:()=>{z("showMenu",!1),window.history.pushState({modal:"active"},"",window.location.pathname),z("showReferral",!0)},onClose:()=>z("showMenu",!1),onLogout:f,onRestorePurchases:re,onLogin:()=>{z("showMenu",!1),w("consent")},onDeleteData:p,onShowAdminPanel:()=>{z("showMenu",!1),window.history.pushState({modal:"active"},"",window.location.pathname),z("showAdminPanel",!0)},onShowTour:()=>{z("showMenu",!1),J(),setTimeout(()=>te(),300)},appVersion:P}),se.showAddModal&&u.jsx(M9,{user:t,lesson:i,onClose:()=>window.history.back(),onSave:x,onDelete:_,showAlert:U=>N("alert",U),showConfirm:(U,Y)=>N("confirm",U,Y),availableLabels:[...new Set(e.map(U=>U.label).filter(U=>U))],allLessons:e,activeTab:E}),s&&u.jsx(nz,{lesson:s,user:t,onClose:ie,onUpdate:U=>x(U,!1),onEdit:()=>{L(s),G(null)},showAlert:U=>typeof U=="string"?N("alert",U):N(U.type,U.message,U.onConfirm),userCoins:(r==null?void 0:r.coins)||0,onDeductCoins:U=>{v||T(((r==null?void 0:r.coins)||0)-U)},isUnlimited:v,onReviewStart:j,displayName:r==null?void 0:r.displayName}),o&&u.jsx(Gz,{lesson:o,user:t,onStart:()=>{G(o),M(null)},onClose:()=>window.history.back(),onEdit:()=>{L(o),M(null)},onDelete:()=>_(o),showConfirm:(U,Y)=>N("confirm",U,Y)}),se.showFeedback&&u.jsx(rz,{user:t,onClose:()=>window.history.back(),showAlert:U=>N("alert",U)}),se.showKnowMore&&u.jsx(iz,{isOpen:se.showKnowMore,onClose:()=>window.history.back(),onLogin:()=>{z("showKnowMore",!1),onLoginRequired(null)}}),se.showCoinModal&&u.jsx(jz,{user:t,userCoins:(r==null?void 0:r.coins)||0,onClose:()=>window.history.back(),onShare:()=>{z("showCoinModal",!1),window.history.pushState({modal:"active"},"",window.location.pathname),z("showReferral",!0)},onShowFeedback:()=>{z("showCoinModal",!1),window.history.pushState({modal:"active"},"",window.location.pathname),z("showFeedback",!0)}}),se.showReferral&&u.jsx(Lz,{user:t,userProfile:r,onClose:()=>window.history.back(),onUpdateProfile:U=>{b(U),W(t.token,U)},showAlert:U=>N("alert",U),onShowFeedback:()=>{z("showReferral",!1),window.history.pushState({modal:"active"},"",window.location.pathname),z("showFeedback",!0)}}),se.showAdminPanel&&u.jsx(Hz,{user:t,onClose:()=>window.history.back(),publicLessons:n,onRefreshPublic:S,showAlert:U=>N("alert",U),showConfirm:(U,Y)=>N("confirm",U,Y),onEditLesson:L}),se.showNamePrompt&&!H&&u.jsx(Kz,{onSave:async U=>{const Y={...r,displayName:U};b(Y),z("showNamePrompt",!1),await W(t.token,Y)}})]})},Yz=()=>{try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return;const e=new t,n=e.createOscillator(),r=e.createGain();n.connect(r),r.connect(e.destination),n.type="sine",n.frequency.setValueAtTime(1200,e.currentTime),n.frequency.exponentialRampToValueAtTime(1800,e.currentTime+.1),r.gain.setValueAtTime(.3,e.currentTime),r.gain.exponentialRampToValueAtTime(.01,e.currentTime+.6),n.start(),n.stop(e.currentTime+.6)}catch(t){console.error("Audio play failed",t)}},Xz=()=>{try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return;const e=new t,n=[523.25,659.25,783.99,1046.5];let r=e.currentTime;n.forEach((i,s)=>{const o=e.createOscillator(),a=e.createGain();o.connect(a),a.connect(e.destination),o.type="triangle",o.frequency.value=i,a.gain.setValueAtTime(.1,r),a.gain.exponentialRampToValueAtTime(.01,r+.5),o.start(r),o.stop(r+.5),r+=.1})}catch(t){console.error("Celebration audio failed",t)}},Jz=({color:t})=>u.jsx("svg",{viewBox:"0 0 100 100",style:{width:"100%",height:"100%",fill:t},children:u.jsx("circle",{cx:"50",cy:"50",r:"40"})}),Zz=({color:t})=>u.jsx("svg",{viewBox:"0 0 100 100",style:{width:"100%",height:"100%",fill:t},children:u.jsx("path",{d:"M50 15 L90 85 L10 85 Z"})}),eU=({color:t})=>u.jsxs("svg",{viewBox:"0 0 100 100",style:{width:"100%",height:"100%",fill:t},children:[u.jsx("rect",{x:"35",y:"10",width:"30",height:"80",rx:"5"}),u.jsx("rect",{x:"10",y:"35",width:"80",height:"30",rx:"5"})]}),tU=({amount:t,onClose:e,type:n="Daily Login"})=>{const[r,i]=R.useState(0);R.useEffect(()=>{Xz();const l=setTimeout(()=>{Yz()},200);let d=0;const h=parseInt(t,10)||0;if(d===h){i(h);return}const f=1e3,p=performance.now(),g=x=>{const _=x-p,k=Math.min(_/f,1),T=1-Math.pow(1-k,4);i(Math.floor(d+(h-d)*T)),k<1&&requestAnimationFrame(g)};return requestAnimationFrame(g),()=>clearTimeout(l)},[t]);const s=12,o=["#FBBF24","#3B82F6","#EF4444","#10B981"],a=180;return u.jsx("div",{style:{position:"fixed",inset:0,zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"auto",backdropFilter:"blur(4px)",background:"rgba(0,0,0,0.3)"},onClick:e,children:u.jsxs("div",{style:{position:"relative"},onClick:l=>l.stopPropagation(),children:[u.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:0,height:0,pointerEvents:"none"},children:[...Array(s)].map((l,d)=>{const h=d/s*360,f=[Jz,Zz,eU][d%3];return u.jsx(Ue.div,{style:{position:"absolute",width:"32px",height:"32px"},initial:{x:0,y:0,scale:0,rotate:0},animate:{x:Math.cos(h*Math.PI/180)*a,y:Math.sin(h*Math.PI/180)*a,scale:[0,1.2,0],rotate:[0,180,360],opacity:[1,1,0]},transition:{duration:1.5,ease:"easeOut",delay:.1},children:u.jsx(f,{color:o[d%o.length]})},d)})}),u.jsxs(Ue.div,{initial:{scale:.8,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0},transition:{type:"spring",damping:15},style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem",textAlign:"center"},children:[u.jsxs("div",{style:{position:"relative"},children:[u.jsx(Ue.div,{animate:{y:[-10,10,-10],rotateY:[0,180,360]},transition:{y:{duration:2,repeat:1/0,ease:"easeInOut"},rotateY:{duration:4,repeat:1/0,ease:"linear"}},style:{width:"120px",height:"120px",background:"linear-gradient(135deg, #fbbf24, #d97706)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"4px solid #fef3c7",boxShadow:"0 10px 25px rgba(217, 119, 6, 0.4), inset 0 2px 5px rgba(255, 255, 255, 0.5)",position:"relative",zIndex:2},children:u.jsx(yv,{size:60,color:"white"})}),u.jsx("div",{style:{position:"absolute",inset:"-20px",background:"radial-gradient(circle, rgba(251, 191, 36, 0.4) 0%, transparent 70%)",borderRadius:"50%",zIndex:1}})]}),u.jsxs("div",{children:[u.jsx(Ue.h2,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},style:{color:"white",fontSize:"1.5rem",fontWeight:"900",textTransform:"uppercase",letterSpacing:"2px",textShadow:"0 2px 10px rgba(0,0,0,0.5)",marginBottom:"0.5rem"},children:n}),u.jsxs(Ue.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,type:"spring"},style:{color:"#fbbf24",fontSize:"4rem",fontWeight:"900",textShadow:"0 4px 15px rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center"},children:["+",r]})]}),u.jsxs(Ue.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:e,style:{background:"white",border:"none",borderRadius:"50px",padding:"1rem 3rem",fontSize:"1.2rem",fontWeight:"800",color:"#d97706",display:"flex",alignItems:"center",gap:"0.75rem",cursor:"pointer",boxShadow:"0 10px 20px rgba(0,0,0,0.2), 0 5px 0 #e5e7eb",marginTop:"1rem"},children:[u.jsx(bo,{size:24,strokeWidth:3}),"CONTINUE"]})]}),u.jsx("button",{onClick:e,style:{position:"absolute",top:"-4rem",right:"0",background:"rgba(255, 255, 255, 0.1)",border:"none",color:"white",padding:"0.5rem",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)",transition:"background 0.2s"},onMouseEnter:l=>l.currentTarget.style.background="rgba(255, 255, 255, 0.2)",onMouseLeave:l=>l.currentTarget.style.background="rgba(255, 255, 255, 0.1)",children:u.jsx(cn,{size:24})})]})})},nU=({onStartDemo:t,onGoToMyLessons:e,userName:n,onLogin:r,onAddLesson:i})=>{const{isActive:s,currentStep:o,nextStep:a,setStep:l,endTour:d,isDemoGracePeriod:h}=fu(),[f,p]=R.useState(null),[g,x]=R.useState(window.innerWidth<768);R.useRef(null),R.useEffect(()=>{const E=()=>x(window.innerWidth<768);return window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]);const _=R.useMemo(()=>[{id:1,targetId:null,mobilePos:{bottom:"20px",left:0,right:0,margin:"0 auto",width:"90%"},desktopPos:{bottom:"50px",left:"50px"},text:`Welcome${n?" "+n:""}! Im Chethan.
Im here to guide you through a more efficient way to learn and retain information.`,actionLabel:"Begin Tour",layout:"duo-card",canSkip:!0},{id:2,targetId:null,mobilePos:{bottom:"20px",left:0,right:0,margin:"0 auto",width:"90%"},desktopPos:{bottom:"20px",left:"20px"},text:"Your progress and lessons are stored securely in your personal Google Drive, ensuring your data remains private and under your exclusive control.",actionLabel:"Sign in with Google",onAction:r,layout:"duo-card",isLoginStep:!0,canSkip:!0,onSkip:()=>l(3),extraContent:u.jsxs("div",{style:{marginTop:"12px",padding:"14px",background:"var(--accent-soft)",borderRadius:"16px",border:"1px solid var(--tour-border)",fontSize:"0.85rem",color:"var(--tour-text)",textAlign:"left"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",fontWeight:"700"},children:[u.jsx("div",{style:{background:"var(--accent-color)",color:"white",width:"22px",height:"22px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.8rem"},children:"!"}),"Setup Requirement"]}),"To enable synchronization, please ensure you ",u.jsx("strong",{children:"check the permission box"})," during sign-in."]})},{id:3,targetId:"tab-lessons",text:"Explore our collection of professionally curated lessons. You can easily add any of these to your personal library.",actionLabel:"Next",layout:"tooltip",placement:"bottom",canSkip:!0},{id:4,targetId:"fab-add-lesson",text:"Ready to create your own? Click the '+' button to start building your personal lesson.",onAction:()=>{i==null||i(),a()},layout:"tooltip",placement:"top",canSkip:!0},{id:5,targetId:"lesson-modal-title-input",text:"Give your lesson a catchy title and start adding questions. You can use text, images, and even voice recordings!",actionLabel:"Got it",layout:"tooltip",placement:"bottom",canSkip:!1},{id:6,targetId:null,text:"You are now fully equipped for success. Start creating your own personalized lessons whenever you're ready.",actionLabel:"Get Started",onAction:e,layout:"duo-card",isFinalAction:!0,canSkip:!1}],[n,r,t,e,l,g,i]),k=_.findIndex(E=>E.id===o),T=_[k]||_[0];R.useEffect(()=>{if(!s)return;const E=()=>{if(T.targetId){const I=document.getElementById(T.targetId),P=(T.highlightId?document.getElementById(T.highlightId):null)||I;if(P){const N=P.getBoundingClientRect();p(N),N.top>=0&&N.left>=0&&N.bottom<=window.innerHeight&&N.right<=window.innerWidth||P.scrollIntoView({behavior:"smooth",block:"center"})}else p(null)}else p(null)};E(),window.addEventListener("resize",E),window.addEventListener("scroll",E);const S=setInterval(E,500);return()=>{window.removeEventListener("resize",E),window.removeEventListener("scroll",E),clearInterval(S)}},[o,T,s]);const v=()=>{T.onAction?T.onAction():T.isFinalAction?d():a()},w=E=>{E.stopPropagation(),T.onSkip?T.onSkip():a()};if(!s)return null;const j=()=>{const E=window.innerWidth,S=window.innerHeight,I=E<768;let A=I?Math.min(E-32,340):T.layout==="duo-card"?550:380;const P=16,N=16,b={position:"fixed",width:A,zIndex:"var(--tour-z-index)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"};if(!f)return{...b,left:(E-A)/2,top:I?"auto":(S-200)/2,bottom:I?"24px":"auto",maxWidth:`calc(100vw - ${P*2}px)`};const W=f.left+f.width/2,de=f.top+f.height/2;let re=T.placement||"bottom";return I&&((re==="left"||re==="right")&&(re=f.top>S/2?"top":"bottom"),re==="bottom"&&f.bottom+220>S&&(re="top"),re==="top"&&f.top<220&&(re="bottom")),re==="top"?(b.left=W-A/2,b.bottom=S-f.top+N):re==="bottom"?(b.left=W-A/2,b.top=f.bottom+N):re==="left"?(b.left=f.left-A-N,b.top=de-100):(b.left=f.right+N,b.top=de-100),b.left<P?b.left=P:b.left+A>E-P&&(b.left=E-A-P),b.top!==void 0?b.top<P?b.top=P:b.top+200>S&&(b.top=S-200-P):b.bottom!==void 0&&b.bottom<P&&(b.bottom=P),b.activePlacement=re,b.arrowLeft=W-b.left,b};if(!s||h)return null;const L=j(),V=g&&T.mobilePos?T.mobilePos:!g&&T.desktopPos?T.desktopPos:L;return u.jsxs("div",{className:"feature-tour-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:"var(--tour-z-index)",pointerEvents:"none"},children:[u.jsx(kn,{children:!T.targetId&&u.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"absolute",inset:0,background:"var(--tour-overlay-bg)",backdropFilter:"blur(4px)",pointerEvents:"auto"}})}),u.jsx(kn,{mode:"wait",children:u.jsx(Ue.div,{initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},style:{position:"fixed",display:"flex",flexDirection:"column",alignItems:"center",pointerEvents:"auto",...V},children:u.jsxs("div",{className:"neo-flat tour-glass",style:{background:"var(--tour-bg)",backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",color:"var(--tour-text)",borderRadius:"24px",border:"1px solid var(--tour-border)",padding:"1.25rem",display:"flex",flexDirection:g?"column":"row",alignItems:"center",gap:"1.25rem",overflow:"hidden",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1)",width:"100%",position:"relative"},children:[u.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minWidth:g?"60px":T.layout==="duo-card"?"140px":"90px",width:g?"60px":T.layout==="duo-card"?"140px":"90px",flexShrink:0},children:u.jsx("img",{src:xv,alt:"Guide",style:{width:"100%",height:"auto",maxWidth:"120px"}})}),u.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.75rem",textAlign:"left"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"8px"},children:[u.jsx("p",{style:{margin:0,fontSize:"0.95rem",lineHeight:"1.6",fontWeight:"600",whiteSpace:"pre-line"},children:T.text}),u.jsx("button",{onClick:d,style:{background:"none",border:"none",color:"var(--tour-text-muted)",cursor:"pointer",padding:4,flexShrink:0},children:u.jsx(cn,{size:18})})]}),T.extraContent,u.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"4px"},children:[T.canSkip&&u.jsx("button",{onClick:w,style:{padding:"0.6rem 1rem",background:"transparent",color:"var(--tour-text-muted)",fontWeight:"600",borderRadius:"12px",border:"1px solid var(--tour-border)",fontSize:"0.85rem"},children:"Skip"}),u.jsxs("button",{onClick:v,style:{flex:2,padding:"0.6rem 1.25rem",background:"var(--tour-accent)",color:"white",fontWeight:"700",borderRadius:"12px",boxShadow:"0 4px 0 var(--tour-accent-dark)",border:"none",fontSize:"0.9rem",display:"flex",justifyContent:"center",alignItems:"center",gap:"8px"},children:[T.isLoginStep&&u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"18px",height:"18px",style:{flexShrink:0},children:[u.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),u.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),u.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),u.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571l6.19,5.238C40.483,35.58,44,30.2,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),T.actionLabel,T.actionIcon||u.jsx(HC,{size:16})]})]})]}),T.targetId&&L.activePlacement&&(L.activePlacement==="top"||L.activePlacement==="bottom")&&u.jsx("div",{style:{position:"absolute",[L.activePlacement==="top"?"bottom":"top"]:"-8px",left:`${L.arrowLeft}px`,transform:"translateX(-50%)",borderLeft:"8px solid transparent",borderRight:"8px solid transparent",[L.activePlacement==="top"?"borderTop":"borderBottom"]:"8px solid var(--tour-bg)",zIndex:1}})]})},o)})]})},rU=()=>{const{user:t,signIn:e,signOut:n}=Ms(),{handleUpdateLocalLesson:r,deleteLesson:i,fetchLessons:s,fetchPublicLessons:o,lessons:a,setPublicLessons:l,publicLessons:d,setLessons:h}=nk(),{toggleModal:f,setReviewLesson:p,setNoteLesson:g,showNotification:x,setActiveLesson:_,showToast:k,modals:T,setHeaderLoading:v,showHeaderNotice:w}=jo(),{queuePostTourEvent:j,endTour:L}=fu(),V=async(N,b,W,de)=>{const re=(W==null?void 0:W.coins)||0;b>0&&de&&de(Math.max(0,re-b)),v(!0);const se=new Promise((z,G)=>setTimeout(()=>G(new Error("Operation timed out. Please try again.")),15e3));try{const z=async()=>{var ie,ee;if(!(t!=null&&t.uid))throw new Error("User must be logged in to add lessons.");console.log(`[AppActions] Recording ownership for "${N.title}" (${b} coins)`),await Un.purchaseLesson(t.uid,N.id,b,N.title),console.log("[AppActions] Entitlement recorded in Cloud Ledger.");let G={...N};console.log("[AppActions] Starting import for:",N.title);const M=G.questions||G.cards||[];if(G.isPublic&&M.length===0){const{getPublicFileContent:U}=await yr(()=>import("./publicDrive-5c32f71c.js"),[]),Y=G.storagePath||G.driveFileId||G.id;console.log("[AppActions] Fetching full content from:",Y);const pe=await U(Y);if(pe){let _e=null;if(typeof pe=="string"){const{decryptionService:Ae}=await yr(()=>Promise.resolve().then(()=>sm),void 0);console.log("[AppActions] Requesting server-side decryption...");const $=await((ie=Vr.currentUser)==null?void 0:ie.getIdToken());if(!$)throw new Error("User must be authenticated to decrypt lessons.");const ae=G.lessonId||G.id,ke=await Ae.decryptPublicLesson(pe,ae,$);_e=om(ke),console.log("[AppActions] Server decryption successful. Normalized questions:",(ee=_e.questions)==null?void 0:ee.length)}else _e=pe;G={...G,..._e,isPublic:!0};const ge=G.questions||G.cards||[];if(console.log("[AppActions] Merged content. Questions count:",ge.length),ge.length===0)throw new Error("Imported lesson contains no questions.")}else throw new Error("Could not fetch lesson questions for import.")}const H=(G.questions||G.cards||[]).length,J={...G,id:N.id,driveFileId:null,isPublic:!1,source:"local",isLocal:!0,cost:0,questionCount:H};console.log("[AppActions] Saving imported lesson as new local lesson. Questions:",H);const te=await In.saveLesson(J);r(J),k({message:b>0?`Purchased "${N.title}"!`:`Added "${N.title}"!`,type:"success"})};await Promise.race([z(),se])}catch(z){console.error("[AppActions] Import/Purchase failed:",z),b>0&&de&&de(re),x("alert",`Operation failed: ${z.message}`)}finally{v(!1)}},E=R.useCallback(async(N,b,W)=>{if(!t){j(()=>E(N,b,W)),e();return}const de=N.cost||0;if(de>0&&((b==null?void 0:b.coins)||0)<de){x("alert",`Not enough coins! You need ${de} coins.`);return}const re=()=>{V(N,de,b,W)};de>0?x("confirm",`Buy "${N.title}" for ${de} coins?`,re):re()},[t,j,e,x]),S=R.useCallback(N=>{if(!t)return;h(W=>W.filter(de=>de.id!==N.id)),In.softDeleteLesson(N.id),t.uid&&N.id&&Un.archiveLesson(t.uid,N.id).catch(W=>console.warn("Archive failed:",W));let b=!1;k({message:`Deleted "${N.title}"`,type:"undo",duration:1e4,onUndo:()=>{b=!0,h(W=>[...W,N]),In.restoreLesson(N.id),t.uid&&N.id&&Un.restoreLesson(t.uid,N.id).catch(W=>console.warn("Restore failed:",W))},onClose:async()=>{if(!b)try{await In.hardDeleteLesson(N),console.log(`[AppActions] Permanently deleted ${N.id}`)}catch(W){console.error("Hard delete background fail:",W)}}}),f("showAddModal",!1),p(null),g(null)},[t,f,p,g,h,k]),I=R.useCallback(async N=>{if(t&&window.confirm("Are you sure? This will delete ALL your lessons. This cannot be undone."))try{const b=a.filter(W=>W.driveFileId&&!W.isPublic);for(const W of b)await i(W);x("alert","All local data deleted."),N(),n()}catch(b){x("alert",`Cleanup partially failed: ${b.message}`)}finally{f("showMenu",!1)}},[t,a,i,n,x,f]),A=R.useCallback(async(N,b=null)=>{var re,se,z;let W=N;const de=W.questions||W.cards||[];if(W.isPublic&&!W.isLocal&&de.length===0)try{const{getPublicFileContent:G}=await yr(()=>import("./publicDrive-5c32f71c.js"),[]),M=W.storagePath||W.driveFileId||W.id,D=await G(M);if(D){let H=null;if(typeof D=="string"){const{decryptionService:J}=await yr(()=>Promise.resolve().then(()=>sm),void 0),te=await((re=Vr.currentUser)==null?void 0:re.getIdToken());if(!te){x("alert","Please sign in to edit this lesson.");return}const ie=W.lessonId||W.id,ee=await J.decryptPublicLesson(D,ie,te);H=om(ee)}else H=D;if(H&&(((se=H.questions)==null?void 0:se.length)>0||((z=H.cards)==null?void 0:z.length)>0))W={...W,...H,isPublic:!0},l(J=>J.map(te=>te.id===N.id?W:te));else throw new Error("Decrypted content has no questions.")}}catch(G){console.error("[AppActions] Failed to fetch full content for edit:",G),x("alert","Failed to load lesson for editing.");return}_(W),window.history.pushState({modal:"active"},"",window.location.pathname),f("showAddModal",!0)},[t,l,_,f,x]),P=R.useCallback(async N=>{var de;if(N.isPublic&&!N.isOwned&&!N.isLocal){if(!t){e("consent");return}w("Add to My Lessons to open");return}let b=N;if((b.questions||b.cards||[]).length===0&&b.isPublic&&!b.isLocal)try{const{getPublicFileContent:re}=await yr(()=>import("./publicDrive-5c32f71c.js"),[]),se=b.driveFileId||b.storagePath||b.id,z=await re(se);if(z){let G=null;if(typeof z=="string"){if(!G&&(z.startsWith("v1:")||z.length>100)){const{decryptionService:M}=await yr(()=>Promise.resolve().then(()=>sm),void 0),D=await((de=Vr.currentUser)==null?void 0:de.getIdToken());if(D){const H=b.lessonId||b.id,J=await M.decryptPublicLesson(z,H,D);G=om(J)}else{console.log("[AppActions] User not authenticated. Triggering sign-in..."),j(()=>P(N)),e("consent");return}}G||(G={})}else G=z;b={...b,...G}}}catch(re){console.error("[AppActions] Failed to fetch full content for review:",re),w("Add to My Lessons to open");return}b.importantNote?g(b):p(b)},[t,w,g,p,j,e]);return{handleImportLesson:E,handleDeleteLesson:S,handleDeleteAllData:I,handleEditLesson:A,handleReviewLaunch:P}},iU=()=>{const{user:t,signIn:e,signOut:n}=Ms(),{allowExit:r}=E9(!!t),{lessons:i,setLessons:s,publicLessons:o,setPublicLessons:a,loading:l,publicLoading:d,fetchLessons:h,fetchPublicLessons:f,handleUpdateLocalLesson:p}=nk(),{modals:g,toggleModal:x,activeLesson:_,setActiveLesson:k,reviewLesson:T,setReviewLesson:v,noteLesson:w,setNoteLesson:j,showNotification:L,headerLoading:V}=jo(),{isActive:E,currentStep:S,setStep:I,startTour:A,endTour:P,isDemoGracePeriod:N,setIsDemoGracePeriod:b}=fu(),[W,de]=R.useState(!1),[re,se]=R.useState(null),[z,G]=R.useState(localStorage.getItem("theme")||"light"),[M,D]=R.useState("Creation Date"),[H,J]=R.useState(null),[te,ie]=R.useState(""),[ee,U]=R.useState("my-lessons"),[Y,pe]=R.useState({standard:"",syllabus:"",medium:"",subject:""}),[_e,ge]=R.useState(localStorage.getItem("soundsEnabled")!=="false"),[Ae,$]=R.useState(!1),ae=R.useCallback(he=>L(he.type,he.message,he.onConfirm),[L]),{userProfile:ke,setUserProfile:Ge,handleUpdateCoins:Ye,loadProfile:Xe,isProfileLoading:dt}=T9(t,ae,se),{handleImportLesson:Ne,handleDeleteLesson:He,handleDeleteAllData:Kn,handleEditLesson:Qn,handleReviewLaunch:jn}=rU(),{performSync:kr}=b9(),Jt=W||l,Zt="1.1.4";R.useEffect(()=>{const he=Mi.get("app_version");if(he&&he!==Zt){console.log(`[VersionControl] Upgrading to ${Zt}.`);const fe=Mi.get("theme"),De=Mi.get("soundsEnabled");Mi.purge(),fe&&Mi.set("theme",fe),De&&Mi.set("soundsEnabled",De),Mi.set("app_version",Zt),window.location.reload(!0)}else Mi.set("app_version",Zt)},[]),R.useEffect(()=>{document.documentElement.setAttribute("data-theme",z),localStorage.setItem("theme",z)},[z]),R.useEffect(()=>{window.location.pathname.includes("/admin")&&x("showAdminPanel",!0),f(),t?(h(),x("showMenu",!1)):s([])},[t,h,f,s,x]),R.useEffect(()=>{E&&(S===3&&U("lessons"),S===4&&U("my-lessons"),S===2&&t&&I(3))},[E,S,t,I]),R.useEffect(()=>{N&&!T&&(b(!1),I(5),U("my-lessons"))},[T,N,I,b]),R.useEffect(()=>{const he=fe=>{re?se(null):w?j(null):g.showReferral?x("showReferral",!1):g.showFeedback?x("showFeedback",!1):g.showKnowMore?x("showKnowMore",!1):g.showAdminPanel?x("showAdminPanel",!1):g.showAdminQuickTools?x("showAdminQuickTools",!1):g.showCoinModal?x("showCoinModal",!1):g.showAddModal?x("showAddModal",!1):T?Ae?(window.history.pushState({modalOpen:!0},"",window.location.pathname),L("confirm","End session?",()=>{v(null),$(!1),window.history.back()})):v(null):g.showMenu?x("showMenu",!1):t&&(!fe.state||fe.state.guard!=="active")&&(window.history.pushState({guard:"active"},"",window.location.pathname),L("confirm","Sign out and exit?",()=>{r(),n(),window.history.back()}))};return window.addEventListener("popstate",he),()=>window.removeEventListener("popstate",he)},[re,g,w,T,Ae,t,n,r,x,j,v,L]);const Ar=R.useMemo(()=>{let he=H?i.filter(fe=>fe.label===H):i;if(te.trim()){const fe=te.toLowerCase().trim(),De=/^\d+\.$/.test(fe);he=he.filter(nt=>{const rt=(nt.title||"").toLowerCase();return De?new RegExp(`(^|\\s)${fe.replace(".","\\.")}(\\s|$)`).test(rt):rt.includes(fe)})}return[...he].sort((fe,De)=>{if(E){if(fe.id==="demo-lesson")return-1;if(De.id==="demo-lesson")return 1}return(De.id||0)-(fe.id||0)})},[i,H,te,E]),Ee=(ke==null?void 0:ke.unlimitedCoinsExpiry)&&new Date(ke.unlimitedCoinsExpiry).getTime()>Date.now();return u.jsxs(D9,{user:t,userProfile:ke,isUnlimited:Ee,isProfileLoading:dt,isAdmin:(t==null?void 0:t.email)===Ii,isTourActive:E,onShowCoinModal:()=>{window.history.pushState({modal:"active"},"",window.location.pathname),x("showCoinModal",!0)},onShowMenu:()=>x("showMenu",!0),onAddLesson:()=>{if(!t){e("consent");return}k(null),window.history.pushState({modal:"active"},"",window.location.pathname),x("showAddModal",!0)},headerLoading:V||Jt,children:[u.jsx(P9,{activeTab:ee,setActiveTab:U,lessons:Ar,publicLessons:o,user:t,onLogin:he=>e(he||"consent"),loading:Jt,publicLoading:d,userCoins:(ke==null?void 0:ke.coins)||0,onReview:jn,onEdit:Qn,onImport:he=>Ne(he,ke,Ye),searchQuery:te,setSearchQuery:ie,onShowFeedback:()=>{window.history.pushState({modal:"active"},"",window.location.pathname),x("showFeedback",!0)},filters:Y,setFilters:pe,sortBy:M,onSortChange:D,filterLabel:H,onLabelChange:J,availableLabels:[...new Set(i.map(he=>he.label).filter(he=>he))],onShowKnowMore:()=>{window.history.pushState({modal:"active"},"",window.location.pathname),x("showKnowMore",!0)},onDelete:He,showConfirm:(he,fe)=>L("confirm",he,fe),onAddLesson:()=>{k(null),window.history.pushState({modal:"active"},"",window.location.pathname),x("showAddModal",!0)},onRefresh:()=>{ee==="my-lessons"&&t?(h(),Xe()):f()}}),u.jsx(Qz,{user:t,lessons:i,publicLessons:o,userProfile:ke,activeLesson:_,reviewLesson:T,noteLesson:w,theme:z,onToggleTheme:()=>G(he=>he==="light"?"dark":"light"),soundsEnabled:_e,onToggleSounds:()=>{const he=!_e;return ge(he),localStorage.setItem("soundsEnabled",he),he},onLogout:()=>{r(),n()},onDeleteData:()=>Kn(r),onShowTour:()=>{x("showMenu",!1),P(),setTimeout(()=>A(),300)},onSaveLesson:(he,fe,De)=>{p(he),(he.isPublic||De)&&f(),fe!==!1&&window.history.back()},onDeleteLesson:He,onImportLesson:he=>Ne(he,ke,Ye),onUpdateCoins:Ye,isUnlimited:Ee,signIn:e,onReviewStart:()=>$(!0),handleEditLesson:Qn,handleReviewLaunch:jn,activeTab:ee,fetchPublicLessons:f,fetchLessons:h,ADMIN_EMAIL:Ii,APP_VERSION:Zt,showNotification:L,setUserProfile:Ge,refreshProfile:Xe,onRestorePurchases:()=>kr(!0,h)}),u.jsx(nU,{userName:ke==null?void 0:ke.displayName,onLogin:()=>e("consent"),onAddLesson:()=>{k(null),window.history.pushState({modal:"active"},"",window.location.pathname),x("showAddModal",!0)},onStartDemo:()=>{const he=i.find(fe=>fe.id==="demo-lesson")||DEMO_LESSON;jn(he),b(!0)},onGoToMyLessons:()=>{U("my-lessons"),P()}}),u.jsx(kn,{children:re&&!E&&u.jsx(tU,{amount:re.amount,type:re.type,onClose:()=>se(null)})})]})},sU=()=>u.jsx(zC,{children:u.jsx(_9,{children:u.jsx(ik,{children:u.jsx(S9,{children:u.jsx(iU,{})})})})});console.log("%c Chethan in Cardland ","background: #4f46e5; color: #fff; font-weight: bold; padding: 4px; border-radius: 4px;");console.log(`Build Version: 1.1.1 | Sync: ${new Date().toISOString()}`);um.createRoot(document.getElementById("root")).render(u.jsx(lr.StrictMode,{children:u.jsx(zC,{children:u.jsx(ik,{children:u.jsx(sU,{})})})}));"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(t=>{for(const e of t)console.log("Unregistering Service Worker:",e),e.unregister()});export{hU as a,Ho as b,x3 as c,Ys as d,V3 as e,mU as f,M3 as g,Xp as h,dU as o,D3 as q,pU as r,Xu as s,fU as u,uU as w};
