var Gf=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var ne=(t,e,n)=>(Gf(t,e,"read from private field"),n?n.call(t):e.get(t)),He=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},st=(t,e,n,r)=>(Gf(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var $t=(t,e,n)=>(Gf(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function kk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var sT={exports:{}},Nh={},oT={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oc=Symbol.for("react.element"),Ak=Symbol.for("react.portal"),Rk=Symbol.for("react.fragment"),Pk=Symbol.for("react.strict_mode"),Nk=Symbol.for("react.profiler"),Dk=Symbol.for("react.provider"),jk=Symbol.for("react.context"),Lk=Symbol.for("react.forward_ref"),Mk=Symbol.for("react.suspense"),Vk=Symbol.for("react.memo"),Ok=Symbol.for("react.lazy"),Zv=Symbol.iterator;function Fk(t){return t===null||typeof t!="object"?null:(t=Zv&&t[Zv]||t["@@iterator"],typeof t=="function"?t:null)}var aT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lT=Object.assign,cT={};function Ga(t,e,n){this.props=t,this.context=e,this.refs=cT,this.updater=n||aT}Ga.prototype.isReactComponent={};Ga.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ga.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function uT(){}uT.prototype=Ga.prototype;function $g(t,e,n){this.props=t,this.context=e,this.refs=cT,this.updater=n||aT}var Wg=$g.prototype=new uT;Wg.constructor=$g;lT(Wg,Ga.prototype);Wg.isPureReactComponent=!0;var e1=Array.isArray,dT=Object.prototype.hasOwnProperty,qg={current:null},hT={key:!0,ref:!0,__self:!0,__source:!0};function fT(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)dT.call(e,r)&&!hT.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Oc,type:t,key:s,ref:o,props:i,_owner:qg.current}}function Uk(t,e){return{$$typeof:Oc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Hg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Oc}function zk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var t1=/\/+/g;function Kf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?zk(""+t.key):e.toString(36)}function Xu(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Oc:case Ak:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Kf(o,0):r,e1(i)?(n="",t!=null&&(n=t.replace(t1,"$&/")+"/"),Xu(i,e,n,"",function(d){return d})):i!=null&&(Hg(i)&&(i=Uk(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(t1,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",e1(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Kf(s,a);o+=Xu(s,e,n,l,i)}else if(l=Fk(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Kf(s,a++),o+=Xu(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function xu(t,e,n){if(t==null)return t;var r=[],i=0;return Xu(t,r,"","",function(s){return e.call(n,s,i++)}),r}function Bk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var _n={current:null},Ju={transition:null},$k={ReactCurrentDispatcher:_n,ReactCurrentBatchConfig:Ju,ReactCurrentOwner:qg};function pT(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:xu,forEach:function(t,e,n){xu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return xu(t,function(){e++}),e},toArray:function(t){return xu(t,function(e){return e})||[]},only:function(t){if(!Hg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Le.Component=Ga;Le.Fragment=Rk;Le.Profiler=Nk;Le.PureComponent=$g;Le.StrictMode=Pk;Le.Suspense=Mk;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$k;Le.act=pT;Le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=lT({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=qg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)dT.call(e,l)&&!hT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:Oc,type:t.type,key:i,ref:s,props:r,_owner:o}};Le.createContext=function(t){return t={$$typeof:jk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Dk,_context:t},t.Consumer=t};Le.createElement=fT;Le.createFactory=function(t){var e=fT.bind(null,t);return e.type=t,e};Le.createRef=function(){return{current:null}};Le.forwardRef=function(t){return{$$typeof:Lk,render:t}};Le.isValidElement=Hg;Le.lazy=function(t){return{$$typeof:Ok,_payload:{_status:-1,_result:t},_init:Bk}};Le.memo=function(t,e){return{$$typeof:Vk,type:t,compare:e===void 0?null:e}};Le.startTransition=function(t){var e=Ju.transition;Ju.transition={};try{t()}finally{Ju.transition=e}};Le.unstable_act=pT;Le.useCallback=function(t,e){return _n.current.useCallback(t,e)};Le.useContext=function(t){return _n.current.useContext(t)};Le.useDebugValue=function(){};Le.useDeferredValue=function(t){return _n.current.useDeferredValue(t)};Le.useEffect=function(t,e){return _n.current.useEffect(t,e)};Le.useId=function(){return _n.current.useId()};Le.useImperativeHandle=function(t,e,n){return _n.current.useImperativeHandle(t,e,n)};Le.useInsertionEffect=function(t,e){return _n.current.useInsertionEffect(t,e)};Le.useLayoutEffect=function(t,e){return _n.current.useLayoutEffect(t,e)};Le.useMemo=function(t,e){return _n.current.useMemo(t,e)};Le.useReducer=function(t,e,n){return _n.current.useReducer(t,e,n)};Le.useRef=function(t){return _n.current.useRef(t)};Le.useState=function(t){return _n.current.useState(t)};Le.useSyncExternalStore=function(t,e,n){return _n.current.useSyncExternalStore(t,e,n)};Le.useTransition=function(){return _n.current.useTransition()};Le.version="18.3.1";oT.exports=Le;var R=oT.exports;const Ir=kk(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wk=R,qk=Symbol.for("react.element"),Hk=Symbol.for("react.fragment"),Gk=Object.prototype.hasOwnProperty,Kk=Wk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qk={key:!0,ref:!0,__self:!0,__source:!0};function mT(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Gk.call(e,r)&&!Qk.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:qk,type:t,key:s,ref:o,props:i,_owner:Kk.current}}Nh.Fragment=Hk;Nh.jsx=mT;Nh.jsxs=mT;sT.exports=Nh;var u=sT.exports,Zp={},gT={exports:{}},$n={},yT={exports:{}},vT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(U,G){var M=U.length;U.push(G);e:for(;0<M;){var D=M-1>>>1,q=U[D];if(0<i(q,G))U[D]=G,U[M]=q,M=D;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var G=U[0],M=U.pop();if(M!==G){U[0]=M;e:for(var D=0,q=U.length,J=q>>>1;D<J;){var ee=2*(D+1)-1,ie=U[ee],Z=ee+1,z=U[Z];if(0>i(ie,M))Z<q&&0>i(z,ie)?(U[D]=z,U[Z]=M,D=Z):(U[D]=ie,U[ee]=M,D=ee);else if(Z<q&&0>i(z,M))U[D]=z,U[Z]=M,D=Z;else break e}}return G}function i(U,G){var M=U.sortIndex-G.sortIndex;return M!==0?M:U.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,f=null,p=3,g=!1,x=!1,_=!1,k=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(U){for(var G=n(d);G!==null;){if(G.callback===null)r(d);else if(G.startTime<=U)r(d),G.sortIndex=G.expirationTime,e(l,G);else break;G=n(d)}}function j(U){if(_=!1,w(U),!x)if(n(l)!==null)x=!0,re(L);else{var G=n(d);G!==null&&se(j,G.startTime-U)}}function L(U,G){x=!1,_&&(_=!1,S(T),T=-1),g=!0;var M=p;try{for(w(G),f=n(l);f!==null&&(!(f.expirationTime>G)||U&&!P());){var D=f.callback;if(typeof D=="function"){f.callback=null,p=f.priorityLevel;var q=D(f.expirationTime<=G);G=t.unstable_now(),typeof q=="function"?f.callback=q:f===n(l)&&r(l),w(G)}else r(l);f=n(l)}if(f!==null)var J=!0;else{var ee=n(d);ee!==null&&se(j,ee.startTime-G),J=!1}return J}finally{f=null,p=M,g=!1}}var V=!1,E=null,T=-1,I=5,A=-1;function P(){return!(t.unstable_now()-A<I)}function N(){if(E!==null){var U=t.unstable_now();A=U;var G=!0;try{G=E(!0,U)}finally{G?b():(V=!1,E=null)}}else V=!1}var b;if(typeof v=="function")b=function(){v(N)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,he=H.port2;H.port1.onmessage=N,b=function(){he.postMessage(null)}}else b=function(){k(N,0)};function re(U){E=U,V||(V=!0,b())}function se(U,G){T=k(function(){U(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_continueExecution=function(){x||g||(x=!0,re(L))},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(U){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var M=p;p=G;try{return U()}finally{p=M}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(U,G){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var M=p;p=U;try{return G()}finally{p=M}},t.unstable_scheduleCallback=function(U,G,M){var D=t.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?D+M:D):M=D,U){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=M+q,U={id:h++,callback:G,priorityLevel:U,startTime:M,expirationTime:q,sortIndex:-1},M>D?(U.sortIndex=M,e(d,U),n(l)===null&&U===n(d)&&(_?(S(T),T=-1):_=!0,se(j,M-D))):(U.sortIndex=q,e(l,U),x||g||(x=!0,re(L))),U},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(U){var G=p;return function(){var M=p;p=G;try{return U.apply(this,arguments)}finally{p=M}}}})(vT);yT.exports=vT;var Yk=yT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xk=R,zn=Yk;function Q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xT=new Set,nc={};function bo(t,e){ka(t,e),ka(t+"Capture",e)}function ka(t,e){for(nc[t]=e,t=0;t<e.length;t++)xT.add(e[t])}var vi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),em=Object.prototype.hasOwnProperty,Jk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,n1={},r1={};function Zk(t){return em.call(r1,t)?!0:em.call(n1,t)?!1:Jk.test(t)?r1[t]=!0:(n1[t]=!0,!1)}function eA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function tA(t,e,n,r){if(e===null||typeof e>"u"||eA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Tn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xt[t]=new Tn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xt[e]=new Tn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xt[t]=new Tn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xt[t]=new Tn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xt[t]=new Tn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xt[t]=new Tn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xt[t]=new Tn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xt[t]=new Tn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xt[t]=new Tn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gg=/[\-:]([a-z])/g;function Kg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gg,Kg);Xt[e]=new Tn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gg,Kg);Xt[e]=new Tn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gg,Kg);Xt[e]=new Tn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xt[t]=new Tn(t,1,!1,t.toLowerCase(),null,!1,!1)});Xt.xlinkHref=new Tn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xt[t]=new Tn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Qg(t,e,n,r){var i=Xt.hasOwnProperty(e)?Xt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(tA(e,n,i,r)&&(n=null),r||i===null?Zk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ai=Xk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wu=Symbol.for("react.element"),Ko=Symbol.for("react.portal"),Qo=Symbol.for("react.fragment"),Yg=Symbol.for("react.strict_mode"),tm=Symbol.for("react.profiler"),wT=Symbol.for("react.provider"),_T=Symbol.for("react.context"),Xg=Symbol.for("react.forward_ref"),nm=Symbol.for("react.suspense"),rm=Symbol.for("react.suspense_list"),Jg=Symbol.for("react.memo"),$i=Symbol.for("react.lazy"),TT=Symbol.for("react.offscreen"),i1=Symbol.iterator;function fl(t){return t===null||typeof t!="object"?null:(t=i1&&t[i1]||t["@@iterator"],typeof t=="function"?t:null)}var mt=Object.assign,Qf;function Il(t){if(Qf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Qf=e&&e[1]||""}return`
`+Qf+t}var Yf=!1;function Xf(t,e){if(!t||Yf)return"";Yf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Yf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Il(t):""}function nA(t){switch(t.tag){case 5:return Il(t.type);case 16:return Il("Lazy");case 13:return Il("Suspense");case 19:return Il("SuspenseList");case 0:case 2:case 15:return t=Xf(t.type,!1),t;case 11:return t=Xf(t.type.render,!1),t;case 1:return t=Xf(t.type,!0),t;default:return""}}function im(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Qo:return"Fragment";case Ko:return"Portal";case tm:return"Profiler";case Yg:return"StrictMode";case nm:return"Suspense";case rm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _T:return(t.displayName||"Context")+".Consumer";case wT:return(t._context.displayName||"Context")+".Provider";case Xg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Jg:return e=t.displayName||null,e!==null?e:im(t.type)||"Memo";case $i:e=t._payload,t=t._init;try{return im(t(e))}catch{}}return null}function rA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return im(e);case 8:return e===Yg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function vs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ST(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function iA(t){var e=ST(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function _u(t){t._valueTracker||(t._valueTracker=iA(t))}function ET(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=ST(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ed(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function sm(t,e){var n=e.checked;return mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function s1(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=vs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function bT(t,e){e=e.checked,e!=null&&Qg(t,"checked",e,!1)}function om(t,e){bT(t,e);var n=vs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?am(t,e.type,n):e.hasOwnProperty("defaultValue")&&am(t,e.type,vs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function o1(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function am(t,e,n){(e!=="number"||Ed(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Cl=Array.isArray;function ha(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+vs(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function lm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Q(91));return mt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function a1(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Q(92));if(Cl(n)){if(1<n.length)throw Error(Q(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:vs(n)}}function IT(t,e){var n=vs(e.value),r=vs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function l1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function CT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?CT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Tu,kT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Tu=Tu||document.createElement("div"),Tu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Tu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function rc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ll={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sA=["Webkit","ms","Moz","O"];Object.keys(Ll).forEach(function(t){sA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ll[e]=Ll[t]})});function AT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ll.hasOwnProperty(t)&&Ll[t]?(""+e).trim():e+"px"}function RT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=AT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var oA=mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function um(t,e){if(e){if(oA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Q(62))}}function dm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hm=null;function Zg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fm=null,fa=null,pa=null;function c1(t){if(t=zc(t)){if(typeof fm!="function")throw Error(Q(280));var e=t.stateNode;e&&(e=Vh(e),fm(t.stateNode,t.type,e))}}function PT(t){fa?pa?pa.push(t):pa=[t]:fa=t}function NT(){if(fa){var t=fa,e=pa;if(pa=fa=null,c1(t),e)for(t=0;t<e.length;t++)c1(e[t])}}function DT(t,e){return t(e)}function jT(){}var Jf=!1;function LT(t,e,n){if(Jf)return t(e,n);Jf=!0;try{return DT(t,e,n)}finally{Jf=!1,(fa!==null||pa!==null)&&(jT(),NT())}}function ic(t,e){var n=t.stateNode;if(n===null)return null;var r=Vh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Q(231,e,typeof n));return n}var pm=!1;if(vi)try{var pl={};Object.defineProperty(pl,"passive",{get:function(){pm=!0}}),window.addEventListener("test",pl,pl),window.removeEventListener("test",pl,pl)}catch{pm=!1}function aA(t,e,n,r,i,s,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Ml=!1,bd=null,Id=!1,mm=null,lA={onError:function(t){Ml=!0,bd=t}};function cA(t,e,n,r,i,s,o,a,l){Ml=!1,bd=null,aA.apply(lA,arguments)}function uA(t,e,n,r,i,s,o,a,l){if(cA.apply(this,arguments),Ml){if(Ml){var d=bd;Ml=!1,bd=null}else throw Error(Q(198));Id||(Id=!0,mm=d)}}function Io(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function MT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function u1(t){if(Io(t)!==t)throw Error(Q(188))}function dA(t){var e=t.alternate;if(!e){if(e=Io(t),e===null)throw Error(Q(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return u1(i),t;if(s===r)return u1(i),e;s=s.sibling}throw Error(Q(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(Q(189))}}if(n.alternate!==r)throw Error(Q(190))}if(n.tag!==3)throw Error(Q(188));return n.stateNode.current===n?t:e}function VT(t){return t=dA(t),t!==null?OT(t):null}function OT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=OT(t);if(e!==null)return e;t=t.sibling}return null}var FT=zn.unstable_scheduleCallback,d1=zn.unstable_cancelCallback,hA=zn.unstable_shouldYield,fA=zn.unstable_requestPaint,Et=zn.unstable_now,pA=zn.unstable_getCurrentPriorityLevel,ey=zn.unstable_ImmediatePriority,UT=zn.unstable_UserBlockingPriority,Cd=zn.unstable_NormalPriority,mA=zn.unstable_LowPriority,zT=zn.unstable_IdlePriority,Dh=null,Wr=null;function gA(t){if(Wr&&typeof Wr.onCommitFiberRoot=="function")try{Wr.onCommitFiberRoot(Dh,t,void 0,(t.current.flags&128)===128)}catch{}}var Tr=Math.clz32?Math.clz32:xA,yA=Math.log,vA=Math.LN2;function xA(t){return t>>>=0,t===0?32:31-(yA(t)/vA|0)|0}var Su=64,Eu=4194304;function kl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function kd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=kl(a):(s&=o,s!==0&&(r=kl(s)))}else o=n&~i,o!==0?r=kl(o):s!==0&&(r=kl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Tr(e),i=1<<n,r|=t[n],e&=~i;return r}function wA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _A(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Tr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=wA(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function gm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function BT(){var t=Su;return Su<<=1,!(Su&4194240)&&(Su=64),t}function Zf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Fc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Tr(e),t[e]=n}function TA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Tr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function ty(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Tr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var We=0;function $T(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var WT,ny,qT,HT,GT,ym=!1,bu=[],is=null,ss=null,os=null,sc=new Map,oc=new Map,Hi=[],SA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function h1(t,e){switch(t){case"focusin":case"focusout":is=null;break;case"dragenter":case"dragleave":ss=null;break;case"mouseover":case"mouseout":os=null;break;case"pointerover":case"pointerout":sc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":oc.delete(e.pointerId)}}function ml(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=zc(e),e!==null&&ny(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function EA(t,e,n,r,i){switch(e){case"focusin":return is=ml(is,t,e,n,r,i),!0;case"dragenter":return ss=ml(ss,t,e,n,r,i),!0;case"mouseover":return os=ml(os,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return sc.set(s,ml(sc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,oc.set(s,ml(oc.get(s)||null,t,e,n,r,i)),!0}return!1}function KT(t){var e=Xs(t.target);if(e!==null){var n=Io(e);if(n!==null){if(e=n.tag,e===13){if(e=MT(n),e!==null){t.blockedOn=e,GT(t.priority,function(){qT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Zu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=vm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);hm=r,n.target.dispatchEvent(r),hm=null}else return e=zc(n),e!==null&&ny(e),t.blockedOn=n,!1;e.shift()}return!0}function f1(t,e,n){Zu(t)&&n.delete(e)}function bA(){ym=!1,is!==null&&Zu(is)&&(is=null),ss!==null&&Zu(ss)&&(ss=null),os!==null&&Zu(os)&&(os=null),sc.forEach(f1),oc.forEach(f1)}function gl(t,e){t.blockedOn===e&&(t.blockedOn=null,ym||(ym=!0,zn.unstable_scheduleCallback(zn.unstable_NormalPriority,bA)))}function ac(t){function e(i){return gl(i,t)}if(0<bu.length){gl(bu[0],t);for(var n=1;n<bu.length;n++){var r=bu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(is!==null&&gl(is,t),ss!==null&&gl(ss,t),os!==null&&gl(os,t),sc.forEach(e),oc.forEach(e),n=0;n<Hi.length;n++)r=Hi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Hi.length&&(n=Hi[0],n.blockedOn===null);)KT(n),n.blockedOn===null&&Hi.shift()}var ma=Ai.ReactCurrentBatchConfig,Ad=!0;function IA(t,e,n,r){var i=We,s=ma.transition;ma.transition=null;try{We=1,ry(t,e,n,r)}finally{We=i,ma.transition=s}}function CA(t,e,n,r){var i=We,s=ma.transition;ma.transition=null;try{We=4,ry(t,e,n,r)}finally{We=i,ma.transition=s}}function ry(t,e,n,r){if(Ad){var i=vm(t,e,n,r);if(i===null)cp(t,e,r,Rd,n),h1(t,r);else if(EA(i,t,e,n,r))r.stopPropagation();else if(h1(t,r),e&4&&-1<SA.indexOf(t)){for(;i!==null;){var s=zc(i);if(s!==null&&WT(s),s=vm(t,e,n,r),s===null&&cp(t,e,r,Rd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else cp(t,e,r,null,n)}}var Rd=null;function vm(t,e,n,r){if(Rd=null,t=Zg(r),t=Xs(t),t!==null)if(e=Io(t),e===null)t=null;else if(n=e.tag,n===13){if(t=MT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Rd=t,null}function QT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pA()){case ey:return 1;case UT:return 4;case Cd:case mA:return 16;case zT:return 536870912;default:return 16}default:return 16}}var es=null,iy=null,ed=null;function YT(){if(ed)return ed;var t,e=iy,n=e.length,r,i="value"in es?es.value:es.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return ed=i.slice(t,1<r?1-r:void 0)}function td(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Iu(){return!0}function p1(){return!1}function Wn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Iu:p1,this.isPropagationStopped=p1,this}return mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Iu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Iu)},persist:function(){},isPersistent:Iu}),e}var Ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sy=Wn(Ka),Uc=mt({},Ka,{view:0,detail:0}),kA=Wn(Uc),ep,tp,yl,jh=mt({},Uc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==yl&&(yl&&t.type==="mousemove"?(ep=t.screenX-yl.screenX,tp=t.screenY-yl.screenY):tp=ep=0,yl=t),ep)},movementY:function(t){return"movementY"in t?t.movementY:tp}}),m1=Wn(jh),AA=mt({},jh,{dataTransfer:0}),RA=Wn(AA),PA=mt({},Uc,{relatedTarget:0}),np=Wn(PA),NA=mt({},Ka,{animationName:0,elapsedTime:0,pseudoElement:0}),DA=Wn(NA),jA=mt({},Ka,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),LA=Wn(jA),MA=mt({},Ka,{data:0}),g1=Wn(MA),VA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},OA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},FA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=FA[t])?!!e[t]:!1}function oy(){return UA}var zA=mt({},Uc,{key:function(t){if(t.key){var e=VA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=td(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?OA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oy,charCode:function(t){return t.type==="keypress"?td(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?td(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),BA=Wn(zA),$A=mt({},jh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),y1=Wn($A),WA=mt({},Uc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oy}),qA=Wn(WA),HA=mt({},Ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),GA=Wn(HA),KA=mt({},jh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),QA=Wn(KA),YA=[9,13,27,32],ay=vi&&"CompositionEvent"in window,Vl=null;vi&&"documentMode"in document&&(Vl=document.documentMode);var XA=vi&&"TextEvent"in window&&!Vl,XT=vi&&(!ay||Vl&&8<Vl&&11>=Vl),v1=String.fromCharCode(32),x1=!1;function JT(t,e){switch(t){case"keyup":return YA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ZT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Yo=!1;function JA(t,e){switch(t){case"compositionend":return ZT(e);case"keypress":return e.which!==32?null:(x1=!0,v1);case"textInput":return t=e.data,t===v1&&x1?null:t;default:return null}}function ZA(t,e){if(Yo)return t==="compositionend"||!ay&&JT(t,e)?(t=YT(),ed=iy=es=null,Yo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return XT&&e.locale!=="ko"?null:e.data;default:return null}}var eR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function w1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!eR[t.type]:e==="textarea"}function eS(t,e,n,r){PT(r),e=Pd(e,"onChange"),0<e.length&&(n=new sy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ol=null,lc=null;function tR(t){dS(t,0)}function Lh(t){var e=Zo(t);if(ET(e))return t}function nR(t,e){if(t==="change")return e}var tS=!1;if(vi){var rp;if(vi){var ip="oninput"in document;if(!ip){var _1=document.createElement("div");_1.setAttribute("oninput","return;"),ip=typeof _1.oninput=="function"}rp=ip}else rp=!1;tS=rp&&(!document.documentMode||9<document.documentMode)}function T1(){Ol&&(Ol.detachEvent("onpropertychange",nS),lc=Ol=null)}function nS(t){if(t.propertyName==="value"&&Lh(lc)){var e=[];eS(e,lc,t,Zg(t)),LT(tR,e)}}function rR(t,e,n){t==="focusin"?(T1(),Ol=e,lc=n,Ol.attachEvent("onpropertychange",nS)):t==="focusout"&&T1()}function iR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Lh(lc)}function sR(t,e){if(t==="click")return Lh(e)}function oR(t,e){if(t==="input"||t==="change")return Lh(e)}function aR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Cr=typeof Object.is=="function"?Object.is:aR;function cc(t,e){if(Cr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!em.call(e,i)||!Cr(t[i],e[i]))return!1}return!0}function S1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function E1(t,e){var n=S1(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=S1(n)}}function rS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?rS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function iS(){for(var t=window,e=Ed();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ed(t.document)}return e}function ly(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function lR(t){var e=iS(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&rS(n.ownerDocument.documentElement,n)){if(r!==null&&ly(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=E1(n,s);var o=E1(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var cR=vi&&"documentMode"in document&&11>=document.documentMode,Xo=null,xm=null,Fl=null,wm=!1;function b1(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;wm||Xo==null||Xo!==Ed(r)||(r=Xo,"selectionStart"in r&&ly(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Fl&&cc(Fl,r)||(Fl=r,r=Pd(xm,"onSelect"),0<r.length&&(e=new sy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xo)))}function Cu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Jo={animationend:Cu("Animation","AnimationEnd"),animationiteration:Cu("Animation","AnimationIteration"),animationstart:Cu("Animation","AnimationStart"),transitionend:Cu("Transition","TransitionEnd")},sp={},sS={};vi&&(sS=document.createElement("div").style,"AnimationEvent"in window||(delete Jo.animationend.animation,delete Jo.animationiteration.animation,delete Jo.animationstart.animation),"TransitionEvent"in window||delete Jo.transitionend.transition);function Mh(t){if(sp[t])return sp[t];if(!Jo[t])return t;var e=Jo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in sS)return sp[t]=e[n];return t}var oS=Mh("animationend"),aS=Mh("animationiteration"),lS=Mh("animationstart"),cS=Mh("transitionend"),uS=new Map,I1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function As(t,e){uS.set(t,e),bo(e,[t])}for(var op=0;op<I1.length;op++){var ap=I1[op],uR=ap.toLowerCase(),dR=ap[0].toUpperCase()+ap.slice(1);As(uR,"on"+dR)}As(oS,"onAnimationEnd");As(aS,"onAnimationIteration");As(lS,"onAnimationStart");As("dblclick","onDoubleClick");As("focusin","onFocus");As("focusout","onBlur");As(cS,"onTransitionEnd");ka("onMouseEnter",["mouseout","mouseover"]);ka("onMouseLeave",["mouseout","mouseover"]);ka("onPointerEnter",["pointerout","pointerover"]);ka("onPointerLeave",["pointerout","pointerover"]);bo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bo("onBeforeInput",["compositionend","keypress","textInput","paste"]);bo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Al="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Al));function C1(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,uA(r,e,void 0,t),t.currentTarget=null}function dS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;C1(i,a,d),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;C1(i,a,d),s=l}}}if(Id)throw t=mm,Id=!1,mm=null,t}function ot(t,e){var n=e[bm];n===void 0&&(n=e[bm]=new Set);var r=t+"__bubble";n.has(r)||(hS(e,t,2,!1),n.add(r))}function lp(t,e,n){var r=0;e&&(r|=4),hS(n,t,r,e)}var ku="_reactListening"+Math.random().toString(36).slice(2);function uc(t){if(!t[ku]){t[ku]=!0,xT.forEach(function(n){n!=="selectionchange"&&(hR.has(n)||lp(n,!1,t),lp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ku]||(e[ku]=!0,lp("selectionchange",!1,e))}}function hS(t,e,n,r){switch(QT(e)){case 1:var i=IA;break;case 4:i=CA;break;default:i=ry}n=i.bind(null,e,n,t),i=void 0,!pm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function cp(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Xs(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}LT(function(){var d=s,h=Zg(n),f=[];e:{var p=uS.get(t);if(p!==void 0){var g=sy,x=t;switch(t){case"keypress":if(td(n)===0)break e;case"keydown":case"keyup":g=BA;break;case"focusin":x="focus",g=np;break;case"focusout":x="blur",g=np;break;case"beforeblur":case"afterblur":g=np;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=m1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=RA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=qA;break;case oS:case aS:case lS:g=DA;break;case cS:g=GA;break;case"scroll":g=kA;break;case"wheel":g=QA;break;case"copy":case"cut":case"paste":g=LA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=y1}var _=(e&4)!==0,k=!_&&t==="scroll",S=_?p!==null?p+"Capture":null:p;_=[];for(var v=d,w;v!==null;){w=v;var j=w.stateNode;if(w.tag===5&&j!==null&&(w=j,S!==null&&(j=ic(v,S),j!=null&&_.push(dc(v,j,w)))),k)break;v=v.return}0<_.length&&(p=new g(p,x,null,n,h),f.push({event:p,listeners:_}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&n!==hm&&(x=n.relatedTarget||n.fromElement)&&(Xs(x)||x[xi]))break e;if((g||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,g?(x=n.relatedTarget||n.toElement,g=d,x=x?Xs(x):null,x!==null&&(k=Io(x),x!==k||x.tag!==5&&x.tag!==6)&&(x=null)):(g=null,x=d),g!==x)){if(_=m1,j="onMouseLeave",S="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(_=y1,j="onPointerLeave",S="onPointerEnter",v="pointer"),k=g==null?p:Zo(g),w=x==null?p:Zo(x),p=new _(j,v+"leave",g,n,h),p.target=k,p.relatedTarget=w,j=null,Xs(h)===d&&(_=new _(S,v+"enter",x,n,h),_.target=w,_.relatedTarget=k,j=_),k=j,g&&x)t:{for(_=g,S=x,v=0,w=_;w;w=Vo(w))v++;for(w=0,j=S;j;j=Vo(j))w++;for(;0<v-w;)_=Vo(_),v--;for(;0<w-v;)S=Vo(S),w--;for(;v--;){if(_===S||S!==null&&_===S.alternate)break t;_=Vo(_),S=Vo(S)}_=null}else _=null;g!==null&&k1(f,p,g,_,!1),x!==null&&k!==null&&k1(f,k,x,_,!0)}}e:{if(p=d?Zo(d):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var L=nR;else if(w1(p))if(tS)L=oR;else{L=iR;var V=rR}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(L=sR);if(L&&(L=L(t,d))){eS(f,L,n,h);break e}V&&V(t,p,d),t==="focusout"&&(V=p._wrapperState)&&V.controlled&&p.type==="number"&&am(p,"number",p.value)}switch(V=d?Zo(d):window,t){case"focusin":(w1(V)||V.contentEditable==="true")&&(Xo=V,xm=d,Fl=null);break;case"focusout":Fl=xm=Xo=null;break;case"mousedown":wm=!0;break;case"contextmenu":case"mouseup":case"dragend":wm=!1,b1(f,n,h);break;case"selectionchange":if(cR)break;case"keydown":case"keyup":b1(f,n,h)}var E;if(ay)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Yo?JT(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(XT&&n.locale!=="ko"&&(Yo||T!=="onCompositionStart"?T==="onCompositionEnd"&&Yo&&(E=YT()):(es=h,iy="value"in es?es.value:es.textContent,Yo=!0)),V=Pd(d,T),0<V.length&&(T=new g1(T,t,null,n,h),f.push({event:T,listeners:V}),E?T.data=E:(E=ZT(n),E!==null&&(T.data=E)))),(E=XA?JA(t,n):ZA(t,n))&&(d=Pd(d,"onBeforeInput"),0<d.length&&(h=new g1("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=E))}dS(f,e)})}function dc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Pd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ic(t,n),s!=null&&r.unshift(dc(t,s,i)),s=ic(t,e),s!=null&&r.push(dc(t,s,i))),t=t.return}return r}function Vo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function k1(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,i?(l=ic(n,s),l!=null&&o.unshift(dc(n,l,a))):i||(l=ic(n,s),l!=null&&o.push(dc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var fR=/\r\n?/g,pR=/\u0000|\uFFFD/g;function A1(t){return(typeof t=="string"?t:""+t).replace(fR,`
`).replace(pR,"")}function Au(t,e,n){if(e=A1(e),A1(t)!==e&&n)throw Error(Q(425))}function Nd(){}var _m=null,Tm=null;function Sm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Em=typeof setTimeout=="function"?setTimeout:void 0,mR=typeof clearTimeout=="function"?clearTimeout:void 0,R1=typeof Promise=="function"?Promise:void 0,gR=typeof queueMicrotask=="function"?queueMicrotask:typeof R1<"u"?function(t){return R1.resolve(null).then(t).catch(yR)}:Em;function yR(t){setTimeout(function(){throw t})}function up(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ac(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ac(e)}function as(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function P1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Qa=Math.random().toString(36).slice(2),Ur="__reactFiber$"+Qa,hc="__reactProps$"+Qa,xi="__reactContainer$"+Qa,bm="__reactEvents$"+Qa,vR="__reactListeners$"+Qa,xR="__reactHandles$"+Qa;function Xs(t){var e=t[Ur];if(e)return e;for(var n=t.parentNode;n;){if(e=n[xi]||n[Ur]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=P1(t);t!==null;){if(n=t[Ur])return n;t=P1(t)}return e}t=n,n=t.parentNode}return null}function zc(t){return t=t[Ur]||t[xi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Q(33))}function Vh(t){return t[hc]||null}var Im=[],ea=-1;function Rs(t){return{current:t}}function lt(t){0>ea||(t.current=Im[ea],Im[ea]=null,ea--)}function et(t,e){ea++,Im[ea]=t.current,t.current=e}var xs={},un=Rs(xs),An=Rs(!1),fo=xs;function Aa(t,e){var n=t.type.contextTypes;if(!n)return xs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Rn(t){return t=t.childContextTypes,t!=null}function Dd(){lt(An),lt(un)}function N1(t,e,n){if(un.current!==xs)throw Error(Q(168));et(un,e),et(An,n)}function fS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Q(108,rA(t)||"Unknown",i));return mt({},n,r)}function jd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||xs,fo=un.current,et(un,t),et(An,An.current),!0}function D1(t,e,n){var r=t.stateNode;if(!r)throw Error(Q(169));n?(t=fS(t,e,fo),r.__reactInternalMemoizedMergedChildContext=t,lt(An),lt(un),et(un,t)):lt(An),et(An,n)}var ii=null,Oh=!1,dp=!1;function pS(t){ii===null?ii=[t]:ii.push(t)}function wR(t){Oh=!0,pS(t)}function Ps(){if(!dp&&ii!==null){dp=!0;var t=0,e=We;try{var n=ii;for(We=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ii=null,Oh=!1}catch(i){throw ii!==null&&(ii=ii.slice(t+1)),FT(ey,Ps),i}finally{We=e,dp=!1}}return null}var ta=[],na=0,Ld=null,Md=0,Jn=[],Zn=0,po=null,li=1,ci="";function $s(t,e){ta[na++]=Md,ta[na++]=Ld,Ld=t,Md=e}function mS(t,e,n){Jn[Zn++]=li,Jn[Zn++]=ci,Jn[Zn++]=po,po=t;var r=li;t=ci;var i=32-Tr(r)-1;r&=~(1<<i),n+=1;var s=32-Tr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,li=1<<32-Tr(e)+i|n<<i|r,ci=s+t}else li=1<<s|n<<i|r,ci=t}function cy(t){t.return!==null&&($s(t,1),mS(t,1,0))}function uy(t){for(;t===Ld;)Ld=ta[--na],ta[na]=null,Md=ta[--na],ta[na]=null;for(;t===po;)po=Jn[--Zn],Jn[Zn]=null,ci=Jn[--Zn],Jn[Zn]=null,li=Jn[--Zn],Jn[Zn]=null}var Un=null,Vn=null,ct=!1,mr=null;function gS(t,e){var n=nr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function j1(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Un=t,Vn=as(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Un=t,Vn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=po!==null?{id:li,overflow:ci}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=nr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Un=t,Vn=null,!0):!1;default:return!1}}function Cm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function km(t){if(ct){var e=Vn;if(e){var n=e;if(!j1(t,e)){if(Cm(t))throw Error(Q(418));e=as(n.nextSibling);var r=Un;e&&j1(t,e)?gS(r,n):(t.flags=t.flags&-4097|2,ct=!1,Un=t)}}else{if(Cm(t))throw Error(Q(418));t.flags=t.flags&-4097|2,ct=!1,Un=t}}}function L1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Un=t}function Ru(t){if(t!==Un)return!1;if(!ct)return L1(t),ct=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Sm(t.type,t.memoizedProps)),e&&(e=Vn)){if(Cm(t))throw yS(),Error(Q(418));for(;e;)gS(t,e),e=as(e.nextSibling)}if(L1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Vn=as(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Vn=null}}else Vn=Un?as(t.stateNode.nextSibling):null;return!0}function yS(){for(var t=Vn;t;)t=as(t.nextSibling)}function Ra(){Vn=Un=null,ct=!1}function dy(t){mr===null?mr=[t]:mr.push(t)}var _R=Ai.ReactCurrentBatchConfig;function vl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Q(309));var r=n.stateNode}if(!r)throw Error(Q(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Q(284));if(!n._owner)throw Error(Q(290,t))}return t}function Pu(t,e){throw t=Object.prototype.toString.call(e),Error(Q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function M1(t){var e=t._init;return e(t._payload)}function vS(t){function e(S,v){if(t){var w=S.deletions;w===null?(S.deletions=[v],S.flags|=16):w.push(v)}}function n(S,v){if(!t)return null;for(;v!==null;)e(S,v),v=v.sibling;return null}function r(S,v){for(S=new Map;v!==null;)v.key!==null?S.set(v.key,v):S.set(v.index,v),v=v.sibling;return S}function i(S,v){return S=ds(S,v),S.index=0,S.sibling=null,S}function s(S,v,w){return S.index=w,t?(w=S.alternate,w!==null?(w=w.index,w<v?(S.flags|=2,v):w):(S.flags|=2,v)):(S.flags|=1048576,v)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function a(S,v,w,j){return v===null||v.tag!==6?(v=vp(w,S.mode,j),v.return=S,v):(v=i(v,w),v.return=S,v)}function l(S,v,w,j){var L=w.type;return L===Qo?h(S,v,w.props.children,j,w.key):v!==null&&(v.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===$i&&M1(L)===v.type)?(j=i(v,w.props),j.ref=vl(S,v,w),j.return=S,j):(j=ld(w.type,w.key,w.props,null,S.mode,j),j.ref=vl(S,v,w),j.return=S,j)}function d(S,v,w,j){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=xp(w,S.mode,j),v.return=S,v):(v=i(v,w.children||[]),v.return=S,v)}function h(S,v,w,j,L){return v===null||v.tag!==7?(v=oo(w,S.mode,j,L),v.return=S,v):(v=i(v,w),v.return=S,v)}function f(S,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=vp(""+v,S.mode,w),v.return=S,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case wu:return w=ld(v.type,v.key,v.props,null,S.mode,w),w.ref=vl(S,null,v),w.return=S,w;case Ko:return v=xp(v,S.mode,w),v.return=S,v;case $i:var j=v._init;return f(S,j(v._payload),w)}if(Cl(v)||fl(v))return v=oo(v,S.mode,w,null),v.return=S,v;Pu(S,v)}return null}function p(S,v,w,j){var L=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return L!==null?null:a(S,v,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case wu:return w.key===L?l(S,v,w,j):null;case Ko:return w.key===L?d(S,v,w,j):null;case $i:return L=w._init,p(S,v,L(w._payload),j)}if(Cl(w)||fl(w))return L!==null?null:h(S,v,w,j,null);Pu(S,w)}return null}function g(S,v,w,j,L){if(typeof j=="string"&&j!==""||typeof j=="number")return S=S.get(w)||null,a(v,S,""+j,L);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case wu:return S=S.get(j.key===null?w:j.key)||null,l(v,S,j,L);case Ko:return S=S.get(j.key===null?w:j.key)||null,d(v,S,j,L);case $i:var V=j._init;return g(S,v,w,V(j._payload),L)}if(Cl(j)||fl(j))return S=S.get(w)||null,h(v,S,j,L,null);Pu(v,j)}return null}function x(S,v,w,j){for(var L=null,V=null,E=v,T=v=0,I=null;E!==null&&T<w.length;T++){E.index>T?(I=E,E=null):I=E.sibling;var A=p(S,E,w[T],j);if(A===null){E===null&&(E=I);break}t&&E&&A.alternate===null&&e(S,E),v=s(A,v,T),V===null?L=A:V.sibling=A,V=A,E=I}if(T===w.length)return n(S,E),ct&&$s(S,T),L;if(E===null){for(;T<w.length;T++)E=f(S,w[T],j),E!==null&&(v=s(E,v,T),V===null?L=E:V.sibling=E,V=E);return ct&&$s(S,T),L}for(E=r(S,E);T<w.length;T++)I=g(E,S,T,w[T],j),I!==null&&(t&&I.alternate!==null&&E.delete(I.key===null?T:I.key),v=s(I,v,T),V===null?L=I:V.sibling=I,V=I);return t&&E.forEach(function(P){return e(S,P)}),ct&&$s(S,T),L}function _(S,v,w,j){var L=fl(w);if(typeof L!="function")throw Error(Q(150));if(w=L.call(w),w==null)throw Error(Q(151));for(var V=L=null,E=v,T=v=0,I=null,A=w.next();E!==null&&!A.done;T++,A=w.next()){E.index>T?(I=E,E=null):I=E.sibling;var P=p(S,E,A.value,j);if(P===null){E===null&&(E=I);break}t&&E&&P.alternate===null&&e(S,E),v=s(P,v,T),V===null?L=P:V.sibling=P,V=P,E=I}if(A.done)return n(S,E),ct&&$s(S,T),L;if(E===null){for(;!A.done;T++,A=w.next())A=f(S,A.value,j),A!==null&&(v=s(A,v,T),V===null?L=A:V.sibling=A,V=A);return ct&&$s(S,T),L}for(E=r(S,E);!A.done;T++,A=w.next())A=g(E,S,T,A.value,j),A!==null&&(t&&A.alternate!==null&&E.delete(A.key===null?T:A.key),v=s(A,v,T),V===null?L=A:V.sibling=A,V=A);return t&&E.forEach(function(N){return e(S,N)}),ct&&$s(S,T),L}function k(S,v,w,j){if(typeof w=="object"&&w!==null&&w.type===Qo&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case wu:e:{for(var L=w.key,V=v;V!==null;){if(V.key===L){if(L=w.type,L===Qo){if(V.tag===7){n(S,V.sibling),v=i(V,w.props.children),v.return=S,S=v;break e}}else if(V.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===$i&&M1(L)===V.type){n(S,V.sibling),v=i(V,w.props),v.ref=vl(S,V,w),v.return=S,S=v;break e}n(S,V);break}else e(S,V);V=V.sibling}w.type===Qo?(v=oo(w.props.children,S.mode,j,w.key),v.return=S,S=v):(j=ld(w.type,w.key,w.props,null,S.mode,j),j.ref=vl(S,v,w),j.return=S,S=j)}return o(S);case Ko:e:{for(V=w.key;v!==null;){if(v.key===V)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(S,v.sibling),v=i(v,w.children||[]),v.return=S,S=v;break e}else{n(S,v);break}else e(S,v);v=v.sibling}v=xp(w,S.mode,j),v.return=S,S=v}return o(S);case $i:return V=w._init,k(S,v,V(w._payload),j)}if(Cl(w))return x(S,v,w,j);if(fl(w))return _(S,v,w,j);Pu(S,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(S,v.sibling),v=i(v,w),v.return=S,S=v):(n(S,v),v=vp(w,S.mode,j),v.return=S,S=v),o(S)):n(S,v)}return k}var Pa=vS(!0),xS=vS(!1),Vd=Rs(null),Od=null,ra=null,hy=null;function fy(){hy=ra=Od=null}function py(t){var e=Vd.current;lt(Vd),t._currentValue=e}function Am(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ga(t,e){Od=t,hy=ra=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(In=!0),t.firstContext=null)}function ar(t){var e=t._currentValue;if(hy!==t)if(t={context:t,memoizedValue:e,next:null},ra===null){if(Od===null)throw Error(Q(308));ra=t,Od.dependencies={lanes:0,firstContext:t}}else ra=ra.next=t;return e}var Js=null;function my(t){Js===null?Js=[t]:Js.push(t)}function wS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,my(e)):(n.next=i.next,i.next=n),e.interleaved=n,wi(t,r)}function wi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Wi=!1;function gy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _S(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function fi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ls(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ze&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,wi(t,n)}return i=r.interleaved,i===null?(e.next=e,my(r)):(e.next=i.next,i.next=e),r.interleaved=e,wi(t,n)}function nd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ty(t,n)}}function V1(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Fd(t,e,n,r){var i=t.updateQueue;Wi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?s=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,h=d=l=null,a=s;do{var p=a.lane,g=a.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var x=t,_=a;switch(p=e,g=n,_.tag){case 1:if(x=_.payload,typeof x=="function"){f=x.call(g,f,p);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=_.payload,p=typeof x=="function"?x.call(g,f,p):x,p==null)break e;f=mt({},f,p);break e;case 2:Wi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else g={eventTime:g,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=g,l=f):h=h.next=g,o|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(1);if(h===null&&(l=f),i.baseState=l,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);go|=o,t.lanes=o,t.memoizedState=f}}function O1(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Q(191,i));i.call(r)}}}var Bc={},qr=Rs(Bc),fc=Rs(Bc),pc=Rs(Bc);function Zs(t){if(t===Bc)throw Error(Q(174));return t}function yy(t,e){switch(et(pc,e),et(fc,t),et(qr,Bc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:cm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=cm(e,t)}lt(qr),et(qr,e)}function Na(){lt(qr),lt(fc),lt(pc)}function TS(t){Zs(pc.current);var e=Zs(qr.current),n=cm(e,t.type);e!==n&&(et(fc,t),et(qr,n))}function vy(t){fc.current===t&&(lt(qr),lt(fc))}var ht=Rs(0);function Ud(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var hp=[];function xy(){for(var t=0;t<hp.length;t++)hp[t]._workInProgressVersionPrimary=null;hp.length=0}var rd=Ai.ReactCurrentDispatcher,fp=Ai.ReactCurrentBatchConfig,mo=0,pt=null,jt=null,Ft=null,zd=!1,Ul=!1,mc=0,TR=0;function nn(){throw Error(Q(321))}function wy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Cr(t[n],e[n]))return!1;return!0}function _y(t,e,n,r,i,s){if(mo=s,pt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rd.current=t===null||t.memoizedState===null?IR:CR,t=n(r,i),Ul){s=0;do{if(Ul=!1,mc=0,25<=s)throw Error(Q(301));s+=1,Ft=jt=null,e.updateQueue=null,rd.current=kR,t=n(r,i)}while(Ul)}if(rd.current=Bd,e=jt!==null&&jt.next!==null,mo=0,Ft=jt=pt=null,zd=!1,e)throw Error(Q(300));return t}function Ty(){var t=mc!==0;return mc=0,t}function Lr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?pt.memoizedState=Ft=t:Ft=Ft.next=t,Ft}function lr(){if(jt===null){var t=pt.alternate;t=t!==null?t.memoizedState:null}else t=jt.next;var e=Ft===null?pt.memoizedState:Ft.next;if(e!==null)Ft=e,jt=t;else{if(t===null)throw Error(Q(310));jt=t,t={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},Ft===null?pt.memoizedState=Ft=t:Ft=Ft.next=t}return Ft}function gc(t,e){return typeof e=="function"?e(t):e}function pp(t){var e=lr(),n=e.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=t;var r=jt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,d=s;do{var h=d.lane;if((mo&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,pt.lanes|=h,go|=h}d=d.next}while(d!==null&&d!==s);l===null?o=r:l.next=a,Cr(r,e.memoizedState)||(In=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,pt.lanes|=s,go|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function mp(t){var e=lr(),n=e.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Cr(s,e.memoizedState)||(In=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function SS(){}function ES(t,e){var n=pt,r=lr(),i=e(),s=!Cr(r.memoizedState,i);if(s&&(r.memoizedState=i,In=!0),r=r.queue,Sy(CS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ft!==null&&Ft.memoizedState.tag&1){if(n.flags|=2048,yc(9,IS.bind(null,n,r,i,e),void 0,null),Ut===null)throw Error(Q(349));mo&30||bS(n,e,i)}return i}function bS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function IS(t,e,n,r){e.value=n,e.getSnapshot=r,kS(e)&&AS(t)}function CS(t,e,n){return n(function(){kS(e)&&AS(t)})}function kS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Cr(t,n)}catch{return!0}}function AS(t){var e=wi(t,1);e!==null&&Sr(e,t,1,-1)}function F1(t){var e=Lr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gc,lastRenderedState:t},e.queue=t,t=t.dispatch=bR.bind(null,pt,t),[e.memoizedState,t]}function yc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function RS(){return lr().memoizedState}function id(t,e,n,r){var i=Lr();pt.flags|=t,i.memoizedState=yc(1|e,n,void 0,r===void 0?null:r)}function Fh(t,e,n,r){var i=lr();r=r===void 0?null:r;var s=void 0;if(jt!==null){var o=jt.memoizedState;if(s=o.destroy,r!==null&&wy(r,o.deps)){i.memoizedState=yc(e,n,s,r);return}}pt.flags|=t,i.memoizedState=yc(1|e,n,s,r)}function U1(t,e){return id(8390656,8,t,e)}function Sy(t,e){return Fh(2048,8,t,e)}function PS(t,e){return Fh(4,2,t,e)}function NS(t,e){return Fh(4,4,t,e)}function DS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function jS(t,e,n){return n=n!=null?n.concat([t]):null,Fh(4,4,DS.bind(null,e,t),n)}function Ey(){}function LS(t,e){var n=lr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&wy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function MS(t,e){var n=lr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&wy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function VS(t,e,n){return mo&21?(Cr(n,e)||(n=BT(),pt.lanes|=n,go|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,In=!0),t.memoizedState=n)}function SR(t,e){var n=We;We=n!==0&&4>n?n:4,t(!0);var r=fp.transition;fp.transition={};try{t(!1),e()}finally{We=n,fp.transition=r}}function OS(){return lr().memoizedState}function ER(t,e,n){var r=us(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},FS(t))US(e,n);else if(n=wS(t,e,n,r),n!==null){var i=wn();Sr(n,t,r,i),zS(n,e,r)}}function bR(t,e,n){var r=us(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(FS(t))US(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Cr(a,o)){var l=e.interleaved;l===null?(i.next=i,my(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=wS(t,e,i,r),n!==null&&(i=wn(),Sr(n,t,r,i),zS(n,e,r))}}function FS(t){var e=t.alternate;return t===pt||e!==null&&e===pt}function US(t,e){Ul=zd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function zS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ty(t,n)}}var Bd={readContext:ar,useCallback:nn,useContext:nn,useEffect:nn,useImperativeHandle:nn,useInsertionEffect:nn,useLayoutEffect:nn,useMemo:nn,useReducer:nn,useRef:nn,useState:nn,useDebugValue:nn,useDeferredValue:nn,useTransition:nn,useMutableSource:nn,useSyncExternalStore:nn,useId:nn,unstable_isNewReconciler:!1},IR={readContext:ar,useCallback:function(t,e){return Lr().memoizedState=[t,e===void 0?null:e],t},useContext:ar,useEffect:U1,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,id(4194308,4,DS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return id(4194308,4,t,e)},useInsertionEffect:function(t,e){return id(4,2,t,e)},useMemo:function(t,e){var n=Lr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Lr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ER.bind(null,pt,t),[r.memoizedState,t]},useRef:function(t){var e=Lr();return t={current:t},e.memoizedState=t},useState:F1,useDebugValue:Ey,useDeferredValue:function(t){return Lr().memoizedState=t},useTransition:function(){var t=F1(!1),e=t[0];return t=SR.bind(null,t[1]),Lr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=pt,i=Lr();if(ct){if(n===void 0)throw Error(Q(407));n=n()}else{if(n=e(),Ut===null)throw Error(Q(349));mo&30||bS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,U1(CS.bind(null,r,s,t),[t]),r.flags|=2048,yc(9,IS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Lr(),e=Ut.identifierPrefix;if(ct){var n=ci,r=li;n=(r&~(1<<32-Tr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=mc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=TR++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},CR={readContext:ar,useCallback:LS,useContext:ar,useEffect:Sy,useImperativeHandle:jS,useInsertionEffect:PS,useLayoutEffect:NS,useMemo:MS,useReducer:pp,useRef:RS,useState:function(){return pp(gc)},useDebugValue:Ey,useDeferredValue:function(t){var e=lr();return VS(e,jt.memoizedState,t)},useTransition:function(){var t=pp(gc)[0],e=lr().memoizedState;return[t,e]},useMutableSource:SS,useSyncExternalStore:ES,useId:OS,unstable_isNewReconciler:!1},kR={readContext:ar,useCallback:LS,useContext:ar,useEffect:Sy,useImperativeHandle:jS,useInsertionEffect:PS,useLayoutEffect:NS,useMemo:MS,useReducer:mp,useRef:RS,useState:function(){return mp(gc)},useDebugValue:Ey,useDeferredValue:function(t){var e=lr();return jt===null?e.memoizedState=t:VS(e,jt.memoizedState,t)},useTransition:function(){var t=mp(gc)[0],e=lr().memoizedState;return[t,e]},useMutableSource:SS,useSyncExternalStore:ES,useId:OS,unstable_isNewReconciler:!1};function ur(t,e){if(t&&t.defaultProps){e=mt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Rm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:mt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Uh={isMounted:function(t){return(t=t._reactInternals)?Io(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=wn(),i=us(t),s=fi(r,i);s.payload=e,n!=null&&(s.callback=n),e=ls(t,s,i),e!==null&&(Sr(e,t,i,r),nd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=wn(),i=us(t),s=fi(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ls(t,s,i),e!==null&&(Sr(e,t,i,r),nd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=wn(),r=us(t),i=fi(n,r);i.tag=2,e!=null&&(i.callback=e),e=ls(t,i,r),e!==null&&(Sr(e,t,r,n),nd(e,t,r))}};function z1(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!cc(n,r)||!cc(i,s):!0}function BS(t,e,n){var r=!1,i=xs,s=e.contextType;return typeof s=="object"&&s!==null?s=ar(s):(i=Rn(e)?fo:un.current,r=e.contextTypes,s=(r=r!=null)?Aa(t,i):xs),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Uh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function B1(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Uh.enqueueReplaceState(e,e.state,null)}function Pm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},gy(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ar(s):(s=Rn(e)?fo:un.current,i.context=Aa(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Rm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Uh.enqueueReplaceState(i,i.state,null),Fd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Da(t,e){try{var n="",r=e;do n+=nA(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function gp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Nm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var AR=typeof WeakMap=="function"?WeakMap:Map;function $S(t,e,n){n=fi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Wd||(Wd=!0,Bm=r),Nm(t,e)},n}function WS(t,e,n){n=fi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Nm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Nm(t,e),typeof r!="function"&&(cs===null?cs=new Set([this]):cs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function $1(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new AR;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=$R.bind(null,t,e,n),e.then(t,t))}function W1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function q1(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=fi(-1,1),e.tag=2,ls(n,e,1))),n.lanes|=1),t)}var RR=Ai.ReactCurrentOwner,In=!1;function xn(t,e,n,r){e.child=t===null?xS(e,null,n,r):Pa(e,t.child,n,r)}function H1(t,e,n,r,i){n=n.render;var s=e.ref;return ga(e,i),r=_y(t,e,n,r,s,i),n=Ty(),t!==null&&!In?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,_i(t,e,i)):(ct&&n&&cy(e),e.flags|=1,xn(t,e,r,i),e.child)}function G1(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Ny(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,qS(t,e,s,r,i)):(t=ld(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:cc,n(o,r)&&t.ref===e.ref)return _i(t,e,i)}return e.flags|=1,t=ds(s,r),t.ref=e.ref,t.return=e,e.child=t}function qS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(cc(s,r)&&t.ref===e.ref)if(In=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(In=!0);else return e.lanes=t.lanes,_i(t,e,i)}return Dm(t,e,n,r,i)}function HS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},et(sa,Ln),Ln|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,et(sa,Ln),Ln|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,et(sa,Ln),Ln|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,et(sa,Ln),Ln|=r;return xn(t,e,i,n),e.child}function GS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Dm(t,e,n,r,i){var s=Rn(n)?fo:un.current;return s=Aa(e,s),ga(e,i),n=_y(t,e,n,r,s,i),r=Ty(),t!==null&&!In?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,_i(t,e,i)):(ct&&r&&cy(e),e.flags|=1,xn(t,e,n,i),e.child)}function K1(t,e,n,r,i){if(Rn(n)){var s=!0;jd(e)}else s=!1;if(ga(e,i),e.stateNode===null)sd(t,e),BS(e,n,r),Pm(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=ar(d):(d=Rn(n)?fo:un.current,d=Aa(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&B1(e,o,r,d),Wi=!1;var p=e.memoizedState;o.state=p,Fd(e,r,o,i),l=e.memoizedState,a!==r||p!==l||An.current||Wi?(typeof h=="function"&&(Rm(e,n,h,r),l=e.memoizedState),(a=Wi||z1(e,n,a,r,p,l,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,_S(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:ur(e.type,a),o.props=d,f=e.pendingProps,p=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=ar(l):(l=Rn(n)?fo:un.current,l=Aa(e,l));var g=n.getDerivedStateFromProps;(h=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||p!==l)&&B1(e,o,r,l),Wi=!1,p=e.memoizedState,o.state=p,Fd(e,r,o,i);var x=e.memoizedState;a!==f||p!==x||An.current||Wi?(typeof g=="function"&&(Rm(e,n,g,r),x=e.memoizedState),(d=Wi||z1(e,n,d,r,p,x,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return jm(t,e,n,r,s,i)}function jm(t,e,n,r,i,s){GS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&D1(e,n,!1),_i(t,e,s);r=e.stateNode,RR.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Pa(e,t.child,null,s),e.child=Pa(e,null,a,s)):xn(t,e,a,s),e.memoizedState=r.state,i&&D1(e,n,!0),e.child}function KS(t){var e=t.stateNode;e.pendingContext?N1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&N1(t,e.context,!1),yy(t,e.containerInfo)}function Q1(t,e,n,r,i){return Ra(),dy(i),e.flags|=256,xn(t,e,n,r),e.child}var Lm={dehydrated:null,treeContext:null,retryLane:0};function Mm(t){return{baseLanes:t,cachePool:null,transitions:null}}function QS(t,e,n){var r=e.pendingProps,i=ht.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),et(ht,i&1),t===null)return km(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=$h(o,r,0,null),t=oo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Mm(n),e.memoizedState=Lm,t):by(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return PR(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ds(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=ds(a,s):(s=oo(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Mm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Lm,r}return s=t.child,t=s.sibling,r=ds(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function by(t,e){return e=$h({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Nu(t,e,n,r){return r!==null&&dy(r),Pa(e,t.child,null,n),t=by(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function PR(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=gp(Error(Q(422))),Nu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=$h({mode:"visible",children:r.children},i,0,null),s=oo(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Pa(e,t.child,null,o),e.child.memoizedState=Mm(o),e.memoizedState=Lm,s);if(!(e.mode&1))return Nu(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Q(419)),r=gp(s,r,void 0),Nu(t,e,o,r)}if(a=(o&t.childLanes)!==0,In||a){if(r=Ut,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,wi(t,i),Sr(r,t,i,-1))}return Py(),r=gp(Error(Q(421))),Nu(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=WR.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Vn=as(i.nextSibling),Un=e,ct=!0,mr=null,t!==null&&(Jn[Zn++]=li,Jn[Zn++]=ci,Jn[Zn++]=po,li=t.id,ci=t.overflow,po=e),e=by(e,r.children),e.flags|=4096,e)}function Y1(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Am(t.return,e,n)}function yp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function YS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(xn(t,e,r.children,n),r=ht.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Y1(t,n,e);else if(t.tag===19)Y1(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(et(ht,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ud(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),yp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ud(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}yp(e,!0,n,null,s);break;case"together":yp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function sd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function _i(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),go|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Q(153));if(e.child!==null){for(t=e.child,n=ds(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ds(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function NR(t,e,n){switch(e.tag){case 3:KS(e),Ra();break;case 5:TS(e);break;case 1:Rn(e.type)&&jd(e);break;case 4:yy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;et(Vd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(et(ht,ht.current&1),e.flags|=128,null):n&e.child.childLanes?QS(t,e,n):(et(ht,ht.current&1),t=_i(t,e,n),t!==null?t.sibling:null);et(ht,ht.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return YS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),et(ht,ht.current),r)break;return null;case 22:case 23:return e.lanes=0,HS(t,e,n)}return _i(t,e,n)}var XS,Vm,JS,ZS;XS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Vm=function(){};JS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Zs(qr.current);var s=null;switch(n){case"input":i=sm(t,i),r=sm(t,r),s=[];break;case"select":i=mt({},i,{value:void 0}),r=mt({},r,{value:void 0}),s=[];break;case"textarea":i=lm(t,i),r=lm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Nd)}um(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var a=i[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(nc.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var l=r[d];if(a=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(nc.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&ot("scroll",t),s||a===l||(s=[])):(s=s||[]).push(d,l))}n&&(s=s||[]).push("style",n);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};ZS=function(t,e,n,r){n!==r&&(e.flags|=4)};function xl(t,e){if(!ct)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function rn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function DR(t,e,n){var r=e.pendingProps;switch(uy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rn(e),null;case 1:return Rn(e.type)&&Dd(),rn(e),null;case 3:return r=e.stateNode,Na(),lt(An),lt(un),xy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ru(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,mr!==null&&(qm(mr),mr=null))),Vm(t,e),rn(e),null;case 5:vy(e);var i=Zs(pc.current);if(n=e.type,t!==null&&e.stateNode!=null)JS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Q(166));return rn(e),null}if(t=Zs(qr.current),Ru(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ur]=e,r[hc]=s,t=(e.mode&1)!==0,n){case"dialog":ot("cancel",r),ot("close",r);break;case"iframe":case"object":case"embed":ot("load",r);break;case"video":case"audio":for(i=0;i<Al.length;i++)ot(Al[i],r);break;case"source":ot("error",r);break;case"img":case"image":case"link":ot("error",r),ot("load",r);break;case"details":ot("toggle",r);break;case"input":s1(r,s),ot("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ot("invalid",r);break;case"textarea":a1(r,s),ot("invalid",r)}um(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Au(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Au(r.textContent,a,t),i=["children",""+a]):nc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ot("scroll",r)}switch(n){case"input":_u(r),o1(r,s,!0);break;case"textarea":_u(r),l1(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Nd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=CT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ur]=e,t[hc]=r,XS(t,e,!1,!1),e.stateNode=t;e:{switch(o=dm(n,r),n){case"dialog":ot("cancel",t),ot("close",t),i=r;break;case"iframe":case"object":case"embed":ot("load",t),i=r;break;case"video":case"audio":for(i=0;i<Al.length;i++)ot(Al[i],t);i=r;break;case"source":ot("error",t),i=r;break;case"img":case"image":case"link":ot("error",t),ot("load",t),i=r;break;case"details":ot("toggle",t),i=r;break;case"input":s1(t,r),i=sm(t,r),ot("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=mt({},r,{value:void 0}),ot("invalid",t);break;case"textarea":a1(t,r),i=lm(t,r),ot("invalid",t);break;default:i=r}um(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?RT(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&kT(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&rc(t,l):typeof l=="number"&&rc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(nc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ot("scroll",t):l!=null&&Qg(t,s,l,o))}switch(n){case"input":_u(t),o1(t,r,!1);break;case"textarea":_u(t),l1(t);break;case"option":r.value!=null&&t.setAttribute("value",""+vs(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?ha(t,!!r.multiple,s,!1):r.defaultValue!=null&&ha(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Nd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return rn(e),null;case 6:if(t&&e.stateNode!=null)ZS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Q(166));if(n=Zs(pc.current),Zs(qr.current),Ru(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ur]=e,(s=r.nodeValue!==n)&&(t=Un,t!==null))switch(t.tag){case 3:Au(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Au(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ur]=e,e.stateNode=r}return rn(e),null;case 13:if(lt(ht),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ct&&Vn!==null&&e.mode&1&&!(e.flags&128))yS(),Ra(),e.flags|=98560,s=!1;else if(s=Ru(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Q(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Q(317));s[Ur]=e}else Ra(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;rn(e),s=!1}else mr!==null&&(qm(mr),mr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ht.current&1?Lt===0&&(Lt=3):Py())),e.updateQueue!==null&&(e.flags|=4),rn(e),null);case 4:return Na(),Vm(t,e),t===null&&uc(e.stateNode.containerInfo),rn(e),null;case 10:return py(e.type._context),rn(e),null;case 17:return Rn(e.type)&&Dd(),rn(e),null;case 19:if(lt(ht),s=e.memoizedState,s===null)return rn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)xl(s,!1);else{if(Lt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ud(t),o!==null){for(e.flags|=128,xl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return et(ht,ht.current&1|2),e.child}t=t.sibling}s.tail!==null&&Et()>ja&&(e.flags|=128,r=!0,xl(s,!1),e.lanes=4194304)}else{if(!r)if(t=Ud(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),xl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ct)return rn(e),null}else 2*Et()-s.renderingStartTime>ja&&n!==1073741824&&(e.flags|=128,r=!0,xl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Et(),e.sibling=null,n=ht.current,et(ht,r?n&1|2:n&1),e):(rn(e),null);case 22:case 23:return Ry(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ln&1073741824&&(rn(e),e.subtreeFlags&6&&(e.flags|=8192)):rn(e),null;case 24:return null;case 25:return null}throw Error(Q(156,e.tag))}function jR(t,e){switch(uy(e),e.tag){case 1:return Rn(e.type)&&Dd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Na(),lt(An),lt(un),xy(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return vy(e),null;case 13:if(lt(ht),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Q(340));Ra()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return lt(ht),null;case 4:return Na(),null;case 10:return py(e.type._context),null;case 22:case 23:return Ry(),null;case 24:return null;default:return null}}var Du=!1,ln=!1,LR=typeof WeakSet=="function"?WeakSet:Set,ue=null;function ia(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){vt(t,e,r)}else n.current=null}function Om(t,e,n){try{n()}catch(r){vt(t,e,r)}}var X1=!1;function MR(t,e){if(_m=Ad,t=iS(),ly(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,f=t,p=null;t:for(;;){for(var g;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(g=f.firstChild)!==null;)p=f,f=g;for(;;){if(f===t)break t;if(p===n&&++d===i&&(a=o),p===s&&++h===r&&(l=o),(g=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=g}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Tm={focusedElem:t,selectionRange:n},Ad=!1,ue=e;ue!==null;)if(e=ue,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ue=t;else for(;ue!==null;){e=ue;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var _=x.memoizedProps,k=x.memoizedState,S=e.stateNode,v=S.getSnapshotBeforeUpdate(e.elementType===e.type?_:ur(e.type,_),k);S.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(j){vt(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,ue=t;break}ue=e.return}return x=X1,X1=!1,x}function zl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Om(e,n,s)}i=i.next}while(i!==r)}}function zh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Fm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function eE(t){var e=t.alternate;e!==null&&(t.alternate=null,eE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ur],delete e[hc],delete e[bm],delete e[vR],delete e[xR])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function tE(t){return t.tag===5||t.tag===3||t.tag===4}function J1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||tE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Um(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Nd));else if(r!==4&&(t=t.child,t!==null))for(Um(t,e,n),t=t.sibling;t!==null;)Um(t,e,n),t=t.sibling}function zm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(zm(t,e,n),t=t.sibling;t!==null;)zm(t,e,n),t=t.sibling}var qt=null,fr=!1;function Mi(t,e,n){for(n=n.child;n!==null;)nE(t,e,n),n=n.sibling}function nE(t,e,n){if(Wr&&typeof Wr.onCommitFiberUnmount=="function")try{Wr.onCommitFiberUnmount(Dh,n)}catch{}switch(n.tag){case 5:ln||ia(n,e);case 6:var r=qt,i=fr;qt=null,Mi(t,e,n),qt=r,fr=i,qt!==null&&(fr?(t=qt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):qt.removeChild(n.stateNode));break;case 18:qt!==null&&(fr?(t=qt,n=n.stateNode,t.nodeType===8?up(t.parentNode,n):t.nodeType===1&&up(t,n),ac(t)):up(qt,n.stateNode));break;case 4:r=qt,i=fr,qt=n.stateNode.containerInfo,fr=!0,Mi(t,e,n),qt=r,fr=i;break;case 0:case 11:case 14:case 15:if(!ln&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Om(n,e,o),i=i.next}while(i!==r)}Mi(t,e,n);break;case 1:if(!ln&&(ia(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){vt(n,e,a)}Mi(t,e,n);break;case 21:Mi(t,e,n);break;case 22:n.mode&1?(ln=(r=ln)||n.memoizedState!==null,Mi(t,e,n),ln=r):Mi(t,e,n);break;default:Mi(t,e,n)}}function Z1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new LR),e.forEach(function(r){var i=qR.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function cr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:qt=a.stateNode,fr=!1;break e;case 3:qt=a.stateNode.containerInfo,fr=!0;break e;case 4:qt=a.stateNode.containerInfo,fr=!0;break e}a=a.return}if(qt===null)throw Error(Q(160));nE(s,o,i),qt=null,fr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(d){vt(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)rE(e,t),e=e.sibling}function rE(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(cr(e,t),jr(t),r&4){try{zl(3,t,t.return),zh(3,t)}catch(_){vt(t,t.return,_)}try{zl(5,t,t.return)}catch(_){vt(t,t.return,_)}}break;case 1:cr(e,t),jr(t),r&512&&n!==null&&ia(n,n.return);break;case 5:if(cr(e,t),jr(t),r&512&&n!==null&&ia(n,n.return),t.flags&32){var i=t.stateNode;try{rc(i,"")}catch(_){vt(t,t.return,_)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&bT(i,s),dm(a,o);var d=dm(a,s);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?RT(i,f):h==="dangerouslySetInnerHTML"?kT(i,f):h==="children"?rc(i,f):Qg(i,h,f,d)}switch(a){case"input":om(i,s);break;case"textarea":IT(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?ha(i,!!s.multiple,g,!1):p!==!!s.multiple&&(s.defaultValue!=null?ha(i,!!s.multiple,s.defaultValue,!0):ha(i,!!s.multiple,s.multiple?[]:"",!1))}i[hc]=s}catch(_){vt(t,t.return,_)}}break;case 6:if(cr(e,t),jr(t),r&4){if(t.stateNode===null)throw Error(Q(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(_){vt(t,t.return,_)}}break;case 3:if(cr(e,t),jr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ac(e.containerInfo)}catch(_){vt(t,t.return,_)}break;case 4:cr(e,t),jr(t);break;case 13:cr(e,t),jr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(ky=Et())),r&4&&Z1(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(ln=(d=ln)||h,cr(e,t),ln=d):cr(e,t),jr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ue=t,h=t.child;h!==null;){for(f=ue=h;ue!==null;){switch(p=ue,g=p.child,p.tag){case 0:case 11:case 14:case 15:zl(4,p,p.return);break;case 1:ia(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(_){vt(r,n,_)}}break;case 5:ia(p,p.return);break;case 22:if(p.memoizedState!==null){tx(f);continue}}g!==null?(g.return=p,ue=g):tx(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=AT("display",o))}catch(_){vt(t,t.return,_)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(_){vt(t,t.return,_)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:cr(e,t),jr(t),r&4&&Z1(t);break;case 21:break;default:cr(e,t),jr(t)}}function jr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(tE(n)){var r=n;break e}n=n.return}throw Error(Q(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(rc(i,""),r.flags&=-33);var s=J1(t);zm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=J1(t);Um(t,a,o);break;default:throw Error(Q(161))}}catch(l){vt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function VR(t,e,n){ue=t,iE(t)}function iE(t,e,n){for(var r=(t.mode&1)!==0;ue!==null;){var i=ue,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Du;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||ln;a=Du;var d=ln;if(Du=o,(ln=l)&&!d)for(ue=i;ue!==null;)o=ue,l=o.child,o.tag===22&&o.memoizedState!==null?nx(i):l!==null?(l.return=o,ue=l):nx(i);for(;s!==null;)ue=s,iE(s),s=s.sibling;ue=i,Du=a,ln=d}ex(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ue=s):ex(t)}}function ex(t){for(;ue!==null;){var e=ue;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ln||zh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ln)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ur(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&O1(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}O1(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&ac(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}ln||e.flags&512&&Fm(e)}catch(p){vt(e,e.return,p)}}if(e===t){ue=null;break}if(n=e.sibling,n!==null){n.return=e.return,ue=n;break}ue=e.return}}function tx(t){for(;ue!==null;){var e=ue;if(e===t){ue=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ue=n;break}ue=e.return}}function nx(t){for(;ue!==null;){var e=ue;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{zh(4,e)}catch(l){vt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){vt(e,i,l)}}var s=e.return;try{Fm(e)}catch(l){vt(e,s,l)}break;case 5:var o=e.return;try{Fm(e)}catch(l){vt(e,o,l)}}}catch(l){vt(e,e.return,l)}if(e===t){ue=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ue=a;break}ue=e.return}}var OR=Math.ceil,$d=Ai.ReactCurrentDispatcher,Iy=Ai.ReactCurrentOwner,ir=Ai.ReactCurrentBatchConfig,ze=0,Ut=null,At=null,Yt=0,Ln=0,sa=Rs(0),Lt=0,vc=null,go=0,Bh=0,Cy=0,Bl=null,En=null,ky=0,ja=1/0,ri=null,Wd=!1,Bm=null,cs=null,ju=!1,ts=null,qd=0,$l=0,$m=null,od=-1,ad=0;function wn(){return ze&6?Et():od!==-1?od:od=Et()}function us(t){return t.mode&1?ze&2&&Yt!==0?Yt&-Yt:_R.transition!==null?(ad===0&&(ad=BT()),ad):(t=We,t!==0||(t=window.event,t=t===void 0?16:QT(t.type)),t):1}function Sr(t,e,n,r){if(50<$l)throw $l=0,$m=null,Error(Q(185));Fc(t,n,r),(!(ze&2)||t!==Ut)&&(t===Ut&&(!(ze&2)&&(Bh|=n),Lt===4&&Gi(t,Yt)),Pn(t,r),n===1&&ze===0&&!(e.mode&1)&&(ja=Et()+500,Oh&&Ps()))}function Pn(t,e){var n=t.callbackNode;_A(t,e);var r=kd(t,t===Ut?Yt:0);if(r===0)n!==null&&d1(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&d1(n),e===1)t.tag===0?wR(rx.bind(null,t)):pS(rx.bind(null,t)),gR(function(){!(ze&6)&&Ps()}),n=null;else{switch($T(r)){case 1:n=ey;break;case 4:n=UT;break;case 16:n=Cd;break;case 536870912:n=zT;break;default:n=Cd}n=hE(n,sE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function sE(t,e){if(od=-1,ad=0,ze&6)throw Error(Q(327));var n=t.callbackNode;if(ya()&&t.callbackNode!==n)return null;var r=kd(t,t===Ut?Yt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Hd(t,r);else{e=r;var i=ze;ze|=2;var s=aE();(Ut!==t||Yt!==e)&&(ri=null,ja=Et()+500,so(t,e));do try{zR();break}catch(a){oE(t,a)}while(1);fy(),$d.current=s,ze=i,At!==null?e=0:(Ut=null,Yt=0,e=Lt)}if(e!==0){if(e===2&&(i=gm(t),i!==0&&(r=i,e=Wm(t,i))),e===1)throw n=vc,so(t,0),Gi(t,r),Pn(t,Et()),n;if(e===6)Gi(t,r);else{if(i=t.current.alternate,!(r&30)&&!FR(i)&&(e=Hd(t,r),e===2&&(s=gm(t),s!==0&&(r=s,e=Wm(t,s))),e===1))throw n=vc,so(t,0),Gi(t,r),Pn(t,Et()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Q(345));case 2:Ws(t,En,ri);break;case 3:if(Gi(t,r),(r&130023424)===r&&(e=ky+500-Et(),10<e)){if(kd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){wn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Em(Ws.bind(null,t,En,ri),e);break}Ws(t,En,ri);break;case 4:if(Gi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Tr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Et()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*OR(r/1960))-r,10<r){t.timeoutHandle=Em(Ws.bind(null,t,En,ri),r);break}Ws(t,En,ri);break;case 5:Ws(t,En,ri);break;default:throw Error(Q(329))}}}return Pn(t,Et()),t.callbackNode===n?sE.bind(null,t):null}function Wm(t,e){var n=Bl;return t.current.memoizedState.isDehydrated&&(so(t,e).flags|=256),t=Hd(t,e),t!==2&&(e=En,En=n,e!==null&&qm(e)),t}function qm(t){En===null?En=t:En.push.apply(En,t)}function FR(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Cr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Gi(t,e){for(e&=~Cy,e&=~Bh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Tr(e),r=1<<n;t[n]=-1,e&=~r}}function rx(t){if(ze&6)throw Error(Q(327));ya();var e=kd(t,0);if(!(e&1))return Pn(t,Et()),null;var n=Hd(t,e);if(t.tag!==0&&n===2){var r=gm(t);r!==0&&(e=r,n=Wm(t,r))}if(n===1)throw n=vc,so(t,0),Gi(t,e),Pn(t,Et()),n;if(n===6)throw Error(Q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ws(t,En,ri),Pn(t,Et()),null}function Ay(t,e){var n=ze;ze|=1;try{return t(e)}finally{ze=n,ze===0&&(ja=Et()+500,Oh&&Ps())}}function yo(t){ts!==null&&ts.tag===0&&!(ze&6)&&ya();var e=ze;ze|=1;var n=ir.transition,r=We;try{if(ir.transition=null,We=1,t)return t()}finally{We=r,ir.transition=n,ze=e,!(ze&6)&&Ps()}}function Ry(){Ln=sa.current,lt(sa)}function so(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,mR(n)),At!==null)for(n=At.return;n!==null;){var r=n;switch(uy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Dd();break;case 3:Na(),lt(An),lt(un),xy();break;case 5:vy(r);break;case 4:Na();break;case 13:lt(ht);break;case 19:lt(ht);break;case 10:py(r.type._context);break;case 22:case 23:Ry()}n=n.return}if(Ut=t,At=t=ds(t.current,null),Yt=Ln=e,Lt=0,vc=null,Cy=Bh=go=0,En=Bl=null,Js!==null){for(e=0;e<Js.length;e++)if(n=Js[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Js=null}return t}function oE(t,e){do{var n=At;try{if(fy(),rd.current=Bd,zd){for(var r=pt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}zd=!1}if(mo=0,Ft=jt=pt=null,Ul=!1,mc=0,Iy.current=null,n===null||n.return===null){Lt=1,vc=e,At=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Yt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=W1(o);if(g!==null){g.flags&=-257,q1(g,o,a,s,e),g.mode&1&&$1(s,d,e),e=g,l=d;var x=e.updateQueue;if(x===null){var _=new Set;_.add(l),e.updateQueue=_}else x.add(l);break e}else{if(!(e&1)){$1(s,d,e),Py();break e}l=Error(Q(426))}}else if(ct&&a.mode&1){var k=W1(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),q1(k,o,a,s,e),dy(Da(l,a));break e}}s=l=Da(l,a),Lt!==4&&(Lt=2),Bl===null?Bl=[s]:Bl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var S=$S(s,l,e);V1(s,S);break e;case 1:a=l;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(cs===null||!cs.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var j=WS(s,a,e);V1(s,j);break e}}s=s.return}while(s!==null)}cE(n)}catch(L){e=L,At===n&&n!==null&&(At=n=n.return);continue}break}while(1)}function aE(){var t=$d.current;return $d.current=Bd,t===null?Bd:t}function Py(){(Lt===0||Lt===3||Lt===2)&&(Lt=4),Ut===null||!(go&268435455)&&!(Bh&268435455)||Gi(Ut,Yt)}function Hd(t,e){var n=ze;ze|=2;var r=aE();(Ut!==t||Yt!==e)&&(ri=null,so(t,e));do try{UR();break}catch(i){oE(t,i)}while(1);if(fy(),ze=n,$d.current=r,At!==null)throw Error(Q(261));return Ut=null,Yt=0,Lt}function UR(){for(;At!==null;)lE(At)}function zR(){for(;At!==null&&!hA();)lE(At)}function lE(t){var e=dE(t.alternate,t,Ln);t.memoizedProps=t.pendingProps,e===null?cE(t):At=e,Iy.current=null}function cE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=jR(n,e),n!==null){n.flags&=32767,At=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Lt=6,At=null;return}}else if(n=DR(n,e,Ln),n!==null){At=n;return}if(e=e.sibling,e!==null){At=e;return}At=e=t}while(e!==null);Lt===0&&(Lt=5)}function Ws(t,e,n){var r=We,i=ir.transition;try{ir.transition=null,We=1,BR(t,e,n,r)}finally{ir.transition=i,We=r}return null}function BR(t,e,n,r){do ya();while(ts!==null);if(ze&6)throw Error(Q(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Q(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(TA(t,s),t===Ut&&(At=Ut=null,Yt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ju||(ju=!0,hE(Cd,function(){return ya(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=ir.transition,ir.transition=null;var o=We;We=1;var a=ze;ze|=4,Iy.current=null,MR(t,n),rE(n,t),lR(Tm),Ad=!!_m,Tm=_m=null,t.current=n,VR(n),fA(),ze=a,We=o,ir.transition=s}else t.current=n;if(ju&&(ju=!1,ts=t,qd=i),s=t.pendingLanes,s===0&&(cs=null),gA(n.stateNode),Pn(t,Et()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wd)throw Wd=!1,t=Bm,Bm=null,t;return qd&1&&t.tag!==0&&ya(),s=t.pendingLanes,s&1?t===$m?$l++:($l=0,$m=t):$l=0,Ps(),null}function ya(){if(ts!==null){var t=$T(qd),e=ir.transition,n=We;try{if(ir.transition=null,We=16>t?16:t,ts===null)var r=!1;else{if(t=ts,ts=null,qd=0,ze&6)throw Error(Q(331));var i=ze;for(ze|=4,ue=t.current;ue!==null;){var s=ue,o=s.child;if(ue.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(ue=d;ue!==null;){var h=ue;switch(h.tag){case 0:case 11:case 15:zl(8,h,s)}var f=h.child;if(f!==null)f.return=h,ue=f;else for(;ue!==null;){h=ue;var p=h.sibling,g=h.return;if(eE(h),h===d){ue=null;break}if(p!==null){p.return=g,ue=p;break}ue=g}}}var x=s.alternate;if(x!==null){var _=x.child;if(_!==null){x.child=null;do{var k=_.sibling;_.sibling=null,_=k}while(_!==null)}}ue=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ue=o;else e:for(;ue!==null;){if(s=ue,s.flags&2048)switch(s.tag){case 0:case 11:case 15:zl(9,s,s.return)}var S=s.sibling;if(S!==null){S.return=s.return,ue=S;break e}ue=s.return}}var v=t.current;for(ue=v;ue!==null;){o=ue;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,ue=w;else e:for(o=v;ue!==null;){if(a=ue,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:zh(9,a)}}catch(L){vt(a,a.return,L)}if(a===o){ue=null;break e}var j=a.sibling;if(j!==null){j.return=a.return,ue=j;break e}ue=a.return}}if(ze=i,Ps(),Wr&&typeof Wr.onPostCommitFiberRoot=="function")try{Wr.onPostCommitFiberRoot(Dh,t)}catch{}r=!0}return r}finally{We=n,ir.transition=e}}return!1}function ix(t,e,n){e=Da(n,e),e=$S(t,e,1),t=ls(t,e,1),e=wn(),t!==null&&(Fc(t,1,e),Pn(t,e))}function vt(t,e,n){if(t.tag===3)ix(t,t,n);else for(;e!==null;){if(e.tag===3){ix(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(cs===null||!cs.has(r))){t=Da(n,t),t=WS(e,t,1),e=ls(e,t,1),t=wn(),e!==null&&(Fc(e,1,t),Pn(e,t));break}}e=e.return}}function $R(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=wn(),t.pingedLanes|=t.suspendedLanes&n,Ut===t&&(Yt&n)===n&&(Lt===4||Lt===3&&(Yt&130023424)===Yt&&500>Et()-ky?so(t,0):Cy|=n),Pn(t,e)}function uE(t,e){e===0&&(t.mode&1?(e=Eu,Eu<<=1,!(Eu&130023424)&&(Eu=4194304)):e=1);var n=wn();t=wi(t,e),t!==null&&(Fc(t,e,n),Pn(t,n))}function WR(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),uE(t,n)}function qR(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Q(314))}r!==null&&r.delete(e),uE(t,n)}var dE;dE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||An.current)In=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return In=!1,NR(t,e,n);In=!!(t.flags&131072)}else In=!1,ct&&e.flags&1048576&&mS(e,Md,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;sd(t,e),t=e.pendingProps;var i=Aa(e,un.current);ga(e,n),i=_y(null,e,r,t,i,n);var s=Ty();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Rn(r)?(s=!0,jd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,gy(e),i.updater=Uh,e.stateNode=i,i._reactInternals=e,Pm(e,r,t,n),e=jm(null,e,r,!0,s,n)):(e.tag=0,ct&&s&&cy(e),xn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(sd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=GR(r),t=ur(r,t),i){case 0:e=Dm(null,e,r,t,n);break e;case 1:e=K1(null,e,r,t,n);break e;case 11:e=H1(null,e,r,t,n);break e;case 14:e=G1(null,e,r,ur(r.type,t),n);break e}throw Error(Q(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ur(r,i),Dm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ur(r,i),K1(t,e,r,i,n);case 3:e:{if(KS(e),t===null)throw Error(Q(387));r=e.pendingProps,s=e.memoizedState,i=s.element,_S(t,e),Fd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Da(Error(Q(423)),e),e=Q1(t,e,r,n,i);break e}else if(r!==i){i=Da(Error(Q(424)),e),e=Q1(t,e,r,n,i);break e}else for(Vn=as(e.stateNode.containerInfo.firstChild),Un=e,ct=!0,mr=null,n=xS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ra(),r===i){e=_i(t,e,n);break e}xn(t,e,r,n)}e=e.child}return e;case 5:return TS(e),t===null&&km(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Sm(r,i)?o=null:s!==null&&Sm(r,s)&&(e.flags|=32),GS(t,e),xn(t,e,o,n),e.child;case 6:return t===null&&km(e),null;case 13:return QS(t,e,n);case 4:return yy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Pa(e,null,r,n):xn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ur(r,i),H1(t,e,r,i,n);case 7:return xn(t,e,e.pendingProps,n),e.child;case 8:return xn(t,e,e.pendingProps.children,n),e.child;case 12:return xn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,et(Vd,r._currentValue),r._currentValue=o,s!==null)if(Cr(s.value,o)){if(s.children===i.children&&!An.current){e=_i(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=fi(-1,n&-n),l.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Am(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Q(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Am(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}xn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ga(e,n),i=ar(i),r=r(i),e.flags|=1,xn(t,e,r,n),e.child;case 14:return r=e.type,i=ur(r,e.pendingProps),i=ur(r.type,i),G1(t,e,r,i,n);case 15:return qS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ur(r,i),sd(t,e),e.tag=1,Rn(r)?(t=!0,jd(e)):t=!1,ga(e,n),BS(e,r,i),Pm(e,r,i,n),jm(null,e,r,!0,t,n);case 19:return YS(t,e,n);case 22:return HS(t,e,n)}throw Error(Q(156,e.tag))};function hE(t,e){return FT(t,e)}function HR(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nr(t,e,n,r){return new HR(t,e,n,r)}function Ny(t){return t=t.prototype,!(!t||!t.isReactComponent)}function GR(t){if(typeof t=="function")return Ny(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Xg)return 11;if(t===Jg)return 14}return 2}function ds(t,e){var n=t.alternate;return n===null?(n=nr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ld(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Ny(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Qo:return oo(n.children,i,s,e);case Yg:o=8,i|=8;break;case tm:return t=nr(12,n,e,i|2),t.elementType=tm,t.lanes=s,t;case nm:return t=nr(13,n,e,i),t.elementType=nm,t.lanes=s,t;case rm:return t=nr(19,n,e,i),t.elementType=rm,t.lanes=s,t;case TT:return $h(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case wT:o=10;break e;case _T:o=9;break e;case Xg:o=11;break e;case Jg:o=14;break e;case $i:o=16,r=null;break e}throw Error(Q(130,t==null?t:typeof t,""))}return e=nr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function oo(t,e,n,r){return t=nr(7,t,r,e),t.lanes=n,t}function $h(t,e,n,r){return t=nr(22,t,r,e),t.elementType=TT,t.lanes=n,t.stateNode={isHidden:!1},t}function vp(t,e,n){return t=nr(6,t,null,e),t.lanes=n,t}function xp(t,e,n){return e=nr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function KR(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zf(0),this.expirationTimes=Zf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Dy(t,e,n,r,i,s,o,a,l){return t=new KR(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=nr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},gy(s),t}function QR(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ko,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function fE(t){if(!t)return xs;t=t._reactInternals;e:{if(Io(t)!==t||t.tag!==1)throw Error(Q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Rn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Q(171))}if(t.tag===1){var n=t.type;if(Rn(n))return fS(t,n,e)}return e}function pE(t,e,n,r,i,s,o,a,l){return t=Dy(n,r,!0,t,i,s,o,a,l),t.context=fE(null),n=t.current,r=wn(),i=us(n),s=fi(r,i),s.callback=e??null,ls(n,s,i),t.current.lanes=i,Fc(t,i,r),Pn(t,r),t}function Wh(t,e,n,r){var i=e.current,s=wn(),o=us(i);return n=fE(n),e.context===null?e.context=n:e.pendingContext=n,e=fi(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ls(i,e,o),t!==null&&(Sr(t,i,o,s),nd(t,i,o)),o}function Gd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function sx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function jy(t,e){sx(t,e),(t=t.alternate)&&sx(t,e)}function YR(){return null}var mE=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ly(t){this._internalRoot=t}qh.prototype.render=Ly.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Q(409));Wh(t,e,null,null)};qh.prototype.unmount=Ly.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;yo(function(){Wh(null,t,null,null)}),e[xi]=null}};function qh(t){this._internalRoot=t}qh.prototype.unstable_scheduleHydration=function(t){if(t){var e=HT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Hi.length&&e!==0&&e<Hi[n].priority;n++);Hi.splice(n,0,t),n===0&&KT(t)}};function My(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ox(){}function XR(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=Gd(o);s.call(d)}}var o=pE(e,r,t,0,null,!1,!1,"",ox);return t._reactRootContainer=o,t[xi]=o.current,uc(t.nodeType===8?t.parentNode:t),yo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var d=Gd(l);a.call(d)}}var l=Dy(t,0,!1,null,null,!1,!1,"",ox);return t._reactRootContainer=l,t[xi]=l.current,uc(t.nodeType===8?t.parentNode:t),yo(function(){Wh(e,l,n,r)}),l}function Gh(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Gd(o);a.call(l)}}Wh(e,o,t,i)}else o=XR(n,e,t,i,r);return Gd(o)}WT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=kl(e.pendingLanes);n!==0&&(ty(e,n|1),Pn(e,Et()),!(ze&6)&&(ja=Et()+500,Ps()))}break;case 13:yo(function(){var r=wi(t,1);if(r!==null){var i=wn();Sr(r,t,1,i)}}),jy(t,1)}};ny=function(t){if(t.tag===13){var e=wi(t,134217728);if(e!==null){var n=wn();Sr(e,t,134217728,n)}jy(t,134217728)}};qT=function(t){if(t.tag===13){var e=us(t),n=wi(t,e);if(n!==null){var r=wn();Sr(n,t,e,r)}jy(t,e)}};HT=function(){return We};GT=function(t,e){var n=We;try{return We=t,e()}finally{We=n}};fm=function(t,e,n){switch(e){case"input":if(om(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Vh(r);if(!i)throw Error(Q(90));ET(r),om(r,i)}}}break;case"textarea":IT(t,n);break;case"select":e=n.value,e!=null&&ha(t,!!n.multiple,e,!1)}};DT=Ay;jT=yo;var JR={usingClientEntryPoint:!1,Events:[zc,Zo,Vh,PT,NT,Ay]},wl={findFiberByHostInstance:Xs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ZR={bundleType:wl.bundleType,version:wl.version,rendererPackageName:wl.rendererPackageName,rendererConfig:wl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ai.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=VT(t),t===null?null:t.stateNode},findFiberByHostInstance:wl.findFiberByHostInstance||YR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lu.isDisabled&&Lu.supportsFiber)try{Dh=Lu.inject(ZR),Wr=Lu}catch{}}$n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JR;$n.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!My(e))throw Error(Q(200));return QR(t,e,null,n)};$n.createRoot=function(t,e){if(!My(t))throw Error(Q(299));var n=!1,r="",i=mE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Dy(t,1,!1,null,null,n,!1,r,i),t[xi]=e.current,uc(t.nodeType===8?t.parentNode:t),new Ly(e)};$n.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Q(188)):(t=Object.keys(t).join(","),Error(Q(268,t)));return t=VT(e),t=t===null?null:t.stateNode,t};$n.flushSync=function(t){return yo(t)};$n.hydrate=function(t,e,n){if(!Hh(e))throw Error(Q(200));return Gh(null,t,e,!0,n)};$n.hydrateRoot=function(t,e,n){if(!My(t))throw Error(Q(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=mE;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=pE(e,null,t,1,n??null,i,!1,s,o),t[xi]=e.current,uc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new qh(e)};$n.render=function(t,e,n){if(!Hh(e))throw Error(Q(200));return Gh(null,t,e,!1,n)};$n.unmountComponentAtNode=function(t){if(!Hh(t))throw Error(Q(40));return t._reactRootContainer?(yo(function(){Gh(null,null,t,!1,function(){t._reactRootContainer=null,t[xi]=null})}),!0):!1};$n.unstable_batchedUpdates=Ay;$n.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Hh(n))throw Error(Q(200));if(t==null||t._reactInternals===void 0)throw Error(Q(38));return Gh(t,e,n,!1,r)};$n.version="18.3.1-next-f1338f8080-20240426";function gE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gE)}catch(t){console.error(t)}}gE(),gT.exports=$n;var eP=gT.exports,ax=eP;Zp.createRoot=ax.createRoot,Zp.hydrateRoot=ax.hydrateRoot;const yE=R.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),Kh=R.createContext({}),Qh=R.createContext(null),Yh=typeof document<"u",Vy=Yh?R.useLayoutEffect:R.useEffect,vE=R.createContext({strict:!1}),Oy=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),tP="framerAppearId",xE="data-"+Oy(tP);function nP(t,e,n,r){const{visualElement:i}=R.useContext(Kh),s=R.useContext(vE),o=R.useContext(Qh),a=R.useContext(yE).reducedMotion,l=R.useRef();r=r||s.renderer,!l.current&&r&&(l.current=r(t,{visualState:e,parent:i,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:a}));const d=l.current;R.useInsertionEffect(()=>{d&&d.update(n,o)});const h=R.useRef(!!(n[xE]&&!window.HandoffComplete));return Vy(()=>{d&&(d.render(),h.current&&d.animationState&&d.animationState.animateChanges())}),R.useEffect(()=>{d&&(d.updateFeatures(),!h.current&&d.animationState&&d.animationState.animateChanges(),h.current&&(h.current=!1,window.HandoffComplete=!0))}),d}function oa(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function rP(t,e,n){return R.useCallback(r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):oa(n)&&(n.current=r))},[e])}function xc(t){return typeof t=="string"||Array.isArray(t)}function Xh(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const Fy=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Uy=["initial",...Fy];function Jh(t){return Xh(t.animate)||Uy.some(e=>xc(t[e]))}function wE(t){return!!(Jh(t)||t.variants)}function iP(t,e){if(Jh(t)){const{initial:n,animate:r}=t;return{initial:n===!1||xc(n)?n:void 0,animate:xc(r)?r:void 0}}return t.inherit!==!1?e:{}}function sP(t){const{initial:e,animate:n}=iP(t,R.useContext(Kh));return R.useMemo(()=>({initial:e,animate:n}),[lx(e),lx(n)])}function lx(t){return Array.isArray(t)?t.join(" "):t}const cx={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},wc={};for(const t in cx)wc[t]={isEnabled:e=>cx[t].some(n=>!!e[n])};function oP(t){for(const e in t)wc[e]={...wc[e],...t[e]}}const zy=R.createContext({}),_E=R.createContext({}),aP=Symbol.for("motionComponentSymbol");function lP({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:i}){t&&oP(t);function s(a,l){let d;const h={...R.useContext(yE),...a,layoutId:cP(a)},{isStatic:f}=h,p=sP(a),g=r(a,f);if(!f&&Yh){p.visualElement=nP(i,g,h,e);const x=R.useContext(_E),_=R.useContext(vE).strict;p.visualElement&&(d=p.visualElement.loadFeatures(h,_,t,x))}return R.createElement(Kh.Provider,{value:p},d&&p.visualElement?R.createElement(d,{visualElement:p.visualElement,...h}):null,n(i,a,rP(g,p.visualElement,l),g,f,p.visualElement))}const o=R.forwardRef(s);return o[aP]=i,o}function cP({layoutId:t}){const e=R.useContext(zy).id;return e&&t!==void 0?e+"-"+t:t}function uP(t){function e(r,i={}){return lP(t(r,i))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(r,i)=>(n.has(i)||n.set(i,e(i)),n.get(i))})}const dP=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function By(t){return typeof t!="string"||t.includes("-")?!1:!!(dP.indexOf(t)>-1||/[A-Z]/.test(t))}const Kd={};function hP(t){Object.assign(Kd,t)}const $c=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Co=new Set($c);function TE(t,{layout:e,layoutId:n}){return Co.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Kd[t]||t==="opacity")}const Nn=t=>!!(t&&t.getVelocity),fP={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},pP=$c.length;function mP(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},r,i){let s="";for(let o=0;o<pP;o++){const a=$c[o];if(t[a]!==void 0){const l=fP[a]||a;s+=`${l}(${t[a]}) `}}return e&&!t.z&&(s+="translateZ(0)"),s=s.trim(),i?s=i(t,r?"":s):n&&r&&(s="none"),s}const SE=t=>e=>typeof e=="string"&&e.startsWith(t),EE=SE("--"),Hm=SE("var(--"),gP=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,yP=(t,e)=>e&&typeof t=="number"?e.transform(t):t,ws=(t,e,n)=>Math.min(Math.max(n,t),e),ko={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Wl={...ko,transform:t=>ws(0,1,t)},Mu={...ko,default:1},ql=t=>Math.round(t*1e5)/1e5,Zh=/(-)?([\d]*\.?[\d])+/g,bE=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,vP=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Wc(t){return typeof t=="string"}const qc=t=>({test:e=>Wc(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),zi=qc("deg"),Hr=qc("%"),Te=qc("px"),xP=qc("vh"),wP=qc("vw"),ux={...Hr,parse:t=>Hr.parse(t)/100,transform:t=>Hr.transform(t*100)},dx={...ko,transform:Math.round},IE={borderWidth:Te,borderTopWidth:Te,borderRightWidth:Te,borderBottomWidth:Te,borderLeftWidth:Te,borderRadius:Te,radius:Te,borderTopLeftRadius:Te,borderTopRightRadius:Te,borderBottomRightRadius:Te,borderBottomLeftRadius:Te,width:Te,maxWidth:Te,height:Te,maxHeight:Te,size:Te,top:Te,right:Te,bottom:Te,left:Te,padding:Te,paddingTop:Te,paddingRight:Te,paddingBottom:Te,paddingLeft:Te,margin:Te,marginTop:Te,marginRight:Te,marginBottom:Te,marginLeft:Te,rotate:zi,rotateX:zi,rotateY:zi,rotateZ:zi,scale:Mu,scaleX:Mu,scaleY:Mu,scaleZ:Mu,skew:zi,skewX:zi,skewY:zi,distance:Te,translateX:Te,translateY:Te,translateZ:Te,x:Te,y:Te,z:Te,perspective:Te,transformPerspective:Te,opacity:Wl,originX:ux,originY:ux,originZ:Te,zIndex:dx,fillOpacity:Wl,strokeOpacity:Wl,numOctaves:dx};function $y(t,e,n,r){const{style:i,vars:s,transform:o,transformOrigin:a}=t;let l=!1,d=!1,h=!0;for(const f in e){const p=e[f];if(EE(f)){s[f]=p;continue}const g=IE[f],x=yP(p,g);if(Co.has(f)){if(l=!0,o[f]=x,!h)continue;p!==(g.default||0)&&(h=!1)}else f.startsWith("origin")?(d=!0,a[f]=x):i[f]=x}if(e.transform||(l||r?i.transform=mP(t.transform,n,h,r):i.transform&&(i.transform="none")),d){const{originX:f="50%",originY:p="50%",originZ:g=0}=a;i.transformOrigin=`${f} ${p} ${g}`}}const Wy=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function CE(t,e,n){for(const r in e)!Nn(e[r])&&!TE(r,n)&&(t[r]=e[r])}function _P({transformTemplate:t},e,n){return R.useMemo(()=>{const r=Wy();return $y(r,e,{enableHardwareAcceleration:!n},t),Object.assign({},r.vars,r.style)},[e])}function TP(t,e,n){const r=t.style||{},i={};return CE(i,r,t),Object.assign(i,_P(t,e,n)),t.transformValues?t.transformValues(i):i}function SP(t,e,n){const r={},i=TP(t,e,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=i,r}const EP=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Qd(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||EP.has(t)}let kE=t=>!Qd(t);function bP(t){t&&(kE=e=>e.startsWith("on")?!Qd(e):t(e))}try{bP(require("@emotion/is-prop-valid").default)}catch{}function IP(t,e,n){const r={};for(const i in t)i==="values"&&typeof t.values=="object"||(kE(i)||n===!0&&Qd(i)||!e&&!Qd(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}function hx(t,e,n){return typeof t=="string"?t:Te.transform(e+n*t)}function CP(t,e,n){const r=hx(e,t.x,t.width),i=hx(n,t.y,t.height);return`${r} ${i}`}const kP={offset:"stroke-dashoffset",array:"stroke-dasharray"},AP={offset:"strokeDashoffset",array:"strokeDasharray"};function RP(t,e,n=1,r=0,i=!0){t.pathLength=1;const s=i?kP:AP;t[s.offset]=Te.transform(-r);const o=Te.transform(e),a=Te.transform(n);t[s.array]=`${o} ${a}`}function qy(t,{attrX:e,attrY:n,attrScale:r,originX:i,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...d},h,f,p){if($y(t,d,h,p),f){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:g,style:x,dimensions:_}=t;g.transform&&(_&&(x.transform=g.transform),delete g.transform),_&&(i!==void 0||s!==void 0||x.transform)&&(x.transformOrigin=CP(_,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(g.x=e),n!==void 0&&(g.y=n),r!==void 0&&(g.scale=r),o!==void 0&&RP(g,o,a,l,!1)}const AE=()=>({...Wy(),attrs:{}}),Hy=t=>typeof t=="string"&&t.toLowerCase()==="svg";function PP(t,e,n,r){const i=R.useMemo(()=>{const s=AE();return qy(s,e,{enableHardwareAcceleration:!1},Hy(r),t.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};CE(s,t.style,t),i.style={...s,...i.style}}return i}function NP(t=!1){return(n,r,i,{latestValues:s},o)=>{const l=(By(n)?PP:SP)(r,s,o,n),h={...IP(r,typeof n=="string",t),...l,ref:i},{children:f}=r,p=R.useMemo(()=>Nn(f)?f.get():f,[f]);return R.createElement(n,{...h,children:p})}}function RE(t,{style:e,vars:n},r,i){Object.assign(t.style,e,i&&i.getProjectionStyles(r));for(const s in n)t.style.setProperty(s,n[s])}const PE=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function NE(t,e,n,r){RE(t,e,void 0,r);for(const i in e.attrs)t.setAttribute(PE.has(i)?i:Oy(i),e.attrs[i])}function Gy(t,e){const{style:n}=t,r={};for(const i in n)(Nn(n[i])||e.style&&Nn(e.style[i])||TE(i,t))&&(r[i]=n[i]);return r}function DE(t,e){const n=Gy(t,e);for(const r in t)if(Nn(t[r])||Nn(e[r])){const i=$c.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[i]=t[r]}return n}function Ky(t,e,n,r={},i={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,i)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,i)),e}function jE(t){const e=R.useRef(null);return e.current===null&&(e.current=t()),e.current}const Yd=t=>Array.isArray(t),DP=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),jP=t=>Yd(t)?t[t.length-1]||0:t;function cd(t){const e=Nn(t)?t.get():t;return DP(e)?e.toValue():e}function LP({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,i,s){const o={latestValues:MP(r,i,s,t),renderState:e()};return n&&(o.mount=a=>n(r,a,o)),o}const LE=t=>(e,n)=>{const r=R.useContext(Kh),i=R.useContext(Qh),s=()=>LP(t,e,r,i);return n?s():jE(s)};function MP(t,e,n,r){const i={},s=r(t,{});for(const p in s)i[p]=cd(s[p]);let{initial:o,animate:a}=t;const l=Jh(t),d=wE(t);e&&d&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let h=n?n.initial===!1:!1;h=h||o===!1;const f=h?a:o;return f&&typeof f!="boolean"&&!Xh(f)&&(Array.isArray(f)?f:[f]).forEach(g=>{const x=Ky(t,g);if(!x)return;const{transitionEnd:_,transition:k,...S}=x;for(const v in S){let w=S[v];if(Array.isArray(w)){const j=h?w.length-1:0;w=w[j]}w!==null&&(i[v]=w)}for(const v in _)i[v]=_[v]}),i}const xt=t=>t;class fx{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function VP(t){let e=new fx,n=new fx,r=0,i=!1,s=!1;const o=new WeakSet,a={schedule:(l,d=!1,h=!1)=>{const f=h&&i,p=f?e:n;return d&&o.add(l),p.add(l)&&f&&i&&(r=e.order.length),l},cancel:l=>{n.remove(l),o.delete(l)},process:l=>{if(i){s=!0;return}if(i=!0,[e,n]=[n,e],n.clear(),r=e.order.length,r)for(let d=0;d<r;d++){const h=e.order[d];h(l),o.has(h)&&(a.schedule(h),t())}i=!1,s&&(s=!1,a.process(l))}};return a}const Vu=["prepare","read","update","preRender","render","postRender"],OP=40;function FP(t,e){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=Vu.reduce((f,p)=>(f[p]=VP(()=>n=!0),f),{}),o=f=>s[f].process(i),a=()=>{const f=performance.now();n=!1,i.delta=r?1e3/60:Math.max(Math.min(f-i.timestamp,OP),1),i.timestamp=f,i.isProcessing=!0,Vu.forEach(o),i.isProcessing=!1,n&&e&&(r=!1,t(a))},l=()=>{n=!0,r=!0,i.isProcessing||t(a)};return{schedule:Vu.reduce((f,p)=>{const g=s[p];return f[p]=(x,_=!1,k=!1)=>(n||l(),g.schedule(x,_,k)),f},{}),cancel:f=>Vu.forEach(p=>s[p].cancel(f)),state:i,steps:s}}const{schedule:tt,cancel:Ti,state:on,steps:wp}=FP(typeof requestAnimationFrame<"u"?requestAnimationFrame:xt,!0),UP={useVisualState:LE({scrapeMotionValuesFromProps:DE,createRenderState:AE,onMount:(t,e,{renderState:n,latestValues:r})=>{tt.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),tt.render(()=>{qy(n,r,{enableHardwareAcceleration:!1},Hy(e.tagName),t.transformTemplate),NE(e,n)})}})},zP={useVisualState:LE({scrapeMotionValuesFromProps:Gy,createRenderState:Wy})};function BP(t,{forwardMotionProps:e=!1},n,r){return{...By(t)?UP:zP,preloadedFeatures:n,useRender:NP(e),createVisualElement:r,Component:t}}function ui(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const ME=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function ef(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const $P=t=>e=>ME(e)&&t(e,ef(e));function pi(t,e,n,r){return ui(t,e,$P(n),r)}const WP=(t,e)=>n=>e(t(n)),hs=(...t)=>t.reduce(WP);function VE(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const px=VE("dragHorizontal"),mx=VE("dragVertical");function OE(t){let e=!1;if(t==="y")e=mx();else if(t==="x")e=px();else{const n=px(),r=mx();n&&r?e=()=>{n(),r()}:(n&&n(),r&&r())}return e}function FE(){const t=OE(!0);return t?(t(),!1):!0}class Ns{constructor(e){this.isMounted=!1,this.node=e}update(){}}function gx(t,e){const n="pointer"+(e?"enter":"leave"),r="onHover"+(e?"Start":"End"),i=(s,o)=>{if(s.pointerType==="touch"||FE())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e),a[r]&&tt.update(()=>a[r](s,o))};return pi(t.current,n,i,{passive:!t.getProps()[r]})}class qP extends Ns{mount(){this.unmount=hs(gx(this.node,!0),gx(this.node,!1))}unmount(){}}class HP extends Ns{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=hs(ui(this.node.current,"focus",()=>this.onFocus()),ui(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const UE=(t,e)=>e?t===e?!0:UE(t,e.parentElement):!1;function _p(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,ef(n))}class GP extends Ns{constructor(){super(...arguments),this.removeStartListeners=xt,this.removeEndListeners=xt,this.removeAccessibleListeners=xt,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const r=this.node.getProps(),s=pi(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:h,globalTapTarget:f}=this.node.getProps();tt.update(()=>{!f&&!UE(this.node.current,a.target)?h&&h(a,l):d&&d(a,l)})},{passive:!(r.onTap||r.onPointerUp)}),o=pi(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=hs(s,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=s=>{if(s.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||_p("up",(l,d)=>{const{onTap:h}=this.node.getProps();h&&tt.update(()=>h(l,d))})};this.removeEndListeners(),this.removeEndListeners=ui(this.node.current,"keyup",o),_p("down",(a,l)=>{this.startPress(a,l)})},n=ui(this.node.current,"keydown",e),r=()=>{this.isPressing&&_p("cancel",(s,o)=>this.cancelPress(s,o))},i=ui(this.node.current,"blur",r);this.removeAccessibleListeners=hs(n,i)}}startPress(e,n){this.isPressing=!0;const{onTapStart:r,whileTap:i}=this.node.getProps();i&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&tt.update(()=>r(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!FE()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&tt.update(()=>r(e,n))}mount(){const e=this.node.getProps(),n=pi(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),r=ui(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=hs(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Gm=new WeakMap,Tp=new WeakMap,KP=t=>{const e=Gm.get(t.target);e&&e(t)},QP=t=>{t.forEach(KP)};function YP({root:t,...e}){const n=t||document;Tp.has(n)||Tp.set(n,{});const r=Tp.get(n),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(QP,{root:t,...e})),r[i]}function XP(t,e,n){const r=YP(e);return Gm.set(t,n),r.observe(t),()=>{Gm.delete(t),r.unobserve(t)}}const JP={some:0,all:1};class ZP extends Ns{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:s}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:JP[i]},a=l=>{const{isIntersecting:d}=l;if(this.isInView===d||(this.isInView=d,s&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),p=d?h:f;p&&p(l)};return XP(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(e5(e,n))&&this.startObserver()}unmount(){}}function e5({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const t5={inView:{Feature:ZP},tap:{Feature:GP},focus:{Feature:HP},hover:{Feature:qP}};function zE(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function n5(t){const e={};return t.values.forEach((n,r)=>e[r]=n.get()),e}function r5(t){const e={};return t.values.forEach((n,r)=>e[r]=n.getVelocity()),e}function tf(t,e,n){const r=t.getProps();return Ky(r,e,n!==void 0?n:r.custom,n5(t),r5(t))}let i5=xt,Qy=xt;const fs=t=>t*1e3,mi=t=>t/1e3,s5={current:!1},BE=t=>Array.isArray(t)&&typeof t[0]=="number";function $E(t){return!!(!t||typeof t=="string"&&WE[t]||BE(t)||Array.isArray(t)&&t.every($E))}const Rl=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,WE={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Rl([0,.65,.55,1]),circOut:Rl([.55,0,1,.45]),backIn:Rl([.31,.01,.66,-.59]),backOut:Rl([.33,1.53,.69,.99])};function qE(t){if(t)return BE(t)?Rl(t):Array.isArray(t)?t.map(qE):WE[t]}function o5(t,e,n,{delay:r=0,duration:i,repeat:s=0,repeatType:o="loop",ease:a,times:l}={}){const d={[e]:n};l&&(d.offset=l);const h=qE(a);return Array.isArray(h)&&(d.easing=h),t.animate(d,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}function a5(t,{repeat:e,repeatType:n="loop"}){const r=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[r]}const HE=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,l5=1e-7,c5=12;function u5(t,e,n,r,i){let s,o,a=0;do o=e+(n-e)/2,s=HE(o,r,i)-t,s>0?n=o:e=o;while(Math.abs(s)>l5&&++a<c5);return o}function Hc(t,e,n,r){if(t===e&&n===r)return xt;const i=s=>u5(s,0,1,t,n);return s=>s===0||s===1?s:HE(i(s),e,r)}const d5=Hc(.42,0,1,1),h5=Hc(0,0,.58,1),GE=Hc(.42,0,.58,1),f5=t=>Array.isArray(t)&&typeof t[0]!="number",KE=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,QE=t=>e=>1-t(1-e),Yy=t=>1-Math.sin(Math.acos(t)),YE=QE(Yy),p5=KE(Yy),XE=Hc(.33,1.53,.69,.99),Xy=QE(XE),m5=KE(Xy),g5=t=>(t*=2)<1?.5*Xy(t):.5*(2-Math.pow(2,-10*(t-1))),y5={linear:xt,easeIn:d5,easeInOut:GE,easeOut:h5,circIn:Yy,circInOut:p5,circOut:YE,backIn:Xy,backInOut:m5,backOut:XE,anticipate:g5},yx=t=>{if(Array.isArray(t)){Qy(t.length===4);const[e,n,r,i]=t;return Hc(e,n,r,i)}else if(typeof t=="string")return y5[t];return t},Jy=(t,e)=>n=>!!(Wc(n)&&vP.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),JE=(t,e,n)=>r=>{if(!Wc(r))return r;const[i,s,o,a]=r.match(Zh);return{[t]:parseFloat(i),[e]:parseFloat(s),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},v5=t=>ws(0,255,t),Sp={...ko,transform:t=>Math.round(v5(t))},eo={test:Jy("rgb","red"),parse:JE("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+Sp.transform(t)+", "+Sp.transform(e)+", "+Sp.transform(n)+", "+ql(Wl.transform(r))+")"};function x5(t){let e="",n="",r="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const Km={test:Jy("#"),parse:x5,transform:eo.transform},aa={test:Jy("hsl","hue"),parse:JE("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Hr.transform(ql(e))+", "+Hr.transform(ql(n))+", "+ql(Wl.transform(r))+")"},vn={test:t=>eo.test(t)||Km.test(t)||aa.test(t),parse:t=>eo.test(t)?eo.parse(t):aa.test(t)?aa.parse(t):Km.parse(t),transform:t=>Wc(t)?t:t.hasOwnProperty("red")?eo.transform(t):aa.transform(t)},ft=(t,e,n)=>-n*t+n*e+t;function Ep(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function w5({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let i=0,s=0,o=0;if(!e)i=s=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;i=Ep(l,a,t+1/3),s=Ep(l,a,t),o=Ep(l,a,t-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:r}}const bp=(t,e,n)=>{const r=t*t;return Math.sqrt(Math.max(0,n*(e*e-r)+r))},_5=[Km,eo,aa],T5=t=>_5.find(e=>e.test(t));function vx(t){const e=T5(t);let n=e.parse(t);return e===aa&&(n=w5(n)),n}const ZE=(t,e)=>{const n=vx(t),r=vx(e),i={...n};return s=>(i.red=bp(n.red,r.red,s),i.green=bp(n.green,r.green,s),i.blue=bp(n.blue,r.blue,s),i.alpha=ft(n.alpha,r.alpha,s),eo.transform(i))};function S5(t){var e,n;return isNaN(t)&&Wc(t)&&(((e=t.match(Zh))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(bE))===null||n===void 0?void 0:n.length)||0)>0}const eb={regex:gP,countKey:"Vars",token:"${v}",parse:xt},tb={regex:bE,countKey:"Colors",token:"${c}",parse:vn.parse},nb={regex:Zh,countKey:"Numbers",token:"${n}",parse:ko.parse};function Ip(t,{regex:e,countKey:n,token:r,parse:i}){const s=t.tokenised.match(e);s&&(t["num"+n]=s.length,t.tokenised=t.tokenised.replace(e,r),t.values.push(...s.map(i)))}function Xd(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&Ip(n,eb),Ip(n,tb),Ip(n,nb),n}function rb(t){return Xd(t).values}function ib(t){const{values:e,numColors:n,numVars:r,tokenised:i}=Xd(t),s=e.length;return o=>{let a=i;for(let l=0;l<s;l++)l<r?a=a.replace(eb.token,o[l]):l<r+n?a=a.replace(tb.token,vn.transform(o[l])):a=a.replace(nb.token,ql(o[l]));return a}}const E5=t=>typeof t=="number"?0:t;function b5(t){const e=rb(t);return ib(t)(e.map(E5))}const _s={test:S5,parse:rb,createTransformer:ib,getAnimatableNone:b5},sb=(t,e)=>n=>`${n>0?e:t}`;function ob(t,e){return typeof t=="number"?n=>ft(t,e,n):vn.test(t)?ZE(t,e):t.startsWith("var(")?sb(t,e):lb(t,e)}const ab=(t,e)=>{const n=[...t],r=n.length,i=t.map((s,o)=>ob(s,e[o]));return s=>{for(let o=0;o<r;o++)n[o]=i[o](s);return n}},I5=(t,e)=>{const n={...t,...e},r={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(r[i]=ob(t[i],e[i]));return i=>{for(const s in r)n[s]=r[s](i);return n}},lb=(t,e)=>{const n=_s.createTransformer(e),r=Xd(t),i=Xd(e);return r.numVars===i.numVars&&r.numColors===i.numColors&&r.numNumbers>=i.numNumbers?hs(ab(r.values,i.values),n):sb(t,e)},_c=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},xx=(t,e)=>n=>ft(t,e,n);function C5(t){return typeof t=="number"?xx:typeof t=="string"?vn.test(t)?ZE:lb:Array.isArray(t)?ab:typeof t=="object"?I5:xx}function k5(t,e,n){const r=[],i=n||C5(t[0]),s=t.length-1;for(let o=0;o<s;o++){let a=i(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||xt:e;a=hs(l,a)}r.push(a)}return r}function cb(t,e,{clamp:n=!0,ease:r,mixer:i}={}){const s=t.length;if(Qy(s===e.length),s===1)return()=>e[0];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=k5(e,r,i),a=o.length,l=d=>{let h=0;if(a>1)for(;h<t.length-2&&!(d<t[h+1]);h++);const f=_c(t[h],t[h+1],d);return o[h](f)};return n?d=>l(ws(t[0],t[s-1],d)):l}function A5(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const i=_c(0,e,r);t.push(ft(n,1,i))}}function R5(t){const e=[0];return A5(e,t.length-1),e}function P5(t,e){return t.map(n=>n*e)}function N5(t,e){return t.map(()=>e||GE).splice(0,t.length-1)}function Jd({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const i=f5(r)?r.map(yx):yx(r),s={done:!1,value:e[0]},o=P5(n&&n.length===e.length?n:R5(e),t),a=cb(o,e,{ease:Array.isArray(i)?i:N5(e,i)});return{calculatedDuration:t,next:l=>(s.value=a(l),s.done=l>=t,s)}}function ub(t,e){return e?t*(1e3/e):0}const D5=5;function db(t,e,n){const r=Math.max(e-D5,0);return ub(n-t(r),e-r)}const Cp=.001,j5=.01,wx=10,L5=.05,M5=1;function V5({duration:t=800,bounce:e=.25,velocity:n=0,mass:r=1}){let i,s;i5(t<=fs(wx));let o=1-e;o=ws(L5,M5,o),t=ws(j5,wx,mi(t)),o<1?(i=d=>{const h=d*o,f=h*t,p=h-n,g=Qm(d,o),x=Math.exp(-f);return Cp-p/g*x},s=d=>{const f=d*o*t,p=f*n+n,g=Math.pow(o,2)*Math.pow(d,2)*t,x=Math.exp(-f),_=Qm(Math.pow(d,2),o);return(-i(d)+Cp>0?-1:1)*((p-g)*x)/_}):(i=d=>{const h=Math.exp(-d*t),f=(d-n)*t+1;return-Cp+h*f},s=d=>{const h=Math.exp(-d*t),f=(n-d)*(t*t);return h*f});const a=5/t,l=F5(i,s,a);if(t=fs(t),isNaN(l))return{stiffness:100,damping:10,duration:t};{const d=Math.pow(l,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:t}}}const O5=12;function F5(t,e,n){let r=n;for(let i=1;i<O5;i++)r=r-t(r)/e(r);return r}function Qm(t,e){return t*Math.sqrt(1-e*e)}const U5=["duration","bounce"],z5=["stiffness","damping","mass"];function _x(t,e){return e.some(n=>t[n]!==void 0)}function B5(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!_x(t,z5)&&_x(t,U5)){const n=V5(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function hb({keyframes:t,restDelta:e,restSpeed:n,...r}){const i=t[0],s=t[t.length-1],o={done:!1,value:i},{stiffness:a,damping:l,mass:d,duration:h,velocity:f,isResolvedFromDuration:p}=B5({...r,velocity:-mi(r.velocity||0)}),g=f||0,x=l/(2*Math.sqrt(a*d)),_=s-i,k=mi(Math.sqrt(a/d)),S=Math.abs(_)<5;n||(n=S?.01:2),e||(e=S?.005:.5);let v;if(x<1){const w=Qm(k,x);v=j=>{const L=Math.exp(-x*k*j);return s-L*((g+x*k*_)/w*Math.sin(w*j)+_*Math.cos(w*j))}}else if(x===1)v=w=>s-Math.exp(-k*w)*(_+(g+k*_)*w);else{const w=k*Math.sqrt(x*x-1);v=j=>{const L=Math.exp(-x*k*j),V=Math.min(w*j,300);return s-L*((g+x*k*_)*Math.sinh(V)+w*_*Math.cosh(V))/w}}return{calculatedDuration:p&&h||null,next:w=>{const j=v(w);if(p)o.done=w>=h;else{let L=g;w!==0&&(x<1?L=db(v,w,j):L=0);const V=Math.abs(L)<=n,E=Math.abs(s-j)<=e;o.done=V&&E}return o.value=o.done?s:j,o}}}function Tx({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:d=.5,restSpeed:h}){const f=t[0],p={done:!1,value:f},g=T=>a!==void 0&&T<a||l!==void 0&&T>l,x=T=>a===void 0?l:l===void 0||Math.abs(a-T)<Math.abs(l-T)?a:l;let _=n*e;const k=f+_,S=o===void 0?k:o(k);S!==k&&(_=S-f);const v=T=>-_*Math.exp(-T/r),w=T=>S+v(T),j=T=>{const I=v(T),A=w(T);p.done=Math.abs(I)<=d,p.value=p.done?S:A};let L,V;const E=T=>{g(p.value)&&(L=T,V=hb({keyframes:[p.value,x(p.value)],velocity:db(w,T,p.value),damping:i,stiffness:s,restDelta:d,restSpeed:h}))};return E(0),{calculatedDuration:null,next:T=>{let I=!1;return!V&&L===void 0&&(I=!0,j(T),E(T)),L!==void 0&&T>L?V.next(T-L):(!I&&j(T),p)}}}const $5=t=>{const e=({timestamp:n})=>t(n);return{start:()=>tt.update(e,!0),stop:()=>Ti(e),now:()=>on.isProcessing?on.timestamp:performance.now()}},Sx=2e4;function Ex(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<Sx;)e+=n,r=t.next(e);return e>=Sx?1/0:e}const W5={decay:Tx,inertia:Tx,tween:Jd,keyframes:Jd,spring:hb};function Zd({autoplay:t=!0,delay:e=0,driver:n=$5,keyframes:r,type:i="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:a="loop",onPlay:l,onStop:d,onComplete:h,onUpdate:f,...p}){let g=1,x=!1,_,k;const S=()=>{k=new Promise(D=>{_=D})};S();let v;const w=W5[i]||Jd;let j;w!==Jd&&typeof r[0]!="number"&&(j=cb([0,100],r,{clamp:!1}),r=[0,100]);const L=w({...p,keyframes:r});let V;a==="mirror"&&(V=w({...p,keyframes:[...r].reverse(),velocity:-(p.velocity||0)}));let E="idle",T=null,I=null,A=null;L.calculatedDuration===null&&s&&(L.calculatedDuration=Ex(L));const{calculatedDuration:P}=L;let N=1/0,b=1/0;P!==null&&(N=P+o,b=N*(s+1)-o);let H=0;const he=D=>{if(I===null)return;g>0&&(I=Math.min(I,D)),g<0&&(I=Math.min(D-b/g,I)),T!==null?H=T:H=Math.round(D-I)*g;const q=H-e*(g>=0?1:-1),J=g>=0?q<0:q>b;H=Math.max(q,0),E==="finished"&&T===null&&(H=b);let ee=H,ie=L;if(s){const pe=Math.min(H,b)/N;let _e=Math.floor(pe),ge=pe%1;!ge&&pe>=1&&(ge=1),ge===1&&_e--,_e=Math.min(_e,s+1),!!(_e%2)&&(a==="reverse"?(ge=1-ge,o&&(ge-=o/N)):a==="mirror"&&(ie=V)),ee=ws(0,1,ge)*N}const Z=J?{done:!1,value:r[0]}:ie.next(ee);j&&(Z.value=j(Z.value));let{done:z}=Z;!J&&P!==null&&(z=g>=0?H>=b:H<=0);const Y=T===null&&(E==="finished"||E==="running"&&z);return f&&f(Z.value),Y&&U(),Z},re=()=>{v&&v.stop(),v=void 0},se=()=>{E="idle",re(),_(),S(),I=A=null},U=()=>{E="finished",h&&h(),re(),_()},G=()=>{if(x)return;v||(v=n(he));const D=v.now();l&&l(),T!==null?I=D-T:(!I||E==="finished")&&(I=D),E==="finished"&&S(),A=I,T=null,E="running",v.start()};t&&G();const M={then(D,q){return k.then(D,q)},get time(){return mi(H)},set time(D){D=fs(D),H=D,T!==null||!v||g===0?T=D:I=v.now()-D/g},get duration(){const D=L.calculatedDuration===null?Ex(L):L.calculatedDuration;return mi(D)},get speed(){return g},set speed(D){D===g||!v||(g=D,M.time=mi(H))},get state(){return E},play:G,pause:()=>{E="paused",T=H},stop:()=>{x=!0,E!=="idle"&&(E="idle",d&&d(),se())},cancel:()=>{A!==null&&he(A),se()},complete:()=>{E="finished"},sample:D=>(I=0,he(D))};return M}function q5(t){let e;return()=>(e===void 0&&(e=t()),e)}const H5=q5(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),G5=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Ou=10,K5=2e4,Q5=(t,e)=>e.type==="spring"||t==="backgroundColor"||!$E(e.ease);function Y5(t,e,{onUpdate:n,onComplete:r,...i}){if(!(H5()&&G5.has(e)&&!i.repeatDelay&&i.repeatType!=="mirror"&&i.damping!==0&&i.type!=="inertia"))return!1;let o=!1,a,l,d=!1;const h=()=>{l=new Promise(w=>{a=w})};h();let{keyframes:f,duration:p=300,ease:g,times:x}=i;if(Q5(e,i)){const w=Zd({...i,repeat:0,delay:0});let j={done:!1,value:f[0]};const L=[];let V=0;for(;!j.done&&V<K5;)j=w.sample(V),L.push(j.value),V+=Ou;x=void 0,f=L,p=V-Ou,g="linear"}const _=o5(t.owner.current,e,f,{...i,duration:p,ease:g,times:x}),k=()=>{d=!1,_.cancel()},S=()=>{d=!0,tt.update(k),a(),h()};return _.onfinish=()=>{d||(t.set(a5(f,i)),r&&r(),S())},{then(w,j){return l.then(w,j)},attachTimeline(w){return _.timeline=w,_.onfinish=null,xt},get time(){return mi(_.currentTime||0)},set time(w){_.currentTime=fs(w)},get speed(){return _.playbackRate},set speed(w){_.playbackRate=w},get duration(){return mi(p)},play:()=>{o||(_.play(),Ti(k))},pause:()=>_.pause(),stop:()=>{if(o=!0,_.playState==="idle")return;const{currentTime:w}=_;if(w){const j=Zd({...i,autoplay:!1});t.setWithVelocity(j.sample(w-Ou).value,j.sample(w).value,Ou)}S()},complete:()=>{d||_.finish()},cancel:S}}function X5({keyframes:t,delay:e,onUpdate:n,onComplete:r}){const i=()=>(n&&n(t[t.length-1]),r&&r(),{time:0,speed:1,duration:0,play:xt,pause:xt,stop:xt,then:s=>(s(),Promise.resolve()),cancel:xt,complete:xt});return e?Zd({keyframes:[0,1],duration:0,delay:e,onComplete:i}):i()}const J5={type:"spring",stiffness:500,damping:25,restSpeed:10},Z5=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),e4={type:"keyframes",duration:.8},t4={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},n4=(t,{keyframes:e})=>e.length>2?e4:Co.has(t)?t.startsWith("scale")?Z5(e[1]):J5:t4,Ym=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(_s.test(e)||e==="0")&&!e.startsWith("url(")),r4=new Set(["brightness","contrast","saturate","opacity"]);function i4(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(Zh)||[];if(!r)return t;const i=n.replace(r,"");let s=r4.has(e)?1:0;return r!==n&&(s*=100),e+"("+s+i+")"}const s4=/([a-z-]*)\(.*?\)/g,Xm={..._s,getAnimatableNone:t=>{const e=t.match(s4);return e?e.map(i4).join(" "):t}},o4={...IE,color:vn,backgroundColor:vn,outlineColor:vn,fill:vn,stroke:vn,borderColor:vn,borderTopColor:vn,borderRightColor:vn,borderBottomColor:vn,borderLeftColor:vn,filter:Xm,WebkitFilter:Xm},Zy=t=>o4[t];function fb(t,e){let n=Zy(t);return n!==Xm&&(n=_s),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const pb=t=>/^0[^.\s]+$/.test(t);function a4(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||pb(t)}function l4(t,e,n,r){const i=Ym(e,n);let s;Array.isArray(n)?s=[...n]:s=[null,n];const o=r.from!==void 0?r.from:t.get();let a;const l=[];for(let d=0;d<s.length;d++)s[d]===null&&(s[d]=d===0?o:s[d-1]),a4(s[d])&&l.push(d),typeof s[d]=="string"&&s[d]!=="none"&&s[d]!=="0"&&(a=s[d]);if(i&&l.length&&a)for(let d=0;d<l.length;d++){const h=l[d];s[h]=fb(e,a)}return s}function c4({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:d,...h}){return!!Object.keys(h).length}function e0(t,e){return t[e]||t.default||t}const u4={skipAnimations:!1},t0=(t,e,n,r={})=>i=>{const s=e0(r,t)||{},o=s.delay||r.delay||0;let{elapsed:a=0}=r;a=a-fs(o);const l=l4(e,t,n,s),d=l[0],h=l[l.length-1],f=Ym(t,d),p=Ym(t,h);let g={keyframes:l,velocity:e.getVelocity(),ease:"easeOut",...s,delay:-a,onUpdate:x=>{e.set(x),s.onUpdate&&s.onUpdate(x)},onComplete:()=>{i(),s.onComplete&&s.onComplete()}};if(c4(s)||(g={...g,...n4(t,g)}),g.duration&&(g.duration=fs(g.duration)),g.repeatDelay&&(g.repeatDelay=fs(g.repeatDelay)),!f||!p||s5.current||s.type===!1||u4.skipAnimations)return X5(g);if(!r.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const x=Y5(e,t,g);if(x)return x}return Zd(g)};function eh(t){return!!(Nn(t)&&t.add)}const mb=t=>/^\-?\d*\.?\d+$/.test(t);function n0(t,e){t.indexOf(e)===-1&&t.push(e)}function r0(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class i0{constructor(){this.subscriptions=[]}add(e){return n0(this.subscriptions,e),()=>r0(this.subscriptions,e)}notify(e,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,r);else for(let s=0;s<i;s++){const o=this.subscriptions[s];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const d4=t=>!isNaN(parseFloat(t));class h4{constructor(e,n={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,i=!0)=>{this.prev=this.current,this.current=r;const{delta:s,timestamp:o}=on;this.lastUpdated!==o&&(this.timeDelta=s,this.lastUpdated=o,tt.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>tt.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=d4(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new i0);const r=this.events[e].add(n);return e==="change"?()=>{r(),tt.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=e,this.timeDelta=r}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?ub(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function La(t,e){return new h4(t,e)}const gb=t=>e=>e.test(t),f4={test:t=>t==="auto",parse:t=>t},yb=[ko,Te,Hr,zi,wP,xP,f4],_l=t=>yb.find(gb(t)),p4=[...yb,vn,_s],m4=t=>p4.find(gb(t));function g4(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,La(n))}function y4(t,e){const n=tf(t,e);let{transitionEnd:r={},transition:i={},...s}=n?t.makeTargetAnimatable(n,!1):{};s={...s,...r};for(const o in s){const a=jP(s[o]);g4(t,o,a)}}function v4(t,e,n){var r,i;const s=Object.keys(e).filter(a=>!t.hasValue(a)),o=s.length;if(o)for(let a=0;a<o;a++){const l=s[a],d=e[l];let h=null;Array.isArray(d)&&(h=d[0]),h===null&&(h=(i=(r=n[l])!==null&&r!==void 0?r:t.readValue(l))!==null&&i!==void 0?i:e[l]),h!=null&&(typeof h=="string"&&(mb(h)||pb(h))?h=parseFloat(h):!m4(h)&&_s.test(d)&&(h=fb(l,d)),t.addValue(l,La(h,{owner:t})),n[l]===void 0&&(n[l]=h),h!==null&&t.setBaseTarget(l,h))}}function x4(t,e){return e?(e[t]||e.default||e).from:void 0}function w4(t,e,n){const r={};for(const i in t){const s=x4(i,e);if(s!==void 0)r[i]=s;else{const o=n.getValue(i);o&&(r[i]=o.get())}}return r}function _4({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function T4(t,e){const n=t.get();if(Array.isArray(e)){for(let r=0;r<e.length;r++)if(e[r]!==n)return!0}else return n!==e}function vb(t,e,{delay:n=0,transitionOverride:r,type:i}={}){let{transition:s=t.getDefaultTransition(),transitionEnd:o,...a}=t.makeTargetAnimatable(e);const l=t.getValue("willChange");r&&(s=r);const d=[],h=i&&t.animationState&&t.animationState.getState()[i];for(const f in a){const p=t.getValue(f),g=a[f];if(!p||g===void 0||h&&_4(h,f))continue;const x={delay:n,elapsed:0,...e0(s||{},f)};if(window.HandoffAppearAnimations){const S=t.getProps()[xE];if(S){const v=window.HandoffAppearAnimations(S,f,p,tt);v!==null&&(x.elapsed=v,x.isHandoff=!0)}}let _=!x.isHandoff&&!T4(p,g);if(x.type==="spring"&&(p.getVelocity()||x.velocity)&&(_=!1),p.animation&&(_=!1),_)continue;p.start(t0(f,p,g,t.shouldReduceMotion&&Co.has(f)?{type:!1}:x));const k=p.animation;eh(l)&&(l.add(f),k.then(()=>l.remove(f))),d.push(k)}return o&&Promise.all(d).then(()=>{o&&y4(t,o)}),d}function Jm(t,e,n={}){const r=tf(t,e,n.custom);let{transition:i=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const s=r?()=>Promise.all(vb(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(l=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:f}=i;return S4(t,e,d+l,h,f,n)}:()=>Promise.resolve(),{when:a}=i;if(a){const[l,d]=a==="beforeChildren"?[s,o]:[o,s];return l().then(()=>d())}else return Promise.all([s(),o(n.delay)])}function S4(t,e,n=0,r=0,i=1,s){const o=[],a=(t.variantChildren.size-1)*r,l=i===1?(d=0)=>d*r:(d=0)=>a-d*r;return Array.from(t.variantChildren).sort(E4).forEach((d,h)=>{d.notify("AnimationStart",e),o.push(Jm(d,e,{...s,delay:n+l(h)}).then(()=>d.notify("AnimationComplete",e)))}),Promise.all(o)}function E4(t,e){return t.sortNodePosition(e)}function b4(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>Jm(t,s,n));r=Promise.all(i)}else if(typeof e=="string")r=Jm(t,e,n);else{const i=typeof e=="function"?tf(t,e,n.custom):e;r=Promise.all(vb(t,i,n))}return r.then(()=>t.notify("AnimationComplete",e))}const I4=[...Fy].reverse(),C4=Fy.length;function k4(t){return e=>Promise.all(e.map(({animation:n,options:r})=>b4(t,n,r)))}function A4(t){let e=k4(t);const n=P4();let r=!0;const i=(l,d)=>{const h=tf(t,d);if(h){const{transition:f,transitionEnd:p,...g}=h;l={...l,...g,...p}}return l};function s(l){e=l(t)}function o(l,d){const h=t.getProps(),f=t.getVariantContext(!0)||{},p=[],g=new Set;let x={},_=1/0;for(let S=0;S<C4;S++){const v=I4[S],w=n[v],j=h[v]!==void 0?h[v]:f[v],L=xc(j),V=v===d?w.isActive:null;V===!1&&(_=S);let E=j===f[v]&&j!==h[v]&&L;if(E&&r&&t.manuallyAnimateOnMount&&(E=!1),w.protectedKeys={...x},!w.isActive&&V===null||!j&&!w.prevProp||Xh(j)||typeof j=="boolean")continue;let I=R4(w.prevProp,j)||v===d&&w.isActive&&!E&&L||S>_&&L,A=!1;const P=Array.isArray(j)?j:[j];let N=P.reduce(i,{});V===!1&&(N={});const{prevResolvedValues:b={}}=w,H={...b,...N},he=re=>{I=!0,g.has(re)&&(A=!0,g.delete(re)),w.needsAnimating[re]=!0};for(const re in H){const se=N[re],U=b[re];if(x.hasOwnProperty(re))continue;let G=!1;Yd(se)&&Yd(U)?G=!zE(se,U):G=se!==U,G?se!==void 0?he(re):g.add(re):se!==void 0&&g.has(re)?he(re):w.protectedKeys[re]=!0}w.prevProp=j,w.prevResolvedValues=N,w.isActive&&(x={...x,...N}),r&&t.blockInitialAnimation&&(I=!1),I&&(!E||A)&&p.push(...P.map(re=>({animation:re,options:{type:v,...l}})))}if(g.size){const S={};g.forEach(v=>{const w=t.getBaseTarget(v);w!==void 0&&(S[v]=w)}),p.push({animation:S})}let k=!!p.length;return r&&(h.initial===!1||h.initial===h.animate)&&!t.manuallyAnimateOnMount&&(k=!1),r=!1,k?e(p):Promise.resolve()}function a(l,d,h){var f;if(n[l].isActive===d)return Promise.resolve();(f=t.variantChildren)===null||f===void 0||f.forEach(g=>{var x;return(x=g.animationState)===null||x===void 0?void 0:x.setActive(l,d)}),n[l].isActive=d;const p=o(h,l);for(const g in n)n[g].protectedKeys={};return p}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>n}}function R4(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!zE(e,t):!1}function zs(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function P4(){return{animate:zs(!0),whileInView:zs(),whileHover:zs(),whileTap:zs(),whileDrag:zs(),whileFocus:zs(),exit:zs()}}class N4 extends Ns{constructor(e){super(e),e.animationState||(e.animationState=A4(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),Xh(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let D4=0;class j4 extends Ns{constructor(){super(...arguments),this.id=D4++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const s=this.node.animationState.setActive("exit",!e,{custom:r??this.node.getProps().custom});n&&!e&&s.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const L4={animation:{Feature:N4},exit:{Feature:j4}},bx=(t,e)=>Math.abs(t-e);function M4(t,e){const n=bx(t.x,e.x),r=bx(t.y,e.y);return Math.sqrt(n**2+r**2)}class xb{constructor(e,n,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=Ap(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,g=M4(f.offset,{x:0,y:0})>=3;if(!p&&!g)return;const{point:x}=f,{timestamp:_}=on;this.history.push({...x,timestamp:_});const{onStart:k,onMove:S}=this.handlers;p||(k&&k(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),S&&S(this.lastMoveEvent,f)},this.handlePointerMove=(f,p)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=kp(p,this.transformPagePoint),tt.update(this.updatePoint,!0)},this.handlePointerUp=(f,p)=>{this.end();const{onEnd:g,onSessionEnd:x,resumeAnimation:_}=this.handlers;if(this.dragSnapToOrigin&&_&&_(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const k=Ap(f.type==="pointercancel"?this.lastMoveEventInfo:kp(p,this.transformPagePoint),this.history);this.startEvent&&g&&g(f,k),x&&x(f,k)},!ME(e))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=r,this.contextWindow=i||window;const o=ef(e),a=kp(o,this.transformPagePoint),{point:l}=a,{timestamp:d}=on;this.history=[{...l,timestamp:d}];const{onSessionStart:h}=n;h&&h(e,Ap(a,this.history)),this.removeListeners=hs(pi(this.contextWindow,"pointermove",this.handlePointerMove),pi(this.contextWindow,"pointerup",this.handlePointerUp),pi(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ti(this.updatePoint)}}function kp(t,e){return e?{point:e(t.point)}:t}function Ix(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Ap({point:t},e){return{point:t,delta:Ix(t,wb(e)),offset:Ix(t,V4(e)),velocity:O4(e,.1)}}function V4(t){return t[0]}function wb(t){return t[t.length-1]}function O4(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const i=wb(t);for(;n>=0&&(r=t[n],!(i.timestamp-r.timestamp>fs(e)));)n--;if(!r)return{x:0,y:0};const s=mi(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const o={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Bn(t){return t.max-t.min}function Zm(t,e=0,n=.01){return Math.abs(t-e)<=n}function Cx(t,e,n,r=.5){t.origin=r,t.originPoint=ft(e.min,e.max,t.origin),t.scale=Bn(n)/Bn(e),(Zm(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=ft(n.min,n.max,t.origin)-t.originPoint,(Zm(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Hl(t,e,n,r){Cx(t.x,e.x,n.x,r?r.originX:void 0),Cx(t.y,e.y,n.y,r?r.originY:void 0)}function kx(t,e,n){t.min=n.min+e.min,t.max=t.min+Bn(e)}function F4(t,e,n){kx(t.x,e.x,n.x),kx(t.y,e.y,n.y)}function Ax(t,e,n){t.min=e.min-n.min,t.max=t.min+Bn(e)}function Gl(t,e,n){Ax(t.x,e.x,n.x),Ax(t.y,e.y,n.y)}function U4(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?ft(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?ft(n,t,r.max):Math.min(t,n)),t}function Rx(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function z4(t,{top:e,left:n,bottom:r,right:i}){return{x:Rx(t.x,n,i),y:Rx(t.y,e,r)}}function Px(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function B4(t,e){return{x:Px(t.x,e.x),y:Px(t.y,e.y)}}function $4(t,e){let n=.5;const r=Bn(t),i=Bn(e);return i>r?n=_c(e.min,e.max-r,t.min):r>i&&(n=_c(t.min,t.max-i,e.min)),ws(0,1,n)}function W4(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const eg=.35;function q4(t=eg){return t===!1?t=0:t===!0&&(t=eg),{x:Nx(t,"left","right"),y:Nx(t,"top","bottom")}}function Nx(t,e,n){return{min:Dx(t,e),max:Dx(t,n)}}function Dx(t,e){return typeof t=="number"?t:t[e]||0}const jx=()=>({translate:0,scale:1,origin:0,originPoint:0}),la=()=>({x:jx(),y:jx()}),Lx=()=>({min:0,max:0}),kt=()=>({x:Lx(),y:Lx()});function Xn(t){return[t("x"),t("y")]}function _b({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function H4({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function G4(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function Rp(t){return t===void 0||t===1}function tg({scale:t,scaleX:e,scaleY:n}){return!Rp(t)||!Rp(e)||!Rp(n)}function qs(t){return tg(t)||Tb(t)||t.z||t.rotate||t.rotateX||t.rotateY}function Tb(t){return Mx(t.x)||Mx(t.y)}function Mx(t){return t&&t!=="0%"}function th(t,e,n){const r=t-n,i=e*r;return n+i}function Vx(t,e,n,r,i){return i!==void 0&&(t=th(t,i,r)),th(t,n,r)+e}function ng(t,e=0,n=1,r,i){t.min=Vx(t.min,e,n,r,i),t.max=Vx(t.max,e,n,r,i)}function Sb(t,{x:e,y:n}){ng(t.x,e.translate,e.scale,e.originPoint),ng(t.y,n.translate,n.scale,n.originPoint)}function K4(t,e,n,r=!1){const i=n.length;if(!i)return;e.x=e.y=1;let s,o;for(let a=0;a<i;a++){s=n[a],o=s.projectionDelta;const l=s.instance;l&&l.style&&l.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&ca(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Sb(t,o)),r&&qs(s.latestValues)&&ca(t,s.latestValues))}e.x=Ox(e.x),e.y=Ox(e.y)}function Ox(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function qi(t,e){t.min=t.min+e,t.max=t.max+e}function Fx(t,e,[n,r,i]){const s=e[i]!==void 0?e[i]:.5,o=ft(t.min,t.max,s);ng(t,e[n],e[r],o,e.scale)}const Q4=["x","scaleX","originX"],Y4=["y","scaleY","originY"];function ca(t,e){Fx(t.x,e,Q4),Fx(t.y,e,Y4)}function Eb(t,e){return _b(G4(t.getBoundingClientRect(),e))}function X4(t,e,n){const r=Eb(t,n),{scroll:i}=e;return i&&(qi(r.x,i.offset.x),qi(r.y,i.offset.y)),r}const bb=({current:t})=>t?t.ownerDocument.defaultView:null,J4=new WeakMap;class Z4{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=kt(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(ef(h,"page").point)},s=(h,f)=>{const{drag:p,dragPropagation:g,onDragStart:x}=this.getProps();if(p&&!g&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=OE(p),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Xn(k=>{let S=this.getAxisMotionValue(k).get()||0;if(Hr.test(S)){const{projection:v}=this.visualElement;if(v&&v.layout){const w=v.layout.layoutBox[k];w&&(S=Bn(w)*(parseFloat(S)/100))}}this.originPoint[k]=S}),x&&tt.update(()=>x(h,f),!1,!0);const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},o=(h,f)=>{const{dragPropagation:p,dragDirectionLock:g,onDirectionLock:x,onDrag:_}=this.getProps();if(!p&&!this.openGlobalLock)return;const{offset:k}=f;if(g&&this.currentDirection===null){this.currentDirection=eN(k),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",f.point,k),this.updateAxis("y",f.point,k),this.visualElement.render(),_&&_(h,f)},a=(h,f)=>this.stop(h,f),l=()=>Xn(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new xb(e,{onSessionStart:i,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:bb(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&tt.update(()=>s(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:i}=this.getProps();if(!r||!Fu(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=U4(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;n&&oa(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&i?this.constraints=z4(i.layoutBox,n):this.constraints=!1,this.elastic=q4(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Xn(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=W4(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!oa(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=X4(r,i.root,this.visualElement.getTransformPagePoint());let o=B4(i.layout.layoutBox,s);if(n){const a=n(H4(o));this.hasMutatedConstraints=!!a,a&&(o=_b(a))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},d=Xn(h=>{if(!Fu(h,n,this.currentDirection))return;let f=l&&l[h]||{};o&&(f={min:0,max:0});const p=i?200:1e6,g=i?40:1e7,x={type:"inertia",velocity:r?e[h]:0,bounceStiffness:p,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...s,...f};return this.startAxisValueAnimation(h,x)});return Promise.all(d).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return r.start(t0(e,r,0,n))}stopAnimation(){Xn(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Xn(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Xn(n=>{const{drag:r}=this.getProps();if(!Fu(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:a}=i.layout.layoutBox[n];s.set(e[n]-ft(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!oa(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Xn(o=>{const a=this.getAxisMotionValue(o);if(a){const l=a.get();i[o]=$4({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Xn(o=>{if(!Fu(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:d}=this.constraints[o];a.set(ft(l,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;J4.set(this.visualElement,this);const e=this.visualElement.current,n=pi(e,"pointerdown",l=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();oa(l)&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),r();const o=ui(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:d})=>{this.isDragging&&d&&(Xn(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=l[h].translate,f.set(f.get()+l[h].translate))}),this.visualElement.render())});return()=>{o(),n(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:o=eg,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function Fu(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function eN(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class tN extends Ns{constructor(e){super(e),this.removeGroupControls=xt,this.removeListeners=xt,this.controls=new Z4(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||xt}unmount(){this.removeGroupControls(),this.removeListeners()}}const Ux=t=>(e,n)=>{t&&tt.update(()=>t(e,n))};class nN extends Ns{constructor(){super(...arguments),this.removePointerDownListener=xt}onPointerDown(e){this.session=new xb(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:bb(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:Ux(e),onStart:Ux(n),onMove:r,onEnd:(s,o)=>{delete this.session,i&&tt.update(()=>i(s,o))}}}mount(){this.removePointerDownListener=pi(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function rN(){const t=R.useContext(Qh);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:r}=t,i=R.useId();return R.useEffect(()=>r(i),[]),!e&&n?[!1,()=>n&&n(i)]:[!0]}const ud={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function zx(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Tl={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Te.test(t))t=parseFloat(t);else return t;const n=zx(t,e.target.x),r=zx(t,e.target.y);return`${n}% ${r}%`}},iN={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,i=_s.parse(t);if(i.length>5)return r;const s=_s.createTransformer(t),o=typeof i[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;i[0+o]/=a,i[1+o]/=l;const d=ft(a,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),s(i)}};class sN extends Ir.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;hP(oN),s&&(n.group&&n.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),ud.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:i,isPresent:s}=this.props,o=r.projection;return o&&(o.isPresent=s,i||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||tt.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Ib(t){const[e,n]=rN(),r=R.useContext(zy);return Ir.createElement(sN,{...t,layoutGroup:r,switchLayoutGroup:R.useContext(_E),isPresent:e,safeToRemove:n})}const oN={borderRadius:{...Tl,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Tl,borderTopRightRadius:Tl,borderBottomLeftRadius:Tl,borderBottomRightRadius:Tl,boxShadow:iN},Cb=["TopLeft","TopRight","BottomLeft","BottomRight"],aN=Cb.length,Bx=t=>typeof t=="string"?parseFloat(t):t,$x=t=>typeof t=="number"||Te.test(t);function lN(t,e,n,r,i,s){i?(t.opacity=ft(0,n.opacity!==void 0?n.opacity:1,cN(r)),t.opacityExit=ft(e.opacity!==void 0?e.opacity:1,0,uN(r))):s&&(t.opacity=ft(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<aN;o++){const a=`border${Cb[o]}Radius`;let l=Wx(e,a),d=Wx(n,a);if(l===void 0&&d===void 0)continue;l||(l=0),d||(d=0),l===0||d===0||$x(l)===$x(d)?(t[a]=Math.max(ft(Bx(l),Bx(d),r),0),(Hr.test(d)||Hr.test(l))&&(t[a]+="%")):t[a]=d}(e.rotate||n.rotate)&&(t.rotate=ft(e.rotate||0,n.rotate||0,r))}function Wx(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const cN=kb(0,.5,YE),uN=kb(.5,.95,xt);function kb(t,e,n){return r=>r<t?0:r>e?1:n(_c(t,e,r))}function qx(t,e){t.min=e.min,t.max=e.max}function Kn(t,e){qx(t.x,e.x),qx(t.y,e.y)}function Hx(t,e,n,r,i){return t-=e,t=th(t,1/n,r),i!==void 0&&(t=th(t,1/i,r)),t}function dN(t,e=0,n=1,r=.5,i,s=t,o=t){if(Hr.test(e)&&(e=parseFloat(e),e=ft(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=ft(s.min,s.max,r);t===s&&(a-=e),t.min=Hx(t.min,e,n,a,i),t.max=Hx(t.max,e,n,a,i)}function Gx(t,e,[n,r,i],s,o){dN(t,e[n],e[r],e[i],e.scale,s,o)}const hN=["x","scaleX","originX"],fN=["y","scaleY","originY"];function Kx(t,e,n,r){Gx(t.x,e,hN,n?n.x:void 0,r?r.x:void 0),Gx(t.y,e,fN,n?n.y:void 0,r?r.y:void 0)}function Qx(t){return t.translate===0&&t.scale===1}function Ab(t){return Qx(t.x)&&Qx(t.y)}function pN(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function Rb(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function Yx(t){return Bn(t.x)/Bn(t.y)}class mN{constructor(){this.members=[]}add(e){n0(this.members,e),e.scheduleRender()}remove(e){if(r0(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Xx(t,e,n){let r="";const i=t.x.translate/e.x,s=t.y.translate/e.y;if((i||s)&&(r=`translate3d(${i}px, ${s}px, 0) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:l,rotateX:d,rotateY:h}=n;l&&(r+=`rotate(${l}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `)}const o=t.x.scale*e.x,a=t.y.scale*e.y;return(o!==1||a!==1)&&(r+=`scale(${o}, ${a})`),r||"none"}const gN=(t,e)=>t.depth-e.depth;class yN{constructor(){this.children=[],this.isDirty=!1}add(e){n0(this.children,e),this.isDirty=!0}remove(e){r0(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(gN),this.isDirty=!1,this.children.forEach(e)}}function vN(t,e){const n=performance.now(),r=({timestamp:i})=>{const s=i-n;s>=e&&(Ti(r),t(s-e))};return tt.read(r,!0),()=>Ti(r)}function xN(t){window.MotionDebug&&window.MotionDebug.record(t)}function wN(t){return t instanceof SVGElement&&t.tagName!=="svg"}function _N(t,e,n){const r=Nn(t)?t:La(t);return r.start(t0("",r,e,n)),r.animation}const Jx=["","X","Y","Z"],TN={visibility:"hidden"},Zx=1e3;let SN=0;const Hs={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Pb({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},a=e==null?void 0:e()){this.id=SN++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Hs.totalNodes=Hs.resolvedTargetDeltas=Hs.recalculatedProjection=0,this.nodes.forEach(IN),this.nodes.forEach(PN),this.nodes.forEach(NN),this.nodes.forEach(CN),xN(Hs)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new yN)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new i0),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=wN(o),this.instance=o;const{layoutId:l,layout:d,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(d||l)&&(this.isLayoutDirty=!0),t){let f;const p=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=vN(p,250),ud.hasAnimatedSinceResize&&(ud.hasAnimatedSinceResize=!1,this.nodes.forEach(tw))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||d)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:p,hasRelativeTargetChanged:g,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||h.getDefaultTransition()||VN,{onLayoutAnimationStart:k,onLayoutAnimationComplete:S}=h.getProps(),v=!this.targetLayout||!Rb(this.targetLayout,x)||g,w=!p&&g;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||p&&(v||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,w);const j={...e0(_,"layout"),onPlay:k,onComplete:S};(h.shouldReduceMotion||this.options.layoutRoot)&&(j.delay=0,j.type=!1),this.startAnimation(j)}else p||tw(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ti(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(DN),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(ew);return}this.isUpdating||this.nodes.forEach(AN),this.isUpdating=!1,this.nodes.forEach(RN),this.nodes.forEach(EN),this.nodes.forEach(bN),this.clearAllSnapshots();const a=performance.now();on.delta=ws(0,1e3/60,a-on.timestamp),on.timestamp=a,on.isProcessing=!0,wp.update.process(on),wp.preRender.process(on),wp.render.process(on),on.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(kN),this.sharedNodes.forEach(jN)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,tt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){tt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=kt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform,a=this.projectionDelta&&!Ab(this.projectionDelta),l=this.getTransformTemplate(),d=l?l(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&(a||qs(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),ON(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return kt();const a=o.measureViewportBox(),{scroll:l}=this.root;return l&&(qi(a.x,l.offset.x),qi(a.y,l.offset.y)),a}removeElementScroll(o){const a=kt();Kn(a,o);for(let l=0;l<this.path.length;l++){const d=this.path[l],{scroll:h,options:f}=d;if(d!==this.root&&h&&f.layoutScroll){if(h.isRoot){Kn(a,o);const{scroll:p}=this.root;p&&(qi(a.x,-p.offset.x),qi(a.y,-p.offset.y))}qi(a.x,h.offset.x),qi(a.y,h.offset.y)}}return a}applyTransform(o,a=!1){const l=kt();Kn(l,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&ca(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),qs(h.latestValues)&&ca(l,h.latestValues)}return qs(this.latestValues)&&ca(l,this.latestValues),l}removeTransform(o){const a=kt();Kn(a,o);for(let l=0;l<this.path.length;l++){const d=this.path[l];if(!d.instance||!qs(d.latestValues))continue;tg(d.latestValues)&&d.updateSnapshot();const h=kt(),f=d.measurePageBox();Kn(h,f),Kx(a,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return qs(this.latestValues)&&Kx(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==on.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==l;if(!(o||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:p}=this.options;if(!(!this.layout||!(f||p))){if(this.resolvedRelativeTargetAt=on.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=kt(),this.relativeTargetOrigin=kt(),Gl(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),Kn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=kt(),this.targetWithTransforms=kt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),F4(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Kn(this.target,this.layout.layoutBox),Sb(this.target,this.targetDelta)):Kn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=kt(),this.relativeTargetOrigin=kt(),Gl(this.relativeTargetOrigin,this.target,g.target),Kn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Hs.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||tg(this.parent.latestValues)||Tb(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let d=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(d=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===on.timestamp&&(d=!1),d)return;const{layout:h,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||f))return;Kn(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,g=this.treeScale.y;K4(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox);const{target:x}=a;if(!x){this.projectionTransform&&(this.projectionDelta=la(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=la(),this.projectionDeltaWithTransform=la());const _=this.projectionTransform;Hl(this.projectionDelta,this.layoutCorrected,x,this.latestValues),this.projectionTransform=Xx(this.projectionDelta,this.treeScale),(this.projectionTransform!==_||this.treeScale.x!==p||this.treeScale.y!==g)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x)),Hs.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,a=!1){const l=this.snapshot,d=l?l.latestValues:{},h={...this.latestValues},f=la();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const p=kt(),g=l?l.source:void 0,x=this.layout?this.layout.source:void 0,_=g!==x,k=this.getStack(),S=!k||k.members.length<=1,v=!!(_&&!S&&this.options.crossfade===!0&&!this.path.some(MN));this.animationProgress=0;let w;this.mixTargetDelta=j=>{const L=j/1e3;nw(f.x,o.x,L),nw(f.y,o.y,L),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Gl(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),LN(this.relativeTarget,this.relativeTargetOrigin,p,L),w&&pN(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=kt()),Kn(w,this.relativeTarget)),_&&(this.animationValues=h,lN(h,d,this.latestValues,L,v,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=L},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ti(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=tt.update(()=>{ud.hasAnimatedSinceResize=!0,this.currentAnimation=_N(0,Zx,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Zx),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:d,latestValues:h}=o;if(!(!a||!l||!d)){if(this!==o&&this.layout&&d&&Nb(this.options.animationType,this.layout.layoutBox,d.layoutBox)){l=this.target||kt();const f=Bn(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+f;const p=Bn(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+p}Kn(a,l),ca(a,h),Hl(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new mN),this.sharedNodes.get(o).add(a);const d=a.options.initialPromotionConfig;a.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const d=this.getStack();d&&d.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(a=!0),!a)return;const d={};for(let h=0;h<Jx.length;h++){const f="rotate"+Jx[h];l[f]&&(d[f]=l[f],o.setStaticValue(f,0))}o.render();for(const h in d)o.setStaticValue(h,d[h]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return TN;const d={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=cd(o==null?void 0:o.pointerEvents)||"",d.transform=h?h(this.latestValues,""):"none",d;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const _={};return this.options.layoutId&&(_.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,_.pointerEvents=cd(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!qs(this.latestValues)&&(_.transform=h?h({},""):"none",this.hasProjected=!1),_}const p=f.animationValues||f.latestValues;this.applyTransformsToTarget(),d.transform=Xx(this.projectionDeltaWithTransform,this.treeScale,p),h&&(d.transform=h(p,d.transform));const{x:g,y:x}=this.projectionDelta;d.transformOrigin=`${g.origin*100}% ${x.origin*100}% 0`,f.animationValues?d.opacity=f===this?(l=(a=p.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:d.opacity=f===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const _ in Kd){if(p[_]===void 0)continue;const{correct:k,applyTo:S}=Kd[_],v=d.transform==="none"?p[_]:k(p[_],f);if(S){const w=S.length;for(let j=0;j<w;j++)d[S[j]]=v}else d[_]=v}return this.options.layoutId&&(d.pointerEvents=f===this?cd(o==null?void 0:o.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(ew),this.root.sharedNodes.clear()}}}function EN(t){t.updateLayout()}function bN(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=t.layout,{animationType:s}=t.options,o=n.source!==t.layout.source;s==="size"?Xn(f=>{const p=o?n.measuredBox[f]:n.layoutBox[f],g=Bn(p);p.min=r[f].min,p.max=p.min+g}):Nb(s,n.layoutBox,r)&&Xn(f=>{const p=o?n.measuredBox[f]:n.layoutBox[f],g=Bn(r[f]);p.max=p.min+g,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+g)});const a=la();Hl(a,r,n.layoutBox);const l=la();o?Hl(l,t.applyTransform(i,!0),n.measuredBox):Hl(l,r,n.layoutBox);const d=!Ab(a);let h=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:p,layout:g}=f;if(p&&g){const x=kt();Gl(x,n.layoutBox,p.layoutBox);const _=kt();Gl(_,r,g.layoutBox),Rb(x,_)||(h=!0),f.options.layoutRoot&&(t.relativeTarget=_,t.relativeTargetOrigin=x,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:d,hasRelativeTargetChanged:h})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function IN(t){Hs.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function CN(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function kN(t){t.clearSnapshot()}function ew(t){t.clearMeasurements()}function AN(t){t.isLayoutDirty=!1}function RN(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function tw(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function PN(t){t.resolveTargetDelta()}function NN(t){t.calcProjection()}function DN(t){t.resetRotation()}function jN(t){t.removeLeadSnapshot()}function nw(t,e,n){t.translate=ft(e.translate,0,n),t.scale=ft(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function rw(t,e,n,r){t.min=ft(e.min,n.min,r),t.max=ft(e.max,n.max,r)}function LN(t,e,n,r){rw(t.x,e.x,n.x,r),rw(t.y,e.y,n.y,r)}function MN(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const VN={duration:.45,ease:[.4,0,.1,1]},iw=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),sw=iw("applewebkit/")&&!iw("chrome/")?Math.round:xt;function ow(t){t.min=sw(t.min),t.max=sw(t.max)}function ON(t){ow(t.x),ow(t.y)}function Nb(t,e,n){return t==="position"||t==="preserve-aspect"&&!Zm(Yx(e),Yx(n),.2)}const FN=Pb({attachResizeListener:(t,e)=>ui(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Pp={current:void 0},Db=Pb({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Pp.current){const t=new FN({});t.mount(window),t.setOptions({layoutScroll:!0}),Pp.current=t}return Pp.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),UN={pan:{Feature:nN},drag:{Feature:tN,ProjectionNode:Db,MeasureLayout:Ib}},zN=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function BN(t){const e=zN.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]}function rg(t,e,n=1){const[r,i]=BN(t);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const o=s.trim();return mb(o)?parseFloat(o):o}else return Hm(i)?rg(i,e,n+1):i}function $N(t,{...e},n){const r=t.current;if(!(r instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(i=>{const s=i.get();if(!Hm(s))return;const o=rg(s,r);o&&i.set(o)});for(const i in e){const s=e[i];if(!Hm(s))continue;const o=rg(s,r);o&&(e[i]=o,n||(n={}),n[i]===void 0&&(n[i]=s))}return{target:e,transitionEnd:n}}const WN=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),jb=t=>WN.has(t),qN=t=>Object.keys(t).some(jb),aw=t=>t===ko||t===Te,lw=(t,e)=>parseFloat(t.split(", ")[e]),cw=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/);if(i)return lw(i[1],e);{const s=r.match(/^matrix\((.+)\)$/);return s?lw(s[1],t):0}},HN=new Set(["x","y","z"]),GN=$c.filter(t=>!HN.has(t));function KN(t){const e=[];return GN.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const Ma={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:cw(4,13),y:cw(5,14)};Ma.translateX=Ma.x;Ma.translateY=Ma.y;const QN=(t,e,n)=>{const r=e.measureViewportBox(),i=e.current,s=getComputedStyle(i),{display:o}=s,a={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(d=>{a[d]=Ma[d](r,s)}),e.render();const l=e.measureViewportBox();return n.forEach(d=>{const h=e.getValue(d);h&&h.jump(a[d]),t[d]=Ma[d](l,s)}),t},YN=(t,e,n={},r={})=>{e={...e},r={...r};const i=Object.keys(e).filter(jb);let s=[],o=!1;const a=[];if(i.forEach(l=>{const d=t.getValue(l);if(!t.hasValue(l))return;let h=n[l],f=_l(h);const p=e[l];let g;if(Yd(p)){const x=p.length,_=p[0]===null?1:0;h=p[_],f=_l(h);for(let k=_;k<x&&p[k]!==null;k++)g?Qy(_l(p[k])===g):g=_l(p[k])}else g=_l(p);if(f!==g)if(aw(f)&&aw(g)){const x=d.get();typeof x=="string"&&d.set(parseFloat(x)),typeof p=="string"?e[l]=parseFloat(p):Array.isArray(p)&&g===Te&&(e[l]=p.map(parseFloat))}else f!=null&&f.transform&&(g!=null&&g.transform)&&(h===0||p===0)?h===0?d.set(g.transform(h)):e[l]=f.transform(p):(o||(s=KN(t),o=!0),a.push(l),r[l]=r[l]!==void 0?r[l]:e[l],d.jump(p))}),a.length){const l=a.indexOf("height")>=0?window.pageYOffset:null,d=QN(e,t,a);return s.length&&s.forEach(([h,f])=>{t.getValue(h).set(f)}),t.render(),Yh&&l!==null&&window.scrollTo({top:l}),{target:d,transitionEnd:r}}else return{target:e,transitionEnd:r}};function XN(t,e,n,r){return qN(e)?YN(t,e,n,r):{target:e,transitionEnd:r}}const JN=(t,e,n,r)=>{const i=$N(t,e,r);return e=i.target,r=i.transitionEnd,XN(t,e,n,r)},ig={current:null},Lb={current:!1};function ZN(){if(Lb.current=!0,!!Yh)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>ig.current=t.matches;t.addListener(e),e()}else ig.current=!1}function eD(t,e,n){const{willChange:r}=e;for(const i in e){const s=e[i],o=n[i];if(Nn(s))t.addValue(i,s),eh(r)&&r.add(i);else if(Nn(o))t.addValue(i,La(s,{owner:t})),eh(r)&&r.remove(i);else if(o!==s)if(t.hasValue(i)){const a=t.getValue(i);!a.hasAnimated&&a.set(s)}else{const a=t.getStaticValue(i);t.addValue(i,La(a!==void 0?a:s,{owner:t}))}}for(const i in n)e[i]===void 0&&t.removeValue(i);return e}const uw=new WeakMap,Mb=Object.keys(wc),tD=Mb.length,dw=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],nD=Uy.length;class rD{constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:i,visualState:s},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>tt.render(this.render,!1,!0);const{latestValues:a,renderState:l}=s;this.latestValues=a,this.baseTarget={...a},this.initialValues=n.initial?{...a}:{},this.renderState=l,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.isControllingVariants=Jh(n),this.isVariantNode=wE(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(n,{});for(const f in h){const p=h[f];a[f]!==void 0&&Nn(p)&&(p.set(a[f],!1),eh(d)&&d.add(f))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,uw.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),Lb.current||ZN(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:ig.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){uw.delete(this.current),this.projection&&this.projection.unmount(),Ti(this.notifyUpdate),Ti(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const r=Co.has(e),i=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&tt.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{i(),s()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},r,i,s){let o,a;for(let l=0;l<tD;l++){const d=Mb[l],{isEnabled:h,Feature:f,ProjectionNode:p,MeasureLayout:g}=wc[d];p&&(o=p),h(n)&&(!this.features[d]&&f&&(this.features[d]=new f(this)),g&&(a=g))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:d,drag:h,dragConstraints:f,layoutScroll:p,layoutRoot:g}=n;this.projection.setOptions({layoutId:l,layout:d,alwaysMeasureLayout:!!h||f&&oa(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof d=="string"?d:"both",initialPromotionConfig:s,layoutScroll:p,layoutRoot:g})}return a}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):kt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<dw.length;r++){const i=dw[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s=e["on"+i];s&&(this.propEventSubscriptions[i]=this.on(i,s))}this.prevMotionValues=eD(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<nD;r++){const i=Uy[r],s=this.props[i];(xc(s)||s===!1)&&(n[i]=s)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=La(n,{owner:this}),this.addValue(e,r)),r}readValue(e){var n;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props,i=typeof r=="string"||typeof r=="object"?(n=Ky(this.props,r))===null||n===void 0?void 0:n[e]:void 0;if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Nn(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new i0),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class Vb extends rD{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...r},{transformValues:i},s){let o=w4(r,e||{},this);if(i&&(n&&(n=i(n)),r&&(r=i(r)),o&&(o=i(o))),s){v4(this,r,o);const a=JN(this,r,o,n);n=a.transitionEnd,r=a.target}return{transition:e,transitionEnd:n,...r}}}function iD(t){return window.getComputedStyle(t)}class sD extends Vb{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(Co.has(n)){const r=Zy(n);return r&&r.default||0}else{const r=iD(e),i=(EE(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return Eb(e,n)}build(e,n,r,i){$y(e,n,r,i.transformTemplate)}scrapeMotionValuesFromProps(e,n){return Gy(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Nn(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,r,i){RE(e,n,r,i)}}class oD extends Vb{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Co.has(n)){const r=Zy(n);return r&&r.default||0}return n=PE.has(n)?n:Oy(n),e.getAttribute(n)}measureInstanceViewportBox(){return kt()}scrapeMotionValuesFromProps(e,n){return DE(e,n)}build(e,n,r,i){qy(e,n,r,this.isSVGTag,i.transformTemplate)}renderInstance(e,n,r,i){NE(e,n,r,i)}mount(e){this.isSVGTag=Hy(e.tagName),super.mount(e)}}const aD=(t,e)=>By(t)?new oD(e,{enableHardwareAcceleration:!1}):new sD(e,{enableHardwareAcceleration:!0}),lD={layout:{ProjectionNode:Db,MeasureLayout:Ib}},cD={...L4,...t5,...UN,...lD},Ue=uP((t,e)=>BP(t,e,cD,aD));function Ob(){const t=R.useRef(!1);return Vy(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function uD(){const t=Ob(),[e,n]=R.useState(0),r=R.useCallback(()=>{t.current&&n(e+1)},[e]);return[R.useCallback(()=>tt.postRender(r),[r]),e]}class dD extends R.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function hD({children:t,isPresent:e}){const n=R.useId(),r=R.useRef(null),i=R.useRef({width:0,height:0,top:0,left:0});return R.useInsertionEffect(()=>{const{width:s,height:o,top:a,left:l}=i.current;if(e||!r.current||!s||!o)return;r.current.dataset.motionPopId=n;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${s}px !important;
            height: ${o}px !important;
            top: ${a}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[e]),R.createElement(dD,{isPresent:e,childRef:r,sizeRef:i},R.cloneElement(t,{ref:r}))}const Np=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:o})=>{const a=jE(fD),l=R.useId(),d=R.useMemo(()=>({id:l,initial:e,isPresent:n,custom:i,onExitComplete:h=>{a.set(h,!0);for(const f of a.values())if(!f)return;r&&r()},register:h=>(a.set(h,!1),()=>a.delete(h))}),s?void 0:[n]);return R.useMemo(()=>{a.forEach((h,f)=>a.set(f,!1))},[n]),R.useEffect(()=>{!n&&!a.size&&r&&r()},[n]),o==="popLayout"&&(t=R.createElement(hD,{isPresent:n},t)),R.createElement(Qh.Provider,{value:d},t)};function fD(){return new Map}function pD(t){return R.useEffect(()=>()=>t(),[])}const Gs=t=>t.key||"";function mD(t,e){t.forEach(n=>{const r=Gs(n);e.set(r,n)})}function gD(t){const e=[];return R.Children.forEach(t,n=>{R.isValidElement(n)&&e.push(n)}),e}const Cn=({children:t,custom:e,initial:n=!0,onExitComplete:r,exitBeforeEnter:i,presenceAffectsLayout:s=!0,mode:o="sync"})=>{const a=R.useContext(zy).forceRender||uD()[0],l=Ob(),d=gD(t);let h=d;const f=R.useRef(new Map).current,p=R.useRef(h),g=R.useRef(new Map).current,x=R.useRef(!0);if(Vy(()=>{x.current=!1,mD(d,g),p.current=h}),pD(()=>{x.current=!0,g.clear(),f.clear()}),x.current)return R.createElement(R.Fragment,null,h.map(v=>R.createElement(Np,{key:Gs(v),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:s,mode:o},v)));h=[...h];const _=p.current.map(Gs),k=d.map(Gs),S=_.length;for(let v=0;v<S;v++){const w=_[v];k.indexOf(w)===-1&&!f.has(w)&&f.set(w,void 0)}return o==="wait"&&f.size&&(h=[]),f.forEach((v,w)=>{if(k.indexOf(w)!==-1)return;const j=g.get(w);if(!j)return;const L=_.indexOf(w);let V=v;if(!V){const E=()=>{f.delete(w);const T=Array.from(g.keys()).filter(I=>!k.includes(I));if(T.forEach(I=>g.delete(I)),p.current=d.filter(I=>{const A=Gs(I);return A===w||T.includes(A)}),!f.size){if(l.current===!1)return;a(),r&&r()}};V=R.createElement(Np,{key:Gs(j),isPresent:!1,onExitComplete:E,custom:e,presenceAffectsLayout:s,mode:o},j),f.set(w,V)}h.splice(L,0,V)}),h=h.map(v=>{const w=v.key;return f.has(w)?v:R.createElement(Np,{key:Gs(v),isPresent:!0,presenceAffectsLayout:s,mode:o},v)}),R.createElement(R.Fragment,null,f.size?h:h.map(v=>R.cloneElement(v)))},yD=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},vD=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Ub={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,d=l?t[i+2]:0,h=s>>2,f=(s&3)<<4|a>>4;let p=(a&15)<<2|d>>6,g=d&63;l||(g=64,o||(p=64)),r.push(n[h],n[f],n[p],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Fb(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):vD(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||d==null||f==null)throw new xD;const p=s<<2|a>>4;if(r.push(p),d!==64){const g=a<<4&240|d>>2;if(r.push(g),f!==64){const x=d<<6&192|f;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class xD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wD=function(t){const e=Fb(t);return Ub.encodeByteArray(e,!0)},nh=function(t){return wD(t).replace(/\./g,"")},zb=function(t){try{return Ub.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD=()=>_D().__FIREBASE_DEFAULTS__,SD=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ED=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&zb(t[1]);return e&&JSON.parse(e)},nf=()=>{try{return yD()||TD()||SD()||ED()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Bb=t=>{var e,n;return(n=(e=nf())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},s0=t=>{const e=Bb(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},$b=()=>{var t;return(t=nf())==null?void 0:t.config},Wb=t=>{var e;return(e=nf())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function rf(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t},a="";return[nh(JSON.stringify(n)),nh(JSON.stringify(o)),a].join(".")}const Kl={};function ID(){const t={prod:[],emulator:[]};for(const e of Object.keys(Kl))Kl[e]?t.emulator.push(e):t.prod.push(e);return t}function CD(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let hw=!1;function sf(t,e){if(typeof window>"u"||typeof document>"u"||!ei(window.location.host)||Kl[t]===e||Kl[t]||hw)return;Kl[t]=e;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=ID().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function d(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{hw=!0,o()},p}function h(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function f(){const p=CD(r),g=n("text"),x=document.getElementById(g)||document.createElement("span"),_=n("learnmore"),k=document.getElementById(_)||document.createElement("a"),S=n("preprendIcon"),v=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const w=p.element;a(w),h(k,_);const j=d();l(v,S),w.append(v,x,k,j),document.body.appendChild(w)}s?(x.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dn())}function AD(){var e;const t=(e=nf())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function RD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PD(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function ND(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function DD(){const t=dn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function jD(){return!AD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function LD(){try{return typeof indexedDB=="object"}catch{return!1}}function MD(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD="FirebaseError";class Ar extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=VD,Object.setPrototypeOf(this,Ar.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gc.prototype.create)}}class Gc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?OD(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Ar(i,a,r)}}function OD(t,e){return t.replace(FD,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const FD=/\{\$([^}]+)}/g;function UD(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function vo(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(fw(s)&&fw(o)){if(!vo(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function fw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function zD(t,e){const n=new BD(t,e);return n.subscribe.bind(n)}class BD{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");$D(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Dp),i.error===void 0&&(i.error=Dp),i.complete===void 0&&(i.complete=Dp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $D(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Dp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(t){return t&&t._delegate?t._delegate:t}class Si{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new bD;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HD(e))try{this.getOrInitializeService({instanceIdentifier:Ks})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ks){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ks){return this.instances.has(e)}getOptions(e=Ks){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:qD(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ks){return this.component?this.component.multipleInstances?e:Ks:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qD(t){return t===Ks?void 0:t}function HD(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new WD(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Me;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Me||(Me={}));const KD={debug:Me.DEBUG,verbose:Me.VERBOSE,info:Me.INFO,warn:Me.WARN,error:Me.ERROR,silent:Me.SILENT},QD=Me.INFO,YD={[Me.DEBUG]:"log",[Me.VERBOSE]:"log",[Me.INFO]:"info",[Me.WARN]:"warn",[Me.ERROR]:"error"},XD=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=YD[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class o0{constructor(e){this.name=e,this._logLevel=QD,this._logHandler=XD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Me))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?KD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Me.DEBUG,...e),this._logHandler(this,Me.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Me.VERBOSE,...e),this._logHandler(this,Me.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Me.INFO,...e),this._logHandler(this,Me.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Me.WARN,...e),this._logHandler(this,Me.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Me.ERROR,...e),this._logHandler(this,Me.ERROR,...e)}}const JD=(t,e)=>e.some(n=>t instanceof n);let pw,mw;function ZD(){return pw||(pw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ej(){return mw||(mw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hb=new WeakMap,sg=new WeakMap,Gb=new WeakMap,jp=new WeakMap,a0=new WeakMap;function tj(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(ps(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Hb.set(n,t)}).catch(()=>{}),a0.set(e,t),e}function nj(t){if(sg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});sg.set(t,e)}let og={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return sg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Gb.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ps(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function rj(t){og=t(og)}function ij(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Lp(this),e,...n);return Gb.set(r,e.sort?e.sort():[e]),ps(r)}:ej().includes(t)?function(...e){return t.apply(Lp(this),e),ps(Hb.get(this))}:function(...e){return ps(t.apply(Lp(this),e))}}function sj(t){return typeof t=="function"?ij(t):(t instanceof IDBTransaction&&nj(t),JD(t,ZD())?new Proxy(t,og):t)}function ps(t){if(t instanceof IDBRequest)return tj(t);if(jp.has(t))return jp.get(t);const e=sj(t);return e!==t&&(jp.set(t,e),a0.set(e,t)),e}const Lp=t=>a0.get(t);function oj(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=ps(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ps(o.result),l.oldVersion,l.newVersion,ps(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const aj=["get","getKey","getAll","getAllKeys","count"],lj=["put","add","delete","clear"],Mp=new Map;function gw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Mp.get(e))return Mp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=lj.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||aj.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),i&&l.done]))[0]};return Mp.set(e,s),s}rj(t=>({...t,get:(e,n,r)=>gw(e,n)||t.get(e,n,r),has:(e,n)=>!!gw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(uj(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function uj(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ag="@firebase/app",yw="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei=new o0("@firebase/app"),dj="@firebase/app-compat",hj="@firebase/analytics-compat",fj="@firebase/analytics",pj="@firebase/app-check-compat",mj="@firebase/app-check",gj="@firebase/auth",yj="@firebase/auth-compat",vj="@firebase/database",xj="@firebase/data-connect",wj="@firebase/database-compat",_j="@firebase/functions",Tj="@firebase/functions-compat",Sj="@firebase/installations",Ej="@firebase/installations-compat",bj="@firebase/messaging",Ij="@firebase/messaging-compat",Cj="@firebase/performance",kj="@firebase/performance-compat",Aj="@firebase/remote-config",Rj="@firebase/remote-config-compat",Pj="@firebase/storage",Nj="@firebase/storage-compat",Dj="@firebase/firestore",jj="@firebase/ai",Lj="@firebase/firestore-compat",Mj="firebase",Vj="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lg="[DEFAULT]",Oj={[ag]:"fire-core",[dj]:"fire-core-compat",[fj]:"fire-analytics",[hj]:"fire-analytics-compat",[mj]:"fire-app-check",[pj]:"fire-app-check-compat",[gj]:"fire-auth",[yj]:"fire-auth-compat",[vj]:"fire-rtdb",[xj]:"fire-data-connect",[wj]:"fire-rtdb-compat",[_j]:"fire-fn",[Tj]:"fire-fn-compat",[Sj]:"fire-iid",[Ej]:"fire-iid-compat",[bj]:"fire-fcm",[Ij]:"fire-fcm-compat",[Cj]:"fire-perf",[kj]:"fire-perf-compat",[Aj]:"fire-rc",[Rj]:"fire-rc-compat",[Pj]:"fire-gcs",[Nj]:"fire-gcs-compat",[Dj]:"fire-fst",[Lj]:"fire-fst-compat",[jj]:"fire-vertex","fire-js":"fire-js",[Mj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rh=new Map,Fj=new Map,cg=new Map;function vw(t,e){try{t.container.addComponent(e)}catch(n){Ei.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ts(t){const e=t.name;if(cg.has(e))return Ei.debug(`There were multiple attempts to register component ${e}.`),!1;cg.set(e,t);for(const n of rh.values())vw(n,t);for(const n of Fj.values())vw(n,t);return!0}function Qc(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Mn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ms=new Gc("app","Firebase",Uj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Si("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ms.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao=Vj;function Kb(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:lg,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw ms.create("bad-app-name",{appName:String(i)});if(n||(n=$b()),!n)throw ms.create("no-options");const s=rh.get(i);if(s){if(vo(n,s.options)&&vo(r,s.config))return s;throw ms.create("duplicate-app",{appName:i})}const o=new GD(i);for(const l of cg.values())o.addComponent(l);const a=new zj(n,r,o);return rh.set(i,a),a}function of(t=lg){const e=rh.get(t);if(!e&&t===lg&&$b())return Kb();if(!e)throw ms.create("no-app",{appName:t});return e}function sr(t,e,n){let r=Oj[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ei.warn(o.join(" "));return}Ts(new Si(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bj="firebase-heartbeat-database",$j=1,Tc="firebase-heartbeat-store";let Vp=null;function Qb(){return Vp||(Vp=oj(Bj,$j,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Tc)}catch(n){console.warn(n)}}}}).catch(t=>{throw ms.create("idb-open",{originalErrorMessage:t.message})})),Vp}async function Wj(t){try{const n=(await Qb()).transaction(Tc),r=await n.objectStore(Tc).get(Yb(t));return await n.done,r}catch(e){if(e instanceof Ar)Ei.warn(e.message);else{const n=ms.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ei.warn(n.message)}}}async function xw(t,e){try{const r=(await Qb()).transaction(Tc,"readwrite");await r.objectStore(Tc).put(e,Yb(t)),await r.done}catch(n){if(n instanceof Ar)Ei.warn(n.message);else{const r=ms.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ei.warn(r.message)}}}function Yb(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qj=1024,Hj=30;class Gj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Qj(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=ww();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>Hj){const o=Yj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Ei.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=ww(),{heartbeatsToSend:r,unsentEntries:i}=Kj(this._heartbeatsCache.heartbeats),s=nh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Ei.warn(n),""}}}function ww(){return new Date().toISOString().substring(0,10)}function Kj(t,e=qj){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),_w(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),_w(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Qj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return LD()?MD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Wj(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return xw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return xw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function _w(t){return nh(JSON.stringify({version:2,heartbeats:t})).length}function Yj(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xj(t){Ts(new Si("platform-logger",e=>new cj(e),"PRIVATE")),Ts(new Si("heartbeat",e=>new Gj(e),"PRIVATE")),sr(ag,yw,t),sr(ag,yw,"esm2020"),sr("fire-js","")}Xj("");var Jj="firebase",Zj="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sr(Jj,Zj,"app");var Tw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gs,Xb;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,T){function I(){}I.prototype=T.prototype,E.F=T.prototype,E.prototype=new I,E.prototype.constructor=E,E.D=function(A,P,N){for(var b=Array(arguments.length-2),H=2;H<arguments.length;H++)b[H-2]=arguments[H];return T.prototype[P].apply(A,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,T,I){I||(I=0);const A=Array(16);if(typeof T=="string")for(var P=0;P<16;++P)A[P]=T.charCodeAt(I++)|T.charCodeAt(I++)<<8|T.charCodeAt(I++)<<16|T.charCodeAt(I++)<<24;else for(P=0;P<16;++P)A[P]=T[I++]|T[I++]<<8|T[I++]<<16|T[I++]<<24;T=E.g[0],I=E.g[1],P=E.g[2];let N=E.g[3],b;b=T+(N^I&(P^N))+A[0]+3614090360&4294967295,T=I+(b<<7&4294967295|b>>>25),b=N+(P^T&(I^P))+A[1]+3905402710&4294967295,N=T+(b<<12&4294967295|b>>>20),b=P+(I^N&(T^I))+A[2]+606105819&4294967295,P=N+(b<<17&4294967295|b>>>15),b=I+(T^P&(N^T))+A[3]+3250441966&4294967295,I=P+(b<<22&4294967295|b>>>10),b=T+(N^I&(P^N))+A[4]+4118548399&4294967295,T=I+(b<<7&4294967295|b>>>25),b=N+(P^T&(I^P))+A[5]+1200080426&4294967295,N=T+(b<<12&4294967295|b>>>20),b=P+(I^N&(T^I))+A[6]+2821735955&4294967295,P=N+(b<<17&4294967295|b>>>15),b=I+(T^P&(N^T))+A[7]+4249261313&4294967295,I=P+(b<<22&4294967295|b>>>10),b=T+(N^I&(P^N))+A[8]+1770035416&4294967295,T=I+(b<<7&4294967295|b>>>25),b=N+(P^T&(I^P))+A[9]+2336552879&4294967295,N=T+(b<<12&4294967295|b>>>20),b=P+(I^N&(T^I))+A[10]+4294925233&4294967295,P=N+(b<<17&4294967295|b>>>15),b=I+(T^P&(N^T))+A[11]+2304563134&4294967295,I=P+(b<<22&4294967295|b>>>10),b=T+(N^I&(P^N))+A[12]+1804603682&4294967295,T=I+(b<<7&4294967295|b>>>25),b=N+(P^T&(I^P))+A[13]+4254626195&4294967295,N=T+(b<<12&4294967295|b>>>20),b=P+(I^N&(T^I))+A[14]+2792965006&4294967295,P=N+(b<<17&4294967295|b>>>15),b=I+(T^P&(N^T))+A[15]+1236535329&4294967295,I=P+(b<<22&4294967295|b>>>10),b=T+(P^N&(I^P))+A[1]+4129170786&4294967295,T=I+(b<<5&4294967295|b>>>27),b=N+(I^P&(T^I))+A[6]+3225465664&4294967295,N=T+(b<<9&4294967295|b>>>23),b=P+(T^I&(N^T))+A[11]+643717713&4294967295,P=N+(b<<14&4294967295|b>>>18),b=I+(N^T&(P^N))+A[0]+3921069994&4294967295,I=P+(b<<20&4294967295|b>>>12),b=T+(P^N&(I^P))+A[5]+3593408605&4294967295,T=I+(b<<5&4294967295|b>>>27),b=N+(I^P&(T^I))+A[10]+38016083&4294967295,N=T+(b<<9&4294967295|b>>>23),b=P+(T^I&(N^T))+A[15]+3634488961&4294967295,P=N+(b<<14&4294967295|b>>>18),b=I+(N^T&(P^N))+A[4]+3889429448&4294967295,I=P+(b<<20&4294967295|b>>>12),b=T+(P^N&(I^P))+A[9]+568446438&4294967295,T=I+(b<<5&4294967295|b>>>27),b=N+(I^P&(T^I))+A[14]+3275163606&4294967295,N=T+(b<<9&4294967295|b>>>23),b=P+(T^I&(N^T))+A[3]+4107603335&4294967295,P=N+(b<<14&4294967295|b>>>18),b=I+(N^T&(P^N))+A[8]+1163531501&4294967295,I=P+(b<<20&4294967295|b>>>12),b=T+(P^N&(I^P))+A[13]+2850285829&4294967295,T=I+(b<<5&4294967295|b>>>27),b=N+(I^P&(T^I))+A[2]+4243563512&4294967295,N=T+(b<<9&4294967295|b>>>23),b=P+(T^I&(N^T))+A[7]+1735328473&4294967295,P=N+(b<<14&4294967295|b>>>18),b=I+(N^T&(P^N))+A[12]+2368359562&4294967295,I=P+(b<<20&4294967295|b>>>12),b=T+(I^P^N)+A[5]+4294588738&4294967295,T=I+(b<<4&4294967295|b>>>28),b=N+(T^I^P)+A[8]+2272392833&4294967295,N=T+(b<<11&4294967295|b>>>21),b=P+(N^T^I)+A[11]+1839030562&4294967295,P=N+(b<<16&4294967295|b>>>16),b=I+(P^N^T)+A[14]+4259657740&4294967295,I=P+(b<<23&4294967295|b>>>9),b=T+(I^P^N)+A[1]+2763975236&4294967295,T=I+(b<<4&4294967295|b>>>28),b=N+(T^I^P)+A[4]+1272893353&4294967295,N=T+(b<<11&4294967295|b>>>21),b=P+(N^T^I)+A[7]+4139469664&4294967295,P=N+(b<<16&4294967295|b>>>16),b=I+(P^N^T)+A[10]+3200236656&4294967295,I=P+(b<<23&4294967295|b>>>9),b=T+(I^P^N)+A[13]+681279174&4294967295,T=I+(b<<4&4294967295|b>>>28),b=N+(T^I^P)+A[0]+3936430074&4294967295,N=T+(b<<11&4294967295|b>>>21),b=P+(N^T^I)+A[3]+3572445317&4294967295,P=N+(b<<16&4294967295|b>>>16),b=I+(P^N^T)+A[6]+76029189&4294967295,I=P+(b<<23&4294967295|b>>>9),b=T+(I^P^N)+A[9]+3654602809&4294967295,T=I+(b<<4&4294967295|b>>>28),b=N+(T^I^P)+A[12]+3873151461&4294967295,N=T+(b<<11&4294967295|b>>>21),b=P+(N^T^I)+A[15]+530742520&4294967295,P=N+(b<<16&4294967295|b>>>16),b=I+(P^N^T)+A[2]+3299628645&4294967295,I=P+(b<<23&4294967295|b>>>9),b=T+(P^(I|~N))+A[0]+4096336452&4294967295,T=I+(b<<6&4294967295|b>>>26),b=N+(I^(T|~P))+A[7]+1126891415&4294967295,N=T+(b<<10&4294967295|b>>>22),b=P+(T^(N|~I))+A[14]+2878612391&4294967295,P=N+(b<<15&4294967295|b>>>17),b=I+(N^(P|~T))+A[5]+4237533241&4294967295,I=P+(b<<21&4294967295|b>>>11),b=T+(P^(I|~N))+A[12]+1700485571&4294967295,T=I+(b<<6&4294967295|b>>>26),b=N+(I^(T|~P))+A[3]+2399980690&4294967295,N=T+(b<<10&4294967295|b>>>22),b=P+(T^(N|~I))+A[10]+4293915773&4294967295,P=N+(b<<15&4294967295|b>>>17),b=I+(N^(P|~T))+A[1]+2240044497&4294967295,I=P+(b<<21&4294967295|b>>>11),b=T+(P^(I|~N))+A[8]+1873313359&4294967295,T=I+(b<<6&4294967295|b>>>26),b=N+(I^(T|~P))+A[15]+4264355552&4294967295,N=T+(b<<10&4294967295|b>>>22),b=P+(T^(N|~I))+A[6]+2734768916&4294967295,P=N+(b<<15&4294967295|b>>>17),b=I+(N^(P|~T))+A[13]+1309151649&4294967295,I=P+(b<<21&4294967295|b>>>11),b=T+(P^(I|~N))+A[4]+4149444226&4294967295,T=I+(b<<6&4294967295|b>>>26),b=N+(I^(T|~P))+A[11]+3174756917&4294967295,N=T+(b<<10&4294967295|b>>>22),b=P+(T^(N|~I))+A[2]+718787259&4294967295,P=N+(b<<15&4294967295|b>>>17),b=I+(N^(P|~T))+A[9]+3951481745&4294967295,E.g[0]=E.g[0]+T&4294967295,E.g[1]=E.g[1]+(P+(b<<21&4294967295|b>>>11))&4294967295,E.g[2]=E.g[2]+P&4294967295,E.g[3]=E.g[3]+N&4294967295}r.prototype.v=function(E,T){T===void 0&&(T=E.length);const I=T-this.blockSize,A=this.C;let P=this.h,N=0;for(;N<T;){if(P==0)for(;N<=I;)i(this,E,N),N+=this.blockSize;if(typeof E=="string"){for(;N<T;)if(A[P++]=E.charCodeAt(N++),P==this.blockSize){i(this,A),P=0;break}}else for(;N<T;)if(A[P++]=E[N++],P==this.blockSize){i(this,A),P=0;break}}this.h=P,this.o+=T},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var T=1;T<E.length-8;++T)E[T]=0;T=this.o*8;for(var I=E.length-8;I<E.length;++I)E[I]=T&255,T/=256;for(this.v(E),E=Array(16),T=0,I=0;I<4;++I)for(let A=0;A<32;A+=8)E[T++]=this.g[I]>>>A&255;return E};function s(E,T){var I=a;return Object.prototype.hasOwnProperty.call(I,E)?I[E]:I[E]=T(E)}function o(E,T){this.h=T;const I=[];let A=!0;for(let P=E.length-1;P>=0;P--){const N=E[P]|0;A&&N==T||(I[P]=N,A=!1)}this.g=I}var a={};function l(E){return-128<=E&&E<128?s(E,function(T){return new o([T|0],T<0?-1:0)}):new o([E|0],E<0?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return f;if(E<0)return k(d(-E));const T=[];let I=1;for(let A=0;E>=I;A++)T[A]=E/I|0,I*=4294967296;return new o(T,0)}function h(E,T){if(E.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(E.charAt(0)=="-")return k(h(E.substring(1),T));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=d(Math.pow(T,8));let A=f;for(let N=0;N<E.length;N+=8){var P=Math.min(8,E.length-N);const b=parseInt(E.substring(N,N+P),T);P<8?(P=d(Math.pow(T,P)),A=A.j(P).add(d(b))):(A=A.j(I),A=A.add(d(b)))}return A}var f=l(0),p=l(1),g=l(16777216);t=o.prototype,t.m=function(){if(_(this))return-k(this).m();let E=0,T=1;for(let I=0;I<this.g.length;I++){const A=this.i(I);E+=(A>=0?A:4294967296+A)*T,T*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(x(this))return"0";if(_(this))return"-"+k(this).toString(E);const T=d(Math.pow(E,6));var I=this;let A="";for(;;){const P=j(I,T).g;I=S(I,P.j(T));let N=((I.g.length>0?I.g[0]:I.h)>>>0).toString(E);if(I=P,x(I))return N+A;for(;N.length<6;)N="0"+N;A=N+A}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function x(E){if(E.h!=0)return!1;for(let T=0;T<E.g.length;T++)if(E.g[T]!=0)return!1;return!0}function _(E){return E.h==-1}t.l=function(E){return E=S(this,E),_(E)?-1:x(E)?0:1};function k(E){const T=E.g.length,I=[];for(let A=0;A<T;A++)I[A]=~E.g[A];return new o(I,~E.h).add(p)}t.abs=function(){return _(this)?k(this):this},t.add=function(E){const T=Math.max(this.g.length,E.g.length),I=[];let A=0;for(let P=0;P<=T;P++){let N=A+(this.i(P)&65535)+(E.i(P)&65535),b=(N>>>16)+(this.i(P)>>>16)+(E.i(P)>>>16);A=b>>>16,N&=65535,b&=65535,I[P]=b<<16|N}return new o(I,I[I.length-1]&-2147483648?-1:0)};function S(E,T){return E.add(k(T))}t.j=function(E){if(x(this)||x(E))return f;if(_(this))return _(E)?k(this).j(k(E)):k(k(this).j(E));if(_(E))return k(this.j(k(E)));if(this.l(g)<0&&E.l(g)<0)return d(this.m()*E.m());const T=this.g.length+E.g.length,I=[];for(var A=0;A<2*T;A++)I[A]=0;for(A=0;A<this.g.length;A++)for(let P=0;P<E.g.length;P++){const N=this.i(A)>>>16,b=this.i(A)&65535,H=E.i(P)>>>16,he=E.i(P)&65535;I[2*A+2*P]+=b*he,v(I,2*A+2*P),I[2*A+2*P+1]+=N*he,v(I,2*A+2*P+1),I[2*A+2*P+1]+=b*H,v(I,2*A+2*P+1),I[2*A+2*P+2]+=N*H,v(I,2*A+2*P+2)}for(E=0;E<T;E++)I[E]=I[2*E+1]<<16|I[2*E];for(E=T;E<2*T;E++)I[E]=0;return new o(I,0)};function v(E,T){for(;(E[T]&65535)!=E[T];)E[T+1]+=E[T]>>>16,E[T]&=65535,T++}function w(E,T){this.g=E,this.h=T}function j(E,T){if(x(T))throw Error("division by zero");if(x(E))return new w(f,f);if(_(E))return T=j(k(E),T),new w(k(T.g),k(T.h));if(_(T))return T=j(E,k(T)),new w(k(T.g),T.h);if(E.g.length>30){if(_(E)||_(T))throw Error("slowDivide_ only works with positive integers.");for(var I=p,A=T;A.l(E)<=0;)I=L(I),A=L(A);var P=V(I,1),N=V(A,1);for(A=V(A,2),I=V(I,2);!x(A);){var b=N.add(A);b.l(E)<=0&&(P=P.add(I),N=b),A=V(A,1),I=V(I,1)}return T=S(E,P.j(T)),new w(P,T)}for(P=f;E.l(T)>=0;){for(I=Math.max(1,Math.floor(E.m()/T.m())),A=Math.ceil(Math.log(I)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),N=d(I),b=N.j(T);_(b)||b.l(E)>0;)I-=A,N=d(I),b=N.j(T);x(N)&&(N=p),P=P.add(N),E=S(E,b)}return new w(P,E)}t.B=function(E){return j(this,E).h},t.and=function(E){const T=Math.max(this.g.length,E.g.length),I=[];for(let A=0;A<T;A++)I[A]=this.i(A)&E.i(A);return new o(I,this.h&E.h)},t.or=function(E){const T=Math.max(this.g.length,E.g.length),I=[];for(let A=0;A<T;A++)I[A]=this.i(A)|E.i(A);return new o(I,this.h|E.h)},t.xor=function(E){const T=Math.max(this.g.length,E.g.length),I=[];for(let A=0;A<T;A++)I[A]=this.i(A)^E.i(A);return new o(I,this.h^E.h)};function L(E){const T=E.g.length+1,I=[];for(let A=0;A<T;A++)I[A]=E.i(A)<<1|E.i(A-1)>>>31;return new o(I,E.h)}function V(E,T){const I=T>>5;T%=32;const A=E.g.length-I,P=[];for(let N=0;N<A;N++)P[N]=T>0?E.i(N+I)>>>T|E.i(N+I+1)<<32-T:E.i(N+I);return new o(P,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Xb=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,gs=o}).apply(typeof Tw<"u"?Tw:typeof self<"u"?self:typeof window<"u"?window:{});var Uu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Jb,Pl,Zb,dd,ug,e2,t2,n2;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Uu=="object"&&Uu];for(var m=0;m<c.length;++m){var y=c[m];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(c,m){if(m)e:{var y=r;c=c.split(".");for(var C=0;C<c.length-1;C++){var O=c[C];if(!(O in y))break e;y=y[O]}c=c[c.length-1],C=y[c],m=m(C),m!=C&&m!=null&&e(y,c,{configurable:!0,writable:!0,value:m})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(m){var y=[],C;for(C in m)Object.prototype.hasOwnProperty.call(m,C)&&y.push([C,m[C]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(c){var m=typeof c;return m=="object"&&c!=null||m=="function"}function l(c,m,y){return c.call.apply(c.bind,arguments)}function d(c,m,y){return d=l,d.apply(null,arguments)}function h(c,m){var y=Array.prototype.slice.call(arguments,1);return function(){var C=y.slice();return C.push.apply(C,arguments),c.apply(this,C)}}function f(c,m){function y(){}y.prototype=m.prototype,c.Z=m.prototype,c.prototype=new y,c.prototype.constructor=c,c.Ob=function(C,O,F){for(var te=Array(arguments.length-2),Re=2;Re<arguments.length;Re++)te[Re-2]=arguments[Re];return m.prototype[O].apply(C,te)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function g(c){const m=c.length;if(m>0){const y=Array(m);for(let C=0;C<m;C++)y[C]=c[C];return y}return[]}function x(c,m){for(let C=1;C<arguments.length;C++){const O=arguments[C];var y=typeof O;if(y=y!="object"?y:O?Array.isArray(O)?"array":y:"null",y=="array"||y=="object"&&typeof O.length=="number"){y=c.length||0;const F=O.length||0;c.length=y+F;for(let te=0;te<F;te++)c[y+te]=O[te]}else c.push(O)}}class _{constructor(m,y){this.i=m,this.j=y,this.h=0,this.g=null}get(){let m;return this.h>0?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function k(c){o.setTimeout(()=>{throw c},0)}function S(){var c=E;let m=null;return c.g&&(m=c.g,c.g=c.g.next,c.g||(c.h=null),m.next=null),m}class v{constructor(){this.h=this.g=null}add(m,y){const C=w.get();C.set(m,y),this.h?this.h.next=C:this.g=C,this.h=C}}var w=new _(()=>new j,c=>c.reset());class j{constructor(){this.next=this.g=this.h=null}set(m,y){this.h=m,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let L,V=!1,E=new v,T=()=>{const c=Promise.resolve(void 0);L=()=>{c.then(I)}};function I(){for(var c;c=S();){try{c.h.call(c.g)}catch(y){k(y)}var m=w;m.j(c),m.h<100&&(m.h++,c.next=m.g,m.g=c)}V=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(c,m){this.type=c,this.g=this.target=m,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var N=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,m=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const y=()=>{};o.addEventListener("test",y,m),o.removeEventListener("test",y,m)}catch{}return c}();function b(c){return/^[\s\xa0]*$/.test(c)}function H(c,m){P.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,m)}f(H,P),H.prototype.init=function(c,m){const y=this.type=c.type,C=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=m,m=c.relatedTarget,m||(y=="mouseover"?m=c.fromElement:y=="mouseout"&&(m=c.toElement)),this.relatedTarget=m,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&H.Z.h.call(this)},H.prototype.h=function(){H.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var he="closure_listenable_"+(Math.random()*1e6|0),re=0;function se(c,m,y,C,O){this.listener=c,this.proxy=null,this.src=m,this.type=y,this.capture=!!C,this.ha=O,this.key=++re,this.da=this.fa=!1}function U(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function G(c,m,y){for(const C in c)m.call(y,c[C],C,c)}function M(c,m){for(const y in c)m.call(void 0,c[y],y,c)}function D(c){const m={};for(const y in c)m[y]=c[y];return m}const q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(c,m){let y,C;for(let O=1;O<arguments.length;O++){C=arguments[O];for(y in C)c[y]=C[y];for(let F=0;F<q.length;F++)y=q[F],Object.prototype.hasOwnProperty.call(C,y)&&(c[y]=C[y])}}function ee(c){this.src=c,this.g={},this.h=0}ee.prototype.add=function(c,m,y,C,O){const F=c.toString();c=this.g[F],c||(c=this.g[F]=[],this.h++);const te=Z(c,m,C,O);return te>-1?(m=c[te],y||(m.fa=!1)):(m=new se(m,this.src,F,!!C,O),m.fa=y,c.push(m)),m};function ie(c,m){const y=m.type;if(y in c.g){var C=c.g[y],O=Array.prototype.indexOf.call(C,m,void 0),F;(F=O>=0)&&Array.prototype.splice.call(C,O,1),F&&(U(m),c.g[y].length==0&&(delete c.g[y],c.h--))}}function Z(c,m,y,C){for(let O=0;O<c.length;++O){const F=c[O];if(!F.da&&F.listener==m&&F.capture==!!y&&F.ha==C)return O}return-1}var z="closure_lm_"+(Math.random()*1e6|0),Y={};function pe(c,m,y,C,O){if(C&&C.once)return Ae(c,m,y,C,O);if(Array.isArray(m)){for(let F=0;F<m.length;F++)pe(c,m[F],y,C,O);return null}return y=dt(y),c&&c[he]?c.J(m,y,a(C)?!!C.capture:!!C,O):_e(c,m,y,!1,C,O)}function _e(c,m,y,C,O,F){if(!m)throw Error("Invalid event type");const te=a(O)?!!O.capture:!!O;let Re=Ye(c);if(Re||(c[z]=Re=new ee(c)),y=Re.add(m,y,C,te,F),y.proxy)return y;if(C=ge(),y.proxy=C,C.src=c,C.listener=y,c.addEventListener)N||(O=te),O===void 0&&(O=!1),c.addEventListener(m.toString(),C,O);else if(c.attachEvent)c.attachEvent(ke(m.toString()),C);else if(c.addListener&&c.removeListener)c.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return y}function ge(){function c(y){return m.call(c.src,c.listener,y)}const m=Ge;return c}function Ae(c,m,y,C,O){if(Array.isArray(m)){for(let F=0;F<m.length;F++)Ae(c,m[F],y,C,O);return null}return y=dt(y),c&&c[he]?c.K(m,y,a(C)?!!C.capture:!!C,O):_e(c,m,y,!0,C,O)}function $(c,m,y,C,O){if(Array.isArray(m))for(var F=0;F<m.length;F++)$(c,m[F],y,C,O);else C=a(C)?!!C.capture:!!C,y=dt(y),c&&c[he]?(c=c.i,F=String(m).toString(),F in c.g&&(m=c.g[F],y=Z(m,y,C,O),y>-1&&(U(m[y]),Array.prototype.splice.call(m,y,1),m.length==0&&(delete c.g[F],c.h--)))):c&&(c=Ye(c))&&(m=c.g[m.toString()],c=-1,m&&(c=Z(m,y,C,O)),(y=c>-1?m[c]:null)&&ae(y))}function ae(c){if(typeof c!="number"&&c&&!c.da){var m=c.src;if(m&&m[he])ie(m.i,c);else{var y=c.type,C=c.proxy;m.removeEventListener?m.removeEventListener(y,C,c.capture):m.detachEvent?m.detachEvent(ke(y),C):m.addListener&&m.removeListener&&m.removeListener(C),(y=Ye(m))?(ie(y,c),y.h==0&&(y.src=null,m[z]=null)):U(c)}}}function ke(c){return c in Y?Y[c]:Y[c]="on"+c}function Ge(c,m){if(c.da)c=!0;else{m=new H(m,this);const y=c.listener,C=c.ha||c.src;c.fa&&ae(c),c=y.call(C,m)}return c}function Ye(c){return c=c[z],c instanceof ee?c:null}var Xe="__closure_events_fn_"+(Math.random()*1e9>>>0);function dt(c){return typeof c=="function"?c:(c[Xe]||(c[Xe]=function(m){return c.handleEvent(m)}),c[Xe])}function Ne(){A.call(this),this.i=new ee(this),this.M=this,this.G=null}f(Ne,A),Ne.prototype[he]=!0,Ne.prototype.removeEventListener=function(c,m,y,C){$(this,c,m,y,C)};function qe(c,m){var y,C=c.G;if(C)for(y=[];C;C=C.G)y.push(C);if(c=c.M,C=m.type||m,typeof m=="string")m=new P(m,c);else if(m instanceof P)m.target=m.target||c;else{var O=m;m=new P(C,c),J(m,O)}O=!0;let F,te;if(y)for(te=y.length-1;te>=0;te--)F=m.g=y[te],O=Hn(F,C,!0,m)&&O;if(F=m.g=c,O=Hn(F,C,!0,m)&&O,O=Hn(F,C,!1,m)&&O,y)for(te=0;te<y.length;te++)F=m.g=y[te],O=Hn(F,C,!1,m)&&O}Ne.prototype.N=function(){if(Ne.Z.N.call(this),this.i){var c=this.i;for(const m in c.g){const y=c.g[m];for(let C=0;C<y.length;C++)U(y[C]);delete c.g[m],c.h--}}this.G=null},Ne.prototype.J=function(c,m,y,C){return this.i.add(String(c),m,!1,y,C)},Ne.prototype.K=function(c,m,y,C){return this.i.add(String(c),m,!0,y,C)};function Hn(c,m,y,C){if(m=c.i.g[String(m)],!m)return!0;m=m.concat();let O=!0;for(let F=0;F<m.length;++F){const te=m[F];if(te&&!te.da&&te.capture==y){const Re=te.listener,Nt=te.ha||te.src;te.fa&&ie(c.i,te),O=Re.call(Nt,C)!==!1&&O}}return O&&!C.defaultPrevented}function Gn(c,m){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(m)>2147483647?-1:o.setTimeout(c,m||0)}function Dn(c){c.g=Gn(()=>{c.g=null,c.i&&(c.i=!1,Dn(c))},c.l);const m=c.h;c.h=null,c.m.apply(null,m)}class Rr extends A{constructor(m,y){super(),this.m=m,this.l=y,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:Dn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zt(c){A.call(this),this.h=c,this.g={}}f(Zt,A);var en=[];function Pr(c){G(c.g,function(m,y){this.g.hasOwnProperty(y)&&ae(m)},c),c.g={}}Zt.prototype.N=function(){Zt.Z.N.call(this),Pr(this)},Zt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ee=o.JSON.stringify,de=o.JSON.parse,fe=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function De(){}function nt(){}var rt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function $e(){P.call(this,"d")}f($e,P);function hn(){P.call(this,"c")}f(hn,P);var Je={},K=null;function le(){return K=K||new Ne}Je.Ia="serverreachability";function me(c){P.call(this,Je.Ia,c)}f(me,P);function X(c){const m=le();qe(m,new me(m))}Je.STAT_EVENT="statevent";function xe(c,m){P.call(this,Je.STAT_EVENT,c),this.stat=m}f(xe,P);function ye(c){const m=le();qe(m,new xe(m,c))}Je.Ja="timingevent";function _t(c,m){P.call(this,Je.Ja,c),this.size=m}f(_t,P);function Ke(c,m){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},m)}function je(){this.g=!0}je.prototype.ua=function(){this.g=!1};function zt(c,m,y,C,O,F){c.info(function(){if(c.g)if(F){var te="",Re=F.split("&");for(let Qe=0;Qe<Re.length;Qe++){var Nt=Re[Qe].split("=");if(Nt.length>1){const Vt=Nt[0];Nt=Nt[1];const Dr=Vt.split("_");te=Dr.length>=2&&Dr[1]=="type"?te+(Vt+"="+Nt+"&"):te+(Vt+"=redacted&")}}}else te=null;else te=F;return"XMLHTTP REQ ("+C+") [attempt "+O+"]: "+m+`
`+y+`
`+te})}function Bt(c,m,y,C,O,F,te){c.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+O+"]: "+m+`
`+y+`
`+F+" "+te})}function tn(c,m,y,C){c.info(function(){return"XMLHTTP TEXT ("+m+"): "+ck(c,y)+(C?" "+C:"")})}function lk(c,m){c.info(function(){return"TIMEOUT: "+m})}je.prototype.info=function(){};function ck(c,m){if(!c.g)return m;if(!m)return null;try{const F=JSON.parse(m);if(F){for(c=0;c<F.length;c++)if(Array.isArray(F[c])){var y=F[c];if(!(y.length<2)){var C=y[1];if(Array.isArray(C)&&!(C.length<1)){var O=C[0];if(O!="noop"&&O!="stop"&&O!="close")for(let te=1;te<C.length;te++)C[te]=""}}}}return Ee(F)}catch{return m}}var cu={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},pv={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},mv;function Df(){}f(Df,De),Df.prototype.g=function(){return new XMLHttpRequest},mv=new Df;function nl(c){return encodeURIComponent(String(c))}function uk(c){var m=1;c=c.split(":");const y=[];for(;m>0&&c.length;)y.push(c.shift()),m--;return c.length&&y.push(c.join(":")),y}function Ri(c,m,y,C){this.j=c,this.i=m,this.l=y,this.S=C||1,this.V=new Zt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new gv}function gv(){this.i=null,this.g="",this.h=!1}var yv={},jf={};function Lf(c,m,y){c.M=1,c.A=du(Nr(m)),c.u=y,c.R=!0,vv(c,null)}function vv(c,m){c.F=Date.now(),uu(c),c.B=Nr(c.A);var y=c.B,C=c.S;Array.isArray(C)||(C=[String(C)]),Pv(y.i,"t",C),c.C=0,y=c.j.L,c.h=new gv,c.g=Qv(c.j,y?m:null,!c.u),c.P>0&&(c.O=new Rr(d(c.Y,c,c.g),c.P)),m=c.V,y=c.g,C=c.ba;var O="readystatechange";Array.isArray(O)||(O&&(en[0]=O.toString()),O=en);for(let F=0;F<O.length;F++){const te=pe(y,O[F],C||m.handleEvent,!1,m.h||m);if(!te)break;m.g[te.key]=te}m=c.J?D(c.J):{},c.u?(c.v||(c.v="POST"),m["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,m)):(c.v="GET",c.g.ea(c.B,c.v,null,m)),X(),zt(c.i,c.v,c.B,c.l,c.S,c.u)}Ri.prototype.ba=function(c){c=c.target;const m=this.O;m&&Di(c)==3?m.j():this.Y(c)},Ri.prototype.Y=function(c){try{if(c==this.g)e:{const Re=Di(this.g),Nt=this.g.ya(),Qe=this.g.ca();if(!(Re<3)&&(Re!=3||this.g&&(this.h.h||this.g.la()||Ov(this.g)))){this.K||Re!=4||Nt==7||(Nt==8||Qe<=0?X(3):X(2)),Mf(this);var m=this.g.ca();this.X=m;var y=dk(this);if(this.o=m==200,Bt(this.i,this.v,this.B,this.l,this.S,Re,m),this.o){if(this.U&&!this.L){t:{if(this.g){var C,O=this.g;if((C=O.g?O.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(C)){var F=C;break t}}F=null}if(c=F)tn(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Vf(this,c);else{this.o=!1,this.m=3,ye(12),Vs(this),rl(this);break e}}if(this.R){c=!0;let Vt;for(;!this.K&&this.C<y.length;)if(Vt=hk(this,y),Vt==jf){Re==4&&(this.m=4,ye(14),c=!1),tn(this.i,this.l,null,"[Incomplete Response]");break}else if(Vt==yv){this.m=4,ye(15),tn(this.i,this.l,y,"[Invalid Chunk]"),c=!1;break}else tn(this.i,this.l,Vt,null),Vf(this,Vt);if(xv(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Re!=4||y.length!=0||this.h.h||(this.m=1,ye(16),c=!1),this.o=this.o&&c,!c)tn(this.i,this.l,y,"[Invalid Chunked Response]"),Vs(this),rl(this);else if(y.length>0&&!this.W){this.W=!0;var te=this.j;te.g==this&&te.aa&&!te.P&&(te.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),qf(te),te.P=!0,ye(11))}}else tn(this.i,this.l,y,null),Vf(this,y);Re==4&&Vs(this),this.o&&!this.K&&(Re==4?qv(this.j,this):(this.o=!1,uu(this)))}else Ik(this.g),m==400&&y.indexOf("Unknown SID")>0?(this.m=3,ye(12)):(this.m=0,ye(13)),Vs(this),rl(this)}}}catch{}finally{}};function dk(c){if(!xv(c))return c.g.la();const m=Ov(c.g);if(m==="")return"";let y="";const C=m.length,O=Di(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Vs(c),rl(c),"";c.h.i=new o.TextDecoder}for(let F=0;F<C;F++)c.h.h=!0,y+=c.h.i.decode(m[F],{stream:!(O&&F==C-1)});return m.length=0,c.h.g+=y,c.C=0,c.h.g}function xv(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function hk(c,m){var y=c.C,C=m.indexOf(`
`,y);return C==-1?jf:(y=Number(m.substring(y,C)),isNaN(y)?yv:(C+=1,C+y>m.length?jf:(m=m.slice(C,C+y),c.C=C+y,m)))}Ri.prototype.cancel=function(){this.K=!0,Vs(this)};function uu(c){c.T=Date.now()+c.H,wv(c,c.H)}function wv(c,m){if(c.D!=null)throw Error("WatchDog timer not null");c.D=Ke(d(c.aa,c),m)}function Mf(c){c.D&&(o.clearTimeout(c.D),c.D=null)}Ri.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(lk(this.i,this.B),this.M!=2&&(X(),ye(17)),Vs(this),this.m=2,rl(this)):wv(this,this.T-c)};function rl(c){c.j.I==0||c.K||qv(c.j,c)}function Vs(c){Mf(c);var m=c.O;m&&typeof m.dispose=="function"&&m.dispose(),c.O=null,Pr(c.V),c.g&&(m=c.g,c.g=null,m.abort(),m.dispose())}function Vf(c,m){try{var y=c.j;if(y.I!=0&&(y.g==c||Of(y.h,c))){if(!c.L&&Of(y.h,c)&&y.I==3){try{var C=y.Ba.g.parse(m)}catch{C=null}if(Array.isArray(C)&&C.length==3){var O=C;if(O[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<c.F)gu(y),pu(y);else break e;Wf(y),ye(18)}}else y.xa=O[1],0<y.xa-y.K&&O[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=Ke(d(y.Va,y),6e3));Sv(y.h)<=1&&y.ta&&(y.ta=void 0)}else Fs(y,11)}else if((c.L||y.g==c)&&gu(y),!b(m))for(O=y.Ba.g.parse(m),m=0;m<O.length;m++){let Qe=O[m];const Vt=Qe[0];if(!(Vt<=y.K))if(y.K=Vt,Qe=Qe[1],y.I==2)if(Qe[0]=="c"){y.M=Qe[1],y.ba=Qe[2];const Dr=Qe[3];Dr!=null&&(y.ka=Dr,y.j.info("VER="+y.ka));const Us=Qe[4];Us!=null&&(y.za=Us,y.j.info("SVER="+y.za));const ji=Qe[5];ji!=null&&typeof ji=="number"&&ji>0&&(C=1.5*ji,y.O=C,y.j.info("backChannelRequestTimeoutMs_="+C)),C=y;const Li=c.g;if(Li){const vu=Li.g?Li.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vu){var F=C.h;F.g||vu.indexOf("spdy")==-1&&vu.indexOf("quic")==-1&&vu.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(Ff(F,F.h),F.h=null))}if(C.G){const Hf=Li.g?Li.g.getResponseHeader("X-HTTP-Session-Id"):null;Hf&&(C.wa=Hf,it(C.J,C.G,Hf))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-c.F,y.j.info("Handshake RTT: "+y.T+"ms")),C=y;var te=c;if(C.na=Kv(C,C.L?C.ba:null,C.W),te.L){Ev(C.h,te);var Re=te,Nt=C.O;Nt&&(Re.H=Nt),Re.D&&(Mf(Re),uu(Re)),C.g=te}else $v(C);y.i.length>0&&mu(y)}else Qe[0]!="stop"&&Qe[0]!="close"||Fs(y,7);else y.I==3&&(Qe[0]=="stop"||Qe[0]=="close"?Qe[0]=="stop"?Fs(y,7):$f(y):Qe[0]!="noop"&&y.l&&y.l.qa(Qe),y.A=0)}}X(4)}catch{}}var fk=class{constructor(c,m){this.g=c,this.map=m}};function _v(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Tv(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Sv(c){return c.h?1:c.g?c.g.size:0}function Of(c,m){return c.h?c.h==m:c.g?c.g.has(m):!1}function Ff(c,m){c.g?c.g.add(m):c.h=m}function Ev(c,m){c.h&&c.h==m?c.h=null:c.g&&c.g.has(m)&&c.g.delete(m)}_v.prototype.cancel=function(){if(this.i=bv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function bv(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let m=c.i;for(const y of c.g.values())m=m.concat(y.G);return m}return g(c.i)}var Iv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pk(c,m){if(c){c=c.split("&");for(let y=0;y<c.length;y++){const C=c[y].indexOf("=");let O,F=null;C>=0?(O=c[y].substring(0,C),F=c[y].substring(C+1)):O=c[y],m(O,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function Pi(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let m;c instanceof Pi?(this.l=c.l,il(this,c.j),this.o=c.o,this.g=c.g,sl(this,c.u),this.h=c.h,Uf(this,Nv(c.i)),this.m=c.m):c&&(m=String(c).match(Iv))?(this.l=!1,il(this,m[1]||"",!0),this.o=ol(m[2]||""),this.g=ol(m[3]||"",!0),sl(this,m[4]),this.h=ol(m[5]||"",!0),Uf(this,m[6]||"",!0),this.m=ol(m[7]||"")):(this.l=!1,this.i=new ll(null,this.l))}Pi.prototype.toString=function(){const c=[];var m=this.j;m&&c.push(al(m,Cv,!0),":");var y=this.g;return(y||m=="file")&&(c.push("//"),(m=this.o)&&c.push(al(m,Cv,!0),"@"),c.push(nl(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&c.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&c.push("/"),c.push(al(y,y.charAt(0)=="/"?yk:gk,!0))),(y=this.i.toString())&&c.push("?",y),(y=this.m)&&c.push("#",al(y,xk)),c.join("")},Pi.prototype.resolve=function(c){const m=Nr(this);let y=!!c.j;y?il(m,c.j):y=!!c.o,y?m.o=c.o:y=!!c.g,y?m.g=c.g:y=c.u!=null;var C=c.h;if(y)sl(m,c.u);else if(y=!!c.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var O=m.h.lastIndexOf("/");O!=-1&&(C=m.h.slice(0,O+1)+C)}if(O=C,O==".."||O==".")C="";else if(O.indexOf("./")!=-1||O.indexOf("/.")!=-1){C=O.lastIndexOf("/",0)==0,O=O.split("/");const F=[];for(let te=0;te<O.length;){const Re=O[te++];Re=="."?C&&te==O.length&&F.push(""):Re==".."?((F.length>1||F.length==1&&F[0]!="")&&F.pop(),C&&te==O.length&&F.push("")):(F.push(Re),C=!0)}C=F.join("/")}else C=O}return y?m.h=C:y=c.i.toString()!=="",y?Uf(m,Nv(c.i)):y=!!c.m,y&&(m.m=c.m),m};function Nr(c){return new Pi(c)}function il(c,m,y){c.j=y?ol(m,!0):m,c.j&&(c.j=c.j.replace(/:$/,""))}function sl(c,m){if(m){if(m=Number(m),isNaN(m)||m<0)throw Error("Bad port number "+m);c.u=m}else c.u=null}function Uf(c,m,y){m instanceof ll?(c.i=m,wk(c.i,c.l)):(y||(m=al(m,vk)),c.i=new ll(m,c.l))}function it(c,m,y){c.i.set(m,y)}function du(c){return it(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function ol(c,m){return c?m?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function al(c,m,y){return typeof c=="string"?(c=encodeURI(c).replace(m,mk),y&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function mk(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Cv=/[#\/\?@]/g,gk=/[#\?:]/g,yk=/[#\?]/g,vk=/[#\?@]/g,xk=/#/g;function ll(c,m){this.h=this.g=null,this.i=c||null,this.j=!!m}function Os(c){c.g||(c.g=new Map,c.h=0,c.i&&pk(c.i,function(m,y){c.add(decodeURIComponent(m.replace(/\+/g," ")),y)}))}t=ll.prototype,t.add=function(c,m){Os(this),this.i=null,c=Lo(this,c);let y=this.g.get(c);return y||this.g.set(c,y=[]),y.push(m),this.h+=1,this};function kv(c,m){Os(c),m=Lo(c,m),c.g.has(m)&&(c.i=null,c.h-=c.g.get(m).length,c.g.delete(m))}function Av(c,m){return Os(c),m=Lo(c,m),c.g.has(m)}t.forEach=function(c,m){Os(this),this.g.forEach(function(y,C){y.forEach(function(O){c.call(m,O,C,this)},this)},this)};function Rv(c,m){Os(c);let y=[];if(typeof m=="string")Av(c,m)&&(y=y.concat(c.g.get(Lo(c,m))));else for(c=Array.from(c.g.values()),m=0;m<c.length;m++)y=y.concat(c[m]);return y}t.set=function(c,m){return Os(this),this.i=null,c=Lo(this,c),Av(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[m]),this.h+=1,this},t.get=function(c,m){return c?(c=Rv(this,c),c.length>0?String(c[0]):m):m};function Pv(c,m,y){kv(c,m),y.length>0&&(c.i=null,c.g.set(Lo(c,m),g(y)),c.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],m=Array.from(this.g.keys());for(let C=0;C<m.length;C++){var y=m[C];const O=nl(y);y=Rv(this,y);for(let F=0;F<y.length;F++){let te=O;y[F]!==""&&(te+="="+nl(y[F])),c.push(te)}}return this.i=c.join("&")};function Nv(c){const m=new ll;return m.i=c.i,c.g&&(m.g=new Map(c.g),m.h=c.h),m}function Lo(c,m){return m=String(m),c.j&&(m=m.toLowerCase()),m}function wk(c,m){m&&!c.j&&(Os(c),c.i=null,c.g.forEach(function(y,C){const O=C.toLowerCase();C!=O&&(kv(this,C),Pv(this,O,y))},c)),c.j=m}function _k(c,m){const y=new je;if(o.Image){const C=new Image;C.onload=h(Ni,y,"TestLoadImage: loaded",!0,m,C),C.onerror=h(Ni,y,"TestLoadImage: error",!1,m,C),C.onabort=h(Ni,y,"TestLoadImage: abort",!1,m,C),C.ontimeout=h(Ni,y,"TestLoadImage: timeout",!1,m,C),o.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=c}else m(!1)}function Tk(c,m){const y=new je,C=new AbortController,O=setTimeout(()=>{C.abort(),Ni(y,"TestPingServer: timeout",!1,m)},1e4);fetch(c,{signal:C.signal}).then(F=>{clearTimeout(O),F.ok?Ni(y,"TestPingServer: ok",!0,m):Ni(y,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(O),Ni(y,"TestPingServer: error",!1,m)})}function Ni(c,m,y,C,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),C(y)}catch{}}function Sk(){this.g=new fe}function zf(c){this.i=c.Sb||null,this.h=c.ab||!1}f(zf,De),zf.prototype.g=function(){return new hu(this.i,this.h)};function hu(c,m){Ne.call(this),this.H=c,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(hu,Ne),t=hu.prototype,t.open=function(c,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=m,this.readyState=1,ul(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const m={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(m.body=c),(this.H||o).fetch(new Request(this.D,m)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,cl(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,ul(this)),this.g&&(this.readyState=3,ul(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Dv(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function Dv(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var m=c.value?c.value:new Uint8Array(0);(m=this.B.decode(m,{stream:!c.done}))&&(this.response=this.responseText+=m)}c.done?cl(this):ul(this),this.readyState==3&&Dv(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,cl(this))},t.Na=function(c){this.g&&(this.response=c,cl(this))},t.ga=function(){this.g&&cl(this)};function cl(c){c.readyState=4,c.l=null,c.j=null,c.B=null,ul(c)}t.setRequestHeader=function(c,m){this.A.append(c,m)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],m=this.h.entries();for(var y=m.next();!y.done;)y=y.value,c.push(y[0]+": "+y[1]),y=m.next();return c.join(`\r
`)};function ul(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(hu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function jv(c){let m="";return G(c,function(y,C){m+=C,m+=":",m+=y,m+=`\r
`}),m}function Bf(c,m,y){e:{for(C in y){var C=!1;break e}C=!0}C||(y=jv(y),typeof c=="string"?y!=null&&nl(y):it(c,m,y))}function yt(c){Ne.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(yt,Ne);var Ek=/^https?$/i,bk=["POST","PUT"];t=yt.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,m,y,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);m=m?m.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():mv.g(),this.g.onreadystatechange=p(d(this.Ca,this));try{this.B=!0,this.g.open(m,String(c),!0),this.B=!1}catch(F){Lv(this,F);return}if(c=y||"",y=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var O in C)y.set(O,C[O]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const F of C.keys())y.set(F,C.get(F));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(y.keys()).find(F=>F.toLowerCase()=="content-type"),O=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(bk,m,void 0)>=0)||C||O||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,te]of y)this.g.setRequestHeader(F,te);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(F){Lv(this,F)}};function Lv(c,m){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=m,c.o=5,Mv(c),fu(c)}function Mv(c){c.A||(c.A=!0,qe(c,"complete"),qe(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,qe(this,"complete"),qe(this,"abort"),fu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fu(this,!0)),yt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Vv(this):this.Xa())},t.Xa=function(){Vv(this)};function Vv(c){if(c.h&&typeof s<"u"){if(c.v&&Di(c)==4)setTimeout(c.Ca.bind(c),0);else if(qe(c,"readystatechange"),Di(c)==4){c.h=!1;try{const F=c.ca();e:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var y;if(!(y=m)){var C;if(C=F===0){let te=String(c.D).match(Iv)[1]||null;!te&&o.self&&o.self.location&&(te=o.self.location.protocol.slice(0,-1)),C=!Ek.test(te?te.toLowerCase():"")}y=C}if(y)qe(c,"complete"),qe(c,"success");else{c.o=6;try{var O=Di(c)>2?c.g.statusText:""}catch{O=""}c.l=O+" ["+c.ca()+"]",Mv(c)}}finally{fu(c)}}}}function fu(c,m){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const y=c.g;c.g=null,m||qe(c,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Di(c){return c.g?c.g.readyState:0}t.ca=function(){try{return Di(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var m=this.g.responseText;return c&&m.indexOf(c)==0&&(m=m.substring(c.length)),de(m)}};function Ov(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Ik(c){const m={};c=(c.g&&Di(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<c.length;C++){if(b(c[C]))continue;var y=uk(c[C]);const O=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const F=m[O]||[];m[O]=F,F.push(y)}M(m,function(C){return C.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function dl(c,m,y){return y&&y.internalChannelParams&&y.internalChannelParams[c]||m}function Fv(c){this.za=0,this.i=[],this.j=new je,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=dl("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=dl("baseRetryDelayMs",5e3,c),this.Za=dl("retryDelaySeedMs",1e4,c),this.Ta=dl("forwardChannelMaxRetries",2,c),this.va=dl("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new _v(c&&c.concurrentRequestLimit),this.Ba=new Sk,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Fv.prototype,t.ka=8,t.I=1,t.connect=function(c,m,y,C){ye(0),this.W=c,this.H=m||{},y&&C!==void 0&&(this.H.OSID=y,this.H.OAID=C),this.F=this.X,this.J=Kv(this,null,this.W),mu(this)};function $f(c){if(Uv(c),c.I==3){var m=c.V++,y=Nr(c.J);if(it(y,"SID",c.M),it(y,"RID",m),it(y,"TYPE","terminate"),hl(c,y),m=new Ri(c,c.j,m),m.M=2,m.A=du(Nr(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(m.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=m.A,y=!0),y||(m.g=Qv(m.j,null),m.g.ea(m.A)),m.F=Date.now(),uu(m)}Gv(c)}function pu(c){c.g&&(qf(c),c.g.cancel(),c.g=null)}function Uv(c){pu(c),c.v&&(o.clearTimeout(c.v),c.v=null),gu(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function mu(c){if(!Tv(c.h)&&!c.m){c.m=!0;var m=c.Ea;L||T(),V||(L(),V=!0),E.add(m,c),c.D=0}}function Ck(c,m){return Sv(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=m.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=Ke(d(c.Ea,c,m),Hv(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const O=new Ri(this,this.j,c);let F=this.o;if(this.U&&(F?(F=D(F),J(F,this.U)):F=this.U),this.u!==null||this.R||(O.J=F,F=null),this.S)e:{for(var m=0,y=0;y<this.i.length;y++){t:{var C=this.i[y];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(m+=C,m>4096){m=y;break e}if(m===4096||y===this.i.length-1){m=y+1;break e}}m=1e3}else m=1e3;m=Bv(this,O,m),y=Nr(this.J),it(y,"RID",c),it(y,"CVER",22),this.G&&it(y,"X-HTTP-Session-Id",this.G),hl(this,y),F&&(this.R?m="headers="+nl(jv(F))+"&"+m:this.u&&Bf(y,this.u,F)),Ff(this.h,O),this.Ra&&it(y,"TYPE","init"),this.S?(it(y,"$req",m),it(y,"SID","null"),O.U=!0,Lf(O,y,null)):Lf(O,y,m),this.I=2}}else this.I==3&&(c?zv(this,c):this.i.length==0||Tv(this.h)||zv(this))};function zv(c,m){var y;m?y=m.l:y=c.V++;const C=Nr(c.J);it(C,"SID",c.M),it(C,"RID",y),it(C,"AID",c.K),hl(c,C),c.u&&c.o&&Bf(C,c.u,c.o),y=new Ri(c,c.j,y,c.D+1),c.u===null&&(y.J=c.o),m&&(c.i=m.G.concat(c.i)),m=Bv(c,y,1e3),y.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Ff(c.h,y),Lf(y,C,m)}function hl(c,m){c.H&&G(c.H,function(y,C){it(m,C,y)}),c.l&&G({},function(y,C){it(m,C,y)})}function Bv(c,m,y){y=Math.min(c.i.length,y);const C=c.l?d(c.l.Ka,c.l,c):null;e:{var O=c.i;let Re=-1;for(;;){const Nt=["count="+y];Re==-1?y>0?(Re=O[0].g,Nt.push("ofs="+Re)):Re=0:Nt.push("ofs="+Re);let Qe=!0;for(let Vt=0;Vt<y;Vt++){var F=O[Vt].g;const Dr=O[Vt].map;if(F-=Re,F<0)Re=Math.max(0,O[Vt].g-100),Qe=!1;else try{F="req"+F+"_"||"";try{var te=Dr instanceof Map?Dr:Object.entries(Dr);for(const[Us,ji]of te){let Li=ji;a(ji)&&(Li=Ee(ji)),Nt.push(F+Us+"="+encodeURIComponent(Li))}}catch(Us){throw Nt.push(F+"type="+encodeURIComponent("_badmap")),Us}}catch{C&&C(Dr)}}if(Qe){te=Nt.join("&");break e}}te=void 0}return c=c.i.splice(0,y),m.G=c,te}function $v(c){if(!c.g&&!c.v){c.Y=1;var m=c.Da;L||T(),V||(L(),V=!0),E.add(m,c),c.A=0}}function Wf(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=Ke(d(c.Da,c),Hv(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,Wv(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=Ke(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ye(10),pu(this),Wv(this))};function qf(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function Wv(c){c.g=new Ri(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var m=Nr(c.na);it(m,"RID","rpc"),it(m,"SID",c.M),it(m,"AID",c.K),it(m,"CI",c.F?"0":"1"),!c.F&&c.ia&&it(m,"TO",c.ia),it(m,"TYPE","xmlhttp"),hl(c,m),c.u&&c.o&&Bf(m,c.u,c.o),c.O&&(c.g.H=c.O);var y=c.g;c=c.ba,y.M=1,y.A=du(Nr(m)),y.u=null,y.R=!0,vv(y,c)}t.Va=function(){this.C!=null&&(this.C=null,pu(this),Wf(this),ye(19))};function gu(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function qv(c,m){var y=null;if(c.g==m){gu(c),qf(c),c.g=null;var C=2}else if(Of(c.h,m))y=m.G,Ev(c.h,m),C=1;else return;if(c.I!=0){if(m.o)if(C==1){y=m.u?m.u.length:0,m=Date.now()-m.F;var O=c.D;C=le(),qe(C,new _t(C,y)),mu(c)}else $v(c);else if(O=m.m,O==3||O==0&&m.X>0||!(C==1&&Ck(c,m)||C==2&&Wf(c)))switch(y&&y.length>0&&(m=c.h,m.i=m.i.concat(y)),O){case 1:Fs(c,5);break;case 4:Fs(c,10);break;case 3:Fs(c,6);break;default:Fs(c,2)}}}function Hv(c,m){let y=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(y*=2),y*m}function Fs(c,m){if(c.j.info("Error code "+m),m==2){var y=d(c.bb,c),C=c.Ua;const O=!C;C=new Pi(C||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||il(C,"https"),du(C),O?_k(C.toString(),y):Tk(C.toString(),y)}else ye(2);c.I=0,c.l&&c.l.pa(m),Gv(c),Uv(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),ye(2)):(this.j.info("Failed to ping google.com"),ye(1))};function Gv(c){if(c.I=0,c.ja=[],c.l){const m=bv(c.h);(m.length!=0||c.i.length!=0)&&(x(c.ja,m),x(c.ja,c.i),c.h.i.length=0,g(c.i),c.i.length=0),c.l.oa()}}function Kv(c,m,y){var C=y instanceof Pi?Nr(y):new Pi(y);if(C.g!="")m&&(C.g=m+"."+C.g),sl(C,C.u);else{var O=o.location;C=O.protocol,m=m?m+"."+O.hostname:O.hostname,O=+O.port;const F=new Pi(null);C&&il(F,C),m&&(F.g=m),O&&sl(F,O),y&&(F.h=y),C=F}return y=c.G,m=c.wa,y&&m&&it(C,y,m),it(C,"VER",c.ka),hl(c,C),C}function Qv(c,m,y){if(m&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return m=c.Aa&&!c.ma?new yt(new zf({ab:y})):new yt(c.ma),m.Fa(c.L),m}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yv(){}t=Yv.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function yu(){}yu.prototype.g=function(c,m){return new jn(c,m)};function jn(c,m){Ne.call(this),this.g=new Fv(m),this.l=c,this.h=m&&m.messageUrlParams||null,c=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(c?c["X-WebChannel-Content-Type"]=m.messageContentType:c={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.sa&&(c?c["X-WebChannel-Client-Profile"]=m.sa:c={"X-WebChannel-Client-Profile":m.sa}),this.g.U=c,(c=m&&m.Qb)&&!b(c)&&(this.g.u=c),this.A=m&&m.supportsCrossDomainXhr||!1,this.v=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!b(m)&&(this.g.G=m,c=this.h,c!==null&&m in c&&(c=this.h,m in c&&delete c[m])),this.j=new Mo(this)}f(jn,Ne),jn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},jn.prototype.close=function(){$f(this.g)},jn.prototype.o=function(c){var m=this.g;if(typeof c=="string"){var y={};y.__data__=c,c=y}else this.v&&(y={},y.__data__=Ee(c),c=y);m.i.push(new fk(m.Ya++,c)),m.I==3&&mu(m)},jn.prototype.N=function(){this.g.l=null,delete this.j,$f(this.g),delete this.g,jn.Z.N.call(this)};function Xv(c){$e.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var m=c.__sm__;if(m){e:{for(const y in m){c=y;break e}c=void 0}(this.i=c)&&(c=this.i,m=m!==null&&c in m?m[c]:void 0),this.data=m}else this.data=c}f(Xv,$e);function Jv(){hn.call(this),this.status=1}f(Jv,hn);function Mo(c){this.g=c}f(Mo,Yv),Mo.prototype.ra=function(){qe(this.g,"a")},Mo.prototype.qa=function(c){qe(this.g,new Xv(c))},Mo.prototype.pa=function(c){qe(this.g,new Jv)},Mo.prototype.oa=function(){qe(this.g,"b")},yu.prototype.createWebChannel=yu.prototype.g,jn.prototype.send=jn.prototype.o,jn.prototype.open=jn.prototype.m,jn.prototype.close=jn.prototype.close,n2=function(){return new yu},t2=function(){return le()},e2=Je,ug={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},cu.NO_ERROR=0,cu.TIMEOUT=8,cu.HTTP_ERROR=6,dd=cu,pv.COMPLETE="complete",Zb=pv,nt.EventType=rt,rt.OPEN="a",rt.CLOSE="b",rt.ERROR="c",rt.MESSAGE="d",Ne.prototype.listen=Ne.prototype.J,Pl=nt,yt.prototype.listenOnce=yt.prototype.K,yt.prototype.getLastError=yt.prototype.Ha,yt.prototype.getLastErrorCode=yt.prototype.ya,yt.prototype.getStatus=yt.prototype.ca,yt.prototype.getResponseJson=yt.prototype.La,yt.prototype.getResponseText=yt.prototype.la,yt.prototype.send=yt.prototype.ea,yt.prototype.setWithCredentials=yt.prototype.Fa,Jb=yt}).apply(typeof Uu<"u"?Uu:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let an=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};an.UNAUTHENTICATED=new an(null),an.GOOGLE_CREDENTIALS=new an("google-credentials-uid"),an.FIRST_PARTY=new an("first-party-uid"),an.MOCK_USER=new an("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ya="12.8.0";function eL(t){Ya=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo=new o0("@firebase/firestore");function zo(){return xo.logLevel}function ce(t,...e){if(xo.logLevel<=Me.DEBUG){const n=e.map(l0);xo.debug(`Firestore (${Ya}): ${t}`,...n)}}function bi(t,...e){if(xo.logLevel<=Me.ERROR){const n=e.map(l0);xo.error(`Firestore (${Ya}): ${t}`,...n)}}function Va(t,...e){if(xo.logLevel<=Me.WARN){const n=e.map(l0);xo.warn(`Firestore (${Ya}): ${t}`,...n)}}function l0(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,r2(t,r,n)}function r2(t,e,n){let r=`FIRESTORE (${Ya}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw bi(r),new Error(r)}function Be(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||r2(e,i,r)}function Ce(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oe extends Ar{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class tL{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(an.UNAUTHENTICATED))}shutdown(){}}class nL{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class rL{constructor(e){this.t=e,this.currentUser=an.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Be(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new gi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new gi,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new gi)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Be(typeof r.accessToken=="string",31837,{l:r}),new i2(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Be(e===null||typeof e=="string",2055,{h:e}),new an(e)}}class iL{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=an.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class sL{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new iL(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(an.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Sw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class oL{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Be(this.o===void 0,3512);const r=s=>{s.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ce("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Sw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Be(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Sw(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aL(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=aL(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Ve(t,e){return t<e?-1:t>e?1:0}function dg(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return Op(i)===Op(s)?Ve(i,s):Op(i)?1:-1}return Ve(t.length,e.length)}const lL=55296,cL=57343;function Op(t){const e=t.charCodeAt(0);return e>=lL&&e<=cL}function Oa(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ew="__name__";class Mr{constructor(e,n,r){n===void 0?n=0:n>e.length&&Se(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Se(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Mr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Mr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Mr.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Ve(e.length,n.length)}static compareSegments(e,n){const r=Mr.isNumericId(e),i=Mr.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Mr.extractNumericId(e).compare(Mr.extractNumericId(n)):dg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return gs.fromString(e.substring(4,e.length-2))}}class Ze extends Mr{construct(e,n,r){return new Ze(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new oe(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Ze(n)}static emptyPath(){return new Ze([])}}const uL=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Kt extends Mr{construct(e,n,r){return new Kt(e,n,r)}static isValidIdentifier(e){return uL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Kt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ew}static keyField(){return new Kt([Ew])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new oe(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new oe(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new oe(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new oe(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Kt(n)}static emptyPath(){return new Kt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(Ze.fromString(e))}static fromName(e){return new we(Ze.fromString(e).popFirst(5))}static empty(){return new we(Ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ze.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new Ze(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s2(t,e,n){if(!n)throw new oe(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function dL(t,e,n,r){if(e===!0&&r===!0)throw new oe(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function bw(t){if(!we.isDocumentKey(t))throw new oe(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Iw(t){if(we.isDocumentKey(t))throw new oe(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function o2(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function af(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Se(12329,{type:typeof t})}function or(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new oe(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=af(t);throw new oe(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Yc(t,e){if(!o2(t))throw new oe(B.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new oe(B.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cw=-62135596800,kw=1e6;class at{static now(){return at.fromMillis(Date.now())}static fromDate(e){return at.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*kw);return new at(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new oe(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new oe(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Cw)throw new oe(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new oe(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/kw}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:at._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yc(e,at._jsonSchema))return new at(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Cw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}at._jsonSchemaVersion="firestore/timestamp/1.0",at._jsonSchema={type:Pt("string",at._jsonSchemaVersion),seconds:Pt("number"),nanoseconds:Pt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{static fromTimestamp(e){return new Ie(e)}static min(){return new Ie(new at(0,0))}static max(){return new Ie(new at(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sc=-1;function hL(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ie.fromTimestamp(r===1e9?new at(n+1,0):new at(n,r));return new Ss(i,we.empty(),e)}function fL(t){return new Ss(t.readTime,t.key,Sc)}class Ss{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ss(Ie.min(),we.empty(),Sc)}static max(){return new Ss(Ie.max(),we.empty(),Sc)}}function pL(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=we.comparator(t.documentKey,e.documentKey),n!==0?n:Ve(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mL="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gL{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xa(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==mL)throw t;ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Se(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new W((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof W?n:W.resolve(n)}catch(n){return W.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):W.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):W.reject(n)}static resolve(e){return new W((n,r)=>{n(e)})}static reject(e){return new W((n,r)=>{r(e)})}static waitFor(e){return new W((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=W.resolve(!1);for(const r of e)n=n.next(i=>i?W.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new W((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new W((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function yL(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ja(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}lf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0=-1;function cf(t){return t==null}function ih(t){return t===0&&1/t==-1/0}function vL(t){return typeof t=="number"&&Number.isInteger(t)&&!ih(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2="";function xL(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Aw(e)),e=wL(t.get(n),e);return Aw(e)}function wL(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case a2:n+="";break;default:n+=s}}return n}function Aw(t){return t+a2+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rw(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ds(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function l2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e,n){this.comparator=e,this.root=n||Ht.EMPTY}insert(e,n){return new gt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ht.BLACK,null,null))}remove(e){return new gt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ht.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zu(this.root,e,this.comparator,!1)}getReverseIterator(){return new zu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zu(this.root,e,this.comparator,!0)}}class zu{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ht{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ht.RED,this.left=i??Ht.EMPTY,this.right=s??Ht.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ht(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ht.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ht.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ht.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ht.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Se(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Se(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Se(27949);return e+(this.isRed()?0:1)}}Ht.EMPTY=null,Ht.RED=!0,Ht.BLACK=!1;Ht.EMPTY=new class{constructor(){this.size=0}get key(){throw Se(57766)}get value(){throw Se(16141)}get color(){throw Se(16727)}get left(){throw Se(29726)}get right(){throw Se(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ht(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.comparator=e,this.data=new gt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Pw(this.data.getIterator())}getIteratorFrom(e){return new Pw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Mt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Mt(this.comparator);return n.data=e,n}}class Pw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.fields=e,e.sort(Kt.comparator)}static empty(){return new On([])}unionWith(e){let n=new Mt(Kt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new On(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Oa(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new c2("Invalid base64 string: "+s):s}}(e);return new Jt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Jt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jt.EMPTY_BYTE_STRING=new Jt("");const _L=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Es(t){if(Be(!!t,39018),typeof t=="string"){let e=0;const n=_L.exec(t);if(Be(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:St(t.seconds),nanos:St(t.nanos)}}function St(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function bs(t){return typeof t=="string"?Jt.fromBase64String(t):Jt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2="server_timestamp",d2="__type__",h2="__previous_value__",f2="__local_write_time__";function d0(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[d2])==null?void 0:r.stringValue)===u2}function uf(t){const e=t.mapValue.fields[h2];return d0(e)?uf(e):e}function Ec(t){const e=Es(t.mapValue.fields[f2].timestampValue);return new at(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(e,n,r,i,s,o,a,l,d,h,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=h,this.apiKey=f}}const sh="(default)";class bc{constructor(e,n){this.projectId=e,this.database=n||sh}static empty(){return new bc("","")}get isDefaultDatabase(){return this.database===sh}isEqual(e){return e instanceof bc&&e.projectId===this.projectId&&e.database===this.database}}function SL(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new oe(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bc(t.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2="__type__",m2="__max__",Bu={mapValue:{fields:{__type__:{stringValue:m2}}}},g2="__vector__",oh="value";function Is(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?d0(t)?4:bL(t)?9007199254740991:EL(t)?10:11:Se(28295,{value:t})}function Jr(t,e){if(t===e)return!0;const n=Is(t);if(n!==Is(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ec(t).isEqual(Ec(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Es(i.timestampValue),a=Es(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return bs(i.bytesValue).isEqual(bs(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return St(i.geoPointValue.latitude)===St(s.geoPointValue.latitude)&&St(i.geoPointValue.longitude)===St(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return St(i.integerValue)===St(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=St(i.doubleValue),a=St(s.doubleValue);return o===a?ih(o)===ih(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Oa(t.arrayValue.values||[],e.arrayValue.values||[],Jr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Rw(o)!==Rw(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Jr(o[l],a[l])))return!1;return!0}(t,e);default:return Se(52216,{left:t})}}function Ic(t,e){return(t.values||[]).find(n=>Jr(n,e))!==void 0}function Fa(t,e){if(t===e)return 0;const n=Is(t),r=Is(e);if(n!==r)return Ve(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ve(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=St(s.integerValue||s.doubleValue),l=St(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return Nw(t.timestampValue,e.timestampValue);case 4:return Nw(Ec(t),Ec(e));case 5:return dg(t.stringValue,e.stringValue);case 6:return function(s,o){const a=bs(s),l=bs(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=Ve(a[d],l[d]);if(h!==0)return h}return Ve(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ve(St(s.latitude),St(o.latitude));return a!==0?a:Ve(St(s.longitude),St(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Dw(t.arrayValue,e.arrayValue);case 10:return function(s,o){var p,g,x,_;const a=s.fields||{},l=o.fields||{},d=(p=a[oh])==null?void 0:p.arrayValue,h=(g=l[oh])==null?void 0:g.arrayValue,f=Ve(((x=d==null?void 0:d.values)==null?void 0:x.length)||0,((_=h==null?void 0:h.values)==null?void 0:_.length)||0);return f!==0?f:Dw(d,h)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Bu.mapValue&&o===Bu.mapValue)return 0;if(s===Bu.mapValue)return 1;if(o===Bu.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const p=dg(l[f],h[f]);if(p!==0)return p;const g=Fa(a[l[f]],d[h[f]]);if(g!==0)return g}return Ve(l.length,h.length)}(t.mapValue,e.mapValue);default:throw Se(23264,{he:n})}}function Nw(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ve(t,e);const n=Es(t),r=Es(e),i=Ve(n.seconds,r.seconds);return i!==0?i:Ve(n.nanos,r.nanos)}function Dw(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Fa(n[i],r[i]);if(s)return s}return Ve(n.length,r.length)}function Ua(t){return hg(t)}function hg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Es(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return bs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return we.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=hg(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${hg(n.fields[o])}`;return i+"}"}(t.mapValue):Se(61005,{value:t})}function hd(t){switch(Is(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=uf(t);return e?16+hd(e):16;case 5:return 2*t.stringValue.length;case 6:return bs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+hd(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return Ds(r.fields,(s,o)=>{i+=s.length+hd(o)}),i}(t.mapValue);default:throw Se(13486,{value:t})}}function jw(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function fg(t){return!!t&&"integerValue"in t}function h0(t){return!!t&&"arrayValue"in t}function Lw(t){return!!t&&"nullValue"in t}function Mw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function fd(t){return!!t&&"mapValue"in t}function EL(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[p2])==null?void 0:r.stringValue)===g2}function Ql(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ds(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ql(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ql(t.arrayValue.values[n]);return e}return{...t}}function bL(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===m2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this.value=e}static empty(){return new bn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!fd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ql(n)}setAll(e){let n=Kt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Ql(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());fd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Jr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];fd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ds(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new bn(Ql(this.value))}}function y2(t){const e=[];return Ds(t.fields,(n,r)=>{const i=new Kt([n]);if(fd(r)){const s=y2(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new On(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new cn(e,0,Ie.min(),Ie.min(),Ie.min(),bn.empty(),0)}static newFoundDocument(e,n,r,i){return new cn(e,1,n,Ie.min(),r,i,0)}static newNoDocument(e,n){return new cn(e,2,n,Ie.min(),Ie.min(),bn.empty(),0)}static newUnknownDocument(e,n){return new cn(e,3,n,Ie.min(),Ie.min(),bn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=bn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=bn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof cn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new cn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e,n){this.position=e,this.inclusive=n}}function Vw(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=we.comparator(we.fromName(o.referenceValue),n.key):r=Fa(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ow(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Jr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e,n="asc"){this.field=e,this.dir=n}}function IL(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{}class Rt extends v2{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new kL(e,n,r):n==="array-contains"?new PL(e,r):n==="in"?new NL(e,r):n==="not-in"?new DL(e,r):n==="array-contains-any"?new jL(e,r):new Rt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new AL(e,r):new RL(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Fa(n,this.value)):n!==null&&Is(this.value)===Is(n)&&this.matchesComparison(Fa(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Se(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class kr extends v2{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new kr(e,n)}matches(e){return x2(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function x2(t){return t.op==="and"}function w2(t){return CL(t)&&x2(t)}function CL(t){for(const e of t.filters)if(e instanceof kr)return!1;return!0}function pg(t){if(t instanceof Rt)return t.field.canonicalString()+t.op.toString()+Ua(t.value);if(w2(t))return t.filters.map(e=>pg(e)).join(",");{const e=t.filters.map(n=>pg(n)).join(",");return`${t.op}(${e})`}}function _2(t,e){return t instanceof Rt?function(r,i){return i instanceof Rt&&r.op===i.op&&r.field.isEqual(i.field)&&Jr(r.value,i.value)}(t,e):t instanceof kr?function(r,i){return i instanceof kr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&_2(o,i.filters[a]),!0):!1}(t,e):void Se(19439)}function T2(t){return t instanceof Rt?function(n){return`${n.field.canonicalString()} ${n.op} ${Ua(n.value)}`}(t):t instanceof kr?function(n){return n.op.toString()+" {"+n.getFilters().map(T2).join(" ,")+"}"}(t):"Filter"}class kL extends Rt{constructor(e,n,r){super(e,n,r),this.key=we.fromName(r.referenceValue)}matches(e){const n=we.comparator(e.key,this.key);return this.matchesComparison(n)}}class AL extends Rt{constructor(e,n){super(e,"in",n),this.keys=S2("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class RL extends Rt{constructor(e,n){super(e,"not-in",n),this.keys=S2("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function S2(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>we.fromName(r.referenceValue))}class PL extends Rt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return h0(n)&&Ic(n.arrayValue,this.value)}}class NL extends Rt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ic(this.value.arrayValue,n)}}class DL extends Rt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ic(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Ic(this.value.arrayValue,n)}}class jL extends Rt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!h0(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ic(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Fw(t,e=null,n=[],r=[],i=null,s=null,o=null){return new LL(t,e,n,r,i,s,o)}function f0(t){const e=Ce(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>pg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),cf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ua(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ua(r)).join(",")),e.Te=n}return e.Te}function p0(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!IL(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!_2(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ow(t.startAt,e.startAt)&&Ow(t.endAt,e.endAt)}function mg(t){return we.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function ML(t,e,n,r,i,s,o,a){return new Xc(t,e,n,r,i,s,o,a)}function df(t){return new Xc(t)}function Uw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function VL(t){return we.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function E2(t){return t.collectionGroup!==null}function Yl(t){const e=Ce(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Mt(Kt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new lh(s,r))}),n.has(Kt.keyField().canonicalString())||e.Ie.push(new lh(Kt.keyField(),r))}return e.Ie}function Gr(t){const e=Ce(t);return e.Ee||(e.Ee=OL(e,Yl(t))),e.Ee}function OL(t,e){if(t.limitType==="F")return Fw(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new lh(i.field,s)});const n=t.endAt?new ah(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ah(t.startAt.position,t.startAt.inclusive):null;return Fw(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function gg(t,e){const n=t.filters.concat([e]);return new Xc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function yg(t,e,n){return new Xc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function hf(t,e){return p0(Gr(t),Gr(e))&&t.limitType===e.limitType}function b2(t){return`${f0(Gr(t))}|lt:${t.limitType}`}function Bo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>T2(i)).join(", ")}]`),cf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Ua(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Ua(i)).join(",")),`Target(${r})`}(Gr(t))}; limitType=${t.limitType})`}function ff(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):we.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Yl(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const d=Vw(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,Yl(r),i)||r.endAt&&!function(o,a,l){const d=Vw(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,Yl(r),i))}(t,e)}function FL(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function I2(t){return(e,n)=>{let r=!1;for(const i of Yl(t)){const s=UL(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function UL(t,e,n){const r=t.field.isKeyField()?we.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),d=a.data.field(s);return l!==null&&d!==null?Fa(l,d):Se(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Se(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ds(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return l2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zL=new gt(we.comparator);function Ii(){return zL}const C2=new gt(we.comparator);function Nl(...t){let e=C2;for(const n of t)e=e.insert(n.key,n);return e}function k2(t){let e=C2;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function to(){return Xl()}function A2(){return Xl()}function Xl(){return new Ro(t=>t.toString(),(t,e)=>t.isEqual(e))}const BL=new gt(we.comparator),$L=new Mt(we.comparator);function Oe(...t){let e=$L;for(const n of t)e=e.add(n);return e}const WL=new Mt(Ve);function qL(){return WL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ih(e)?"-0":e}}function R2(t){return{integerValue:""+t}}function HL(t,e){return vL(e)?R2(e):m0(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(){this._=void 0}}function GL(t,e,n){return t instanceof Cc?function(i,s){const o={fields:{[d2]:{stringValue:u2},[f2]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&d0(s)&&(s=uf(s)),s&&(o.fields[h2]=s),{mapValue:o}}(n,e):t instanceof kc?N2(t,e):t instanceof Ac?D2(t,e):function(i,s){const o=P2(i,s),a=zw(o)+zw(i.Ae);return fg(o)&&fg(i.Ae)?R2(a):m0(i.serializer,a)}(t,e)}function KL(t,e,n){return t instanceof kc?N2(t,e):t instanceof Ac?D2(t,e):n}function P2(t,e){return t instanceof ch?function(r){return fg(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Cc extends pf{}class kc extends pf{constructor(e){super(),this.elements=e}}function N2(t,e){const n=j2(e);for(const r of t.elements)n.some(i=>Jr(i,r))||n.push(r);return{arrayValue:{values:n}}}class Ac extends pf{constructor(e){super(),this.elements=e}}function D2(t,e){let n=j2(e);for(const r of t.elements)n=n.filter(i=>!Jr(i,r));return{arrayValue:{values:n}}}class ch extends pf{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function zw(t){return St(t.integerValue||t.doubleValue)}function j2(t){return h0(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QL{constructor(e,n){this.field=e,this.transform=n}}function YL(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof kc&&i instanceof kc||r instanceof Ac&&i instanceof Ac?Oa(r.elements,i.elements,Jr):r instanceof ch&&i instanceof ch?Jr(r.Ae,i.Ae):r instanceof Cc&&i instanceof Cc}(t.transform,e.transform)}class XL{constructor(e,n){this.version=e,this.transformResults=n}}class Kr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Kr}static exists(e){return new Kr(void 0,e)}static updateTime(e){return new Kr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class mf{}function L2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new V2(t.key,Kr.none()):new Jc(t.key,t.data,Kr.none());{const n=t.data,r=bn.empty();let i=new Mt(Kt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new js(t.key,r,new On(i.toArray()),Kr.none())}}function JL(t,e,n){t instanceof Jc?function(i,s,o){const a=i.value.clone(),l=$w(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof js?function(i,s,o){if(!pd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=$w(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(M2(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Jl(t,e,n,r){return t instanceof Jc?function(s,o,a,l){if(!pd(s.precondition,o))return a;const d=s.value.clone(),h=Ww(s.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof js?function(s,o,a,l){if(!pd(s.precondition,o))return a;const d=Ww(s.fieldTransforms,l,o),h=o.data;return h.setAll(M2(s)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,a){return pd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function ZL(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=P2(r.transform,i||null);s!=null&&(n===null&&(n=bn.empty()),n.set(r.field,s))}return n||null}function Bw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Oa(r,i,(s,o)=>YL(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Jc extends mf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class js extends mf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function M2(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function $w(t,e,n){const r=new Map;Be(t.length===n.length,32656,{Ve:n.length,de:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,KL(o,a,n[i]))}return r}function Ww(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,GL(s,o,e))}return r}class V2 extends mf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class eM extends mf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&JL(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Jl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Jl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=A2();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=L2(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(Ie.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Oe())}isEqual(e){return this.batchId===e.batchId&&Oa(this.mutations,e.mutations,(n,r)=>Bw(n,r))&&Oa(this.baseMutations,e.baseMutations,(n,r)=>Bw(n,r))}}class g0{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Be(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return BL}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new g0(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct,Fe;function iM(t){switch(t){case B.OK:return Se(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return Se(15467,{code:t})}}function O2(t){if(t===void 0)return bi("GRPC error has no .code"),B.UNKNOWN;switch(t){case Ct.OK:return B.OK;case Ct.CANCELLED:return B.CANCELLED;case Ct.UNKNOWN:return B.UNKNOWN;case Ct.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case Ct.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case Ct.INTERNAL:return B.INTERNAL;case Ct.UNAVAILABLE:return B.UNAVAILABLE;case Ct.UNAUTHENTICATED:return B.UNAUTHENTICATED;case Ct.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case Ct.NOT_FOUND:return B.NOT_FOUND;case Ct.ALREADY_EXISTS:return B.ALREADY_EXISTS;case Ct.PERMISSION_DENIED:return B.PERMISSION_DENIED;case Ct.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case Ct.ABORTED:return B.ABORTED;case Ct.OUT_OF_RANGE:return B.OUT_OF_RANGE;case Ct.UNIMPLEMENTED:return B.UNIMPLEMENTED;case Ct.DATA_LOSS:return B.DATA_LOSS;default:return Se(39323,{code:t})}}(Fe=Ct||(Ct={}))[Fe.OK=0]="OK",Fe[Fe.CANCELLED=1]="CANCELLED",Fe[Fe.UNKNOWN=2]="UNKNOWN",Fe[Fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Fe[Fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Fe[Fe.NOT_FOUND=5]="NOT_FOUND",Fe[Fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Fe[Fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Fe[Fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Fe[Fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Fe[Fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Fe[Fe.ABORTED=10]="ABORTED",Fe[Fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Fe[Fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Fe[Fe.INTERNAL=13]="INTERNAL",Fe[Fe.UNAVAILABLE=14]="UNAVAILABLE",Fe[Fe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oM=new gs([4294967295,4294967295],0);function qw(t){const e=sM().encode(t),n=new Xb;return n.update(e),new Uint8Array(n.digest())}function Hw(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new gs([n,r],0),new gs([i,s],0)]}class y0{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Dl(`Invalid padding: ${n}`);if(r<0)throw new Dl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Dl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Dl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=gs.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(gs.fromNumber(r)));return i.compare(oM)===1&&(i=new gs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=qw(e),[r,i]=Hw(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new y0(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=qw(e),[r,i]=Hw(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Dl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Zc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new gf(Ie.min(),i,new gt(Ve),Ii(),Oe())}}class Zc{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Zc(r,n,Oe(),Oe(),Oe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e,n,r,i){this.Se=e,this.removedTargetIds=n,this.key=r,this.De=i}}class F2{constructor(e,n){this.targetId=e,this.Ce=n}}class U2{constructor(e,n,r=Jt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Gw{constructor(){this.ve=0,this.Fe=Kw(),this.Me=Jt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Oe(),n=Oe(),r=Oe();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Se(38017,{changeType:s})}}),new Zc(this.Me,this.xe,e,n,r)}Ke(){this.Oe=!1,this.Fe=Kw()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Be(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class aM{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ii(),this.He=$u(),this.Je=$u(),this.Ze=new gt(Ve)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Se(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(mg(s))if(r===0){const o=new we(s.path);this.et(n,o,cn.newNoDocument(o,Ie.min()))}else Be(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=bs(r).toUint8Array()}catch(l){if(l instanceof c2)return Va("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new y0(o,i,s)}catch(l){return Va(l instanceof Dl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&mg(a.target)){const l=new we(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,cn.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.Ke())}});let r=Oe();this.Je.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.ot(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new gf(e,n,this.Ze,this.je,r);return this.je=Ii(),this.He=$u(),this.Je=$u(),this.Ze=new gt(Ve),i}Ye(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,r),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.qe(n,1):i.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new Gw,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new Mt(Ve),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new Mt(Ve),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ce("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Gw),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function $u(){return new gt(we.comparator)}function Kw(){return new gt(we.comparator)}const lM=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),cM=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),uM=(()=>({and:"AND",or:"OR"}))();class dM{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function vg(t,e){return t.useProto3Json||cf(e)?e:{value:e}}function uh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function z2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function hM(t,e){return uh(t,e.toTimestamp())}function Qr(t){return Be(!!t,49232),Ie.fromTimestamp(function(n){const r=Es(n);return new at(r.seconds,r.nanos)}(t))}function v0(t,e){return xg(t,e).canonicalString()}function xg(t,e){const n=function(i){return new Ze(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function B2(t){const e=Ze.fromString(t);return Be(G2(e),10190,{key:e.toString()}),e}function wg(t,e){return v0(t.databaseId,e.path)}function Fp(t,e){const n=B2(e);if(n.get(1)!==t.databaseId.projectId)throw new oe(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new oe(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new we(W2(n))}function $2(t,e){return v0(t.databaseId,e)}function fM(t){const e=B2(t);return e.length===4?Ze.emptyPath():W2(e)}function _g(t){return new Ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function W2(t){return Be(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Qw(t,e,n){return{name:wg(t,e),fields:n.value.mapValue.fields}}function pM(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Se(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,h){return d.useProto3Json?(Be(h===void 0||typeof h=="string",58123),Jt.fromBase64String(h||"")):(Be(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Jt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?B.UNKNOWN:O2(d.code);return new oe(h,d.message||"")}(o);n=new U2(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Fp(t,r.document.name),s=Qr(r.document.updateTime),o=r.document.createTime?Qr(r.document.createTime):Ie.min(),a=new bn({mapValue:{fields:r.document.fields}}),l=cn.newFoundDocument(i,s,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new md(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Fp(t,r.document),s=r.readTime?Qr(r.readTime):Ie.min(),o=cn.newNoDocument(i,s),a=r.removedTargetIds||[];n=new md([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Fp(t,r.document),s=r.removedTargetIds||[];n=new md([],s,i,null)}else{if(!("filter"in e))return Se(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new rM(i,s),a=r.targetId;n=new F2(a,o)}}return n}function mM(t,e){let n;if(e instanceof Jc)n={update:Qw(t,e.key,e.value)};else if(e instanceof V2)n={delete:wg(t,e.key)};else if(e instanceof js)n={update:Qw(t,e.key,e.data),updateMask:EM(e.fieldMask)};else{if(!(e instanceof eM))return Se(16599,{dt:e.type});n={verify:wg(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Cc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof kc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ac)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ch)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Se(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:hM(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Se(27497)}(t,e.precondition)),n}function gM(t,e){return t&&t.length>0?(Be(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?Qr(i.updateTime):Qr(s);return o.isEqual(Ie.min())&&(o=Qr(s)),new XL(o,i.transformResults||[])}(n,e))):[]}function yM(t,e){return{documents:[$2(t,e.path)]}}function vM(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=$2(t,i);const s=function(d){if(d.length!==0)return H2(kr.create(d,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(h=>function(p){return{field:$o(p.field),direction:_M(p.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=vg(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:i}}function xM(t){let e=fM(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Be(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(f){const p=q2(f);return p instanceof kr&&w2(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(p=>function(x){return new lh(Wo(x.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(p))}(n.orderBy));let a=null;n.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,cf(p)?null:p}(n.limit));let l=null;n.startAt&&(l=function(f){const p=!!f.before,g=f.values||[];return new ah(g,p)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const p=!f.before,g=f.values||[];return new ah(g,p)}(n.endAt)),ML(e,i,o,s,a,"F",l,d)}function wM(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Se(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function q2(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Wo(n.unaryFilter.field);return Rt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Wo(n.unaryFilter.field);return Rt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Wo(n.unaryFilter.field);return Rt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Wo(n.unaryFilter.field);return Rt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Se(61313);default:return Se(60726)}}(t):t.fieldFilter!==void 0?function(n){return Rt.create(Wo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Se(58110);default:return Se(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return kr.create(n.compositeFilter.filters.map(r=>q2(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Se(1026)}}(n.compositeFilter.op))}(t):Se(30097,{filter:t})}function _M(t){return lM[t]}function TM(t){return cM[t]}function SM(t){return uM[t]}function $o(t){return{fieldPath:t.canonicalString()}}function Wo(t){return Kt.fromServerFormat(t.fieldPath)}function H2(t){return t instanceof Rt?function(n){if(n.op==="=="){if(Mw(n.value))return{unaryFilter:{field:$o(n.field),op:"IS_NAN"}};if(Lw(n.value))return{unaryFilter:{field:$o(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Mw(n.value))return{unaryFilter:{field:$o(n.field),op:"IS_NOT_NAN"}};if(Lw(n.value))return{unaryFilter:{field:$o(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$o(n.field),op:TM(n.op),value:n.value}}}(t):t instanceof kr?function(n){const r=n.getFilters().map(i=>H2(i));return r.length===1?r[0]:{compositeFilter:{op:SM(n.op),filters:r}}}(t):Se(54877,{filter:t})}function EM(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function G2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function K2(t){return!!t&&typeof t._toProto=="function"&&t._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e,n,r,i,s=Ie.min(),o=Ie.min(),a=Jt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ns(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ns(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ns(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ns(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{constructor(e){this.yt=e}}function IM(t){const e=xM({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?yg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CM{constructor(){this.Sn=new kM}addToCollectionParentIndex(e,n){return this.Sn.add(n),W.resolve()}getCollectionParents(e,n){return W.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return W.resolve()}deleteFieldIndex(e,n){return W.resolve()}deleteAllFieldIndexes(e){return W.resolve()}createTargetIndexes(e,n){return W.resolve()}getDocumentsMatchingTarget(e,n){return W.resolve(null)}getIndexType(e,n){return W.resolve(0)}getFieldIndexes(e,n){return W.resolve([])}getNextCollectionGroupToUpdate(e){return W.resolve(null)}getMinOffset(e,n){return W.resolve(Ss.min())}getMinOffsetFromCollectionGroup(e,n){return W.resolve(Ss.min())}updateCollectionGroup(e,n,r){return W.resolve()}updateIndexEntries(e,n){return W.resolve()}}class kM{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Mt(Ze.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Mt(Ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Q2=41943040;class Sn{static withCacheSize(e){return new Sn(e,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sn.DEFAULT_COLLECTION_PERCENTILE=10,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sn.DEFAULT=new Sn(Q2,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sn.DISABLED=new Sn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new za(0)}static ar(){return new za(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw="LruGarbageCollector",AM=1048576;function Jw([t,e],[n,r]){const i=Ve(t,n);return i===0?Ve(e,r):i}class RM{constructor(e){this.Pr=e,this.buffer=new Mt(Jw),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Jw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class PM{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ce(Xw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ja(n)?ce(Xw,"Ignoring IndexedDB error during garbage collection: ",n):await Xa(n)}await this.Ar(3e5)})}}class NM{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return W.resolve(lf.ce);const r=new RM(n);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.mr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ce("LruGarbageCollector","Garbage collection skipped; disabled"),W.resolve(Yw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Yw):this.gr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let r,i,s,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),zo()<=Me.DEBUG&&ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),W.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function DM(t,e){return new NM(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(){this.changes=new Ro(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,cn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?W.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LM{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Jl(r.mutation,i,On.empty(),at.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Oe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Oe()){const i=to();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Nl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=to();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Oe()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Ii();const o=Xl(),a=function(){return Xl()}();return n.forEach((l,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof js)?s=s.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Jl(h.mutation,d,h.mutation.getFieldMask(),at.now())):o.set(d.key,On.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new LM(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Xl();let i=new gt((o,a)=>o-a),s=Oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||On.empty();h=a.applyToLocalView(d,h),r.set(l,h);const f=(i.get(a.batchId)||Oe()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,f=A2();h.forEach(p=>{if(!s.has(p)){const g=L2(n.get(p),r.get(p));g!==null&&f.set(p,g),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return W.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return VL(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):E2(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):W.resolve(to());let a=Sc,l=s;return o.next(d=>W.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(h)?W.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{l=l.insert(h,p)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,l,d,Oe())).next(h=>({batchId:a,changes:k2(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new we(n)).next(r=>{let i=Nl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Nl();return this.indexManager.getCollectionParents(e,s).next(a=>W.forEach(a,l=>{const d=function(f,p){return new Xc(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,cn.newInvalidDocument(h)))});let a=Nl();return o.forEach((l,d)=>{const h=s.get(l);h!==void 0&&Jl(h.mutation,d,On.empty(),at.now()),ff(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VM{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return W.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Qr(i.createTime)}}(n)),W.resolve()}getNamedQuery(e,n){return W.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,function(i){return{name:i.name,query:IM(i.bundledQuery),readTime:Qr(i.readTime)}}(n)),W.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(){this.overlays=new gt(we.comparator),this.Lr=new Map}getOverlay(e,n){return W.resolve(this.overlays.get(n))}getOverlays(e,n){const r=to();return W.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.bt(e,n,s)}),W.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Lr.delete(r)),W.resolve()}getOverlaysForCollection(e,n,r){const i=to(),s=n.length+1,o=new we(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return W.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new gt((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=s.get(d.largestBatchId);h===null&&(h=to(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=to(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=i)););return W.resolve(a)}bt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new nM(n,r));let s=this.Lr.get(n);s===void 0&&(s=Oe(),this.Lr.set(n,s)),this.Lr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FM{constructor(){this.sessionToken=Jt.EMPTY_BYTE_STRING}getSessionToken(e){return W.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,W.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(){this.kr=new Mt(Ot.Kr),this.qr=new Mt(Ot.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const r=new Ot(e,n);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new Ot(e,n))}Qr(e,n){e.forEach(r=>this.removeReference(r,n))}Gr(e){const n=new we(new Ze([])),r=new Ot(n,e),i=new Ot(n,e+1),s=[];return this.qr.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new we(new Ze([])),r=new Ot(n,e),i=new Ot(n,e+1);let s=Oe();return this.qr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Ot(e,0),r=this.kr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ot{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return we.comparator(e.key,n.key)||Ve(e.Hr,n.Hr)}static Ur(e,n){return Ve(e.Hr,n.Hr)||we.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new Mt(Ot.Kr)}checkEmpty(e){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new tM(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Jr=this.Jr.add(new Ot(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return W.resolve(o)}lookupMutationBatch(e,n){return W.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Xr(r),s=i<0?0:i;return W.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?u0:this.Yn-1)}getAllMutationBatches(e){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ot(n,0),i=new Ot(n,Number.POSITIVE_INFINITY),s=[];return this.Jr.forEachInRange([r,i],o=>{const a=this.Zr(o.Hr);s.push(a)}),W.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Mt(Ve);return n.forEach(i=>{const s=new Ot(i,0),o=new Ot(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([s,o],a=>{r=r.add(a.Hr)})}),W.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;we.isDocumentKey(s)||(s=s.child(""));const o=new Ot(new we(s),0);let a=new Mt(Ve);return this.Jr.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(a=a.add(l.Hr)),!0)},o),W.resolve(this.Yr(a))}Yr(e){const n=[];return e.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Be(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return W.forEach(n.mutations,i=>{const s=new Ot(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,n){const r=new Ot(n,0),i=this.Jr.firstAfterOrEqual(r);return W.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,W.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{constructor(e){this.ti=e,this.docs=function(){return new gt(we.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ti(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return W.resolve(r?r.document.mutableCopy():cn.newInvalidDocument(n))}getEntries(e,n){let r=Ii();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():cn.newInvalidDocument(i))}),W.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Ii();const o=n.path,a=new we(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||pL(fL(h),r)<=0||(i.has(h.key)||ff(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return W.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Se(9500)}ni(e,n){return W.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new BM(this)}getSize(e){return W.resolve(this.size)}}class BM extends jM{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)}),W.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(e){this.persistence=e,this.ri=new Ro(n=>f0(n),p0),this.lastRemoteSnapshotVersion=Ie.min(),this.highestTargetId=0,this.ii=0,this.si=new x0,this.targetCount=0,this.oi=za._r()}forEachTarget(e,n){return this.ri.forEach((r,i)=>n(i)),W.resolve()}getLastRemoteSnapshotVersion(e){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return W.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ii&&(this.ii=n),W.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new za(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,W.resolve()}updateTargetData(e,n){return this.lr(n),W.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,W.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.ri.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),W.waitFor(s).next(()=>i)}getTargetCount(e){return W.resolve(this.targetCount)}getTargetData(e,n){const r=this.ri.get(n)||null;return W.resolve(r)}addMatchingKeys(e,n,r){return this.si.$r(n,r),W.resolve()}removeMatchingKeys(e,n,r){this.si.Qr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),W.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),W.resolve()}getMatchingKeysForTargetId(e,n){const r=this.si.jr(n);return W.resolve(r)}containsKey(e,n){return W.resolve(this.si.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e,n){this._i={},this.overlays={},this.ai=new lf(0),this.ui=!1,this.ui=!0,this.ci=new FM,this.referenceDelegate=e(this),this.li=new $M(this),this.indexManager=new CM,this.remoteDocumentCache=function(i){return new zM(i)}(r=>this.referenceDelegate.hi(r)),this.serializer=new bM(n),this.Pi=new VM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new OM,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this._i[e.toKey()];return r||(r=new UM(n,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,r){ce("MemoryPersistence","Starting transaction:",e);const i=new WM(this.ai.next());return this.referenceDelegate.Ti(),r(i).next(s=>this.referenceDelegate.Ii(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,n){return W.or(Object.values(this._i).map(r=>()=>r.containsKey(e,n)))}}class WM extends gL{constructor(e){super(),this.currentSequenceNumber=e}}class w0{constructor(e){this.persistence=e,this.Ri=new x0,this.Ai=null}static Vi(e){return new w0(e)}get di(){if(this.Ai)return this.Ai;throw Se(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.di.delete(r.toString()),W.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.di.add(r.toString()),W.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),W.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach(i=>this.di.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.di.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.di,r=>{const i=we.fromPath(r);return this.mi(e,i).next(s=>{s||n.removeEntry(i,Ie.min())})}).next(()=>(this.Ai=null,n.apply(e)))}updateLimboDocument(e,n){return this.mi(e,n).next(r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())})}hi(e){return 0}mi(e,n){return W.or([()=>W.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class dh{constructor(e,n){this.persistence=e,this.fi=new Ro(r=>xL(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=DM(this,n)}static Vi(e,n){return new dh(e,n)}Ti(){}Ii(e){return W.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}mr(e,n){return W.forEach(this.fi,(r,i)=>this.wr(e,r,i).next(s=>s?W.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ni(e,o=>this.wr(e,o,n).next(a=>{a||(r++,s.removeEntry(o,Ie.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),W.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),W.resolve()}removeReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),W.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),W.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=hd(e.data.value)),n}wr(e,n,r){return W.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.fi.get(n);return W.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Ts=r,this.Is=i}static Es(e,n){let r=Oe(),i=Oe();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new _0(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return jD()?8:yL(dn())>0?6:4}()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.gs(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ps(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new qM;return this.ys(e,n,o).next(a=>{if(s.result=a,this.As)return this.ws(e,n,o,a.size)})}).next(()=>s.result)}ws(e,n,r,i){return r.documentReadCount<this.Vs?(zo()<=Me.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",Bo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),W.resolve()):(zo()<=Me.DEBUG&&ce("QueryEngine","Query:",Bo(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(zo()<=Me.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",Bo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Gr(n))):W.resolve())}gs(e,n){if(Uw(n))return W.resolve(null);let r=Gr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=yg(n,null,"F"),r=Gr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Oe(...s);return this.fs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.bs(n,a);return this.Ss(n,d,o,l.readTime)?this.gs(e,yg(n,null,"F")):this.Ds(e,d,n,l)}))})))}ps(e,n,r,i){return Uw(n)||i.isEqual(Ie.min())?W.resolve(null):this.fs.getDocuments(e,r).next(s=>{const o=this.bs(n,s);return this.Ss(n,o,r,i)?W.resolve(null):(zo()<=Me.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Bo(n)),this.Ds(e,o,n,hL(i,Sc)).next(a=>a))})}bs(e,n){let r=new Mt(I2(e));return n.forEach((i,s)=>{ff(e,s)&&(r=r.add(s))}),r}Ss(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ys(e,n,r){return zo()<=Me.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",Bo(n)),this.fs.getDocumentsMatchingQuery(e,n,Ss.min(),r)}Ds(e,n,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T0="LocalStore",GM=3e8;class KM{constructor(e,n,r,i){this.persistence=e,this.Cs=n,this.serializer=i,this.vs=new gt(Ve),this.Fs=new Ro(s=>f0(s),p0),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MM(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.vs))}}function QM(t,e,n,r){return new KM(t,e,n,r)}async function X2(t,e){const n=Ce(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Oe();for(const d of i){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of s){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({Ns:d,removedBatchIds:o,addedBatchIds:a}))})})}function YM(t,e){const n=Ce(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.xs.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const f=d.batch,p=f.keys();let g=W.resolve();return p.forEach(x=>{g=g.next(()=>h.getEntry(l,x)).next(_=>{const k=d.docVersions.get(x);Be(k!==null,48541),_.version.compareTo(k)<0&&(f.applyToRemoteDocument(_,d),_.isValidDocument()&&(_.setReadTime(d.commitVersion),h.addEntry(_)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Oe();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function J2(t){const e=Ce(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.li.getLastRemoteSnapshotVersion(n))}function XM(t,e){const n=Ce(t),r=e.snapshotVersion;let i=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});i=n.vs;const a=[];e.targetChanges.forEach((h,f)=>{const p=i.get(f);if(!p)return;a.push(n.li.removeMatchingKeys(s,h.removedDocuments,f).next(()=>n.li.addMatchingKeys(s,h.addedDocuments,f)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(Jt.EMPTY_BYTE_STRING,Ie.min()).withLastLimboFreeSnapshotVersion(Ie.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,r)),i=i.insert(f,g),function(_,k,S){return _.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=GM?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(p,g,h)&&a.push(n.li.updateTargetData(s,g))});let l=Ii(),d=Oe();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(JM(s,o,e.documentUpdates).next(h=>{l=h.Bs,d=h.Ls})),!r.isEqual(Ie.min())){const h=n.li.getLastRemoteSnapshotVersion(s).next(f=>n.li.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return W.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,d)).next(()=>l)}).then(s=>(n.vs=i,s))}function JM(t,e,n){let r=Oe(),i=Oe();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Ii();return n.forEach((a,l)=>{const d=s.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(Ie.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ce(T0,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{Bs:o,Ls:i}})}function ZM(t,e){const n=Ce(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=u0),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function eV(t,e){const n=Ce(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.li.getTargetData(r,e).next(s=>s?(i=s,W.resolve(i)):n.li.allocateTargetId(r).next(o=>(i=new ns(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.li.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.vs=n.vs.insert(r.targetId,r),n.Fs.set(e,r.targetId)),r})}async function Tg(t,e,n){const r=Ce(t),i=r.vs.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Ja(o))throw o;ce(T0,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function Zw(t,e,n){const r=Ce(t);let i=Ie.min(),s=Oe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const f=Ce(l),p=f.Fs.get(h);return p!==void 0?W.resolve(f.vs.get(p)):f.li.getTargetData(d,h)}(r,o,Gr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?i:Ie.min(),n?s:Oe())).next(a=>(tV(r,FL(e),a),{documents:a,ks:s})))}function tV(t,e,n){let r=t.Ms.get(e)||Ie.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Ms.set(e,r)}class e_{constructor(){this.activeTargetIds=qL()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class nV{constructor(){this.vo=new e_,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,r){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new e_,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_="ConnectivityMonitor";class n_{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ce(t_,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ce(t_,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wu=null;function Sg(){return Wu===null?Wu=function(){return 268435456+Math.round(2147483648*Math.random())}():Wu++,"0x"+Wu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Up="RestConnection",iV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class sV{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===sh?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,n,r,i,s){const o=Sg(),a=this.Qo(e,n.toUriEncodedString());ce(Up,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,i,s);const{host:d}=new URL(a),h=ei(d);return this.zo(e,a,l,r,h).then(f=>(ce(Up,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Va(Up,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}jo(e,n,r,i,s,o){return this.Wo(e,n,r,i,s)}Go(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ya}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Qo(e,n){const r=iV[e];let i=`${this.qo}/v1/${n}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn="WebChannelConnection",Sl=(t,e,n)=>{t.listen(e,r=>{try{n(r)}catch(i){setTimeout(()=>{throw i},0)}})};class va extends sV{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!va.c_){const e=t2();Sl(e,e2.STAT_EVENT,n=>{n.stat===ug.PROXY?ce(sn,"STAT_EVENT: detected buffering proxy"):n.stat===ug.NOPROXY&&ce(sn,"STAT_EVENT: detected no buffering proxy")}),va.c_=!0}}zo(e,n,r,i,s){const o=Sg();return new Promise((a,l)=>{const d=new Jb;d.setWithCredentials(!0),d.listenOnce(Zb.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case dd.NO_ERROR:const f=d.getResponseJson();ce(sn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case dd.TIMEOUT:ce(sn,`RPC '${e}' ${o} timed out`),l(new oe(B.DEADLINE_EXCEEDED,"Request time out"));break;case dd.HTTP_ERROR:const p=d.getStatus();if(ce(sn,`RPC '${e}' ${o} failed with status:`,p,"response text:",d.getResponseText()),p>0){let g=d.getResponseJson();Array.isArray(g)&&(g=g[0]);const x=g==null?void 0:g.error;if(x&&x.status&&x.message){const _=function(S){const v=S.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(v)>=0?v:B.UNKNOWN}(x.status);l(new oe(_,x.message))}else l(new oe(B.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new oe(B.UNAVAILABLE,"Connection failed."));break;default:Se(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ce(sn,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(i);ce(sn,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",h,r,15)})}T_(e,n,r){const i=Sg(),s=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const d=s.join("");ce(sn,`Creating RPC '${e}' stream ${i}: ${d}`,a);const h=o.createWebChannel(d,a);this.I_(h);let f=!1,p=!1;const g=new oV({Ho:x=>{p?ce(sn,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(f||(ce(sn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),ce(sn,`RPC '${e}' stream ${i} sending:`,x),h.send(x))},Jo:()=>h.close()});return Sl(h,Pl.EventType.OPEN,()=>{p||(ce(sn,`RPC '${e}' stream ${i} transport opened.`),g.i_())}),Sl(h,Pl.EventType.CLOSE,()=>{p||(p=!0,ce(sn,`RPC '${e}' stream ${i} transport closed`),g.o_(),this.E_(h))}),Sl(h,Pl.EventType.ERROR,x=>{p||(p=!0,Va(sn,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),g.o_(new oe(B.UNAVAILABLE,"The operation could not be completed")))}),Sl(h,Pl.EventType.MESSAGE,x=>{var _;if(!p){const k=x.data[0];Be(!!k,16349);const S=k,v=(S==null?void 0:S.error)||((_=S[0])==null?void 0:_.error);if(v){ce(sn,`RPC '${e}' stream ${i} received error:`,v);const w=v.status;let j=function(E){const T=Ct[E];if(T!==void 0)return O2(T)}(w),L=v.message;j===void 0&&(j=B.INTERNAL,L="Unknown error status: "+w+" with message "+v.message),p=!0,g.o_(new oe(j,L)),h.close()}else ce(sn,`RPC '${e}' stream ${i} received:`,k),g.__(k)}}),va.u_(),setTimeout(()=>{g.s_()},0),g}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(n=>n===e)}Go(e,n,r){super.Go(e,n,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return n2()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aV(t){return new va(t)}function zp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(t){return new dM(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */va.c_=!1;class Z2{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Ci=e,this.timerId=n,this.R_=r,this.A_=i,this.V_=s,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ce("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_="PersistentStream";class eI{constructor(e,n,r,i,s,o,a,l){this.Ci=e,this.b_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Z2(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(bi(n.toString()),bi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new oe(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.H_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ce(r_,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget(()=>this.D_===e?n():(ce(r_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class lV extends eI{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=pM(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ie.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ie.min():o.readTime?Qr(o.readTime):Ie.min()}(e);return this.listener.J_(n,r)}Z_(e){const n={};n.database=_g(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=mg(l)?{documents:yM(s,l)}:{query:vM(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=z2(s,o.resumeToken);const d=vg(s,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(Ie.min())>0){a.readTime=uh(s,o.snapshotVersion.toTimestamp());const d=vg(s,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=wM(this.serializer,e);r&&(n.labels=r),this.K_(n)}X_(e){const n={};n.database=_g(this.serializer),n.removeTarget=e,this.K_(n)}}class cV extends eI{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return Be(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Be(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Be(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=gM(e.writeResults,e.commitTime),r=Qr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=_g(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>mM(this.serializer,r))};this.K_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{}class dV extends uV{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new oe(B.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,xg(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new oe(B.UNKNOWN,s.toString())})}jo(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(e,xg(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new oe(B.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function hV(t,e,n,r){return new dV(t,e,n,r)}class fV{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(bi(n),this.aa=!1):ce("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo="RemoteStore";class pV{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=s,this.Aa.Mo(o=>{r.enqueueAndForget(async()=>{Po(this)&&(ce(wo,"Restarting streams for network reachability change."),await async function(l){const d=Ce(l);d.Ea.add(4),await eu(d),d.Va.set("Unknown"),d.Ea.delete(4),await vf(d)}(this))})}),this.Va=new fV(r,i)}}async function vf(t){if(Po(t))for(const e of t.Ra)await e(!0)}async function eu(t){for(const e of t.Ra)await e(!1)}function tI(t,e){const n=Ce(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),I0(n)?b0(n):Za(n).O_()&&E0(n,e))}function S0(t,e){const n=Ce(t),r=Za(n);n.Ia.delete(e),r.O_()&&nI(n,e),n.Ia.size===0&&(r.O_()?r.L_():Po(n)&&n.Va.set("Unknown"))}function E0(t,e){if(t.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ie.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Za(t).Z_(e)}function nI(t,e){t.da.$e(e),Za(t).X_(e)}function b0(t){t.da=new aM({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Za(t).start(),t.Va.ua()}function I0(t){return Po(t)&&!Za(t).x_()&&t.Ia.size>0}function Po(t){return Ce(t).Ea.size===0}function rI(t){t.da=void 0}async function mV(t){t.Va.set("Online")}async function gV(t){t.Ia.forEach((e,n)=>{E0(t,e)})}async function yV(t,e){rI(t),I0(t)?(t.Va.ha(e),b0(t)):t.Va.set("Unknown")}async function vV(t,e,n){if(t.Va.set("Online"),e instanceof U2&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.da.removeTarget(a))}(t,e)}catch(r){ce(wo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await hh(t,r)}else if(e instanceof md?t.da.Xe(e):e instanceof F2?t.da.st(e):t.da.tt(e),!n.isEqual(Ie.min()))try{const r=await J2(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.da.Tt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(d);h&&s.Ia.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(Jt.EMPTY_BYTE_STRING,h.snapshotVersion)),nI(s,l);const f=new ns(h.target,l,d,h.sequenceNumber);E0(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ce(wo,"Failed to raise snapshot:",r),await hh(t,r)}}async function hh(t,e,n){if(!Ja(e))throw e;t.Ea.add(1),await eu(t),t.Va.set("Offline"),n||(n=()=>J2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ce(wo,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await vf(t)})}function iI(t,e){return e().catch(n=>hh(t,n,e))}async function xf(t){const e=Ce(t),n=Cs(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:u0;for(;xV(e);)try{const i=await ZM(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,wV(e,i)}catch(i){await hh(e,i)}sI(e)&&oI(e)}function xV(t){return Po(t)&&t.Ta.length<10}function wV(t,e){t.Ta.push(e);const n=Cs(t);n.O_()&&n.Y_&&n.ea(e.mutations)}function sI(t){return Po(t)&&!Cs(t).x_()&&t.Ta.length>0}function oI(t){Cs(t).start()}async function _V(t){Cs(t).ra()}async function TV(t){const e=Cs(t);for(const n of t.Ta)e.ea(n.mutations)}async function SV(t,e,n){const r=t.Ta.shift(),i=g0.from(r,e,n);await iI(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await xf(t)}async function EV(t,e){e&&Cs(t).Y_&&await async function(r,i){if(function(o){return iM(o)&&o!==B.ABORTED}(i.code)){const s=r.Ta.shift();Cs(r).B_(),await iI(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await xf(r)}}(t,e),sI(t)&&oI(t)}async function i_(t,e){const n=Ce(t);n.asyncQueue.verifyOperationInProgress(),ce(wo,"RemoteStore received new credentials");const r=Po(n);n.Ea.add(3),await eu(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await vf(n)}async function bV(t,e){const n=Ce(t);e?(n.Ea.delete(2),await vf(n)):e||(n.Ea.add(2),await eu(n),n.Va.set("Unknown"))}function Za(t){return t.ma||(t.ma=function(n,r,i){const s=Ce(n);return s.sa(),new lV(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Zo:mV.bind(null,t),Yo:gV.bind(null,t),t_:yV.bind(null,t),J_:vV.bind(null,t)}),t.Ra.push(async e=>{e?(t.ma.B_(),I0(t)?b0(t):t.Va.set("Unknown")):(await t.ma.stop(),rI(t))})),t.ma}function Cs(t){return t.fa||(t.fa=function(n,r,i){const s=Ce(n);return s.sa(),new cV(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:_V.bind(null,t),t_:EV.bind(null,t),ta:TV.bind(null,t),na:SV.bind(null,t)}),t.Ra.push(async e=>{e?(t.fa.B_(),await xf(t)):(await t.fa.stop(),t.Ta.length>0&&(ce(wo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new gi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new C0(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new oe(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function k0(t,e){if(bi("AsyncQueue",`${e}: ${t}`),Ja(t))return new oe(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{static emptySet(e){return new xa(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||we.comparator(n.key,r.key):(n,r)=>we.comparator(n.key,r.key),this.keyedMap=Nl(),this.sortedSet=new gt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof xa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new xa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(){this.ga=new gt(we.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Se(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ba{constructor(e,n,r,i,s,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ba(e,n,xa.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IV{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class CV{constructor(){this.queries=o_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=Ce(n),s=i.queries;i.queries=o_(),s.forEach((o,a)=>{for(const l of a.ba)l.onError(r)})})(this,new oe(B.ABORTED,"Firestore shutting down"))}}function o_(){return new Ro(t=>b2(t),hf)}async function A0(t,e){const n=Ce(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.Sa()&&e.Da()&&(r=2):(s=new IV,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=k0(o,`Initialization of query '${Bo(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.ba.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&P0(n)}async function R0(t,e){const n=Ce(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.ba.indexOf(e);o>=0&&(s.ba.splice(o,1),s.ba.length===0?i=e.Da()?0:1:!s.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function kV(t,e){const n=Ce(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.ba)a.Fa(i)&&(r=!0);o.wa=i}}r&&P0(n)}function AV(t,e,n){const r=Ce(t),i=r.queries.get(e);if(i)for(const s of i.ba)s.onError(n);r.queries.delete(e)}function P0(t){t.Ca.forEach(e=>{e.next()})}var Eg,a_;(a_=Eg||(Eg={})).Ma="default",a_.Cache="cache";class N0{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ba(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ba.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Eg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e){this.key=e}}class lI{constructor(e){this.key=e}}class RV{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Oe(),this.mutatedKeys=Oe(),this.eu=I2(e),this.tu=new xa(this.eu)}get nu(){return this.Za}ru(e,n){const r=n?n.iu:new s_,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const p=i.get(h),g=ff(this.query,f)?f:null,x=!!p&&this.mutatedKeys.has(p.key),_=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let k=!1;p&&g?p.data.isEqual(g.data)?x!==_&&(r.track({type:3,doc:g}),k=!0):this.su(p,g)||(r.track({type:2,doc:g}),k=!0,(l&&this.eu(g,l)>0||d&&this.eu(g,d)<0)&&(a=!0)):!p&&g?(r.track({type:0,doc:g}),k=!0):p&&!g&&(r.track({type:1,doc:p}),k=!0,(l||d)&&(a=!0)),k&&(g?(o=o.add(g),s=_?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Ss:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(g,x){const _=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Se(20277,{Vt:k})}};return _(g)-_(x)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Ya.size===0&&this.current&&!i?1:0,d=l!==this.Xa;return this.Xa=l,o.length!==0||d?{snapshot:new Ba(this.query,e.tu,s,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new s_,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Za=this.Za.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Za=this.Za.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Oe(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new lI(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new aI(r))}),n}cu(e){this.Za=e.ks,this.Ya=Oe();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ba.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const D0="SyncEngine";class PV{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class NV{constructor(e){this.key=e,this.hu=!1}}class DV{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ro(a=>b2(a),hf),this.Iu=new Map,this.Eu=new Set,this.Ru=new gt(we.comparator),this.Au=new Map,this.Vu=new x0,this.du={},this.mu=new Map,this.fu=za.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function jV(t,e,n=!0){const r=pI(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await cI(r,e,n,!0),i}async function LV(t,e){const n=pI(t);await cI(n,e,!0,!1)}async function cI(t,e,n,r){const i=await eV(t.localStore,Gr(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await MV(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&tI(t.remoteStore,i),a}async function MV(t,e,n,r,i){t.pu=(f,p,g)=>async function(_,k,S,v){let w=k.view.ru(S);w.Ss&&(w=await Zw(_.localStore,k.query,!1).then(({documents:E})=>k.view.ru(E,w)));const j=v&&v.targetChanges.get(k.targetId),L=v&&v.targetMismatches.get(k.targetId)!=null,V=k.view.applyChanges(w,_.isPrimaryClient,j,L);return c_(_,k.targetId,V.au),V.snapshot}(t,f,p,g);const s=await Zw(t.localStore,e,!0),o=new RV(e,s.ks),a=o.ru(s.documents),l=Zc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(a,t.isPrimaryClient,l);c_(t,n,d.au);const h=new PV(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function VV(t,e,n){const r=Ce(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!hf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Tg(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&S0(r.remoteStore,i.targetId),bg(r,i.targetId)}).catch(Xa)):(bg(r,i.targetId),await Tg(r.localStore,i.targetId,!0))}async function OV(t,e){const n=Ce(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),S0(n.remoteStore,r.targetId))}async function FV(t,e,n){const r=HV(t);try{const i=await function(o,a){const l=Ce(o),d=at.now(),h=a.reduce((g,x)=>g.add(x.key),Oe());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let x=Ii(),_=Oe();return l.xs.getEntries(g,h).next(k=>{x=k,x.forEach((S,v)=>{v.isValidDocument()||(_=_.add(S))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,x)).next(k=>{f=k;const S=[];for(const v of a){const w=ZL(v,f.get(v.key).overlayedDocument);w!=null&&S.push(new js(v.key,w,y2(w.value.mapValue),Kr.exists(!0)))}return l.mutationQueue.addMutationBatch(g,d,S,a)}).next(k=>{p=k;const S=k.applyToLocalDocumentSet(f,_);return l.documentOverlayCache.saveOverlays(g,k.batchId,S)})}).then(()=>({batchId:p.batchId,changes:k2(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let d=o.du[o.currentUser.toKey()];d||(d=new gt(Ve)),d=d.insert(a,l),o.du[o.currentUser.toKey()]=d}(r,i.batchId,n),await tu(r,i.changes),await xf(r.remoteStore)}catch(i){const s=k0(i,"Failed to persist write");n.reject(s)}}async function uI(t,e){const n=Ce(t);try{const r=await XM(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(Be(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Be(o.hu,14607):i.removedDocuments.size>0&&(Be(o.hu,42227),o.hu=!1))}),await tu(n,r,e)}catch(r){await Xa(r)}}function l_(t,e,n){const r=Ce(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=Ce(o);l.onlineState=a;let d=!1;l.queries.forEach((h,f)=>{for(const p of f.ba)p.va(a)&&(d=!0)}),d&&P0(l)}(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function UV(t,e,n){const r=Ce(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new gt(we.comparator);o=o.insert(s,cn.newNoDocument(s,Ie.min()));const a=Oe().add(s),l=new gf(Ie.min(),new Map,new gt(Ve),o,a);await uI(r,l),r.Ru=r.Ru.remove(s),r.Au.delete(e),j0(r)}else await Tg(r.localStore,e,!1).then(()=>bg(r,e,n)).catch(Xa)}async function zV(t,e){const n=Ce(t),r=e.batch.batchId;try{const i=await YM(n.localStore,e);hI(n,r,null),dI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await tu(n,i)}catch(i){await Xa(i)}}async function BV(t,e,n){const r=Ce(t);try{const i=await function(o,a){const l=Ce(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(f=>(Be(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(d,f))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);hI(r,e,n),dI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await tu(r,i)}catch(i){await Xa(i)}}function dI(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function hI(t,e,n){const r=Ce(t);let i=r.du[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.du[r.currentUser.toKey()]=i}}function bg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Vu.Gr(e).forEach(r=>{t.Vu.containsKey(r)||fI(t,r)})}function fI(t,e){t.Eu.delete(e.path.canonicalString());const n=t.Ru.get(e);n!==null&&(S0(t.remoteStore,n),t.Ru=t.Ru.remove(e),t.Au.delete(n),j0(t))}function c_(t,e,n){for(const r of n)r instanceof aI?(t.Vu.addReference(r.key,e),$V(t,r)):r instanceof lI?(ce(D0,"Document no longer in limbo: "+r.key),t.Vu.removeReference(r.key,e),t.Vu.containsKey(r.key)||fI(t,r.key)):Se(19791,{wu:r})}function $V(t,e){const n=e.key,r=n.path.canonicalString();t.Ru.get(n)||t.Eu.has(r)||(ce(D0,"New document in limbo: "+n),t.Eu.add(r),j0(t))}function j0(t){for(;t.Eu.size>0&&t.Ru.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new we(Ze.fromString(e)),r=t.fu.next();t.Au.set(r,new NV(n)),t.Ru=t.Ru.insert(n,r),tI(t.remoteStore,new ns(Gr(df(n.path)),r,"TargetPurposeLimboResolution",lf.ce))}}async function tu(t,e,n){const r=Ce(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(d){i.push(d);const f=_0.Es(l.targetId,d);s.push(f)}}))}),await Promise.all(o),r.Pu.J_(i),await async function(l,d){const h=Ce(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>W.forEach(d,p=>W.forEach(p.Ts,g=>h.persistence.referenceDelegate.addReference(f,p.targetId,g)).next(()=>W.forEach(p.Is,g=>h.persistence.referenceDelegate.removeReference(f,p.targetId,g)))))}catch(f){if(!Ja(f))throw f;ce(T0,"Failed to update sequence numbers: "+f)}for(const f of d){const p=f.targetId;if(!f.fromCache){const g=h.vs.get(p),x=g.snapshotVersion,_=g.withLastLimboFreeSnapshotVersion(x);h.vs=h.vs.insert(p,_)}}}(r.localStore,s))}async function WV(t,e){const n=Ce(t);if(!n.currentUser.isEqual(e)){ce(D0,"User change. New user:",e.toKey());const r=await X2(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new oe(B.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await tu(n,r.Ns)}}function qV(t,e){const n=Ce(t),r=n.Au.get(e);if(r&&r.hu)return Oe().add(r.key);{let i=Oe();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function pI(t){const e=Ce(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=uI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=UV.bind(null,e),e.Pu.J_=kV.bind(null,e.eventManager),e.Pu.yu=AV.bind(null,e.eventManager),e}function HV(t){const e=Ce(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=BV.bind(null,e),e}class fh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return QM(this.persistence,new HM,e.initialUser,this.serializer)}Cu(e){return new Y2(w0.Vi,this.serializer)}Du(e){return new nV}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fh.provider={build:()=>new fh};class GV extends fh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Be(this.persistence.referenceDelegate instanceof dh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new PM(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Sn.withCacheSize(this.cacheSizeBytes):Sn.DEFAULT;return new Y2(r=>dh.Vi(r,n),this.serializer)}}class Ig{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>l_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=WV.bind(null,this.syncEngine),await bV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new CV}()}createDatastore(e){const n=yf(e.databaseInfo.databaseId),r=aV(e.databaseInfo);return hV(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new pV(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>l_(this.syncEngine,n,0),function(){return n_.v()?new n_:new rV}())}createSyncEngine(e,n){return function(i,s,o,a,l,d,h){const f=new DV(i,s,o,a,l,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ce(i);ce(wo,"RemoteStore shutting down."),s.Ea.add(5),await eu(s),s.Aa.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Ig.provider={build:()=>new Ig};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):bi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks="FirestoreClient";class KV{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this._databaseInfo=i,this.user=an.UNAUTHENTICATED,this.clientId=c0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ce(ks,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ce(ks,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=k0(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Bp(t,e){t.asyncQueue.verifyOperationInProgress(),ce(ks,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await X2(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function u_(t,e){t.asyncQueue.verifyOperationInProgress();const n=await QV(t);ce(ks,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>i_(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>i_(e.remoteStore,i)),t._onlineComponents=e}async function QV(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ce(ks,"Using user provided OfflineComponentProvider");try{await Bp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===B.FAILED_PRECONDITION||i.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Va("Error using user provided cache. Falling back to memory cache: "+n),await Bp(t,new fh)}}else ce(ks,"Using default OfflineComponentProvider"),await Bp(t,new GV(void 0));return t._offlineComponents}async function mI(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ce(ks,"Using user provided OnlineComponentProvider"),await u_(t,t._uninitializedComponentsProvider._online)):(ce(ks,"Using default OnlineComponentProvider"),await u_(t,new Ig))),t._onlineComponents}function YV(t){return mI(t).then(e=>e.syncEngine)}async function ph(t){const e=await mI(t),n=e.eventManager;return n.onListen=jV.bind(null,e.syncEngine),n.onUnlisten=VV.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=LV.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=OV.bind(null,e.syncEngine),n}function XV(t,e,n,r){const i=new L0(r),s=new N0(e,i,n);return t.asyncQueue.enqueueAndForget(async()=>A0(await ph(t),s)),()=>{i.Nu(),t.asyncQueue.enqueueAndForget(async()=>R0(await ph(t),s))}}function JV(t,e,n={}){const r=new gi;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,d){const h=new L0({next:p=>{h.Nu(),o.enqueueAndForget(()=>R0(s,f));const g=p.docs.has(a);!g&&p.fromCache?d.reject(new oe(B.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&l&&l.source==="server"?d.reject(new oe(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(p)},error:p=>d.reject(p)}),f=new N0(df(a.path),h,{includeMetadataChanges:!0,Ka:!0});return A0(s,f)}(await ph(t),t.asyncQueue,e,n,r)),r.promise}function ZV(t,e,n={}){const r=new gi;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,d){const h=new L0({next:p=>{h.Nu(),o.enqueueAndForget(()=>R0(s,f)),p.fromCache&&l.source==="server"?d.reject(new oe(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),f=new N0(a,h,{includeMetadataChanges:!0,Ka:!0});return A0(s,f)}(await ph(t),t.asyncQueue,e,n,r)),r.promise}function e3(t,e){const n=new gi;return t.asyncQueue.enqueueAndForget(async()=>FV(await YV(t),e,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3="ComponentProvider",d_=new Map;function n3(t,e,n,r,i){return new TL(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,gI(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI="firestore.googleapis.com",h_=!0;class f_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new oe(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yI,this.ssl=h_}else this.host=e.host,this.ssl=e.ssl??h_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Q2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<AM)throw new oe(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}dL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gI(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new oe(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new oe(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new oe(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new f_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new oe(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new oe(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new f_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new tL;switch(r.type){case"firstParty":return new sL(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new oe(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=d_.get(n);r&&(ce(t3,"Removing Datastore"),d_.delete(n),r.terminate())}(this),Promise.resolve()}}function r3(t,e,n,r={}){var d;t=or(t,wf);const i=ei(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(rf(`https://${a}`),sf("Firestore",!0)),s.host!==yI&&s.host!==a&&Va("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!vo(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=an.MOCK_USER;else{h=qb(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new oe(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new an(p)}t._authCredentials=new nL(new i2(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new No(this.firestore,e,this._query)}}class wt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ys(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new wt(this.firestore,e,this._key)}toJSON(){return{type:wt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Yc(n,wt._jsonSchema))return new wt(e,r||null,new we(Ze.fromString(n.referencePath)))}}wt._jsonSchemaVersion="firestore/documentReference/1.0",wt._jsonSchema={type:Pt("string",wt._jsonSchemaVersion),referencePath:Pt("string")};class ys extends No{constructor(e,n,r){super(e,n,df(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new wt(this.firestore,null,new we(e))}withConverter(e){return new ys(this.firestore,e,this._path)}}function i3(t,e,...n){if(t=ut(t),s2("collection","path",e),t instanceof wf){const r=Ze.fromString(e,...n);return Iw(r),new ys(t,null,r)}{if(!(t instanceof wt||t instanceof ys))throw new oe(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ze.fromString(e,...n));return Iw(r),new ys(t.firestore,null,r)}}function qo(t,e,...n){if(t=ut(t),arguments.length===1&&(e=c0.newId()),s2("doc","path",e),t instanceof wf){const r=Ze.fromString(e,...n);return bw(r),new wt(t,null,new we(r))}{if(!(t instanceof wt||t instanceof ys))throw new oe(B.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ze.fromString(e,...n));return bw(r),new wt(t.firestore,t instanceof ys?t.converter:null,new we(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_="AsyncQueue";class m_{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Z2(this,"async_queue_retry"),this._c=()=>{const r=zp();r&&ce(p_,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=zp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=zp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new gi;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Ja(e))throw e;ce(p_,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,bi("INTERNAL UNHANDLED ERROR: ",g_(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=C0.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&Se(47125,{Pc:g_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function g_(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class _o extends wf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new m_,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new m_(e),this._firestoreClient=void 0,await e}}}function s3(t,e){const n=typeof t=="object"?t:of(),r=typeof t=="string"?t:e||sh,i=Qc(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=s0("firestore");s&&r3(i,...s)}return i}function _f(t){if(t._terminated)throw new oe(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||o3(t),t._firestoreClient}function o3(t){var r,i,s,o;const e=t._freezeSettings(),n=n3(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,(i=t._app)==null?void 0:i.options.apiKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new KV(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const d=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e){this._byteString=e}static fromBase64String(e){try{return new er(Jt.fromBase64String(e))}catch(n){throw new oe(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new er(Jt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:er._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yc(e,er._jsonSchema))return er.fromBase64String(e.bytes)}}er._jsonSchemaVersion="firestore/bytes/1.0",er._jsonSchema={type:Pt("string",er._jsonSchemaVersion),bytes:Pt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new oe(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new oe(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new oe(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Yr._jsonSchemaVersion}}static fromJSON(e){if(Yc(e,Yr._jsonSchema))return new Yr(e.latitude,e.longitude)}}Yr._jsonSchemaVersion="firestore/geoPoint/1.0",Yr._jsonSchema={type:Pt("string",Yr._jsonSchemaVersion),latitude:Pt("number"),longitude:Pt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Er._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yc(e,Er._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Er(e.vectorValues);throw new oe(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Er._jsonSchemaVersion="firestore/vectorValue/1.0",Er._jsonSchema={type:Pt("string",Er._jsonSchemaVersion),vectorValues:Pt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a3=/^__.*__$/;class l3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new js(e,this.data,this.fieldMask,n,this.fieldTransforms):new Jc(e,this.data,n,this.fieldTransforms)}}class vI{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new js(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function xI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Se(40011,{dataSource:t})}}class V0{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new V0({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return mh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(xI(this.dataSource)&&a3.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class c3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||yf(e)}createContext(e,n,r,i=!1){return new V0({dataSource:e,methodName:n,targetDoc:r,path:Kt.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function O0(t){const e=t._freezeSettings(),n=yf(t._databaseId);return new c3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function u3(t,e,n,r,i,s={}){const o=t.createContext(s.merge||s.mergeFields?2:0,e,n,i);U0("Data must be an object, but it was:",o,r);const a=wI(r,o);let l,d;if(s.merge)l=new On(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const p=$a(e,f,n);if(!o.contains(p))throw new oe(B.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);SI(h,p)||h.push(p)}l=new On(h),d=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,d=o.fieldTransforms;return new l3(new bn(a),l,d)}class Sf extends Tf{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Sf}}class F0 extends Tf{_toFieldTransform(e){return new QL(e.path,new Cc)}isEqual(e){return e instanceof F0}}function d3(t,e,n,r){const i=t.createContext(1,e,n);U0("Data must be an object, but it was:",i,r);const s=[],o=bn.empty();Ds(r,(l,d)=>{const h=TI(e,l,n);d=ut(d);const f=i.childContextForFieldPath(h);if(d instanceof Sf)s.push(h);else{const p=nu(d,f);p!=null&&(s.push(h),o.set(h,p))}});const a=new On(s);return new vI(o,a,i.fieldTransforms)}function h3(t,e,n,r,i,s){const o=t.createContext(1,e,n),a=[$a(e,r,n)],l=[i];if(s.length%2!=0)throw new oe(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push($a(e,s[p])),l.push(s[p+1]);const d=[],h=bn.empty();for(let p=a.length-1;p>=0;--p)if(!SI(d,a[p])){const g=a[p];let x=l[p];x=ut(x);const _=o.childContextForFieldPath(g);if(x instanceof Sf)d.push(g);else{const k=nu(x,_);k!=null&&(d.push(g),h.set(g,k))}}const f=new On(d);return new vI(h,f,o.fieldTransforms)}function f3(t,e,n,r=!1){return nu(n,t.createContext(r?4:3,e))}function nu(t,e){if(_I(t=ut(t)))return U0("Unsupported field value:",e,t),wI(t,e);if(t instanceof Tf)return function(r,i){if(!xI(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=nu(a,i.childContextForArray(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ut(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return HL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=at.fromDate(r);return{timestampValue:uh(i.serializer,s)}}if(r instanceof at){const s=new at(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:uh(i.serializer,s)}}if(r instanceof Yr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof er)return{bytesValue:z2(i.serializer,r._byteString)};if(r instanceof wt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:v0(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Er)return function(o,a){const l=o instanceof Er?o.toArray():o;return{mapValue:{fields:{[p2]:{stringValue:g2},[oh]:{arrayValue:{values:l.map(h=>{if(typeof h!="number")throw a.createError("VectorValues must only contain numeric values.");return m0(a.serializer,h)})}}}}}}(r,i);if(K2(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${af(r)}`)}(t,e)}function wI(t,e){const n={};return l2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ds(t,(r,i)=>{const s=nu(i,e.childContextForField(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function _I(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof at||t instanceof Yr||t instanceof er||t instanceof wt||t instanceof Tf||t instanceof Er||K2(t))}function U0(t,e,n){if(!_I(n)||!o2(n)){const r=af(n);throw r==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function $a(t,e,n){if((e=ut(e))instanceof M0)return e._internalPath;if(typeof e=="string")return TI(t,e);throw mh("Field path arguments must be of type string or ",t,!1,void 0,n)}const p3=new RegExp("[~\\*/\\[\\]]");function TI(t,e,n){if(e.search(p3)>=0)throw mh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new M0(...e.split("."))._internalPath}catch{throw mh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function mh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new oe(B.INVALID_ARGUMENT,a+t+l)}function SI(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m3{convertValue(e,n="none"){switch(Is(e)){case 0:return null;case 1:return e.booleanValue;case 2:return St(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(bs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Se(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ds(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[oh].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>St(o.doubleValue));return new Er(n)}convertGeoPoint(e){return new Yr(St(e.latitude),St(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=uf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ec(e));default:return null}}convertTimestamp(e){const n=Es(e);return new at(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ze.fromString(e);Be(G2(r),9688,{name:e});const i=new bc(r.get(1),r.get(3)),s=new we(r.popFirst(5));return i.isEqual(n)||bi(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0 extends m3{constructor(e){super(),this.firestore=e}convertBytes(e){return new er(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new wt(this.firestore,null,n)}}function qu(){return new F0("serverTimestamp")}const y_="@firebase/firestore",v_="4.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new wt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new g3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const n=this._document.data.field($a("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class g3 extends EI{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new oe(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class B0{}class y3 extends B0{}function v3(t,e,...n){let r=[];e instanceof B0&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof $0).length,a=s.filter(l=>l instanceof Ef).length;if(o>1||o>0&&a>0)throw new oe(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Ef extends y3{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Ef(e,n,r)}_apply(e){const n=this._parse(e);return II(e._query,n),new No(e.firestore,e.converter,gg(e._query,n))}_parse(e){const n=O0(e.firestore);return function(s,o,a,l,d,h,f){let p;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new oe(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){__(f,h);const x=[];for(const _ of f)x.push(w_(l,s,_));p={arrayValue:{values:x}}}else p=w_(l,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||__(f,h),p=f3(a,o,f,h==="in"||h==="not-in");return Rt.create(d,h,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ZU(t,e,n){const r=e,i=$a("where",t);return Ef._create(i,r,n)}class $0 extends B0{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new $0(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:kr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)II(o,l),o=gg(o,l)}(e._query,n),new No(e.firestore,e.converter,gg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function w_(t,e,n){if(typeof(n=ut(n))=="string"){if(n==="")throw new oe(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!E2(e)&&n.indexOf("/")!==-1)throw new oe(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ze.fromString(n));if(!we.isDocumentKey(r))throw new oe(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return jw(t,new we(r))}if(n instanceof wt)return jw(t,n._key);throw new oe(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${af(n)}.`)}function __(t,e){if(!Array.isArray(t)||t.length===0)throw new oe(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function II(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new oe(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new oe(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function x3(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class jl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ao extends EI{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new gd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field($a("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new oe(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ao._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ao._jsonSchemaVersion="firestore/documentSnapshot/1.0",ao._jsonSchema={type:Pt("string",ao._jsonSchemaVersion),bundleSource:Pt("string","DocumentSnapshot"),bundleName:Pt("string"),bundle:Pt("string")};class gd extends ao{data(e={}){return super.data(e)}}class lo{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new jl(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new gd(this._firestore,this._userDataWriter,r.key,r,new jl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new oe(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new gd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new jl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new gd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new jl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:w3(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new oe(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=lo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=c0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function w3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Se(61501,{type:t})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lo._jsonSchemaVersion="firestore/querySnapshot/1.0",lo._jsonSchema={type:Pt("string",lo._jsonSchemaVersion),bundleSource:Pt("string","QuerySnapshot"),bundleName:Pt("string"),bundle:Pt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yd(t){t=or(t,wt);const e=or(t.firestore,_o),n=_f(e);return JV(n,t._key).then(r=>kI(e,t,r))}function _3(t){t=or(t,No);const e=or(t.firestore,_o),n=_f(e),r=new z0(e);return bI(t._query),ZV(n,t._query).then(i=>new lo(e,r,t,i))}function T3(t,e,n){t=or(t,wt);const r=or(t.firestore,_o),i=x3(t.converter,e,n),s=O0(r);return CI(r,[u3(s,"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Kr.none())])}function $p(t,e,n,...r){t=or(t,wt);const i=or(t.firestore,_o),s=O0(i);let o;return o=typeof(e=ut(e))=="string"||e instanceof M0?h3(s,"updateDoc",t._key,e,n,r):d3(s,"updateDoc",t._key,e),CI(i,[o.toMutation(t._key,Kr.exists(!0))])}function ez(t,...e){var d,h,f;t=ut(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||x_(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(x_(e[r])){const p=e[r];e[r]=(d=p.next)==null?void 0:d.bind(p),e[r+1]=(h=p.error)==null?void 0:h.bind(p),e[r+2]=(f=p.complete)==null?void 0:f.bind(p)}let s,o,a;if(t instanceof wt)o=or(t.firestore,_o),a=df(t._key.path),s={next:p=>{e[r]&&e[r](kI(o,t,p))},error:e[r+1],complete:e[r+2]};else{const p=or(t,No);o=or(p.firestore,_o),a=p._query;const g=new z0(o);s={next:x=>{e[r]&&e[r](new lo(o,g,p,x))},error:e[r+1],complete:e[r+2]},bI(t._query)}const l=_f(o);return XV(l,a,i,s)}function CI(t,e){const n=_f(t);return e3(n,e)}function kI(t,e,n){const r=n.docs.get(e._key),i=new z0(t);return new ao(t,i,e._key,r,new jl(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){eL(Ao),Ts(new Si("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new _o(new rL(r.getProvider("auth-internal")),new oL(o,r.getProvider("app-check-internal")),SL(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),sr(y_,v_,e),sr(y_,v_,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI="firebasestorage.googleapis.com",RI="storageBucket",S3=2*60*1e3,E3=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It extends Ar{constructor(e,n,r=0){super(Wp(e),`Firebase Storage: ${n} (${Wp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,It.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Wp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var bt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(bt||(bt={}));function Wp(t){return"storage/"+t}function W0(){const t="An unknown error occurred, please check the error payload for server response.";return new It(bt.UNKNOWN,t)}function b3(t){return new It(bt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function I3(t){return new It(bt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function C3(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new It(bt.UNAUTHENTICATED,t)}function k3(){return new It(bt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function A3(t){return new It(bt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function R3(){return new It(bt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function P3(){return new It(bt.CANCELED,"User canceled the upload/download.")}function N3(t){return new It(bt.INVALID_URL,"Invalid URL '"+t+"'.")}function D3(t){return new It(bt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function j3(){return new It(bt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+RI+"' property when initializing the app?")}function L3(){return new It(bt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function M3(t){return new It(bt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Cg(t){return new It(bt.INVALID_ARGUMENT,t)}function PI(){return new It(bt.APP_DELETED,"The Firebase app was deleted.")}function V3(t){return new It(bt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Zl(t,e){return new It(bt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function El(t){throw new It(bt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Fn.makeFromUrl(e,n)}catch{return new Fn(e,"")}if(r.path==="")return r;throw D3(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function d(j){j.path_=decodeURIComponent(j.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",g=new RegExp(`^https?://${f}/${h}/b/${i}/o${p}`,"i"),x={bucket:1,path:3},_=n===AI?"(?:storage.googleapis.com|storage.cloud.google.com)":n,k="([^?#]*)",S=new RegExp(`^https?://${_}/${i}/${k}`,"i"),w=[{regex:a,indices:l,postModify:s},{regex:g,indices:x,postModify:d},{regex:S,indices:{bucket:1,path:2},postModify:d}];for(let j=0;j<w.length;j++){const L=w[j],V=L.regex.exec(e);if(V){const E=V[L.indices.bucket];let T=V[L.indices.path];T||(T=""),r=new Fn(E,T),L.postModify(r);break}}if(r==null)throw N3(e);return r}}class O3{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F3(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...k){d||(d=!0,e.apply(null,k))}function f(k){i=setTimeout(()=>{i=null,t(g,l())},k)}function p(){s&&clearTimeout(s)}function g(k,...S){if(d){p();return}if(k){p(),h.call(null,k,...S);return}if(l()||o){p(),h.call(null,k,...S);return}r<64&&(r*=2);let w;a===1?(a=2,w=0):w=(r+Math.random())*1e3,f(w)}let x=!1;function _(k){x||(x=!0,p(),!d&&(i!==null?(k||(a=2),clearTimeout(i),f(0)):k||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,_(!0)},n),_}function U3(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z3(t){return t!==void 0}function B3(t){return typeof t=="object"&&!Array.isArray(t)}function NI(t){return typeof t=="string"||t instanceof String}function T_(t){return q0()&&t instanceof Blob}function q0(){return typeof Blob<"u"}function S_(t,e,n,r){if(r<e)throw Cg(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Cg(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function $3(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var co;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(co||(co={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W3(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(e,n,r,i,s,o,a,l,d,h,f,p=!0,g=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=p,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,_)=>{this.resolve_=x,this.reject_=_,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Hu(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===co.NO_ERROR,l=s.getStatus();if(!a||W3(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===co.ABORT;r(!1,new Hu(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new Hu(d,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());z3(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=W0();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?PI():P3();o(l)}else{const l=R3();o(l)}};this.canceled_?n(!1,new Hu(!1,null,!0)):this.backoffId_=F3(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&U3(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Hu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function H3(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function G3(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function K3(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Q3(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function Y3(t,e,n,r,i,s,o=!0,a=!1){const l=$3(t.urlParams),d=t.url+l,h=Object.assign({},t.headers);return K3(h,e),H3(h,n),G3(h,s),Q3(h,r),new q3(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X3(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function J3(...t){const e=X3();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(q0())return new Blob(t);throw new It(bt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Z3(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e6(t){if(typeof atob>"u")throw M3("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class qp{constructor(e,n){this.data=e,this.contentType=n||null}}function t6(t,e){switch(t){case Br.RAW:return new qp(jI(e));case Br.BASE64:case Br.BASE64URL:return new qp(LI(t,e));case Br.DATA_URL:return new qp(r6(e),i6(e))}throw W0()}function jI(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function n6(t){let e;try{e=decodeURIComponent(t)}catch{throw Zl(Br.DATA_URL,"Malformed data URL.")}return jI(e)}function LI(t,e){switch(t){case Br.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Zl(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Br.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Zl(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=e6(e)}catch(i){throw i.message.includes("polyfill")?i:Zl(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class MI{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Zl(Br.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=s6(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function r6(t){const e=new MI(t);return e.base64?LI(Br.BASE64,e.rest):n6(e.rest)}function i6(t){return new MI(t).contentType}function s6(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e,n){let r=0,i="";T_(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(T_(this.data_)){const r=this.data_,i=Z3(r,e,n);return i===null?null:new Ki(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Ki(r,!0)}}static getBlob(...e){if(q0()){const n=e.map(r=>r instanceof Ki?r.data_:r);return new Ki(J3.apply(null,n))}else{const n=e.map(o=>NI(o)?t6(Br.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Ki(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o6(t){let e;try{e=JSON.parse(t)}catch{return null}return B3(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a6(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function l6(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function VI(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c6(t,e){return e}class fn{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||c6}}let Gu=null;function u6(t){return!NI(t)||t.length<2?t:VI(t)}function d6(){if(Gu)return Gu;const t=[];t.push(new fn("bucket")),t.push(new fn("generation")),t.push(new fn("metageneration")),t.push(new fn("name","fullPath",!0));function e(s,o){return u6(o)}const n=new fn("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new fn("size");return i.xform=r,t.push(i),t.push(new fn("timeCreated")),t.push(new fn("updated")),t.push(new fn("md5Hash",null,!0)),t.push(new fn("cacheControl",null,!0)),t.push(new fn("contentDisposition",null,!0)),t.push(new fn("contentEncoding",null,!0)),t.push(new fn("contentLanguage",null,!0)),t.push(new fn("contentType",null,!0)),t.push(new fn("metadata","customMetadata",!0)),Gu=t,Gu}function h6(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new Fn(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function f6(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return h6(r,t),r}function p6(t,e,n){const r=o6(e);return r===null?null:f6(t,r,n)}function m6(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class OI{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g6(t){if(!t)throw W0()}function y6(t,e){function n(r,i){const s=p6(t,i,e);return g6(s!==null),s}return n}function FI(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=k3():i=C3():n.getStatus()===402?i=I3(t.bucket):n.getStatus()===403?i=A3(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function v6(t){const e=FI(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=b3(t.path)),s.serverResponse=i.serverResponse,s}return n}function x6(t,e,n){const r=e.fullServerUrl(),i=DI(r,t.host,t._protocol)+"?alt=media",s="GET",o=t.maxOperationRetryTime,a=new OI(i,s,(l,d)=>d,o);return a.errorHandler=v6(e),n!==void 0&&(a.headers.Range=`bytes=0-${n}`,a.successCodes=[200,206]),a}function w6(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function _6(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=w6(null,e)),r}function T6(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let w="";for(let j=0;j<2;j++)w=w+Math.random().toString().slice(2);return w}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const d=_6(e,r,i),h=m6(d,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+d.contentType+`\r
\r
`,p=`\r
--`+l+"--",g=Ki.getBlob(f,r,p);if(g===null)throw L3();const x={name:d.fullPath},_=DI(s,t.host,t._protocol),k="POST",S=t.maxUploadRetryTime,v=new OI(_,k,y6(t,n),S);return v.urlParams=x,v.headers=o,v.body=g.uploadData(),v.errorHandler=FI(e),v}class UI{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=co.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=co.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=co.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i,s){if(this.sent_)throw El("cannot .send() more than once");if(ei(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw El("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw El("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw El("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw El("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class S6 extends UI{initXhr(){this.xhr_.responseType="text"}}function E6(){return new S6}class b6 extends UI{initXhr(){this.xhr_.responseType="arraybuffer"}}function I6(){return new b6}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,n){this._service=e,n instanceof Fn?this._location=n:this._location=Fn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new To(e,n)}get root(){const e=new Fn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return VI(this._location.path)}get storage(){return this._service}get parent(){const e=a6(this._location.path);if(e===null)return null;const n=new Fn(this._location.bucket,e);return new To(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw V3(e)}}function C6(t,e){t._throwIfRoot("getBytes");const n=x6(t.storage,t._location,e);return t.storage.makeRequestWithTokens(n,I6).then(r=>e!==void 0?r.slice(0,e):r)}function k6(t,e,n){t._throwIfRoot("uploadBytes");const r=T6(t.storage,t._location,d6(),new Ki(e,!0),n);return t.storage.makeRequestWithTokens(r,E6).then(i=>({metadata:i,ref:t}))}function A6(t,e){const n=l6(t._location.path,e),r=new Fn(t._location.bucket,n);return new To(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R6(t){return/^[A-Za-z]+:\/\//.test(t)}function P6(t,e){return new To(t,e)}function zI(t,e){if(t instanceof H0){const n=t;if(n._bucket==null)throw j3();const r=new To(n,n._bucket);return e!=null?zI(r,e):r}else return e!==void 0?A6(t,e):t}function N6(t,e){if(e&&R6(e)){if(t instanceof H0)return P6(t,e);throw Cg("To use ref(service, url), the first argument must be a Storage instance.")}else return zI(t,e)}function E_(t,e){const n=e==null?void 0:e[RI];return n==null?null:Fn.makeFromBucketSpec(n,t)}function D6(t,e,n,r={}){t.host=`${e}:${n}`;const i=ei(e);i&&(rf(`https://${t.host}/b`),sf("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:qb(s,t.app.options.projectId))}class H0{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=AI,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=S3,this._maxUploadRetryTime=E3,this._requests=new Set,i!=null?this._bucket=Fn.makeFromBucketSpec(i,this._host):this._bucket=E_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Fn.makeFromBucketSpec(this._url,e):this._bucket=E_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){S_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){S_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Mn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new To(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new O3(PI());{const o=Y3(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const b_="@firebase/storage",I_="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI="storage";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tz(t,e){return t=ut(t),C6(t,e)}function nz(t,e,n){return t=ut(t),k6(t,e,n)}function rz(t,e){return t=ut(t),N6(t,e)}function j6(t=of(),e){t=ut(t);const r=Qc(t,BI).getImmediate({identifier:e}),i=s0("storage");return i&&L6(r,...i),r}function L6(t,e,n,r={}){D6(t,e,n,r)}function M6(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new H0(n,r,i,e,Ao)}function V6(){Ts(new Si(BI,M6,"PUBLIC").setMultipleInstances(!0)),sr(b_,I_,""),sr(b_,I_,"esm2020")}V6();function $I(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const O6=$I,WI=new Gc("auth","Firebase",$I());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh=new o0("@firebase/auth");function F6(t,...e){gh.logLevel<=Me.WARN&&gh.warn(`Auth (${Ao}): ${t}`,...e)}function vd(t,...e){gh.logLevel<=Me.ERROR&&gh.error(`Auth (${Ao}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(t,...e){throw K0(t,...e)}function br(t,...e){return K0(t,...e)}function G0(t,e,n){const r={...O6(),[e]:n};return new Gc("auth","Firebase",r).create(e,{appName:t.name})}function uo(t){return G0(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function U6(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Zr(t,"argument-error"),G0(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function K0(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return WI.create(t,...e)}function be(t,e,...n){if(!t)throw K0(e,...n)}function di(t){const e="INTERNAL ASSERTION FAILED: "+t;throw vd(e),new Error(e)}function Ci(t,e){t||di(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kg(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function z6(){return C_()==="http:"||C_()==="https:"}function C_(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(z6()||PD()||"connection"in navigator)?navigator.onLine:!0}function $6(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ci(n>e,"Short delay should be less than long delay!"),this.isMobile=kD()||ND()}get(){return B6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0(t,e){Ci(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;di("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;di("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;di("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q6=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],H6=new ru(3e4,6e4);function Y0(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function el(t,e,n,r,i={}){return HI(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Kc({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:l,...s};return RD()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&ei(t.emulatorConfig.host)&&(d.credentials="include"),qI.fetch()(await GI(t,t.config.apiHost,n,a),d)})}async function HI(t,e,n){t._canInitEmulator=!1;const r={...W6,...e};try{const i=new K6(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Ku(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ku(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Ku(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Ku(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw G0(t,h,d);Zr(t,h)}}catch(i){if(i instanceof Ar)throw i;Zr(t,"network-request-failed",{message:String(i)})}}async function G6(t,e,n,r,i={}){const s=await el(t,e,n,r,i);return"mfaPendingCredential"in s&&Zr(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function GI(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?Q0(t.config,i):`${t.config.apiScheme}://${i}`;return q6.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class K6{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(br(this.auth,"network-request-failed")),H6.get())})}}function Ku(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=br(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q6(t,e){return el(t,"POST","/v1/accounts:delete",e)}async function yh(t,e){return el(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ec(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Y6(t,e=!1){const n=ut(t),r=await n.getIdToken(e),i=X0(r);be(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:ec(Hp(i.auth_time)),issuedAtTime:ec(Hp(i.iat)),expirationTime:ec(Hp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Hp(t){return Number(t)*1e3}function X0(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return vd("JWT malformed, contained fewer than 3 sections"),null;try{const i=zb(n);return i?JSON.parse(i):(vd("Failed to decode base64 JWT payload"),null)}catch(i){return vd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function k_(t){const e=X0(t);return be(e,"internal-error"),be(typeof e.exp<"u","internal-error"),be(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ar&&X6(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function X6({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ec(this.lastLoginAt),this.creationTime=ec(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vh(t){var f;const e=t.auth,n=await t.getIdToken(),r=await Rc(t,yh(e,{idToken:n}));be(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(f=i.providerUserInfo)!=null&&f.length?KI(i.providerUserInfo):[],o=eO(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),d=a?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Ag(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function Z6(t){const e=ut(t);await vh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function eO(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function KI(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tO(t,e){const n=await HI(t,{},async()=>{const r=Kc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await GI(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&ei(t.emulatorConfig.host)&&(l.credentials="include"),qI.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function nO(t,e){return el(t,"POST","/v2/accounts:revokeToken",Y0(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){be(e.idToken,"internal-error"),be(typeof e.idToken<"u","internal-error"),be(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):k_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){be(e.length!==0,"internal-error");const n=k_(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(be(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await tO(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new wa;return r&&(be(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(be(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(be(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new wa,this.toJSON())}_performRefresh(){return di("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vi(t,e){be(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class _r{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new J6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ag(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Rc(this,this.stsTokenManager.getToken(this.auth,e));return be(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Y6(this,e)}reload(){return Z6(this)}_assign(e){this!==e&&(be(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new _r({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){be(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await vh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mn(this.auth.app))return Promise.reject(uo(this.auth));const e=await this.getIdToken();return await Rc(this,Q6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:p,isAnonymous:g,providerData:x,stsTokenManager:_}=n;be(f&&_,e,"internal-error");const k=wa.fromJSON(this.name,_);be(typeof f=="string",e,"internal-error"),Vi(r,e.name),Vi(i,e.name),be(typeof p=="boolean",e,"internal-error"),be(typeof g=="boolean",e,"internal-error"),Vi(s,e.name),Vi(o,e.name),Vi(a,e.name),Vi(l,e.name),Vi(d,e.name),Vi(h,e.name);const S=new _r({uid:f,auth:e,email:i,emailVerified:p,displayName:r,isAnonymous:g,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:k,createdAt:d,lastLoginAt:h});return x&&Array.isArray(x)&&(S.providerData=x.map(v=>({...v}))),l&&(S._redirectEventId=l),S}static async _fromIdTokenResponse(e,n,r=!1){const i=new wa;i.updateFromServerResponse(n);const s=new _r({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await vh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];be(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?KI(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new wa;a.updateFromIdToken(r);const l=new _r({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ag(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_=new Map;function hi(t){Ci(t instanceof Function,"Expected a class definition");let e=A_.get(t);return e?(Ci(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,A_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}QI.type="NONE";const R_=QI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xd(t,e,n){return`firebase:${t}:${e}:${n}`}class _a{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=xd(this.userKey,i.apiKey,s),this.fullPersistenceKey=xd("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await yh(this.auth,{idToken:e}).catch(()=>{});return n?_r._fromGetAccountInfoResponse(this.auth,n,e):null}return _r._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new _a(hi(R_),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||hi(R_);const o=xd(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const p=await yh(e,{idToken:h}).catch(()=>{});if(!p)break;f=await _r._fromGetAccountInfoResponse(e,p,h)}else f=_r._fromJSON(e,h);d!==s&&(a=f),s=d;break}}catch{}const l=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new _a(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new _a(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ZI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(YI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(tC(e))return"Blackberry";if(nC(e))return"Webos";if(XI(e))return"Safari";if((e.includes("chrome/")||JI(e))&&!e.includes("edge/"))return"Chrome";if(eC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function YI(t=dn()){return/firefox\//i.test(t)}function XI(t=dn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function JI(t=dn()){return/crios\//i.test(t)}function ZI(t=dn()){return/iemobile/i.test(t)}function eC(t=dn()){return/android/i.test(t)}function tC(t=dn()){return/blackberry/i.test(t)}function nC(t=dn()){return/webos/i.test(t)}function J0(t=dn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function rO(t=dn()){var e;return J0(t)&&!!((e=window.navigator)!=null&&e.standalone)}function iO(){return DD()&&document.documentMode===10}function rC(t=dn()){return J0(t)||eC(t)||nC(t)||tC(t)||/windows phone/i.test(t)||ZI(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iC(t,e=[]){let n;switch(t){case"Browser":n=P_(dn());break;case"Worker":n=`${P_(dn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ao}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oO(t,e={}){return el(t,"GET","/v2/passwordPolicy",Y0(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO=6;class lO{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??aO,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new N_(this),this.idTokenSubscription=new N_(this),this.beforeStateQueue=new sO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=WI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=hi(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await _a.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await yh(this,{idToken:e}),r=await _r._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Mn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return be(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await vh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mn(this.app))return Promise.reject(uo(this));const n=e?ut(e):null;return n&&be(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&be(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mn(this.app)?Promise.reject(uo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mn(this.app)?Promise.reject(uo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(hi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await oO(this),n=new lO(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Gc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await nO(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&hi(e)||this._popupRedirectResolver;be(n,this,"argument-error"),this.redirectPersistenceManager=await _a.create(this,[hi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(be(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return be(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Mn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&F6(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function iu(t){return ut(t)}class N_{constructor(e){this.auth=e,this.observer=null,this.addObserver=zD(n=>this.observer=n)}get next(){return be(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uO(t){Z0=t}function dO(t){return Z0.loadJS(t)}function hO(){return Z0.gapiScript}function fO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pO(t,e){const n=Qc(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(vo(s,e??{}))return i;Zr(i,"already-initialized")}return n.initialize({options:e})}function mO(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(hi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function gO(t,e,n){const r=iu(t);be(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=sC(e),{host:o,port:a}=yO(e),l=a===null?"":`:${a}`,d={url:`${s}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){be(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),be(vo(d,r.config.emulator)&&vo(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,ei(o)?(rf(`${s}//${o}${l}`),sf("Auth",!0)):i||vO()}function sC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function yO(t){const e=sC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:D_(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:D_(o)}}}function D_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function vO(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return di("not implemented")}_getIdTokenResponse(e){return di("not implemented")}_linkToIdToken(e,n){return di("not implemented")}_getReauthenticationResolver(e){return di("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ta(t,e){return G6(t,"POST","/v1/accounts:signInWithIdp",Y0(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xO="http://localhost";class So extends oC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new So(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Zr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new So(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ta(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ta(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ta(e,n)}buildRequest(){const e={requestUri:xO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Kc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su extends ev{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi extends su{constructor(){super("facebook.com")}static credential(e){return So._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qi.credential(e.oauthAccessToken)}catch{return null}}}Qi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr extends su{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return So._fromParams({providerId:tr.PROVIDER_ID,signInMethod:tr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return tr.credentialFromTaggedObject(e)}static credentialFromError(e){return tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return tr.credential(n,r)}catch{return null}}}tr.GOOGLE_SIGN_IN_METHOD="google.com";tr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi extends su{constructor(){super("github.com")}static credential(e){return So._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yi.credential(e.oauthAccessToken)}catch{return null}}}Yi.GITHUB_SIGN_IN_METHOD="github.com";Yi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends su{constructor(){super("twitter.com")}static credential(e,n){return So._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Xi.credential(n,r)}catch{return null}}}Xi.TWITTER_SIGN_IN_METHOD="twitter.com";Xi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await _r._fromIdTokenResponse(e,r,i),o=j_(r);return new Wa({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=j_(r);return new Wa({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function j_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh extends Ar{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,xh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new xh(e,n,r,i)}}function aC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?xh._fromErrorAndOperation(t,s,e,r):s})}async function wO(t,e,n=!1){const r=await Rc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Wa._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _O(t,e,n=!1){const{auth:r}=t;if(Mn(r.app))return Promise.reject(uo(r));const i="reauthenticate";try{const s=await Rc(t,aC(r,i,e,t),n);be(s.idToken,r,"internal-error");const o=X0(s.idToken);be(o,r,"internal-error");const{sub:a}=o;return be(t.uid===a,r,"user-mismatch"),Wa._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Zr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TO(t,e,n=!1){if(Mn(t.app))return Promise.reject(uo(t));const r="signIn",i=await aC(t,r,e),s=await Wa._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function SO(t,e,n,r){return ut(t).onIdTokenChanged(e,n,r)}function EO(t,e,n){return ut(t).beforeAuthStateChanged(e,n)}function bO(t){return ut(t).signOut()}const wh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(wh,"1"),this.storage.removeItem(wh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IO=1e3,CO=10;class cC extends lC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);iO()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,CO):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},IO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}cC.type="LOCAL";const kO=cC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC extends lC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}uC.type="SESSION";const dC=uC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new bf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async d=>d(n.origin,s)),l=await AO(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}bf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const d=tv("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const p=f;if(p.data.eventId===d)switch(p.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(){return window}function PO(t){Xr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hC(){return typeof Xr().WorkerGlobalScope<"u"&&typeof Xr().importScripts=="function"}async function NO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function DO(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function jO(){return hC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC="firebaseLocalStorageDb",LO=1,_h="firebaseLocalStorage",pC="fbase_key";class ou{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function If(t,e){return t.transaction([_h],e?"readwrite":"readonly").objectStore(_h)}function MO(){const t=indexedDB.deleteDatabase(fC);return new ou(t).toPromise()}function Rg(){const t=indexedDB.open(fC,LO);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(_h,{keyPath:pC})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(_h)?e(r):(r.close(),await MO(),e(await Rg()))})})}async function L_(t,e,n){const r=If(t,!0).put({[pC]:e,value:n});return new ou(r).toPromise()}async function VO(t,e){const n=If(t,!1).get(e),r=await new ou(n).toPromise();return r===void 0?null:r.value}function M_(t,e){const n=If(t,!0).delete(e);return new ou(n).toPromise()}const OO=800,FO=3;class mC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Rg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>FO)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return hC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bf._getInstance(jO()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await NO(),!this.activeServiceWorker)return;this.sender=new RO(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||DO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Rg();return await L_(e,wh,"1"),await M_(e,wh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>L_(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>VO(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>M_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=If(i,!1).getAll();return new ou(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),OO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}mC.type="LOCAL";const UO=mC;new ru(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(t,e){return e?hi(e):(be(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv extends oC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ta(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ta(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ta(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function zO(t){return TO(t.auth,new nv(t),t.bypassAuthState)}function BO(t){const{auth:e,user:n}=t;return be(n,e,"internal-error"),_O(n,new nv(t),t.bypassAuthState)}async function $O(t){const{auth:e,user:n}=t;return be(n,e,"internal-error"),wO(n,new nv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zO;case"linkViaPopup":case"linkViaRedirect":return $O;case"reauthViaPopup":case"reauthViaRedirect":return BO;default:Zr(this.auth,"internal-error")}}resolve(e){Ci(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ci(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO=new ru(2e3,1e4);async function V_(t,e,n){if(Mn(t.app))return Promise.reject(br(t,"operation-not-supported-in-this-environment"));const r=iu(t);U6(t,e,ev);const i=gC(r,n);return new no(r,"signInViaPopup",e,i).executeNotNull()}class no extends yC{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,no.currentPopupAction&&no.currentPopupAction.cancel(),no.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return be(e,this.auth,"internal-error"),e}async onExecution(){Ci(this.filter.length===1,"Popup operations only handle one event");const e=tv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(br(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(br(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,no.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(br(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,WO.get())};e()}}no.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qO="pendingRedirect",wd=new Map;class HO extends yC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=wd.get(this.auth._key());if(!e){try{const r=await GO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}wd.set(this.auth._key(),e)}return this.bypassAuthState||wd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function GO(t,e){const n=YO(e),r=QO(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function KO(t,e){wd.set(t._key(),e)}function QO(t){return hi(t._redirectPersistence)}function YO(t){return xd(qO,t.config.apiKey,t.name)}async function XO(t,e){return await iu(t)._initializationPromise,vC(t,e,!1)}async function vC(t,e,n=!1){if(Mn(t.app))return Promise.reject(uo(t));const r=iu(t),i=gC(r,e),o=await new HO(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JO=10*60*1e3;class ZO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eF(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!xC(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(br(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=JO&&this.cachedEventUids.clear(),this.cachedEventUids.has(O_(e))}saveEventToCache(e){this.cachedEventUids.add(O_(e)),this.lastProcessedEventTime=Date.now()}}function O_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function xC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function eF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tF(t,e={}){return el(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rF=/^https?/;async function iF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await tF(t);for(const n of e)try{if(sF(n))return}catch{}Zr(t,"unauthorized-domain")}function sF(t){const e=kg(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!rF.test(n))return!1;if(nF.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=new ru(3e4,6e4);function F_(){const t=Xr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function aF(t){return new Promise((e,n)=>{var i,s,o;function r(){F_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{F_(),n(br(t,"network-request-failed"))},timeout:oF.get()})}if((s=(i=Xr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Xr().gapi)!=null&&o.load)r();else{const a=fO("iframefcb");return Xr()[a]=()=>{gapi.load?r():n(br(t,"network-request-failed"))},dO(`${hO()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw _d=null,e})}let _d=null;function lF(t){return _d=_d||aF(t),_d}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF=new ru(5e3,15e3),uF="__/auth/iframe",dF="emulator/auth/iframe",hF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pF(t){const e=t.config;be(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Q0(e,dF):`https://${t.config.authDomain}/${uF}`,r={apiKey:e.apiKey,appName:t.name,v:Ao},i=fF.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Kc(r).slice(1)}`}async function mF(t){const e=await lF(t),n=Xr().gapi;return be(n,t,"internal-error"),e.open({where:document.body,url:pF(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hF,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=br(t,"network-request-failed"),a=Xr().setTimeout(()=>{s(o)},cF.get());function l(){Xr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},yF=500,vF=600,xF="_blank",wF="http://localhost";class U_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _F(t,e,n,r=yF,i=vF){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...gF,width:r.toString(),height:i.toString(),top:s,left:o},d=dn().toLowerCase();n&&(a=JI(d)?xF:n),YI(d)&&(e=e||wF,l.scrollbars="yes");const h=Object.entries(l).reduce((p,[g,x])=>`${p}${g}=${x},`,"");if(rO(d)&&a!=="_self")return TF(e||"",a),new U_(null);const f=window.open(e||"",a,h);be(f,t,"popup-blocked");try{f.focus()}catch{}return new U_(f)}function TF(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SF="__/auth/handler",EF="emulator/auth/handler",bF=encodeURIComponent("fac");async function z_(t,e,n,r,i,s){be(t.config.authDomain,t,"auth-domain-config-required"),be(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ao,eventId:i};if(e instanceof ev){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",UD(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries(s||{}))o[h]=f}if(e instanceof su){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${bF}=${encodeURIComponent(l)}`:"";return`${IF(t)}?${Kc(a).slice(1)}${d}`}function IF({config:t}){return t.emulator?Q0(t,EF):`https://${t.authDomain}/${SF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gp="webStorageSupport";class CF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dC,this._completeRedirectFn=vC,this._overrideRedirectResult=KO}async _openPopup(e,n,r,i){var o;Ci((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await z_(e,n,r,kg(),i);return _F(e,s,tv())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await z_(e,n,r,kg(),i);return PO(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Ci(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await mF(e),r=new ZO(e);return n.register("authEvent",i=>(be(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Gp,{type:Gp},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[Gp];s!==void 0&&n(!!s),Zr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=iF(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return rC()||XI()||J0()}}const kF=CF;var B_="@firebase/auth",$_="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){be(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function PF(t){Ts(new Si("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;be(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iC(t)},d=new cO(r,i,s,l);return mO(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ts(new Si("auth-internal",e=>{const n=iu(e.getProvider("auth").getImmediate());return(r=>new AF(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),sr(B_,$_,RF(t)),sr(B_,$_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NF=5*60,DF=Wb("authIdTokenMaxAge")||NF;let W_=null;const jF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>DF)return;const i=n==null?void 0:n.token;W_!==i&&(W_=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function LF(t=of()){const e=Qc(t,"auth");if(e.isInitialized())return e.getImmediate();const n=pO(t,{popupRedirectResolver:kF,persistence:[UO,kO,dC]}),r=Wb("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=jF(s.toString());EO(n,o,()=>o(n.currentUser)),SO(n,a=>o(a))}}const i=Bb("auth");return i&&gO(n,`http://${i}`),n}function MF(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}uO({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=br("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",MF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});PF("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VF="type.googleapis.com/google.protobuf.Int64Value",OF="type.googleapis.com/google.protobuf.UInt64Value";function wC(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Th(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Th(e));if(typeof t=="function"||typeof t=="object")return wC(t,e=>Th(e));throw new Error("Data cannot be encoded in JSON: "+t)}function qa(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case VF:case OF:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>qa(e)):typeof t=="function"||typeof t=="object"?wC(t,e=>qa(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class kn extends Ar{constructor(e,n,r){super(`${rv}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,kn.prototype)}}function FF(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Sh(t,e){let n=FF(t),r=n,i;try{const s=e&&e.error;if(s){const o=s.status;if(typeof o=="string"){if(!q_[o])return new kn("internal","internal");n=q_[o],r=o}const a=s.message;typeof a=="string"&&(r=a),i=s.details,i!==void 0&&(i=qa(i))}}catch{}return n==="ok"?null:new kn(n,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(e,n,r,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Mn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||i==null||i.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pg="us-central1",zF=/^data: (.*?)(?:\n|$)/;function BF(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new kn("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class $F{constructor(e,n,r,i,s=Pg,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new UF(e,n,r,i),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(s);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=Pg}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function WF(t,e,n){const r=ei(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(rf(t.emulatorOrigin+"/backends"),sf("Functions",!0))}function qF(t,e,n){const r=i=>GF(t,e,i,n||{});return r.stream=(i,s)=>QF(t,e,i,s),r}function _C(t){return t.emulatorOrigin&&ei(t.emulatorOrigin)?"include":void 0}async function HF(t,e,n,r,i){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n,credentials:_C(i)})}catch{return{status:0,json:null}}let o=null;try{o=await s.json()}catch{}return{status:s.status,json:o}}async function TC(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function GF(t,e,n,r){const i=t._url(e);return KF(t,i,n,r)}async function KF(t,e,n,r){n=Th(n);const i={data:n},s=await TC(t,r),o=r.timeout||7e4,a=BF(o),l=await Promise.race([HF(e,i,s,t.fetchImpl,t),a.promise,t.cancelAllRequests]);if(a.cancel(),!l)throw new kn("cancelled","Firebase Functions instance was deleted.");const d=Sh(l.status,l.json);if(d)throw d;if(!l.json)throw new kn("internal","Response is not valid JSON object.");let h=l.json.data;if(typeof h>"u"&&(h=l.json.result),typeof h>"u")throw new kn("internal","Response is missing data field.");return{data:qa(h)}}function QF(t,e,n,r){const i=t._url(e);return YF(t,i,n,r||{})}async function YF(t,e,n,r){var p;n=Th(n);const i={data:n},s=await TC(t,r);s["Content-Type"]="application/json",s.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:s,signal:r==null?void 0:r.signal,credentials:_C(t)})}catch(g){if(g instanceof Error&&g.name==="AbortError"){const _=new kn("cancelled","Request was cancelled.");return{data:Promise.reject(_),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(_)}}}}}}const x=Sh(0,null);return{data:Promise.reject(x),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(x)}}}}}}let a,l;const d=new Promise((g,x)=>{a=g,l=x});(p=r==null?void 0:r.signal)==null||p.addEventListener("abort",()=>{const g=new kn("cancelled","Request was cancelled.");l(g)});const h=o.body.getReader(),f=XF(h,a,l,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const g=f.getReader();return{async next(){const{value:x,done:_}=await g.read();return{value:x,done:_}},async return(){return await g.cancel(),{done:!0,value:void 0}}}}},data:d}}function XF(t,e,n,r){const i=(o,a)=>{const l=o.match(zF);if(!l)return;const d=l[1];try{const h=JSON.parse(d);if("result"in h){e(qa(h.result));return}if("message"in h){a.enqueue(qa(h.message));return}if("error"in h){const f=Sh(0,h);a.error(f),n(f);return}}catch(h){if(h instanceof kn){a.error(h),n(h);return}}},s=new TextDecoder;return new ReadableStream({start(o){let a="";return l();async function l(){if(r!=null&&r.aborted){const d=new kn("cancelled","Request was cancelled");return o.error(d),n(d),Promise.resolve()}try{const{value:d,done:h}=await t.read();if(h){a.trim()&&i(a.trim(),o),o.close();return}if(r!=null&&r.aborted){const p=new kn("cancelled","Request was cancelled");o.error(p),n(p),await t.cancel();return}a+=s.decode(d,{stream:!0});const f=a.split(`
`);a=f.pop()||"";for(const p of f)p.trim()&&i(p.trim(),o);return l()}catch(d){const h=d instanceof kn?d:Sh(0,null);o.error(h),n(h)}}},cancel(){return t.cancel()}})}const H_="@firebase/functions",G_="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF="auth-internal",ZF="app-check-internal",e8="messaging-internal";function t8(t){const e=(n,{instanceIdentifier:r})=>{const i=n.getProvider("app").getImmediate(),s=n.getProvider(JF),o=n.getProvider(e8),a=n.getProvider(ZF);return new $F(i,s,o,a,r)};Ts(new Si(rv,e,"PUBLIC").setMultipleInstances(!0)),sr(H_,G_,t),sr(H_,G_,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n8(t=of(),e=Pg){const r=Qc(ut(t),rv).getImmediate({identifier:e}),i=s0("functions");return i&&r8(r,...i),r}function r8(t,e,n){WF(ut(t),e,n)}function Ho(t,e,n){return qF(ut(t),e,n)}t8();const i8={apiKey:"AIzaSyCbQY1wxVEoQVGdnylLPMq1-_4sNgucxg0",authDomain:"mindcraft-admin.firebaseapp.com",projectId:"mindcraft-admin",storageBucket:"mindcraft-admin.firebasestorage.app",messagingSenderId:"375110192152",appId:"1:375110192152:web:ade8d56b867b194944076d"},Cf=Kb(i8),Qs=s3(Cf),iz=j6(Cf),pr=LF(Cf),Go=n8(Cf);var dr,Nc,si,Ys;class Ng{constructor(e="cic_",n=null){He(this,si);He(this,dr,void 0);He(this,Nc,void 0);st(this,dr,e),st(this,Nc,n)}get(e,n=null){var r;try{const i=(r=ne(this,si,Ys))==null?void 0:r.getItem(ne(this,dr)+e);return i==null?n:JSON.parse(i)}catch(i){return console.error(`[StorageStore] Read error for "${e}":`,i),n}}set(e,n){var r,i;try{const s=JSON.stringify(n,(o,a)=>{if(!(o.startsWith("_")||o.startsWith("$"))&&!(typeof a=="function"||a instanceof Element))return a});(r=ne(this,si,Ys))==null||r.setItem(ne(this,dr)+e,s)}catch(s){console.error(`[StorageStore] Write error for "${e}":`,s);try{const o=JSON.parse(JSON.stringify(n,s8()));(i=ne(this,si,Ys))==null||i.setItem(ne(this,dr)+e,JSON.stringify(o))}catch{console.error(`[StorageStore] Total failure for "${e}"`)}}}remove(e){var n;(n=ne(this,si,Ys))==null||n.removeItem(ne(this,dr)+e)}purge(){const e=ne(this,si,Ys);if(!e)return;const n=[];for(let r=0;r<e.length;r++){const i=e.key(r);i!=null&&i.startsWith(ne(this,dr))&&n.push(i)}n.forEach(r=>e.removeItem(r))}keys(){const e=ne(this,si,Ys);if(!e)return[];const n=[];for(let r=0;r<e.length;r++){const i=e.key(r);i!=null&&i.startsWith(ne(this,dr))&&n.push(i.replace(ne(this,dr),""))}return n}}dr=new WeakMap,Nc=new WeakMap,si=new WeakSet,Ys=function(){return ne(this,Nc)||(typeof window<"u"?window.localStorage:null)};function s8(){const t=new WeakSet;return(e,n)=>{if(typeof n=="object"&&n!==null){if(t.has(n))return;t.add(n)}return n}}const Oi=new Ng("cic_v1_");var ba,hr,Dc,Ch,SC;const ua=class ua{constructor(){He(this,Ch);He(this,hr,null);He(this,Dc,void 0);if(ne(ua,ba))return ne(ua,ba);st(this,Dc,new Ng("cic_global_")),this.startSession=this.startSession.bind(this),this.endSession=this.endSession.bind(this),st(ua,ba,this)}startSession(e){if(!e)throw new Error("Security Violation: Attempted to start session without UID");ne(this,hr)&&ne(this,hr).uid!==e&&(console.warn("[SessionManager] Hot-swapping sessions. Purging previous."),this.endSession()),$t(this,Ch,SC).call(this,e);const n=`cic_user_${e}_`;st(this,hr,{uid:e,store:new Ng(n)}),console.info(`[SessionManager] Secure session initialized for ${e}`)}endSession(){if(!ne(this,hr))return;const e=ne(this,hr).uid;console.info(`[SessionManager] Ending session for ${e}`),st(this,hr,null)}get userStore(){if(!ne(this,hr))throw new Error("Security Violation: Attempted to access user storage without active session");return ne(this,hr).store}get globalStore(){return ne(this,Dc)}static purgeAllUserSessions(){console.info("[SessionManager] Executing FULL Manual Purge...");const e=window.localStorage,n=[];for(let r=0;r<e.length;r++){const i=e.key(r);i&&(i.startsWith("cic_user_")||i.startsWith("cic_lesson_")||i.startsWith("cic_v1_lessons"))&&n.push(i)}n.forEach(r=>e.removeItem(r)),console.info(`[SessionManager] Purged ${n.length} sensitive keys.`)}};ba=new WeakMap,hr=new WeakMap,Dc=new WeakMap,Ch=new WeakSet,SC=function(e){const n=window.localStorage,r=[],i=`cic_user_${e}_`;for(let s=0;s<n.length;s++){const o=n.key(s);o&&(o.startsWith("cic_user_")&&!o.startsWith(i)&&r.push(o),(o.startsWith("cic_lesson_")||o.startsWith("cic_v1_lessons"))&&r.push(o))}r.length>0&&(console.info(`[SessionManager] Cleaning up ${r.length} stale/legacy session keys.`),r.forEach(s=>n.removeItem(s)))},He(ua,ba,void 0);let Dg=ua;const Sa=new Dg,yn={IDLE:"IDLE",INITIALIZING:"INITIALIZING",READY:"READY",AUTHENTICATING:"AUTHENTICATING",SUCCESS:"SUCCESS",ERROR:"ERROR"},o8=["https://www.googleapis.com/auth/drive.file"];var Ia,Zi,oi,Ca,Vr,mn,ro,kh,jc,Lg,Lc,Mg,Mc,Vg,Or,Bi,Ah,EC,Rh,bC;const da=class da{constructor(){He(this,jc);He(this,Lc);He(this,Mc);He(this,Or);He(this,Ah);He(this,Rh);He(this,Zi,yn.IDLE);He(this,oi,null);He(this,Ca,new Set);He(this,Vr,null);He(this,mn,null);He(this,ro,null);He(this,kh,!1);if(ne(da,Ia))return ne(da,Ia);st(da,Ia,this)}subscribe(e){return ne(this,Ca).add(e),e(this.getSnapshot()),()=>ne(this,Ca).delete(e)}getSnapshot(){var e;return{user:this.user,status:ne(this,Zi),error:ne(this,oi),token:(e=ne(this,mn))==null?void 0:e.token,hasDrive:this.hasDriveAccess}}get state(){return ne(this,Zi)}get error(){return ne(this,oi)}get user(){var e;return ne(this,Zi)!==yn.SUCCESS||!((e=ne(this,mn))!=null&&e.token)?null:{...ne(this,Vr),token:ne(this,mn).token}}get token(){var e;return(e=ne(this,mn))==null?void 0:e.token}get uid(){var e,n;return((e=pr.currentUser)==null?void 0:e.uid)||((n=ne(this,Vr))==null?void 0:n.id)}get hasDriveAccess(){var e;return!!((e=ne(this,mn))!=null&&e.token)}async initialize(){return ne(this,ro)?ne(this,ro):(st(this,ro,(async()=>{$t(this,Or,Bi).call(this,yn.INITIALIZING);try{const e=await XO(pr);if(e){const n=tr.credentialFromResult(e);await $t(this,jc,Lg).call(this,e.user,n)}else if(pr.currentUser){console.info("[IdentityManager] User restored from Firebase persistence."),st(this,Vr,$t(this,Lc,Mg).call(this,pr.currentUser)),Sa.startSession(ne(this,Vr).id);try{console.info("[IdentityManager] Attempting silent Drive token restoration..."),await this.signIn({prompt:"none"})}catch(n){console.warn("[IdentityManager] Silent restoration failed. Forcing logout to maintain Atomic State.",n.message),await this.signOut()}}}catch(e){console.error("[IdentityManager] Initialization Error:",e),$t(this,Mc,Vg).call(this,e)}st(this,kh,!0),ne(this,Zi)===yn.INITIALIZING&&$t(this,Or,Bi).call(this,ne(this,Vr)?yn.SUCCESS:yn.READY)})()),ne(this,ro))}async ensureDriveAccess(){var e,n;if((e=ne(this,mn))!=null&&e.token&&ne(this,mn).expiresAt>Date.now()+3e5)return ne(this,mn).token;console.info("[IdentityManager] Drive token missing/stale. Re-acquiring...");try{return await this.signIn({prompt:"none"}),(n=ne(this,mn))==null?void 0:n.token}catch(r){throw console.warn("[IdentityManager] Silent re-acquisition failed."),r}}async signIn(e={prompt:"select_account"}){$t(this,Or,Bi).call(this,yn.AUTHENTICATING);const n=new tr;o8.forEach(r=>n.addScope(r)),e.prompt&&e.prompt!=="none"&&n.setCustomParameters({prompt:e.prompt});try{let r,i;if(e.prompt==="none"){const s=await V_(pr,n);r=s.user,i=tr.credentialFromResult(s)}else{const s=await V_(pr,n);r=s.user,i=tr.credentialFromResult(s)}await $t(this,jc,Lg).call(this,r,i)}catch(r){throw console.error("[IdentityManager] Sign-In Failed:",r.code,r.message),$t(this,Mc,Vg).call(this,r),r}}async signOut(){$t(this,Or,Bi).call(this,yn.AUTHENTICATING);try{await bO(pr),console.info("[IdentityManager] Signed out from Firebase.")}catch(e){console.error("[IdentityManager] Sign-out failed:",e)}finally{$t(this,Rh,bC).call(this)}}};Ia=new WeakMap,Zi=new WeakMap,oi=new WeakMap,Ca=new WeakMap,Vr=new WeakMap,mn=new WeakMap,ro=new WeakMap,kh=new WeakMap,jc=new WeakSet,Lg=async function(e,n){if(n!=null&&n.accessToken||console.warn("[IdentityManager] Success without token. Attempting immediate repair..."),st(this,Vr,$t(this,Lc,Mg).call(this,e)),st(this,mn,n!=null&&n.accessToken?{token:n.accessToken,expiresAt:Date.now()+3600*1e3}:null),!ne(this,mn))throw new Error("DRIVE_TOKEN_MISSING");Sa.startSession(e.uid),$t(this,Or,Bi).call(this,yn.SUCCESS),console.info("[IdentityManager] Atomic Login Success:",e.uid)},Lc=new WeakSet,Mg=function(e){return e?{id:e.uid,name:e.displayName,email:e.email,picture:e.photoURL,uid:e.uid}:null},Mc=new WeakSet,Vg=function(e){st(this,oi,`Authentication Error: ${e.message||String(e)}`),$t(this,Or,Bi).call(this,yn.ERROR,ne(this,oi))},Or=new WeakSet,Bi=function(e,n=null){st(this,Zi,e),n&&st(this,oi,n),$t(this,Ah,EC).call(this)},Ah=new WeakSet,EC=function(){const e=this.getSnapshot();ne(this,Ca).forEach(n=>n(e))},Rh=new WeakSet,bC=function(){st(this,Vr,null),st(this,mn,null),st(this,oi,null),Sa.endSession(),$t(this,Or,Bi).call(this,yn.IDLE)},He(da,Ia,null);let jg=da;const vr=new jg,a8=t=>vr.signIn(t),l8=()=>vr.requestDriveAccess(),IC=R.createContext(null),CC=({children:t})=>{const[e,n]=R.useState(vr.getSnapshot());R.useEffect(()=>{const o=vr.subscribe(a=>{n(a)});return vr.initialize().catch(a=>{console.error("[AuthProvider] Identity Initialization Failed:",a)}),()=>o()},[]);const r=R.useCallback((o="select_account")=>vr.signIn({prompt:o}),[]),i=R.useCallback(()=>{vr.signOut()},[]),s={user:e.user,authStatus:e.status,error:e.error,token:e.token,hasDrive:e.hasDrive,signIn:r,signOut:i,isLoading:e.status===yn.INITIALIZING||e.status===yn.AUTHENTICATING,isReady:e.status!==yn.IDLE&&e.status!==yn.INITIALIZING};return u.jsx(IC.Provider,{value:s,children:t})},Ls=()=>{const t=R.useContext(IC);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},c8="modulepreload",u8=function(t){return"/chethan-in-cardland/beta/"+t},K_={},gr=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=u8(s),s in K_)return;K_[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let h=i.length-1;h>=0;h--){const f=i[h];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const d=document.createElement("link");if(d.rel=o?"stylesheet":c8,o||(d.as="script",d.crossOrigin=""),d.href=s,document.head.appendChild(d),o)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},Q_=3,Y_=1e3,ho=async(t,e={},n=0)=>{var r,i,s,o,a,l,d,h;try{const f=await fetch(t,e);if(f.ok)return f;if(f.status===401&&n<1){console.info("[Network] Token invalid. Attempting silent refresh...");try{const g=await vr.acquireToken({prompt:"none",elevated:e._isElevated}),x={...e,headers:{...e.headers,Authorization:`Bearer ${g}`}};return await ho(t,x,n+1)}catch(g){throw console.error("[Network] Refresh failed.",g),new Error("REAUTH_NEEDED")}}if(f.status===403){const g=await f.json().catch(()=>({})),x=((s=(i=(r=g.error)==null?void 0:r.errors)==null?void 0:i[0])==null?void 0:s.reason)||"unknown",_=((o=g.error)==null?void 0:o.message)||"No detailed message";if(console.error("[Audit] 403 Forbidden detected.",{url:t,reason:x,message:_,tokenPrefix:((l=(a=e.headers)==null?void 0:a.Authorization)==null?void 0:l.substring(0,17))+"...",fullError:g}),x==="accessNotConfigured")console.error("[Audit] ROOT CAUSE: Google Drive API is likely DISABLED in the Google Cloud Console for this project.");else if(x==="insufficientPermissions"){console.error("[Audit] ROOT CAUSE: OAuth token is missing required scopes (drive.file or drive).");try{const k=(h=(d=e.headers)==null?void 0:d.Authorization)==null?void 0:h.replace("Bearer ","");if(k){const v=await(await fetch(`https://www.googleapis.com/oauth2/v3/tokeninfo?access_token=${k}`)).json();console.info("[Audit] Token Scope Info:",{scopes:v.scope,expires_in:v.expires_in,email:v.email})}}catch(k){console.warn("[Audit] Could not verify token scopes:",k)}}throw new Error(`REAUTH_NEEDED: ${x}: ${_}`)}if((f.status>=500||f.status===429)&&n<Q_){const g=Y_*Math.pow(2,n);return console.warn(`[Network] Transient error ${f.status}. Retrying in ${g}ms...`),await new Promise(x=>setTimeout(x,g)),await ho(t,e,n+1)}return f}catch(f){if(n<Q_){const p=Y_*Math.pow(2,n);return await new Promise(g=>setTimeout(g,p)),await ho(t,e,n+1)}throw f}},iv="https://www.googleapis.com/drive/v3/files",X_="https://www.googleapis.com/upload/drive/v3/files",kC="lesson_content_cache",kf=()=>{try{const t=Sa.userStore.get(kC,{});return new Map(Object.entries(t))}catch{return new Map}},sv=t=>{try{t.size>50&&Array.from(t.keys()).slice(0,t.size-50).forEach(i=>t.delete(i));const e=Object.fromEntries(t);Sa.userStore.set(kC,e)}catch(e){console.warn("Failed to save cache:",e)}},Af=t=>({Authorization:`Bearer ${t}`,"Content-Type":"application/json"}),d8=async t=>{const e="mimeType = 'application/json' and (name contains 'cic_lesson_' or name contains 'flashcard_stack_') and trashed = false",n="files(id, name, owners, permissions, ownedByMe, sharingUser, starred, createdTime, modifiedTime, appProperties)",r=`${iv}?q=${encodeURIComponent(e)}&fields=${n}&supportsAllDrives=true&includeItemsFromAllDrives=true&spaces=drive&t=${Date.now()}`,i=await ho(r,{headers:Af(t),_isElevated:!0});if(i.status===401)throw new Error("REAUTH_NEEDED");return(await i.json()).files||[]},h8=(t,e)=>{const r=kf().get(t);return r&&r.modifiedTime===e?{...r.content,driveFileId:t,_isCached:!0}:null},f8=async(t,e)=>{var n,r,i,s,o,a;try{const l=h8(e.id,e.modifiedTime);if(l)return{...l,ownedByMe:e.ownedByMe,ownerName:(r=(n=e.owners)==null?void 0:n[0])==null?void 0:r.displayName,sharingUser:e.sharingUser,isAccepted:e.ownedByMe||e.starred};const d=await p8(t,e.id),h=kf();return h.set(e.id,{content:d,modifiedTime:e.modifiedTime}),sv(h),typeof d=="string"?{encryptedContent:d,driveFileId:e.id,ownedByMe:e.ownedByMe,ownerName:(s=(i=e.owners)==null?void 0:i[0])==null?void 0:s.displayName,sharingUser:e.sharingUser,isAccepted:e.ownedByMe||e.starred,modifiedTime:e.modifiedTime}:{...d,driveFileId:e.id,ownedByMe:e.ownedByMe,ownerName:(a=(o=e.owners)==null?void 0:o[0])==null?void 0:a.displayName,sharingUser:e.sharingUser,isAccepted:e.ownedByMe||e.starred}}catch(l){return console.error(`[Drive] Fetch failed for ${e.id}`,l),{...m8(e),error:!0,errorMessage:l.message}}},p8=async(t,e)=>{const n=`${iv}/${e}?alt=media&t=${Date.now()}`,r=await ho(n,{headers:Af(t),_isElevated:!0});if(r.status===401)throw new Error("REAUTH_NEEDED");const i=await r.text();try{return JSON.parse(i)}catch{return i}},m8=t=>{const e=t.appProperties||{};return{id:e.id||t.id,driveFileId:t.id,title:e.title||t.name.replace("cic_lesson_","").replace("flashcard_stack_","").replace(".json","")||"Error Loading Lesson",label:e.label||"Unknown",questions:[],questionCount:parseInt(e.questionCount||e.cardsCount)||0,modifiedTime:t.modifiedTime,ownedByMe:t.ownedByMe,source:"drive"}},g8=async(t,e,n=null,r=null,i=null)=>{var l,d;const s={id:e.id,title:e.title,label:e.label||"",questionCount:String(e.questionCount!==void 0?e.questionCount:((l=e.questions)==null?void 0:l.length)||((d=e.cards)==null?void 0:d.length)||0),lastMarks:e.lastMarks!==void 0?String(e.lastMarks):"",nextReview:e.nextReview||"",reviewStage:e.reviewStage!==void 0?String(e.reviewStage):"-1"},o=`cic_lesson_${e.id}.json`;return y8(t,o,i!==null?i:e,n,"application/json",r,s)},AC=async(t,e)=>{const n=await ho(`${iv}/${e}`,{method:"DELETE",headers:Af(t),_isElevated:!0});if(!n.ok&&n.status!==404)throw new Error(`Drive Delete Failed: ${n.status}`);if(e){const r=kf();r.delete(e),sv(r)}return!0},y8=async(t,e,n,r=null,i="application/json",s=null,o=null)=>{var x;const a={name:e,mimeType:i};o&&(a.appProperties=o),s&&!r&&(a.parents=[s]);const l=r?`${X_}/${r}?uploadType=multipart`:`${X_}?uploadType=multipart`,d=r?"PATCH":"POST",h="-------314159265358979323846",f=`\r
--`+h+`\r
`,p=`\r
--`+h+"--",g=f+`Content-Type: application/json; charset=UTF-8\r
\r
`+JSON.stringify(a)+f+`Content-Type: application/json\r
\r
`+(typeof n=="string"?n:JSON.stringify(n))+p;try{const _=await ho(l,{method:d,headers:{...Af(t),"Content-Type":`multipart/related; boundary=${h}`},body:g,_isElevated:!0});if(_.status===401)throw new Error("REAUTH_NEEDED");if(!_.ok){const v=await _.json();throw new Error(((x=v.error)==null?void 0:x.message)||"Failed to save to Google Drive")}const k=await _.json(),S=kf();return S.set(k.id,{content:n,modifiedTime:k.modifiedTime||new Date().toISOString()}),sv(S),k}catch(_){throw _}},v8="DC3xQSHS3NL1vuxaPknC7KQI8mSv4VptXtLlKNBkJFE=",ov="AES-GCM",J_="PBKDF2",x8="SHA-256",w8=1e5,Z_=async(t,e="cic_default_salt")=>{const n=new TextEncoder,r=await crypto.subtle.importKey("raw",n.encode(v8+t),{name:J_},!1,["deriveBits","deriveKey"]),i=n.encode(e);return await crypto.subtle.deriveKey({name:J_,salt:i,iterations:w8,hash:x8},r,{name:ov,length:256},!1,["encrypt","decrypt"])},_8=async(t,e)=>{const n=new TextEncoder,r=typeof t=="string"?t:JSON.stringify(t),i=crypto.getRandomValues(new Uint8Array(12)),s=await crypto.subtle.encrypt({name:ov,iv:i},e,n.encode(r)),o=new Uint8Array(i.length+s.byteLength);o.set(i),o.set(new Uint8Array(s),i.length);const a=8192;let l="";for(let d=0;d<o.length;d+=a)l+=String.fromCharCode.apply(null,o.subarray(d,d+a));return btoa(l)},T8=async(t,e)=>{try{let n,r;if(t.startsWith("v1:")){const o=t.split(":"),a=o[1],l=o[2];n=new Uint8Array(a.match(/.{1,2}/g).map(h=>parseInt(h,16)));const d=atob(l);r=new Uint8Array(d.length);for(let h=0;h<d.length;h++)r[h]=d.charCodeAt(h)}else{const o=new Uint8Array(atob(t).split("").map(a=>a.charCodeAt(0)));n=o.slice(0,12),r=o.slice(12)}const i=await crypto.subtle.decrypt({name:ov,iv:n},e,r),s=new TextDecoder().decode(i);try{return JSON.parse(s)}catch{return s}}catch(n){throw console.error("[LessonCrypto] Decryption failed:",n),new Error("Lesson decryption failed. This content might be owned by another user or corrupted.")}};var Fr,Vc,Ph;class S8{constructor(e){He(this,Fr,new Map);He(this,Vc,void 0);He(this,Ph,3e3);st(this,Vc,e)}enqueue(e,n){const r=e.id;ne(this,Fr).has(r)&&clearTimeout(ne(this,Fr).get(r));const i=setTimeout(async()=>{ne(this,Fr).delete(r);try{await ne(this,Vc).syncToDrive(e,n)}catch(s){console.warn(`[SyncQueue] Background sync failed for ${r}, will retry on next flip.`,s.message)}},ne(this,Ph));ne(this,Fr).set(r,i)}async flush(){const e=Array.from(ne(this,Fr).entries());ne(this,Fr).clear();for(const[n,r]of e)clearTimeout(r)}hasPending(){return ne(this,Fr).size>0}}Fr=new WeakMap,Vc=new WeakMap,Ph=new WeakMap;const bl=()=>{try{return Sa.userStore}catch{return{get:(e,n)=>n,set:()=>{},remove:()=>{}}}};var ai,gn,io;class E8{constructor(){He(this,ai,!1);He(this,gn,null);He(this,io,void 0);st(this,io,new S8(this))}setDriveAccess(e,n=null){st(this,ai,e),st(this,gn,n),console.info(`[Storage] Strategy initialized: ${e?"Google Drive":"Local Persistence (Recruiter Mode)"}`)}async listLessons(){const e=bl(),n=e.get("lessons",[]);if(!ne(this,ai)||!ne(this,gn))return n;try{const i=(await d8(ne(this,gn))).map(a=>{const l=a.appProperties||{};return{id:l.id||a.id,driveFileId:a.id,title:l.title||a.name.replace("cic_lesson_","").replace(".json",""),questionCount:parseInt(l.questionCount||l.cardsCount)||0,lastMarks:l.lastMarks?parseInt(l.lastMarks):void 0,nextReview:l.nextReview||void 0,label:l.label||"No label",modifiedTime:a.modifiedTime,ownedByMe:a.ownedByMe}}),s=[],o=new Map(n.map(a=>[a.id,a]));return i.forEach(a=>{const l=o.get(a.id);l&&l.updatedAt&&(!a.modifiedTime||new Date(l.updatedAt)>new Date(a.modifiedTime))?s.push(l):s.push(a),l&&o.delete(a.id)}),s.push(...o.values()),e.set("lessons",s),s}catch(r){return console.error("[Storage] Drive fetch failed. Falling back to local.",r),n}}async getLessonContent(e){let n=null;const r=bl(),i=r.get("lessons_full",{}),s=i[e.id];if(s&&s.updatedAt&&(!e.modifiedTime||new Date(s.updatedAt)>=new Date(e.modifiedTime))&&(s.questions||s.cards))return s;if(ne(this,ai)&&ne(this,gn)&&e.driveFileId)try{n=await f8(ne(this,gn),{id:e.driveFileId,modifiedTime:e.modifiedTime});const l=vr.uid;if(n&&n.encryptedContent&&l){const d=await Z_(l),h=await T8(n.encryptedContent,d);n={...n,...h,encryptedContent:void 0}}n&&(n.questions||n.cards)&&(i[e.id]={...n,updatedAt:e.modifiedTime||new Date().toISOString()},r.set("lessons_full",i))}catch{console.warn("[Storage] Drive content fetch failed, hitting local cache:",e.id)}const a=l=>!l||!l.questions&&!l.cards||l.error;return a(n)&&(a(s)||(n=s)),n||e}async saveLesson(e,n=null){var h,f;const r=p=>!p||!p.questions&&!p.cards,i=bl(),s=i.get("lessons_full",{});let o={...e,updatedAt:new Date().toISOString()};if(r(o)){const p=s[e.id];r(p)||(o={...p,...o,updatedAt:new Date().toISOString()})}try{const p=JSON.parse(JSON.stringify(o,(g,x)=>{if(!(typeof x=="function"||x instanceof Element))return x}));s[e.id]=p,o=p}catch{s[e.id]=o}i.set("lessons_full",s);const a=i.get("lessons",[]),l=a.findIndex(p=>p.id===e.id),d={...o,questions:void 0,cards:void 0,questionCount:o.questionCount!==void 0?o.questionCount:((h=o.questions)==null?void 0:h.length)||((f=o.cards)==null?void 0:f.length)||0};return l>=0?a[l]=d:a.push(d),i.set("lessons",a),ne(this,ai)&&ne(this,io).enqueue(o,n),o}async syncToDrive(e,n){if(ne(this,ai)){if(!ne(this,gn))try{const r=await vr.ensureDriveAccess();r&&st(this,gn,r)}catch(r){console.warn("[Storage] Silent token recovery failed:",r.message)}if(ne(this,gn))try{let r=e;const i=vr.uid;if(i){const f=await Z_(i);r=await _8(e,f)}const s=e.driveFileId&&e.driveFileId.length>20?e.driveFileId:null,o=await g8(ne(this,gn),e,s,n,r),a=bl(),l=a.get("lessons_full",{}),d=a.get("lessons",[]);l[e.id]&&(l[e.id].driveFileId=o.id,l[e.id].modifiedTime=o.modifiedTime,a.set("lessons_full",l));const h=d.findIndex(f=>f.id===e.id);h>=0&&(d[h].driveFileId=o.id,d[h].modifiedTime=o.modifiedTime,a.set("lessons",d))}catch(r){const i=r.message||String(r);throw(i.includes("REAUTH_NEEDED")||i.includes("403"))&&st(this,gn,null),r}}}async deleteLesson(e){ne(this,ai)&&ne(this,gn)&&e.driveFileId&&await AC(ne(this,gn),e.driveFileId).catch(()=>{});const n=bl(),r=n.get("lessons",[]);n.set("lessons",r.filter(s=>s.id!==e.id));const i=n.get("lessons_full",{});delete i[e.id],n.set("lessons_full",i)}async shutdown(){await ne(this,io).flush()}hasPendingSyncs(){return ne(this,io).hasPending()}}ai=new WeakMap,gn=new WeakMap,io=new WeakMap;const xr=new E8,av="/chethan-in-cardland/beta/assets/logo-423dc48b.png",ki={}.VITE_ADMIN_EMAIL||"chethanincardland@gmail.com",b8="https://us-central1-mindcraft-admin.cloudfunctions.net/decryptPublicLesson",I8={}.VITE_UPI_ID||"vinayarajh1-1@okhdfcbank",C8={}.VITE_SUPPORT_PHONE||"919497449115",k8="ChethanInCardland",Oo={id:"demo-lesson",title:"General Knowledge (Demo)",titleImage:av,label:"Science",questions:[{id:1,question:{text:"What is the role of red blood cells?",image:"",audio:""},answer:{text:"They carry oxygen to body tissues.",image:"",audio:""}},{id:2,question:{text:"Why do we need sleep?",image:"",audio:""},answer:{text:"Sleep helps the body and brain recover and function properly.",image:"",audio:""}},{id:3,type:"mcq",question:{text:"Which part of the human body has no blood supply?",image:"",audio:""},options:[{id:"a",text:"Retina",isCorrect:!1},{id:"b",text:"Cornea",isCorrect:!0},{id:"c",text:"Brain",isCorrect:!1},{id:"d",text:"Liver",isCorrect:!1}],answer:{text:"Cornea",image:"",audio:""}},{id:4,question:{text:"Who was known as the Iron Man of India?",image:"",audio:""},answer:{text:"Sardar Vallabhbhai Patel was known as the Iron Man of India.",image:"",audio:""}},{id:5,type:"mcq",question:{text:"Which planet spins backwards compared to others?",image:"",audio:""},options:[{id:"a",text:"Mars",isCorrect:!1},{id:"b",text:"Earth",isCorrect:!1},{id:"c",text:"Venus",isCorrect:!0},{id:"d",text:"Jupiter",isCorrect:!1}],answer:{text:"Venus",image:"",audio:""}}],owner:ki,ownerName:"Demo User",avgRating:4.8,lastReviewed:"Jan 7, 2026",nextReview:new Date(Date.now()+3*24*60*60*1e3).toISOString(),reviewStage:0,isPublic:!1},A8=(t,e,n)=>{const[r,i]=R.useState([Oo]),[s,o]=R.useState([]),[a,l]=R.useState(!1),[d,h]=R.useState(!1),f=R.useRef(0),p=R.useRef([]),g=R.useRef(null),x=R.useCallback(async v=>{i(w=>{const j=w.findIndex(L=>L.id===v.id);if(j>=0){const L=[...w];return L[j]={...L[j],...v},L}return[v,...w]});try{await xr.saveLesson(v)}catch(w){console.error("[Lessons] Failed to persist update:",w),n==null||n("Auto-save failed","error")}},[n]),_=R.useCallback(async()=>{console.log("[Lessons] Public lessons are now real-time synced.")},[]);R.useEffect(()=>{let v=()=>{},w=!0;return(async()=>{h(!0);try{const[L,V]=await Promise.all([gr(()=>import("./localLessonsService-b405e72b.js"),[]),gr(()=>import("./publicDrive-e06dc611.js"),[])]);if(!w)return;const E=await L.listLocalLessons();v=V.subscribeToPublicLessons(T=>{if(!w)return;const I=new Set(T.map(P=>P.id)),A=[...T,...E.filter(P=>!I.has(P.id))];console.log(`[Lessons] Synced ${T.length} Cloud + ${E.length} Local`),o(A),h(!1)})}catch(L){console.error("[Lessons] Subscription failed:",L),w&&h(!1)}})(),()=>{w=!1,v()}},[]);const k=R.useCallback(async(v=!1)=>{if(!t){i([Oo]);return}if(!(!v&&Date.now()-f.current<6e4)){f.current=Date.now(),l(!0);try{const w=await xr.listLessons(),j=w.find(I=>I.id===Oo.id),L=j?{...Oo,...j}:Oo,V=w.filter(I=>I.id!==Oo.id);i([L,...V]),l(!1),g.current&&clearInterval(g.current),p.current=[],g.current=setInterval(()=>{const I=p.current.splice(0,p.current.length);I.length>0&&i(A=>{const P=[...A];return I.forEach(N=>{const b=P.findIndex(H=>H.id===N.id);b>=0&&(P[b]={...P[b],...N,loading:!1})}),P})},500);const E=[...V],T=async()=>{if(E.length===0)return;const I=E.shift();try{const A=await xr.getLessonContent(I);p.current.push(A)}catch{}await T()};if(await Promise.all([T(),T()]),p.current.length>0){const I=p.current.splice(0,p.current.length);i(A=>{const P=[...A];return I.forEach(N=>{const b=P.findIndex(H=>H.id===N.id);b>=0&&(P[b]={...P[b],...N,loading:!1})}),P})}g.current&&(clearInterval(g.current),g.current=null)}catch(w){console.error("[Lessons] Load failed:",w),l(!1)}}},[t]);R.useEffect(()=>{xr.setDriveAccess(e,t==null?void 0:t.token),e&&(t!=null&&t.token)&&t&&(console.log("[Lessons] Drive token active. Syncing My Lessons..."),k(!0))},[e,t==null?void 0:t.token,t,k]);const S=R.useCallback(async v=>{if(v){l(!0);try{const w=(t==null?void 0:t.email)===ki,j=v.source==="firestore"||v.isPublic&&!v.isLocal;if(w&&j){const{deletePublicLesson:L}=await gr(()=>import("./publicDrive-e06dc611.js"),[]);await L(v.id),o(V=>V.filter(E=>E.id!==v.id))}else await xr.deleteLesson(v),i(L=>L.filter(V=>V.id!==v.id))}catch(w){throw console.error(w),w}finally{l(!1)}}},[n]);return{lessons:r,publicLessons:s,loading:a,publicLoading:d,setLessons:i,setPublicLessons:o,fetchLessons:k,fetchPublicLessons:_,handleUpdateLocalLesson:x,deleteLesson:S}};var R8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const P8=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),N8=(t,e)=>{const n=R.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,children:a,...l},d)=>R.createElement("svg",{ref:d,...R8,width:i,height:i,stroke:r,strokeWidth:o?Number(s)*24/Number(i):s,className:`lucide lucide-${P8(t)}`,...l},[...e.map(([h,f])=>R.createElement(h,f)),...(Array.isArray(a)?a:[a])||[]]));return n.displayName=`${t}`,n};var ve=N8;const RC=ve("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),D8=ve("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),PC=ve("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Eh=ve("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),j8=ve("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),L8=ve("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),M8=ve("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),V8=ve("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Eo=ve("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),O8=ve("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),F8=ve("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]),lv=ve("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),U8=ve("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),NC=ve("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),DC=ve("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),jC=ve("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),z8=ve("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),B8=ve("Gift",[["polyline",{points:"20 12 20 22 4 22 4 12",key:"nda8fc"}],["rect",{width:"20",height:"5",x:"2",y:"7",key:"wkgdzj"}],["line",{x1:"12",x2:"12",y1:"22",y2:"7",key:"1n8zgp"}],["path",{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z",key:"zighg4"}],["path",{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z",key:"1pa5tk"}]]),Og=ve("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),$8=ve("Keyboard",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",ry:"2",key:"15u882"}],["path",{d:"M6 8h.001",key:"1ej0i3"}],["path",{d:"M10 8h.001",key:"1x2st2"}],["path",{d:"M14 8h.001",key:"1vkmyp"}],["path",{d:"M18 8h.001",key:"kfsenl"}],["path",{d:"M8 12h.001",key:"1sjpby"}],["path",{d:"M12 12h.001",key:"al75ts"}],["path",{d:"M16 12h.001",key:"931bgk"}],["path",{d:"M7 16h10",key:"wp8him"}]]),Fg=ve("Layers",[["polygon",{points:"12 2 2 7 12 12 22 7 12 2",key:"1b0ttc"}],["polyline",{points:"2 17 12 22 22 17",key:"imjtdl"}],["polyline",{points:"2 12 12 17 22 12",key:"5dexcv"}]]),W8=ve("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),q8=ve("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),H8=ve("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),LC=ve("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),G8=ve("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]),rs=ve("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),bh=ve("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),K8=ve("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),Q8=ve("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Y8=ve("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]),cv=ve("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),Rf=ve("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Ji=ve("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Pc=ve("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),tc=ve("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),X8=ve("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]),J8=ve("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Ug=ve("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Z8=ve("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),MC=ve("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),e9=ve("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),VC=ve("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),t9=ve("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]),zg=ve("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),n9=ve("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),yi=ve("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),r9=ve("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Td=ve("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),OC=ve("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),i9=ve("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),s9=ve("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),Qt=ve("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),o9=ve("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),a9=ve("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),l9=ve("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),c9=({message:t,type:e="info",onUndo:n,onClose:r,duration:i=5e3})=>(R.useEffect(()=>{if(i){const s=setTimeout(()=>{r()},i);return()=>clearTimeout(s)}},[i,r]),u.jsxs(Ue.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95,transition:{duration:.2}},className:"neo-flat toast-container",style:{position:"fixed",bottom:"1.5rem",left:"0.5rem",right:"0.5rem",margin:"0 auto",width:"fit-content",maxWidth:"calc(100% - 2rem)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"space-between",gap:"1rem",padding:"0.6rem 1rem",borderRadius:"50px",background:"var(--bg-color)",color:"var(--text-color)",boxShadow:"8px 8px 16px var(--shadow-dark), -8px -8px 16px var(--shadow-light)",border:"1px solid var(--shadow-light)"},children:[u.jsx("span",{style:{flex:1,fontSize:"0.85rem",fontWeight:"600",paddingLeft:"0.5rem",wordBreak:"break-word",lineHeight:"1.2",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexShrink:0},children:[e==="undo"&&n&&u.jsxs("button",{onClick:s=>{s.stopPropagation(),n(),r()},className:"neo-button",style:{padding:"0.3rem 0.7rem",fontSize:"0.7rem",background:"var(--accent-color)",color:"white",border:"none",borderRadius:"20px",display:"flex",alignItems:"center",gap:"4px",boxShadow:"2px 2px 5px rgba(0,0,0,0.2)",cursor:"pointer",fontWeight:"700"},children:[u.jsx(tc,{size:12}),"Undo"]}),u.jsx("button",{onClick:r,style:{background:"transparent",border:"none",color:"var(--text-color)",opacity:.3,cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%"},children:u.jsx(Qt,{size:16})})]})]})),FC=R.createContext(null),u9=({children:t})=>{const[e,n]=R.useState(null),[r,i]=R.useState(null),[s,o]=R.useState({showMenu:!1,showAddModal:!1,showFeedback:!1,showKnowMore:!1,showReferral:!1,showAdminPanel:!1,showCoinModal:!1,showNamePrompt:!1}),[a,l]=R.useState(!1),[d,h]=R.useState(null),[f,p]=R.useState(null),[g,x]=R.useState(null),[_,k]=R.useState(null),S=R.useCallback(()=>{o({showMenu:!1,showAddModal:!1,showFeedback:!1,showKnowMore:!1,showReferral:!1,showAdminPanel:!1,showCoinModal:!1,showNamePrompt:!1}),p(null),x(null),k(null)},[]),v=R.useCallback((I,A=null)=>{o(P=>({...P,[I]:A!==null?A:!P[I]}))},[]),w=R.useCallback((I,A,P=null)=>{n({type:I,message:A,onConfirm:P})},[]),j=R.useCallback(()=>{n(null)},[]),L=R.useCallback(({message:I,type:A="info",onUndo:P=null,duration:N=5e3,onClose:b=null})=>{i({id:Date.now(),message:I,type:A,onUndo:P,duration:N,onCloseCallback:b})},[]),V=R.useCallback(()=>{i(I=>(I!=null&&I.onCloseCallback&&I.onCloseCallback(),null))},[]),E=R.useCallback((I,A=3e3)=>{const P=Date.now();h({id:P,message:I}),setTimeout(()=>{h(N=>(N==null?void 0:N.id)===P?null:N)},A)},[]),T=R.useCallback(()=>{h(null)},[]);return u.jsxs(FC.Provider,{value:{modals:s,toggleModal:v,closeAllModals:S,activeLesson:f,setActiveLesson:p,reviewLesson:g,setReviewLesson:x,noteLesson:_,setNoteLesson:k,notification:e,showNotification:w,clearNotification:j,toast:r,showToast:L,hideToast:V,headerLoading:a,setHeaderLoading:l,headerNotice:d,showHeaderNotice:E,clearHeaderNotice:T},children:[t,u.jsx(Cn,{children:r&&u.jsx(c9,{message:r.message,type:r.type,onUndo:r.onUndo,duration:r.duration,onClose:V},r.id)})]})},Do=()=>{const t=R.useContext(FC);if(!t)throw new Error("useUI must be used within a UIProvider");return t},UC=R.createContext(null),d9=({children:t})=>{const{user:e,hasDrive:n}=Ls(),{showNotification:r}=Do(),i=R.useCallback(o=>{o&&r(o.type,o.message,o.onConfirm)},[r]),s=A8(e,n,i);return u.jsx(UC.Provider,{value:s,children:t})},zC=()=>{const t=R.useContext(UC);if(!t)throw new Error("useLesson must be used within a LessonProvider");return t},Fo="users",rr={async syncProfile(t,e=!1){if(!(t!=null&&t.uid))return null;const n=qo(Qs,Fo,t.uid),r=await yd(n),i={uid:t.uid,email:t.email,displayName:t.displayName||"Learner",photoURL:t.photoURL||null,lastSeen:qu()};if(r.exists()){const s=r.data(),o={...i,loginCount:e?(s.loginCount||0)+1:s.loginCount||1};return await $p(n,o),{...s,...o}}else{const s={...i,coins:0,totalReviews:0,loginCount:1,createdAt:qu()};return await T3(n,s),{...s,id:t.uid}}},async getProfile(t){if(!t)return null;const e=await yd(qo(Qs,Fo,t));return e.exists()?{...e.data(),id:e.id}:null},async getEntitlements(t){if(!t)return{};const e=await yd(qo(Qs,Fo,t));return e.exists()?e.data().purchasedLessons||{}:{}},async archiveLesson(t,e){if(!t||!e)return;const n=qo(Qs,Fo,t);await $p(n,{[`purchasedLessons.${e}.archived`]:!0,[`purchasedLessons.${e}.archivedAt`]:qu()})},async restoreLesson(t,e){if(!t||!e)return;const n=qo(Qs,Fo,t);await $p(n,{[`purchasedLessons.${e}.archived`]:!1,[`purchasedLessons.${e}.restoredAt`]:qu()})},async purchaseLesson(t,e,n,r){return(await Ho(Go,"purchaseLesson")({lessonId:e,cost:n,title:r})).data},async checkDailyBonus(t){return(await Ho(Go,"checkDailyBonus")()).data},async applyReferral(t,e){return(await Ho(Go,"applyReferral")({referralCode:e})).data},async checkReferralCompletion(t,e,n,r){return(await Ho(Go,"checkReferralCompletion")({lessonId:e,isDemo:n,isUserCreated:r})).data},async updateBalance(t,e){throw new Error("Direct balance updates are disabled for security. Use specific action functions.")},async adminAddCoins(t,e){return(await Ho(Go,"grantCoins")({uid:t,amount:e})).data},async listUsers(){const t=v3(i3(Qs,Fo));return(await _3(t)).docs.map(n=>({...n.data(),id:n.id}))}},h9=(t,e,n)=>{const[r,i]=R.useState(null),[s,o]=R.useState(!1),[a,l]=R.useState(0),d=R.useRef(0),h=R.useRef(null);R.useEffect(()=>{if(!(t!=null&&t.uid)){i(null);return}let p=!0;const g=async()=>{r||o(!0);try{const _=h.current!==t.uid,k=await rr.syncProfile(t,_);if(!p)return;_&&(h.current=t.uid);const S=localStorage.getItem("pendingReferral");if(S&&!k.referredBy&&await rr.applyReferral(t.uid,S)){localStorage.removeItem("pendingReferral"),e&&e({type:"alert",message:"Referral bonus applied!"});const j=await rr.syncProfile(t,!1);p&&i(j);return}const v=await rr.checkDailyBonus(t.uid);if(!p)return;if(v.awarded&&(n&&n({amount:v.bonus,type:"Daily Login"}),k.coins=v.newBalance),k.coins>d.current&&d.current>0){const w=k.coins-d.current;n&&n({amount:w,type:"Gift Received"})}d.current=k.coins,i(k)}catch(_){console.error("[useUserProfile] Sync Failed:",_)}finally{p&&o(!1)}};g();const x=()=>{document.visibilityState==="visible"&&(t!=null&&t.uid)&&g()};return window.addEventListener("visibilitychange",x),()=>{p=!1,window.removeEventListener("visibilitychange",x)}},[t==null?void 0:t.uid,e,n,a]);const f=R.useCallback(p=>{!t||!r||i(g=>({...g,coins:p}))},[t,r]);return{userProfile:r,setUserProfile:i,isProfileLoading:s,handleUpdateCoins:f,loadProfile:R.useCallback(()=>l(p=>p+1),[])}},f9=(t,e="")=>{const n=R.useRef(!1);R.useEffect(()=>{const i=s=>{if(t&&!n.current)return s.preventDefault(),s.returnValue=e,e};return window.addEventListener("beforeunload",i),()=>window.removeEventListener("beforeunload",i)},[t,e]);const r=R.useCallback(()=>{n.current=!0},[]);return R.useEffect(()=>{var i;t&&!n.current&&((i=window.history.state)==null?void 0:i.guard)!=="active"&&window.history.pushState({guard:"active"},"")},[t]),{allowExit:r}},BC=R.createContext(null),$C=({children:t})=>{const[e,n]=R.useState({isActive:!1,currentStep:1,isComplete:localStorage.getItem("tour_complete")==="true",isDemoGracePeriod:!1,eventQueue:[]}),r=R.useRef(null);R.useEffect(()=>{e.isComplete&&localStorage.setItem("tour_complete","true")},[e.isComplete]);const i=R.useCallback(()=>{n(f=>({...f,isActive:!0,currentStep:1}))},[]),s=R.useCallback(()=>{n(f=>({...f,isActive:!1,currentStep:1}))},[]),o=R.useCallback(()=>{n(f=>({...f,currentStep:f.currentStep+1}))},[]),a=R.useCallback(f=>{n(p=>({...p,currentStep:f}))},[]),l=R.useCallback(f=>{n(p=>({...p,eventQueue:[...p.eventQueue,f]}))},[]),d=R.useCallback(()=>{if(e.eventQueue.length===0)return;const[f,...p]=e.eventQueue;f(),n(g=>({...g,eventQueue:p}))},[e.eventQueue]);R.useEffect(()=>{if(e.eventQueue.length===0||e.isActive)return;const f=()=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{d()},3e3)};return window.addEventListener("mousemove",f),window.addEventListener("keydown",f),window.addEventListener("click",f),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("keydown",f),window.removeEventListener("click",f),r.current&&clearTimeout(r.current)}},[e.eventQueue,e.isActive,d]);const h={...e,startTour:i,endTour:s,nextStep:o,setStep:a,queuePostTourEvent:l,setIsDemoGracePeriod:f=>n(p=>({...p,isDemoGracePeriod:f}))};return u.jsx(BC.Provider,{value:h,children:t})},au=()=>{const t=R.useContext(BC);if(!t)throw new Error("useTour must be used within a TourProvider");return t},WC={decryptPublicLesson:async(t,e,n)=>{if(!n)throw new Error("User must be authenticated to decrypt lessons.");if(!e)throw new Error("Lesson ID is required for secure decryption.");try{const r=await fetch(b8,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({lessonId:e,data:t})});if(!r.ok){let s=r.statusText;try{const o=await r.json();s=o.error||o.message||s}catch{}throw r.status===401?new Error(`Unauthorized: ${s}`):r.status===403?new Error(`Forbidden: ${s}`):r.status===429?new Error("Rate Limit Exceeded. Please try again later."):new Error(`Decryption Server Error: ${s}`)}const i=await r.json();return i.data||i}catch(r){throw console.error("[DecryptionService] Remote decryption failed:",r),r}}},Kp=Object.freeze(Object.defineProperty({__proto__:null,decryptionService:WC},Symbol.toStringTag,{value:"Module"})),p9=()=>{const{user:t,token:e}=Ls(),{showToast:n}=Do(),r=R.useRef(!1),i=R.useCallback(async(s=!1,o=null)=>{var a;if(!(!t||!e||r.current)){r.current=!0,console.log(`[EntitlementSync] ${s?"Manual":"Auto"} audit started...`);try{const l=await rr.getEntitlements(t.uid);if(!l||Object.keys(l).length===0){s&&n({message:"No purchased lessons found to restore.",type:"info"}),r.current=!1;return}const d=await xr.listLessons(),h=new Set(d.map(x=>x.id)),f=Object.keys(l).filter(x=>!(l[x].archived||h.has(x)));if(f.length===0){console.log("[EntitlementSync] All clear. No missing lessons."),s&&n({message:"Your library is already up to date.",type:"success"}),r.current=!1;return}console.log(`[EntitlementSync] Found ${f.length} missing lessons. Initiating restore...`,f),s&&n({message:`Restoring ${f.length} purchased lesson(s)...`,type:"info",duration:4e3});const{getPublicFileContent:p}=await gr(()=>import("./publicDrive-e06dc611.js"),[]);let g=0;for(const x of f)try{const _=qo(Qs,"lessons",x),k=await yd(_);if(!k.exists()){console.error(`[EntitlementSync] Cannot restore ${x}: Metadata missing from catalog.`);continue}const S=k.data(),v=S.storagePath||`lessons/${S.type==="premium"?"premium":"free"}/${x}.enc`,w=await p(v);let j;if(typeof w=="string"){const L=await((a=pr.currentUser)==null?void 0:a.getIdToken(!0));j=await WC.decryptPublicLesson(w,x,L)}else j=w;j.id=x,await xr.saveLesson(j),g++,console.log(`[EntitlementSync] Restored ${x} successfully.`)}catch(_){console.error(`[EntitlementSync] Failed to restore ${x}:`,_)}g>0&&o&&await o(),s&&n({message:g>0?`Successfully restored ${g} lesson(s).`:"No lessons were restored.",type:g>0?"success":"info"})}catch(l){console.error("[EntitlementSync] Audit failed:",l),s&&n({message:"Failed to restore purchases. Please try again.",type:"error"})}finally{r.current=!1}}},[t,e,n]);return R.useEffect(()=>{if(!t||!e)return;const s=setTimeout(()=>i(!1),2e3);return()=>clearTimeout(s)},[t,e,i]),{performSync:i}},Bg=(t,e=["image/","audio/"])=>{if(!t||typeof t!="string"||t.toLowerCase().startsWith("javascript:")||t.toLowerCase().startsWith("data:text/html"))return!1;if(t.startsWith("data:")){const n=t.match(/^data:([^;,]+)/);if(!n)return!1;const r=n[1].toLowerCase();if(!e.some(s=>r.startsWith(s)))return!1}return!0},Ea=(t,e=1e4)=>{if(!t||typeof t!="string")return"";let n=t.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"");return n.length>e&&(n=n.substring(0,e)),n},m9=t=>{if(!t||typeof t!="string")return"Untitled";let e=t.replace(/[\x00-\x1F\x7F]/g,"");return e=e.trim(),e.length>50&&(e=e.substring(0,50)),e=e.replace(/[&=?#]/g,""),e||"Untitled"},g9=t=>{if(!t||typeof t!="string")return"";let e=t.substring(0,500);return e=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,""),e=e.replace(/[*_~`]/g,""),e.trim()},y9=t=>!t||typeof t!="string"?!1:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),v9=t=>{if(!t)return{text:"New",isOverdue:!1,color:"inherit"};const e=new Date,i=(new Date(t)-e)/(1e3*60*60*24);if(i<0){const s=Math.ceil(Math.abs(i));return s===0?{text:"Due: Today",isOverdue:!0,color:"#ef4444"}:{text:`Due: ${s} day${s===1?"":"s"} ago`,isOverdue:!0,color:"#ef4444"}}else{const s=Math.ceil(i);return s===0?{text:"Due: Today",isOverdue:!0,color:"#ef4444"}:s===1?{text:"Review: Tomorrow",isOverdue:!1,color:"var(--text-color)"}:{text:`Review: in ${s} days`,isOverdue:!1,color:"var(--text-color)"}}},eT=({lesson:t,onReview:e,onEdit:n,onImport:r,user:i,onDelete:s,showConfirm:o})=>{var f,p,g,x,_,k,S,v,w;const a=m9(t.title),d=(i==null?void 0:i.email)===ki||!t.isPublic;let h=null;return t.titleImage&&Bg(t.titleImage,["image/"])?h=t.titleImage:(g=(p=(f=t.questions)==null?void 0:f[0])==null?void 0:p.question)!=null&&g.image&&Bg(t.questions[0].question.image,["image/"])?h=t.questions[0].question.image:h=`https://ui-avatars.com/api/?name=${encodeURIComponent(a)}&background=random&color=fff&size=128`,t.loading?u.jsxs("div",{className:"neo-flat lesson-card",style:{height:"100%",position:"relative",overflow:"hidden"},children:[u.jsxs("div",{className:"shimmer-wrapper",children:[u.jsx("div",{className:"shimmer",style:{width:"40px",height:"20px",borderRadius:"12px",marginBottom:"1rem"}}),u.jsx("div",{className:"shimmer",style:{width:"100%",height:"140px",borderRadius:"12px",marginBottom:"1rem"}}),t.title&&t.title!=="Loading..."?u.jsx("div",{style:{marginBottom:"0.5rem",height:"40px",fontWeight:"600",fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.title}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"shimmer",style:{width:"80%",height:"20px",borderRadius:"4px",marginBottom:"0.5rem"}}),u.jsx("div",{className:"shimmer",style:{width:"60%",height:"20px",borderRadius:"4px"}})]})]}),u.jsx("style",{children:`
                    .shimmer-wrapper { padding: 0.5rem; width: 100%; height: 100%; }
                    .shimmer {
                        background: linear-gradient(90deg, var(--bg-color) 0%, var(--neo-shadow-light) 50%, var(--bg-color) 100%);
                        background-size: 200% 100%;
                        animation: shimmer 1.5s infinite;
                    }
                    @keyframes shimmer {
                        0% { background-position: -200% 0; }
                        100% { background-position: 200% 0; }
                    }
                `})]}):u.jsxs("div",{className:"neo-flat lesson-card",id:t.id==="demo-lesson"?"lesson-card-demo-lesson":void 0,onClick:()=>e(t),style:{position:"relative",display:"flex",flexDirection:"column",height:"100%"},children:[d&&u.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:2,display:"flex",gap:"8px"},children:[u.jsx("button",{className:"neo-button icon-btn",onClick:j=>{j.stopPropagation(),n(t)},style:{background:"var(--bg-color)",opacity:.8},title:"Edit Lesson",children:u.jsx(cv,{size:18,color:"var(--accent-color)"})}),u.jsx("button",{className:"neo-button icon-btn",onClick:j=>{j.stopPropagation(),s(t)},style:{background:"var(--bg-color)",opacity:.8,color:"#ef4444"},title:"Delete Lesson",children:u.jsx(yi,{size:18})})]}),u.jsxs("div",{className:"neo-flat",style:{position:"absolute",top:"12px",left:"12px",zIndex:2,display:"flex",alignItems:"center",gap:"4px",fontSize:"0.8rem",fontWeight:"600",padding:"4px 8px",borderRadius:"12px",opacity:.9},children:[u.jsx(Fg,{size:14}),t.questionCount!==void 0?t.questionCount:((x=t.questions)==null?void 0:x.length)||((_=t.cards)==null?void 0:_.length)||0]}),u.jsx("img",{src:h,alt:t.title,style:{width:"100%",height:"140px",objectFit:"contain",borderRadius:"12px",background:"var(--bg-color)"}}),u.jsx("div",{style:{marginTop:"0.8rem"},children:u.jsx("h3",{style:{fontSize:"0.95rem",fontWeight:"600",marginBottom:"0.2rem",display:"-webkit-box",WebkitLineClamp:5,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"1.35",minHeight:"2.7em",textAlign:"left",color:"var(--text-color)",opacity:.9,padding:"0 2px"},title:t.title,children:t.title})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"auto",gap:"1rem",paddingTop:"1rem"},children:[t.isPublic&&u.jsxs("button",{className:`neo-button ${t.isOwned?"owned-btn":""}`,style:{flex:1,padding:"0.6rem",background:t.isOwned?"#16a34a":t.cost>0?"#f59e0b":"var(--accent-color)",color:"white",border:"none",fontSize:"0.85rem",display:"flex",gap:"6px",alignItems:"center",justifyContent:"center",borderRadius:"12px",cursor:t.isOwned?"default":"pointer",opacity:t.isOwned?.9:1},onClick:j=>{j.stopPropagation(),!t.isOwned&&(i?r(t):e(t))},children:[t.isOwned?u.jsx(Fg,{size:14}):i?t.cost>0?u.jsx(lv,{size:14}):u.jsx(Ji,{size:14}):null,t.isOwned?"Owned":i?t.cost>0?`Buy for ${t.cost}`:"Free - Add to My Lessons":"Login with Google to Open"]}),!t.isPublic&&u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.6rem",flex:1,minWidth:0},children:t.lastMarks!==void 0?u.jsxs("div",{className:"neo-flat",style:{padding:"6px 10px",borderRadius:"12px",textAlign:"center",fontSize:"0.8rem",color:"var(--accent-color)",fontWeight:"700"},children:["Marks: ",t.lastMarks,"/",(t.questionCountAtLastReview||((k=t.questions)==null?void 0:k.length)||((S=t.cards)==null?void 0:S.length)||0)*2]}):t.lastSessionIndex!==void 0?u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("div",{className:"neo-inset",style:{height:"6px",width:"100%",borderRadius:"3px",overflow:"hidden",padding:"0"},children:u.jsx("div",{style:{height:"100%",width:`${t.lastSessionIndex/(((v=t.questions)==null?void 0:v.length)||((w=t.cards)==null?void 0:w.length)||1)*100}%`,background:"var(--accent-color)"}})}),u.jsx("button",{className:"neo-button",style:{width:"100%",padding:"0.4rem",fontSize:"0.75rem",fontWeight:"800",background:"var(--accent-color)",color:"white",border:"none",justifyContent:"center"},children:"RESUME"})]}):u.jsx("div",{className:"neo-flat",style:{padding:"6px 10px",borderRadius:"12px",textAlign:"center",fontSize:"0.8rem",opacity:.5,fontWeight:"700"},children:"New"})}),!t.isPublic&&u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center",gap:"0.1rem",fontSize:"0.7rem",opacity:.8,flexShrink:0,textAlign:"right"},children:[t.nextReview&&u.jsx("div",{style:{display:"flex",alignItems:"center",gap:"3px",opacity:.7},children:u.jsx(L8,{size:10})}),u.jsx("div",{id:t.id==="demo-lesson"?"next-review-indicator-demo-lesson":void 0,style:{whiteSpace:"nowrap"},children:u.jsx(x9,{nextReview:t.nextReview})})]})]}),u.jsx("style",{children:`
        .lesson-card:hover { transform: translateY(-5px); }
      `})]})},x9=({nextReview:t})=>{const{text:e,isOverdue:n,color:r}=v9(t);return u.jsx("span",{style:{color:r,fontWeight:n?"700":"600",fontSize:n?"0.85rem":"0.9rem"},children:e})},yr=({label:t,value:e,options:n,onChange:r,placeholder:i="Select...",displayValue:s=l=>l,style:o={},children:a})=>{const[l,d]=R.useState(!1),h=R.useRef(null);return R.useEffect(()=>{const f=p=>{h.current&&!h.current.contains(p.target)&&d(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]),u.jsxs("div",{ref:h,style:{display:"flex",flexDirection:"column",gap:"0.4rem",position:"relative",width:"100%",...o},children:[t&&u.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontWeight:"600",marginLeft:"4px"},children:t}),u.jsxs("button",{className:"neo-select",style:{textAlign:"left",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",width:"100%",position:"relative",height:"48px"},onClick:()=>d(!l),children:[u.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e?s(e):i}),u.jsx(O8,{size:18,style:{transform:l?"rotate(180deg)":"none",transition:"transform 0.3s",marginLeft:"8px",flexShrink:0}})]}),l&&u.jsxs("div",{className:"neo-flat",style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"8px",zIndex:1e3,padding:"8px",display:"flex",flexDirection:"column",gap:"4px",maxHeight:"300px",overflowY:"auto",boxShadow:"10px 10px 20px var(--shadow-dark), -10px -10px 20px var(--shadow-light)"},children:[a,n.map((f,p)=>{const g=e===f.value;return u.jsx("button",{className:`neo-button ${g?"neo-inset":""}`,style:{padding:"10px 14px",fontSize:"0.9rem",cursor:"pointer",boxShadow:g?"inset 2px 2px 5px var(--shadow-dark), inset -2px -2px 5px var(--shadow-light)":"none",background:g?"var(--accent-soft)":"transparent",border:"none",borderRadius:"8px",width:"100%",textAlign:"left",justifyContent:"flex-start",color:g?"var(--accent-color)":"var(--text-color)",fontWeight:g?"700":"500"},onClick:()=>{r(f.value),d(!1)},children:f.label},p)})]})]})},w9=({activeTab:t,setActiveTab:e,lessons:n,publicLessons:r,loading:i,publicLoading:s,onReview:o,onEdit:a,onImport:l,searchQuery:d,setSearchQuery:h,onShowFeedback:f,filters:p,setFilters:g,user:x,onLogin:_,sortBy:k,onSortChange:S,filterLabel:v,onLabelChange:w,availableLabels:j,onShowKnowMore:L,onDelete:V,showConfirm:E,onAddLesson:T,onRefresh:I})=>{const{isActive:A,startTour:P}=au(),{error:N,isReady:b,user:H}=Ls(),he=t==="my-lessons"?i:s,re=t==="my-lessons"&&!i&&!x&&!A,[se,U]=R.useState(!1),G=Ir.useRef(null),M=Ir.useMemo(()=>{const $={standards:new Set,syllabuses:new Set,mediums:new Set,subjects:new Set};return r.forEach(ae=>{ae.standard&&$.standards.add(ae.standard),ae.syllabus&&$.syllabuses.add(ae.syllabus),ae.medium&&$.mediums.add(ae.medium),ae.subject&&$.subjects.add(ae.subject)}),{standards:Array.from($.standards).sort(),syllabuses:Array.from($.syllabuses).sort(),mediums:Array.from($.mediums).sort(),subjects:Array.from($.subjects).sort()}},[r]),{standards:D,syllabuses:q,mediums:J,subjects:ee}=M,ie=new Set(n.map($=>$.lessonId||$.storagePath||$.driveFileId||$.id)),Z=r.filter($=>{if(!$||!$.title)return!1;const ae=d.toLowerCase().trim(),ke=/^\d+\.$/.test(ae),Ge=$.title.toLowerCase(),Ye=ke?new RegExp(`(^|\\s)${ae.replace(".","\\.")}(\\s|$)`).test(Ge):Ge.includes(ae),Xe=!p.standard||$.standard===p.standard,dt=!p.syllabus||$.syllabus===p.syllabus,Ne=!p.medium||$.medium===p.medium,qe=!p.subject||$.subject===p.subject;return Ye&&Xe&&dt&&Ne&&qe}).map($=>({...$,isOwned:ie.has($.lessonId||$.storagePath||$.id)})).sort(($,ae)=>k==="Title"?$.title.localeCompare(ae.title):(parseInt(ae.id||0)||0)-(parseInt($.id||0)||0)),z=t==="my-lessons"?n:Z,Y=($,ae)=>{g(ke=>({...ke,[$]:ae}))},pe=()=>u.jsxs("div",{style:{position:"relative",display:"inline-flex"},ref:G,children:[u.jsx("button",{className:`icon-btn ${se?"active":""}`,onClick:$=>{$.stopPropagation(),U(!se)},style:{background:"none",border:"none",boxShadow:"none",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)",cursor:"pointer",opacity:.6,padding:0},title:"Settings",children:se?u.jsx(Qt,{size:20}):u.jsx(MC,{size:20})}),se&&u.jsxs("div",{className:"neo-flat settings-dropdown",style:{position:"absolute",top:"calc(100% + 10px)",right:0,width:"280px",padding:"2rem 1.5rem",zIndex:2e3,borderRadius:"24px",display:"flex",flexDirection:"column",gap:"1.75rem",border:"1px solid rgba(255,255,255,0.4)",boxShadow:"var(--neo-box-shadow)"},children:[u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem"},children:u.jsxs("div",{style:{position:"relative"},children:[u.jsx(Ug,{size:16,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",opacity:.5}}),u.jsx("input",{className:"neo-input",placeholder:"Search...",value:d,onChange:$=>h($.target.value),style:{width:"100%",paddingLeft:"38px",fontSize:"0.9rem",height:"44px",boxShadow:"inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light)"}})]})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:700,opacity:.5,marginLeft:"4px"},children:"Sort By"}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem"},children:(t==="my-lessons"?[{label:"Date",value:"Creation Date"},{label:"Title",value:"Title"},{label:"Marks",value:"Average Rating"},{label:"Reviews",value:"Upcoming Review"}]:[{label:"Newest",value:"Creation Date"},{label:"Title",value:"Title"}]).map($=>u.jsx("button",{className:`neo-button ${k===$.value?"neo-glow-blue":""}`,onClick:()=>S($.value),style:{padding:"0.6rem 0.4rem",fontSize:"0.8rem",borderRadius:"10px",justifyContent:"center"},children:$.label},$.value))})]}),u.jsxs("button",{className:"neo-button",onClick:()=>{I==null||I(),U(!1)},style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",padding:"0.9rem",borderRadius:"14px"},children:[u.jsx(Pc,{size:18})," Refresh Lessons"]})]})]}),_e=()=>u.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"2rem",gap:"0.5rem",alignItems:"center"},children:u.jsxs("div",{id:"tabs-container",className:"neo-tabs-container",style:{margin:0},children:[u.jsx("button",{id:"tab-my-lessons",className:`neo-tab-item ${t==="my-lessons"?"active":""}`,onClick:()=>e("my-lessons"),children:"My Lessons"}),u.jsx("button",{id:"tab-lessons",className:`neo-tab-item ${t==="lessons"?"active":""}`,onClick:()=>e("lessons"),children:"Lessons"})]})}),ge=()=>{const $=[{label:"All Labels",value:null},...j.map(ae=>({label:ae,value:ae}))];return u.jsxs("div",{style:{marginBottom:"2rem",padding:"0 0.5rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginLeft:"4px",paddingRight:"10px"},children:[u.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontWeight:"600"},children:"Filter by Label"}),pe()]}),u.jsx(yr,{value:v,options:$,onChange:w,placeholder:"All Labels",displayValue:ae=>ae||"All Labels"})]})},Ae=()=>u.jsxs("div",{className:"filter-bar neo-inset",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(130px, 1fr))",gap:"1.25rem",padding:"1.25rem",paddingTop:"2.5rem",marginBottom:"2.5rem",borderRadius:"20px",position:"relative"},children:[u.jsx("div",{style:{position:"absolute",top:"12px",right:"10px",zIndex:10},children:pe()}),u.jsx(yr,{label:"Medium",value:p.medium,options:[{label:"All Mediums",value:""},...J.map($=>({label:$,value:$}))],onChange:$=>Y("medium",$),placeholder:"All Mediums",displayValue:$=>$||"All Mediums"}),u.jsx(yr,{label:"Syllabus",value:p.syllabus,options:[{label:"All Syllabuses",value:""},...q.map($=>({label:$,value:$}))],onChange:$=>Y("syllabus",$),placeholder:"All Syllabuses",displayValue:$=>$||"All Syllabuses"}),u.jsx(yr,{label:"Standard",value:p.standard,options:[{label:"All Standards",value:""},...D.map($=>({label:`Standard ${$}`,value:$}))],onChange:$=>Y("standard",$),placeholder:"All Standards",displayValue:$=>$?`Standard ${$}`:"All Standards"}),u.jsx(yr,{label:"Subject",value:p.subject,options:[{label:"All Subjects",value:""},...ee.map($=>({label:$,value:$}))],onChange:$=>Y("subject",$),placeholder:"All Subjects",displayValue:$=>$||"All Subjects"})]});return u.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[(!re||he)&&u.jsxs(u.Fragment,{children:[_e(),t==="my-lessons"&&ge(),t==="lessons"&&Ae()]}),re&&!he&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"3rem 1rem",textAlign:"center",minHeight:"50vh"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem",marginBottom:"1rem"},children:[u.jsxs("h1",{style:{fontSize:"clamp(2.5rem, 8vw, 3.5rem)",fontWeight:"800",lineHeight:"1.1",color:"#4f46e5",margin:0},children:["Study smarter.",u.jsx("br",{}),"Remember longer."]}),u.jsxs("p",{style:{fontSize:"clamp(1rem, 3vw, 1.15rem)",fontWeight:"500",opacity:.9,marginTop:"1.5rem",maxWidth:"650px",margin:"1.5rem auto 0 auto",lineHeight:"1.7",padding:"0 10px"},children:["Powered by scientifically proven strategies such as spaced repetition and active recall, this app makes learning easier and helps you remember longer.",u.jsx("button",{onClick:L,style:{background:"rgba(79, 70, 229, 0.1)",border:"none",color:"#4f46e5",cursor:"pointer",padding:"2px 8px",fontSize:"0.8rem",fontWeight:"700",display:"inline-block",marginLeft:"8px",borderRadius:"6px",verticalAlign:"middle",boxShadow:"inset 1px 1px 2px rgba(255,255,255,0.5), inset -1px -1px 2px rgba(0,0,0,0.05)"},children:"know more"})]})]}),u.jsxs("div",{className:"hero-cta-container",children:[u.jsxs("div",{className:"hero-btn-group",children:[u.jsx("button",{className:"hero-btn primary-btn",onClick:P,children:"Beginners Guide"}),H&&!(x!=null&&x.hasDrive)?u.jsxs("button",{className:"hero-btn primary-btn neo-glow-blue",onClick:()=>_("consent"),style:{background:"var(--accent-color)",color:"white"},children:[u.jsx(Pc,{size:20,className:i?"spin":""}),"Complete Sync Setup"]}):H?null:u.jsx("button",{className:"hero-btn hero-btn-google",onClick:()=>_("consent"),style:{color:"var(--text-color)"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",whiteSpace:"nowrap"},children:["Continue with",u.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"1px",fontWeight:"700",fontSize:"1.2rem",letterSpacing:"-0.02em",marginLeft:"2px"},children:[u.jsx("span",{style:{color:"#4285F4"},children:"G"}),u.jsx("span",{style:{color:"#EA4335"},children:"o"}),u.jsx("span",{style:{color:"#FBBC05"},children:"o"}),u.jsx("span",{style:{color:"#4285F4"},children:"g"}),u.jsx("span",{style:{color:"#34A853"},children:"l"}),u.jsx("span",{style:{color:"#EA4335"},children:"e"})]})]})})]}),N&&u.jsxs("div",{style:{padding:"1rem",background:"var(--error-soft)",borderRadius:"16px",border:"1px solid var(--error-color)",color:"var(--error-color)",fontSize:"0.85rem",marginTop:"1rem",maxWidth:"350px",textAlign:"left"},children:[u.jsx("strong",{children:"Connectivity Notice:"})," ",N]})]})]}),u.jsxs("div",{style:{padding:"0 1rem",maxWidth:"1200px",margin:"0 auto",width:"100%"},children:[u.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"2rem",position:"relative",minHeight:"48px"},children:u.jsx("h2",{className:"responsive-heading",style:{fontSize:"2rem",fontWeight:"800",color:"var(--accent-color)",flex:1},children:"Lessons"})}),Ae(),s?u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem"},children:[u.jsxs("div",{className:"card-loader-container",children:[u.jsx("div",{className:"card-loader-item"}),u.jsx("div",{className:"card-loader-item"}),u.jsx("div",{className:"card-loader-item"})]}),u.jsx("p",{style:{marginTop:"1rem",opacity:.6,fontSize:"0.9rem",fontWeight:500},children:"Loading lessons..."})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"lessons-grid",style:{padding:"0 1.25rem"},children:Z.map($=>u.jsx(eT,{lesson:$,onReview:o,onEdit:a,onImport:l,user:x,onDelete:V,showConfirm:E},$.driveFileId||$.id))}),Z.length===0&&u.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem 2rem",textAlign:"center",gap:"2rem"},children:u.jsxs("div",{style:{maxWidth:"500px",display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem"},children:[u.jsx("div",{className:"neo-flat",style:{padding:"2rem",borderRadius:"24px",opacity:.8},children:u.jsx(rs,{size:64,color:"var(--accent-color)"})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("h3",{style:{fontSize:"1.4rem"},children:"No lessons found"}),u.jsx("p",{style:{opacity:.7},children:"This filter does not have any files. You can request lessons to the developer via the feedback option."})]}),u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:f,style:{padding:"0.8rem 2rem",gap:"8px"},children:[u.jsx(rs,{size:18})," Request Lessons"]})]})})]})]})]}),he?u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem"},children:[u.jsxs("div",{className:"card-loader-container",children:[u.jsx("div",{className:"card-loader-item"}),u.jsx("div",{className:"card-loader-item"}),u.jsx("div",{className:"card-loader-item"})]}),u.jsx("p",{style:{marginTop:"1rem",opacity:.6,fontSize:"0.9rem",fontWeight:500},children:"Loading lessons..."})]}):!re&&u.jsxs(u.Fragment,{children:[z.length===0&&t==="my-lessons"&&u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem 2rem",textAlign:"center",gap:"2rem"},children:[u.jsx("div",{className:"neo-flat",style:{padding:"3rem",borderRadius:"32px"},children:u.jsx("img",{src:av,alt:"Welcome",style:{width:"120px",height:"auto"}})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("h3",{style:{fontSize:"1.4rem"},children:"Welcome to Chethan in Cardland!"}),u.jsx("p",{style:{opacity:.7},children:"You don't have any lessons yet. Create your own or explore our Lessons collection."})]}),u.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",justifyContent:"center"},children:[u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:T,style:{padding:"0.8rem 2rem",gap:"8px"},children:[u.jsx(Ji,{size:18})," Create New Lesson"]}),u.jsxs("button",{className:"neo-button",onClick:()=>e("lessons"),style:{padding:"0.8rem 2rem",gap:"8px"},children:[u.jsx(Ug,{size:18})," Browse Lessons"]})]})]}),z.length===0&&t==="lessons"&&u.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem 2rem",textAlign:"center",gap:"2rem"},children:u.jsxs("div",{style:{maxWidth:"500px",display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem"},children:[u.jsx("div",{className:"neo-flat",style:{padding:"2rem",borderRadius:"24px",opacity:.8},children:u.jsx(rs,{size:64,color:"var(--accent-color)"})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("h3",{style:{fontSize:"1.4rem"},children:"No lessons found"}),u.jsx("p",{style:{opacity:.7},children:"This filter does not have any files. You can request lessons to the developer via the feedback option."})]}),u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:f,style:{padding:"0.8rem 2rem",gap:"8px"},children:[u.jsx(rs,{size:18})," Request Lessons"]})]})}),z.length>0&&u.jsx("div",{className:"lessons-grid",children:z.map($=>u.jsx(eT,{lesson:$,onReview:o,onEdit:a,onImport:l,user:x,onDelete:V,showConfirm:E},$.driveFileId||$.id))})]})]})},_9=({coins:t,isUnlimited:e})=>u.jsxs("div",{className:"neo-inset",style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 12px",borderRadius:"20px",color:"#FFB800",fontWeight:"800",marginRight:"8px",position:"relative"},children:[u.jsx(lv,{size:18,fill:"currentColor"}),u.jsx("span",{style:{opacity:e?.5:1},children:t}),e&&u.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255, 255, 255, 0.9)",borderRadius:"10px",padding:"0 4px",color:"#8b5cf6",fontSize:"1.2rem",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:""})]}),T9=({user:t,userProfile:e,isUnlimited:n,isAdmin:r,isTourActive:i,onShowCoinModal:s,onShowMenu:o,onAddLesson:a,onLogin:l,isProfileLoading:d,headerLoading:h,children:f})=>{const{headerNotice:p,clearHeaderNotice:g,toast:x,hideToast:_,notification:k,clearNotification:S}=Do();return Ir.useEffect(()=>{if(x&&x.duration){const v=setTimeout(()=>{_()},x.duration);return()=>clearTimeout(v)}},[x,_]),u.jsxs("div",{className:"app-layout",children:[u.jsx("header",{className:"main-header",style:{position:"relative"},children:u.jsx(Cn,{mode:"wait",children:h?u.jsx(Ue.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{position:"absolute",left:"1rem",right:"1rem",top:"0.5rem",bottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--bg-color)",zIndex:10,borderRadius:"16px",boxShadow:"5px 5px 10px var(--shadow-dark), -5px -5px 10px var(--shadow-light)"},children:u.jsxs("div",{className:"card-loader-small",children:[u.jsx("div",{className:"card-loader-item-small"}),u.jsx("div",{className:"card-loader-item-small"}),u.jsx("div",{className:"card-loader-item-small"})]})},"loader"):k?u.jsxs(Ue.div,{className:k.type==="confirm"?"neo-glow-header-confirm":"neo-glow-blue",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{position:"absolute",left:"1rem",right:"1rem",top:"0.5rem",bottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"space-between",zIndex:11,borderRadius:"16px",padding:"0 1rem"},children:[u.jsx("span",{style:{fontWeight:"700",fontSize:"0.95rem",color:"var(--text-color)",flex:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:k.message}),u.jsx("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center"},children:k.type==="confirm"?u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"neo-button",onClick:v=>{v.stopPropagation(),k.onConfirm&&k.onConfirm(),S()},style:{padding:"0.4rem 1.2rem",fontSize:"0.85rem",fontWeight:"800",height:"auto",minHeight:"unset",background:"var(--accent-color)",color:"white",border:"none",boxShadow:"0 4px 12px rgba(var(--accent-rgb), 0.4)"},children:"Confirm"}),u.jsx("button",{className:"neo-button icon-btn",onClick:v=>{v.stopPropagation(),S()},style:{padding:"4px",width:"28px",height:"28px",minWidth:"28px",background:"var(--bg-color)",border:"none",boxShadow:"2px 2px 5px var(--shadow-dark), -2px -2px 5px var(--shadow-light)"},children:u.jsx(Qt,{size:14,color:"#ef4444"})})]}):u.jsx("button",{className:"neo-button",onClick:v=>{v.stopPropagation(),S()},style:{padding:"0.4rem 1rem",fontSize:"0.85rem",fontWeight:"700",height:"auto",minHeight:"unset",color:"var(--accent-color)"},children:"Got it"})})]},"notification"):x?u.jsxs(Ue.div,{className:"neo-glow-header",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{position:"absolute",left:"1rem",right:"1rem",top:"0.5rem",bottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"space-between",color:"var(--text-color)",zIndex:10,borderRadius:"16px",fontWeight:"600",fontSize:"0.9rem",padding:"0 1rem"},children:[u.jsx("span",{style:{flex:1,textAlign:"left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:x.message}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[x.onUndo&&u.jsx("button",{className:"neo-button",style:{padding:"0.3rem 0.8rem",fontSize:"0.8rem",height:"auto",minHeight:"unset"},onClick:v=>{v.stopPropagation(),x.onUndo(),x.onClose?x.onClose():_()},children:"Undo"}),u.jsx("button",{className:"neo-button icon-btn",onClick:v=>{v.stopPropagation(),_()},style:{padding:"4px",width:"28px",height:"28px",minWidth:"28px",background:"var(--bg-color)",display:"flex",alignItems:"center",justifyContent:"center",border:"none",boxShadow:"2px 2px 5px var(--shadow-dark), -2px -2px 5px var(--shadow-light)"},children:u.jsx(Qt,{size:14,color:"#ef4444"})})]})]},"toast"):p?u.jsxs(Ue.div,{className:"neo-glow-header",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{position:"absolute",left:"1rem",right:"1rem",top:"0.5rem",bottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)",zIndex:10,borderRadius:"16px",fontWeight:"700",fontSize:"1rem",padding:"0 1.5rem",textAlign:"center"},children:[u.jsx("span",{children:p.message}),u.jsx("button",{className:"neo-button icon-btn",onClick:v=>{v.stopPropagation(),g()},style:{position:"absolute",right:"0.5rem",padding:"4px",width:"28px",height:"28px",minWidth:"28px",background:"var(--bg-color)",display:"flex",alignItems:"center",justifyContent:"center",border:"none",boxShadow:"2px 2px 5px var(--shadow-dark), -2px -2px 5px var(--shadow-light)"},children:u.jsx(Qt,{size:14,color:"#ef4444"})})]},"notice"):u.jsxs(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("img",{src:av,alt:"Chethan",className:"app-logo"}),u.jsxs("div",{className:"header-actions",children:[t&&u.jsx("div",{onClick:s,style:{display:"flex",alignItems:"center",gap:"4px"},children:u.jsx(_9,{coins:(e==null?void 0:e.coins)||0,isUnlimited:n})}),u.jsx("button",{className:"neo-button icon-btn",onClick:o,children:u.jsx(LC,{size:24})})]})]},"content")})}),u.jsxs("div",{className:"app-container",children:[u.jsx("main",{className:"main-content",children:f}),(t||i)&&u.jsx("button",{id:"fab-add-lesson",className:"neo-button neo-glow-blue fab-add-button",onClick:a,children:u.jsx(Ji,{size:32})})]}),u.jsx("style",{children:`
                .app-layout {
                    display: flex;
                    flex-direction: column;
                    min-height: 100dvh;
                    background: var(--bg-color);
                }
                .main-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 1rem 1.5rem;
                    background: var(--bg-color);
                    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
                    z-index: 1000;
                    position: sticky;
                    top: 0;
                }
                .header-actions {
                    display: flex;
                    gap: 0.75rem;
                    align-items: center;
                }
                .app-logo {
                    height: 2.5rem;
                    width: auto;
                    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
                }
                .main-content {
                    flex: 1;
                    padding-bottom: 5rem; /* Space for FAB */
                }
                
                @media (max-width: 480px) {
                    .main-header {
                        padding: 0.75rem 1rem;
                    }
                    .app-logo {
                        height: 2rem;
                    }
                }
            `})]})},ti=({onClick:t,style:e,size:n=20,className:r=""})=>u.jsx("button",{onClick:t,className:`neo-button ${r}`,style:{width:"36px",height:"36px",padding:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#ef4444",background:"var(--bg-color)",borderRadius:"12px",border:"none",cursor:"pointer",boxShadow:"4px 4px 8px var(--shadow-dark), -4px -4px 8px var(--shadow-light), 0 0 4px rgba(239, 68, 68, 0.2)",transition:"all 0.2s ease",...e},onMouseEnter:i=>{i.currentTarget.style.boxShadow="4px 4px 8px var(--shadow-dark), -4px -4px 8px var(--shadow-light), 0 0 8px rgba(239, 68, 68, 0.4)",i.currentTarget.style.transform="scale(1.05)"},onMouseLeave:i=>{i.currentTarget.style.boxShadow="4px 4px 8px var(--shadow-dark), -4px -4px 8px var(--shadow-light), 0 0 4px rgba(239, 68, 68, 0.2)",i.currentTarget.style.transform="scale(1)"},title:"Close",children:u.jsx(Qt,{size:n})}),S9=({user:t,theme:e,onToggleTheme:n,soundsEnabled:r,onToggleSounds:i,onShowFeedback:s,onClose:o,onLogout:a,onLogin:l,onDeleteData:d,onShowAdminPanel:h,onShowReferral:f,onShowTour:p,onRestorePurchases:g,appVersion:x})=>{const _=()=>{window.confirm("Check for updates? This will refresh the page.")&&window.location.reload(!0)};return u.jsxs("div",{className:"fixed inset-0",style:{position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:5e3,pointerEvents:"none",display:"flex",justifyContent:"flex-end"},children:[u.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.3)",backdropFilter:"blur(4px)",pointerEvents:"auto"},onClick:o}),u.jsxs("div",{className:"relative w-80 h-full bg-white dark:bg-gray-800 shadow-2xl p-6 flex flex-col gap-6 overflow-y-auto",style:{position:"relative",width:"320px",height:"100%",background:"var(--bg-color)",boxShadow:"-5px 0 25px rgba(0,0,0,0.1)",padding:"2rem",paddingBottom:"2rem",display:"flex",flexDirection:"column",gap:"1.25rem",pointerEvents:"auto",borderLeft:"1px solid var(--border-color)",animation:"slideIn 0.3s ease-out",overflowY:"auto",WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",touchAction:"pan-y"},onClick:k=>k.stopPropagation(),children:[u.jsxs("div",{className:"flex justify-between items-center",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"700",margin:0},children:"Menu"}),u.jsx(ti,{onClick:o})]}),t?u.jsxs("div",{className:"neo-card flex items-center gap-3 p-3",style:{padding:"1rem",display:"flex",alignItems:"center",gap:"1rem"},children:[u.jsxs("div",{style:{position:"relative",width:"48px",height:"48px",flexShrink:0},children:[t.picture?u.jsx("img",{src:t.picture,alt:t.name,style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"},onError:k=>{k.target.style.display="none",k.target.nextSibling.style.display="flex"}}):null,u.jsx("div",{style:{width:"100%",height:"100%",borderRadius:"50%",background:"var(--accent-soft)",display:t.picture?"none":"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)"},children:u.jsx(Td,{size:24})})]}),u.jsxs("div",{style:{overflow:"hidden",flex:1},children:[u.jsx("div",{style:{fontWeight:"600",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),u.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-color)",opacity:.6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.email})]})]}):u.jsxs("button",{className:"neo-button",style:{width:"100%",padding:"0.75rem 1rem",display:"flex",alignItems:"center",gap:"1rem",textAlign:"left"},onClick:()=>{o(),l()},children:[u.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"var(--bg-secondary)"},children:u.jsx(Td,{size:20})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[u.jsx("span",{style:{fontWeight:"600",fontSize:"1rem"},children:"Guest User"}),u.jsx("span",{style:{fontSize:"0.75rem",opacity:.8},children:"Sign in to save progress"})]})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{children:e==="dark"?"Eye Care On":"Eye Care Off"}),u.jsx("button",{className:`neo-button icon-btn ${e==="dark"?"neo-glow-blue":""}`,onClick:n,children:e==="dark"?u.jsx(jC,{size:20}):u.jsx(DC,{size:20})})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{children:r?"Sounds On":"Sounds Off"}),u.jsx("button",{className:`neo-button icon-btn ${r?"neo-glow-blue":""}`,onClick:i,children:r?u.jsx(i9,{size:20}):u.jsx(s9,{size:20})})]}),u.jsx("div",{style:{flex:1}}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(t==null?void 0:t.email)===ki&&u.jsxs("button",{className:"neo-button neo-glow-blue",style:{width:"100%",color:"var(--accent-color)",fontWeight:"bold"},onClick:h,children:[u.jsx(MC,{size:18})," Admin Panel"]}),u.jsxs("button",{className:"neo-button",style:{width:"100%",color:"var(--accent-color)"},onClick:s,children:[u.jsx(rs,{size:18})," Help/Feedback"]}),t&&u.jsxs("button",{className:"neo-button",style:{width:"100%",color:"#f59e0b"},onClick:f,children:[u.jsx(OC,{size:18})," Refer a Friend"]}),t?u.jsxs(u.Fragment,{children:[u.jsxs("button",{className:"neo-button",style:{width:"100%",color:"#8b5cf6"},onClick:p,children:[u.jsx(VC,{size:18})," Beginner's Guide"]}),u.jsxs("button",{className:"neo-button",style:{width:"100%",color:"var(--accent-color)"},onClick:()=>{o(),g()},children:[u.jsx(tc,{size:18})," Restore Purchased"]}),u.jsxs("button",{className:"neo-button",style:{width:"100%"},onClick:a,children:[u.jsx(H8,{size:18})," Logout"]}),u.jsxs("button",{className:"neo-button neo-glow-red",style:{width:"100%",color:"var(--error-color)"},onClick:d,children:[u.jsx(yi,{size:18})," Delete Data"]})]}):u.jsxs("button",{className:"neo-button neo-glow-blue",style:{width:"100%",backgroundColor:"var(--accent-color)",color:"white"},onClick:()=>{o(),l()},children:[u.jsx(Td,{size:18})," Sign in with Google"]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",marginTop:"0.5rem",opacity:.5},children:[u.jsxs("span",{style:{fontSize:"0.7rem",fontWeight:"500"},children:["v",x]}),u.jsx("button",{onClick:_,style:{background:"none",border:"none",color:"var(--accent-color)",fontSize:"0.65rem",textDecoration:"underline",cursor:"pointer",padding:"4px"},children:"Check for updates"})]})]}),u.jsx("style",{children:`
            @keyframes slideIn {
                from { transform: translateX(100%); }
                to { transform: translateX(0); }
            }
            `})]})},Fi=(t,e)=>{if(!e)return"";const n=String(e).trim();switch(t){case"standard":const r=n.toUpperCase().replace(/^(STANDARD|STD|CLASS|GRADE)\s*/i,"");return{5:"V",V:"V",6:"VI",VI:"VI",7:"VII",VII:"VII",8:"VIII",VIII:"VIII",9:"IX",IX:"IX",10:"X",X:"X"}[r]||r;case"syllabus":const s=n.toUpperCase();return s.includes("NCERT")?"NCERT":s.includes("KERALA")?"Kerala":n;case"medium":const o=n.toLowerCase();return o.includes("malayalam")?"Malayalam":o.includes("english")?"English":n.charAt(0).toUpperCase()+n.slice(1);case"subject":const a=n.toLowerCase();return a.includes("math")?"Maths":a.includes("social")?"Social Science":a.includes("science")?"Science":a.includes("malayalam")?"Malayalam":a.includes("hindi")?"Hindi":a.includes("english")?"English":n.charAt(0).toUpperCase()+n.slice(1);default:return n}},E9=t=>{if(!t||!t.trim())return{title:"",label:"",importantNote:"",questions:[],sections:[]};let e=null,n="",r="",i="",s=[],o="",a="",l="",d="",h=0,f=[];try{const _=t.match(/\[[\s\S]*\]|\{[\s\S]*\}/);_&&(e=JSON.parse(_[0]))}catch{}if(e)Array.isArray(e)?s=e:(n=e.title||"",r=e.label||e.tag||"",i=e.importantNote||e.note||"",o=Fi("standard",e.standard||e.Standard),a=Fi("syllabus",e.syllabus||e.Syllabus),l=Fi("medium",e.medium||e.Medium),d=Fi("subject",e.subject||e.Subject),h=e.cost||e.Cost||0,f=e.sections||[],s=e.questions||e.cards||[]);else{const _=t.match(/^(?:Title|Lesson Title|Stack Title|Name):\s*(.*)$/im),k=t.match(/^(?:Label|Category|Tag):\s*(.*)$/im),S=t.match(/^(?:Important Note|Note|Description):\s*(.*)$/im);n=_?_[1].trim():"",r=k?k[1].trim():"",i=S?S[1].trim():"";const v=t.match(/^(?:Standard|Class|Grade):\s*(.*)$/im),w=t.match(/^(?:Syllabus|Board):\s*(.*)$/im),j=t.match(/^(?:Medium|Language):\s*(.*)$/im),L=t.match(/^(?:Subject):\s*(.*)$/im),V=t.match(/^(?:Cost|Coins|Price):\s*(\d+)$/im);o=Fi("standard",v?v[1].trim():""),a=Fi("syllabus",w?w[1].trim():""),l=Fi("medium",j?j[1].trim():""),d=Fi("subject",L?L[1].trim():""),h=V?parseInt(V[1],10):0,t.split(/(?=Q:|Question:|Q\d+:|Question \d+:)/i).forEach(T=>{if(!T.trim())return;const I=T.match(/(?:Q:|Question:|Q\d+:|Question \d+:)\s*([\s\S]*?)(?=A:|Answer:|A\d+:|Answer \d+:|$)/i),A=T.match(/(?:A:|Answer:|A\d+:|Answer \d+:)\s*([\s\S]*?)(?=Q:|Question:|Q\d+:|Question \d+:|$)/i);I&&A&&s.push({question:I[1].trim(),answer:A[1].trim()})})}const p=_=>{var V,E,T,I;const k=_.choices||_.options||[],S=_.type==="mcq"||k&&Array.isArray(k)&&k.length>0,v=S?"mcq":"flashcard";let w=[];if(S){const A=_.correctAnswer||_.answer;w=k.map((P,N)=>{const b=typeof P=="string"?P:P.text||"";let H=!1;return typeof A=="number"?H=N===A:typeof P=="object"&&P.isCorrect!==void 0?H=P.isCorrect:A&&(H=b.trim().toLowerCase()===String(A).trim().toLowerCase()),{id:Math.random(),text:b,isCorrect:H}})}const j=()=>{var A;return typeof _.question=="string"?_.question:typeof _.question=="object"&&((A=_.question)!=null&&A.text)?_.question.text:typeof _.q=="string"?_.q:""},L=()=>{var A;return typeof _.answer=="string"?_.answer:typeof _.answer=="object"&&((A=_.answer)!=null&&A.text)?_.answer.text:typeof _.a=="string"?_.a:""};return{id:Math.random(),type:v,question:{text:j(),image:((V=_.question)==null?void 0:V.image)||"",audio:((E=_.question)==null?void 0:E.audio)||""},answer:{text:L(),image:((T=_.answer)==null?void 0:T.image)||"",audio:((I=_.answer)==null?void 0:I.audio)||""},options:w}},g=f.map(_=>({noteSegment:_.noteSegment||"",questions:(_.questions||_.cards||[]).map(p)})),x=g.length>0?g.flatMap(_=>_.questions):s.map(p);return{title:n,label:r,importantNote:i,standard:o,syllabus:a,medium:l,subject:d,cost:parseInt(h)||0,sections:g,questions:x,cards:x}},Qp=t=>{if(!t)return t;const e=i=>{var f,p,g,x;if(i.question&&typeof i.question=="object"&&"text"in i.question)return i;const s=i.choices||i.options||[],o=i.type==="mcq"||s&&Array.isArray(s)&&s.length>0,a=o?"mcq":"flashcard";let l=[];if(o){const _=i.correctAnswer||(typeof i.answer=="string"?i.answer:null);l=s.map((k,S)=>{const v=typeof k=="string"?k:k.text||"";let w=!1;return typeof _=="number"?w=S===_:typeof k=="object"&&k.isCorrect!==void 0?w=k.isCorrect:_&&(w=v.trim().toLowerCase()===String(_).trim().toLowerCase()),{id:i.id?`${i.id}-opt-${S}`:Math.random(),text:v,isCorrect:w}})}const d=()=>{var _;return typeof i.question=="string"?i.question:typeof i.question=="object"&&((_=i.question)!=null&&_.text)?i.question.text:typeof i.q=="string"?i.q:""},h=()=>{var _;return typeof i.answer=="string"?i.answer:typeof i.answer=="object"&&((_=i.answer)!=null&&_.text)?i.answer.text:typeof i.a=="string"?i.a:""};return{id:i.id||Math.random(),type:a,question:{text:d(),image:((f=i.question)==null?void 0:f.image)||"",audio:((p=i.question)==null?void 0:p.audio)||""},answer:{text:h(),image:((g=i.answer)==null?void 0:g.image)||"",audio:((x=i.answer)==null?void 0:x.audio)||""},options:l,lastRating:i.lastRating}};let n=[],r=[];return t.sections&&Array.isArray(t.sections)&&t.sections.length>0?(n=t.sections.map((i,s)=>{const o=i.noteSegment||"",a=(i.questions||i.cards||[]).map((l,d)=>({...e(l),sectionIndex:s,sectionNoteSegment:o,isFirstInSection:d===0&&o}));return{noteSegment:o,questions:a}}),r=n.flatMap(i=>i.questions)):(t.questions||t.cards)&&(r=(t.questions||t.cards||[]).map(e)),{...t,sections:n,questions:r,cards:r}},qC=({imageUrl:t,onClose:e})=>{const[n,r]=R.useState(1),[i,s]=R.useState(0),[o,a]=R.useState({x:0,y:0}),l=()=>{r(g=>Math.min(g+.5,5))},d=()=>{const g=Math.max(n-.5,.5);r(g),g<=1&&a({x:0,y:0})},h=()=>{s(g=>(g+90)%360)},f=()=>{r(1),s(0),a({x:0,y:0})},p=(g,x)=>{n>1&&a({x:o.x+x.offset.x,y:o.y+x.offset.y})};return u.jsxs(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"image-viewer-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.95)",zIndex:9999,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"2rem",overflow:"hidden"},onClick:e,children:[u.jsxs("div",{style:{position:"absolute",top:"1rem",right:"1rem",display:"flex",gap:"0.5rem",zIndex:1e4},onClick:g=>g.stopPropagation(),children:[u.jsx("button",{className:"neo-button icon-btn",onClick:l,title:"Zoom In",style:{background:"var(--bg-color)"},children:u.jsx(a9,{size:20})}),u.jsx("button",{className:"neo-button icon-btn",onClick:d,title:"Zoom Out",style:{background:"var(--bg-color)"},children:u.jsx(l9,{size:20})}),u.jsx("button",{className:"neo-button icon-btn",onClick:h,title:"Rotate",style:{background:"var(--bg-color)"},children:u.jsx(X8,{size:20})}),u.jsx("button",{className:"neo-button icon-btn",onClick:f,title:"Reset",style:{background:"var(--bg-color)",fontSize:"0.8rem",padding:"8px 12px"},children:"Reset"}),u.jsx(ti,{onClick:e,size:20})]}),u.jsxs("div",{style:{position:"absolute",bottom:"2rem",left:"50%",transform:"translateX(-50%)",background:"var(--bg-color)",padding:"0.5rem 1rem",borderRadius:"20px",fontSize:"0.9rem",fontWeight:"bold",boxShadow:"4px 4px 8px var(--shadow-dark), -4px -4px 8px var(--shadow-light)"},onClick:g=>g.stopPropagation(),children:[Math.round(n*100),"% ",n>1&&" Drag to pan"]}),u.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},onClick:g=>g.stopPropagation(),children:u.jsx(Ue.img,{src:t,alt:"Full screen view",drag:n>1,dragConstraints:{left:0,right:0,top:0,bottom:0},dragElastic:.1,dragMomentum:!1,onDragEnd:p,animate:{scale:n,rotate:i,x:o.x,y:o.y},transition:{type:"spring",stiffness:200,damping:20},style:{maxWidth:n<=1?"90vw":"none",maxHeight:n<=1?"90vh":"none",width:n>1?"auto":void 0,height:n>1?"90vh":void 0,objectFit:"contain",cursor:n>1?"grab":"zoom-in",userSelect:"none"},whileDrag:{cursor:"grabbing"},onClick:g=>{g.stopPropagation(),n===1&&l()},draggable:!1})})]})},Ih=({value:t,onChange:e,placeholder:n,style:r={},...i})=>{const s=R.useRef(null),o=a=>{a&&(a.style.height="auto",a.style.height=`${a.scrollHeight}px`)};return R.useEffect(()=>{o(s.current)},[t]),u.jsx("textarea",{ref:s,className:"neo-input",placeholder:n,value:t,onChange:a=>{e(a),o(a.target)},style:{...r,overflow:"hidden",resize:"none",minHeight:"40px",display:"block"},...i})},tT=({question:t,index:e,totalQuestions:n,onUpdate:r,onRemove:i,onMove:s,recording:o,startRecording:a,stopRecording:l,cancelRecording:d,recordingTime:h,handleFileUpload:f,handleOptionChange:p,setViewingImage:g,showSplitUI:x,selectedQuestions:_,toggleQuestionSelection:k})=>{var v;const S=w=>{const j=Math.floor(w/60),L=w%60;return`${j}:${L.toString().padStart(2,"0")}`};return u.jsxs("div",{className:"neo-inset",style:{padding:"1.5rem",display:"flex",flexDirection:"column",gap:"1rem",position:"relative"},children:[x&&u.jsx("div",{style:{position:"absolute",top:"10px",left:"10px",zIndex:5},children:u.jsx("input",{type:"checkbox",className:"neo-checkbox",checked:_==null?void 0:_.has(t.id),onChange:()=>k==null?void 0:k(t.id)})}),u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[u.jsx("div",{style:{fontSize:"0.9rem",fontWeight:"bold",opacity:.5,display:"flex",alignItems:"center",gap:"0.5rem"},children:u.jsxs("span",{children:[t.type==="mcq"?"MCQ":"QUESTION"," ",e+1]})}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:"var(--bg-color)",padding:"4px 8px",borderRadius:"8px",boxShadow:"inset 2px 2px 4px var(--shadow-dark), inset -2px -2px 4px var(--shadow-light)"},children:[u.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"Pos:"}),u.jsx("input",{type:"number",className:"neo-input",style:{width:"40px",padding:"2px",textAlign:"center",boxShadow:"none",background:"transparent",height:"auto",fontSize:"0.9rem",fontWeight:"bold"},placeholder:"#",onBlur:w=>{w.target.value&&(s(w.target.value),w.target.value="")},onKeyDown:w=>{w.key==="Enter"&&w.target.value&&(s(w.target.value),w.target.value="")}})]}),u.jsx("button",{className:"neo-button icon-btn",style:{width:"32px",height:"32px",color:"var(--error-color)",boxShadow:"none"},onClick:i,title:"Delete Question",children:u.jsx(yi,{size:16})})]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"bold"},children:"QUESTION"}),u.jsxs("div",{style:{display:"flex",gap:"5px"},children:[o?o.id===t.id&&o.field==="question"?u.jsxs("div",{className:"neo-flat",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:10,borderRadius:"12px",display:"flex",alignItems:"center",padding:"0 1rem",gap:"1rem",background:"var(--bg-color)"},children:[u.jsx("div",{style:{width:"10px",height:"10px",background:"red",borderRadius:"50%",animation:"pulse 1s infinite"}}),u.jsxs("span",{style:{flex:1,fontWeight:"600"},children:["Recording... ",S(h)]}),u.jsx("button",{className:"neo-button icon-btn",title:"Cancel",style:{width:"32px",height:"32px"},onClick:d,children:u.jsx(Qt,{size:14,color:"var(--error-color)"})}),u.jsx("button",{className:"neo-button icon-btn",title:"Stop & Save",style:{width:"32px",height:"32px"},onClick:l,children:u.jsx(Eo,{size:14,color:"var(--accent-color)"})})]}):null:u.jsxs("div",{style:{display:"flex",gap:"5px"},children:[u.jsx("button",{className:"neo-button icon-btn",style:{width:"32px",height:"32px",color:t.question.audio?"var(--accent-color)":"currentColor"},onClick:()=>a(t.id,"question"),children:u.jsx(bh,{size:14})}),t.question.audio&&u.jsx("button",{className:"neo-button icon-btn",style:{width:"32px",height:"32px"},onClick:()=>r("question",{...t.question,audio:""}),children:u.jsx(yi,{size:12,color:"var(--error-color)"})})]}),u.jsxs("label",{className:"neo-button icon-btn",style:{width:"32px",height:"32px",cursor:"pointer"},children:[u.jsx(Og,{size:14,color:t.question.image?"var(--accent-color)":"currentColor"}),u.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:w=>f(w,j=>r("question",{...t.question,image:j}))})]})]})]}),t.question.image&&u.jsxs("div",{style:{position:"relative",width:"100%",maxHeight:"150px"},children:[u.jsx("img",{src:t.question.image,style:{width:"100%",height:"100%",maxHeight:"150px",objectFit:"contain",borderRadius:"8px",cursor:"pointer"},onClick:()=>g(t.question.image)}),u.jsx("button",{className:"neo-button icon-btn",style:{position:"absolute",top:"5px",right:"5px",width:"24px",height:"24px"},onClick:()=>r("question",{...t.question,image:""}),children:u.jsx(Qt,{size:12})})]}),u.jsx("div",{style:{position:"relative"},children:u.jsx(Ih,{placeholder:"The question... ",value:t.question.text,onChange:w=>r("question",{...t.question,text:Ea(w.target.value)}),style:{paddingRight:"30px"}})})]}),t.type==="mcq"?u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"bold"},children:"OPTIONS"}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:(v=t.options)==null?void 0:v.map((w,j)=>u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("input",{type:"radio",name:`correct-${t.id}`,checked:w.isCorrect,onChange:()=>p(w.id,"isCorrect",!0),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"var(--accent-color)"}}),u.jsx("input",{className:"neo-input",placeholder:`Option ${String.fromCharCode(65+j)}`,value:w.text,onChange:L=>p(w.id,"text",Ea(L.target.value)),style:{borderColor:w.isCorrect?"var(--accent-color)":"transparent",borderWidth:w.isCorrect?"2px":"1px"}})]},w.id))})]}):u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"bold"},children:"ANSWER"}),u.jsxs("div",{style:{display:"flex",gap:"5px"},children:[o?o.id===t.id&&o.field==="answer"?u.jsxs("div",{className:"neo-flat",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:10,borderRadius:"12px",display:"flex",alignItems:"center",padding:"0 1rem",gap:"1rem",background:"var(--bg-color)"},children:[u.jsx("div",{style:{width:"10px",height:"10px",background:"red",borderRadius:"50%",animation:"pulse 1s infinite"}}),u.jsxs("span",{style:{flex:1,fontWeight:"600"},children:["Recording... ",S(h)]}),u.jsx("button",{className:"neo-button icon-btn",title:"Cancel",style:{width:"32px",height:"32px"},onClick:d,children:u.jsx(Qt,{size:14,color:"var(--error-color)"})}),u.jsx("button",{className:"neo-button icon-btn",title:"Stop & Save",style:{width:"32px",height:"32px"},onClick:l,children:u.jsx(Eo,{size:14,color:"var(--accent-color)"})})]}):null:u.jsxs("div",{style:{display:"flex",gap:"5px"},children:[u.jsx("button",{className:"neo-button icon-btn",style:{width:"32px",height:"32px",color:t.answer.audio?"var(--accent-color)":"currentColor"},onClick:()=>a(t.id,"answer"),children:u.jsx(bh,{size:14})}),t.answer.audio&&u.jsx("button",{className:"neo-button icon-btn",style:{width:"32px",height:"32px"},onClick:()=>r("answer",{...t.answer,audio:""}),children:u.jsx(yi,{size:12,color:"var(--error-color)"})})]}),u.jsxs("label",{className:"neo-button icon-btn",style:{width:"32px",height:"32px",cursor:"pointer"},children:[u.jsx(Og,{size:14,color:t.answer.image?"var(--accent-color)":"currentColor"}),u.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:w=>f(w,j=>r("answer",{...t.answer,image:j}))})]})]})]}),t.answer.image&&u.jsxs("div",{style:{position:"relative",width:"100%",maxHeight:"150px"},children:[u.jsx("img",{src:t.answer.image,style:{width:"100%",height:"100%",maxHeight:"150px",objectFit:"contain",borderRadius:"8px",cursor:"pointer"},onClick:()=>g(t.answer.image)}),u.jsx("button",{className:"neo-button icon-btn",style:{position:"absolute",top:"5px",right:"5px",width:"24px",height:"24px"},onClick:()=>r("answer",{...t.answer,image:""}),children:u.jsx(Qt,{size:12})})]}),u.jsx(Ih,{placeholder:"The answer... ",value:t.answer.text,onChange:w=>r("answer",{...t.answer,text:Ea(w.target.value)})})]})]},t.id)},b9=({user:t,lesson:e,onClose:n,onSave:r,onDelete:i,showAlert:s,showConfirm:o,availableLabels:a,allLessons:l,activeTab:d,defaultMetadata:h})=>{const[f,p]=R.useState((e==null?void 0:e.title)||""),[g,x]=R.useState((e==null?void 0:e.titleImage)||""),[_,k]=R.useState((e==null?void 0:e.label)||"No label"),[S,v]=R.useState((e==null?void 0:e.importantNote)||""),[w,j]=R.useState(""),[L,V]=R.useState((e==null?void 0:e.questions)||(e==null?void 0:e.cards)||[{id:Date.now(),question:{text:"",image:"",audio:""},answer:{text:"",image:"",audio:""}}]),[E,T]=R.useState((e==null?void 0:e.standard)||(e?"":(h==null?void 0:h.standard)||"")),[I,A]=R.useState((e==null?void 0:e.syllabus)||(e?"":(h==null?void 0:h.syllabus)||"")),[P,N]=R.useState((e==null?void 0:e.medium)||(e?"":(h==null?void 0:h.medium)||"")),[b,H]=R.useState((e==null?void 0:e.subject)||(e?"":(h==null?void 0:h.subject)||"")),[he,re]=R.useState((e==null?void 0:e.cost)||0),[se,U]=R.useState((e==null?void 0:e.sections)||[]),[G,M]=R.useState(d==="lessons"&&(t==null?void 0:t.email)===ki),[D,q]=R.useState(null);R.useRef(null);const[J,ee]=R.useState(!1),[ie,Z]=R.useState(new Set),[z,Y]=R.useState(!1),[pe,_e]=R.useState(""),[ge,Ae]=R.useState(!1),$=R.useRef(null),ae=R.useRef(null),[ke,Ge]=R.useState(null),[Ye,Xe]=R.useState(0),[dt,Ne]=R.useState(null),qe=R.useRef(null),Hn=()=>{const K={id:Date.now(),type:"flashcard",question:{text:"",image:"",audio:""},answer:{text:"",image:"",audio:""}};if(se.length>0){const le=se.length-1,me=[...se];me[le].questions=me[le].questions||me[le].cards||[],me[le].questions.push(K),U(me),V(me.flatMap(X=>X.questions||X.cards))}else V([...L,K]);Rr()},Gn=()=>{const K={id:Date.now(),type:"mcq",question:{text:"",image:"",audio:""},options:[{id:Date.now()+1,text:"",isCorrect:!1},{id:Date.now()+2,text:"",isCorrect:!1},{id:Date.now()+3,text:"",isCorrect:!1},{id:Date.now()+4,text:"",isCorrect:!1}],answer:{text:"",image:"",audio:""}};if(se.length>0){const le=se.length-1,me=[...se];me[le].questions=me[le].questions||me[le].cards||[],me[le].questions.push(K),U(me),V(me.flatMap(X=>X.questions||X.cards))}else V([...L,K]);Rr()},Dn=()=>{U([...se,{noteSegment:"",questions:[]}])},Rr=()=>{setTimeout(()=>{ae.current&&ae.current.scrollTo({top:ae.current.scrollHeight,behavior:"smooth"})},100)},Zt=(K,le,me=null)=>{const X=parseInt(le)-1;if(me!==null){const xe=[...se],ye=xe[me].questions||xe[me].cards||[];if(isNaN(X)||X<0||X>=ye.length||X===K)return;const[_t]=ye.splice(K,1);ye.splice(X,0,_t),xe[me].questions=ye,U(xe),V(xe.flatMap(Ke=>Ke.questions||Ke.cards))}else{if(isNaN(X)||X<0||X>=L.length||X===K)return;const xe=[...L],[ye]=xe.splice(K,1);xe.splice(X,0,ye),V(xe)}},en=(K,le,me,X)=>{V(L.map(xe=>xe.id!==K?xe:me==="isCorrect"?{...xe,options:xe.options.map(ye=>({...ye,isCorrect:ye.id===le}))}:{...xe,options:xe.options.map(ye=>ye.id===le?{...ye,[me]:X}:ye)}))},Pr=K=>{L.length>1&&V(L.filter(le=>le.id!==K))},Ee=(K,le,me)=>{V(L.map(X=>X.id===K?{...X,[le]:me}:X))},de=(K,le,me="image")=>{const X=K.target.files[0];if(!X)return;const xe=new FileReader;xe.onloadend=()=>{const ye=xe.result;if(!Bg(ye,me==="image"?["image/"]:["audio/"])){s(`Invalid ${me} file. Only ${me} files are allowed.`);return}le(ye)},xe.readAsDataURL(X)},fe=async(K,le)=>{Ge({id:K,field:le}),Xe(0);try{const me=await navigator.mediaDevices.getUserMedia({audio:!0}),X=new MediaRecorder(me),xe=[];X.ondataavailable=ye=>xe.push(ye.data),X.onstop=()=>{const ye=new Blob(xe,{type:"audio/webm"}),_t=new FileReader;_t.onloadend=()=>{V(Ke=>Ke.map(je=>je.id===K?{...je,[le]:{...je[le],audio:_t.result}}:je))},_t.readAsDataURL(ye),me.getTracks().forEach(Ke=>Ke.stop()),clearInterval(qe.current),Xe(0)},X.start(),Ne(X),qe.current=setInterval(()=>Xe(ye=>ye+1),1e3)}catch{s("Could not access microphone."),Ge(null),Xe(0)}},De=()=>{dt&&(dt.stop(),Ne(null),Ge(null))},nt=()=>{dt&&(dt.onstop=()=>{clearInterval(qe.current),Xe(0),Ne(null),Ge(null)},dt.stop())},rt=async()=>{var me;if(!f.trim())return s("Please enter a title");const K=se.length>0?se.flatMap(X=>X.questions||X.cards):L;for(let X=0;X<K.length;X++){const xe=K[X],ye=xe.question.text.trim()||xe.question.image||xe.question.audio,_t=xe.answer.text.trim()||xe.answer.image||xe.answer.audio;if(xe.type==="mcq"){const Ke=(me=xe.options)==null?void 0:me.some(je=>je.isCorrect);if(!ye)return s(`Question is required for MCQ ${X+1}`);if(!Ke)return s(`Please select a correct answer for MCQ ${X+1}`)}else{if(!ye)return s(`Question is required for question ${X+1}`);if(!_t)return s(`Answer is required for question ${X+1}`)}}const le={id:(e==null?void 0:e.id)||Date.now().toString(),title:f,titleImage:g,label:_,standard:E,syllabus:I,medium:P,subject:b,importantNote:S,questions:K,sections:se,owner:t.email,avgRating:(e==null?void 0:e.avgRating)||null,lastReviewed:(e==null?void 0:e.lastReviewed)||null,cost:parseInt(he)||0,questionCount:K.length};try{Ae(!0);let X;if(G){const{savePublicLesson:ye}=await gr(()=>import("./publicDrive-e06dc611.js"),[]);X=await ye(le)}else X=await xr.saveLesson(le);const xe=X.driveFileId||X.id;r({...X,driveFileId:xe},!0,G)}catch(X){if(Ae(!1),X.message==="REAUTH_NEEDED"||X.message.includes("REAUTH_NEEDED")){s("Please reconnect to Google Drive to save.");try{await a8({prompt:"consent"}),await rt()}catch(xe){console.error("Re-auth failed/cancelled",xe)}}else console.error("Save failed:",X),X.code==="storage/unknown"||X.message.includes("storage/unknown")?s('Cloud upload failed (likely CORS). Please use the "Download" button to save locally.'):s(`Failed to save lesson: ${X.message}`)}},$e=()=>{if(ie.size===0)return s("Please select at least one question to split.");if(ie.size===L.length)return s("Cannot split all questions.");o(`Split ${ie.size} question(s) into a new lesson?`,async()=>{const K=L.filter(X=>ie.has(X.id)),le=L.filter(X=>!ie.has(X.id)),me={id:Date.now().toString(),title:`${f} (Split)`,titleImage:g,label:_,questions:K,owner:t.email,questionCount:K.length};try{const X=await xr.saveLesson(me);r({...X,driveFileId:X.driveFileId||X.id},!1),V(le),Z(new Set),ee(!1),s("Lesson split successfully!"),await rt()}catch{s("Failed to split lesson.")}})},hn=async()=>{if(!pe)return s("Please select a lesson to merge with.");const K=l==null?void 0:l.find(le=>le.id===pe);if(!K)return s("Target lesson not found.");o(`Merge "${f}" into "${K.title}"?`,async()=>{try{const le=K.questions||K.cards||[],me={...K,questions:[...le,...L],questionCount:le.length+L.length};await xr.saveLesson(me),e!=null&&e.driveFileId&&await AC(t.token,e.driveFileId),s("Lessons merged successfully!"),n()}catch{s("Failed to merge lessons.")}})},Je=K=>{Z(le=>{const me=new Set(le);return me.has(K)?me.delete(K):me.add(K),me})};return u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)",background:"rgba(255,255,255,0.01)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:u.jsxs("div",{ref:$,className:"modal-content neo-flat",style:{width:"100%",maxWidth:"600px",height:window.innerWidth<768?"100%":"90vh",maxHeight:"100%",padding:0,display:"flex",flexDirection:"column",position:"relative",overflow:"hidden",borderRadius:window.innerWidth<768?0:"24px"},children:[u.jsxs("div",{style:{padding:"1.5rem 2rem",borderBottom:"1px solid var(--shadow-dark)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-color)",zIndex:10},children:[u.jsx("h2",{style:{fontSize:"1.5rem",margin:0},children:e?"Edit Lesson":"New Lesson"}),u.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:u.jsx(ti,{onClick:n,size:18})})]}),u.jsxs("div",{ref:ae,style:{padding:"2rem",flex:1,overflowY:"auto",display:"flex",flexDirection:"column",gap:"1.5rem"},children:[u.jsx("div",{style:{display:"flex",gap:"1.5rem",alignItems:"flex-start"},children:u.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.8rem"},children:[u.jsx("label",{style:{fontWeight:"600",opacity:.7},children:"Title & Cover Image"}),u.jsxs("div",{style:{display:"flex",gap:"10px"},children:[u.jsxs("div",{style:{position:"relative",flex:1},children:[u.jsx("input",{id:"lesson-modal-title-input",className:"neo-input",placeholder:"Lesson Title ",value:f,onChange:K=>p(Ea(K.target.value)),style:{paddingRight:"30px"}}),!f&&u.jsx("span",{style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",color:"red",pointerEvents:"none"},children:"*"})]}),u.jsxs("div",{style:{display:"flex",gap:"8px"},children:[u.jsxs("label",{className:"neo-button icon-btn",style:{cursor:"pointer",flexShrink:0,color:g?"var(--accent-color)":"currentColor"},children:[u.jsx(Og,{size:18}),u.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:K=>de(K,x)})]}),g&&u.jsx("button",{className:"neo-button icon-btn",style:{flexShrink:0},onClick:()=>x(""),children:u.jsx(yi,{size:16,color:"var(--error-color)"})})]})]}),u.jsx(yr,{label:"Label",value:_,options:[{label:"No label",value:"No label"},...a.filter(K=>K!=="No label").map(K=>({label:K,value:K}))],onChange:k,placeholder:"Select label...",children:u.jsxs("div",{style:{display:"flex",gap:"8px",padding:"8px",borderBottom:"1px solid var(--shadow-dark)",marginBottom:"4px"},children:[u.jsx("input",{className:"neo-input",placeholder:"Create new label...",value:w,onChange:K=>j(Ea(K.target.value)),onKeyPress:K=>{K.key==="Enter"&&w.trim()&&(k(w.trim()),j(""))},style:{flex:1,fontSize:"0.85rem",padding:"8px 12px",height:"36px"}}),u.jsx("button",{className:"neo-button",style:{padding:"8px 12px",fontSize:"0.85rem",height:"36px"},onClick:()=>{w.trim()&&(k(w.trim()),j(""))},children:u.jsx(Ji,{size:14})})]})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem",marginTop:"0.5rem"},children:[u.jsx("label",{style:{fontWeight:"600",opacity:.7},children:"Important Note (Optional)"}),u.jsx(Ih,{placeholder:"Add an important note...",value:S,onChange:K=>v(Ea(K.target.value))})]})]})}),(t==null?void 0:t.email)===ki&&u.jsxs("div",{className:"neo-inset",style:{padding:"1.5rem",display:"flex",flexDirection:"column",gap:"1.25rem",borderRadius:"16px"},children:[u.jsx("h3",{style:{fontSize:"0.9rem",fontWeight:"bold",opacity:.6},children:"COMMUNITY METADATA"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.25rem"},children:[u.jsx(yr,{label:"Standard",value:E,options:["V","VI","VII","VIII","IX","X"].map(K=>({label:`Standard ${K}`,value:K})),onChange:T,placeholder:"Select Standard"}),u.jsx(yr,{label:"Syllabus",value:I,options:["NCERT","Kerala"].map(K=>({label:K,value:K})),onChange:A,placeholder:"Select Syllabus"}),u.jsx(yr,{label:"Medium",value:P,options:["Malayalam","English"].map(K=>({label:K,value:K})),onChange:N,placeholder:"Select Medium"}),u.jsx(yr,{label:"Subject",value:b,options:["Maths","Social Science","Science","English","Malayalam","Hindi"].map(K=>({label:K,value:K})),onChange:H,placeholder:"Select Subject"}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem"},children:[u.jsx("label",{style:{fontSize:"0.7rem",fontWeight:"700",color:"#94a3b8",textTransform:"uppercase"},children:"Cost (Coins)"}),u.jsx("input",{type:"number",className:"neo-input",value:he,onChange:K=>re(K.target.value),placeholder:"0 for free",style:{padding:"10px 12px"}})]})]}),u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"1rem",cursor:"pointer",padding:"0.5rem",borderRadius:"8px",background:G?"var(--accent-soft)":"transparent"},children:[u.jsx("input",{type:"checkbox",checked:G,onChange:K=>M(K.target.checked),style:{width:"18px",height:"18px"}}),u.jsx("span",{style:{fontSize:"0.9rem",fontWeight:"600",color:G?"var(--accent-color)":"inherit"},children:"Publish to Community Pool"})]})]}),u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:se&&se.length>0?se.map((K,le)=>{const me=K.questions||K.cards||[];return u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",padding:"1rem",borderRadius:"12px",border:"1px solid var(--shadow-dark)"},children:[u.jsxs("div",{className:"neo-flat",style:{padding:"1rem",borderLeft:"4px solid var(--accent-color)",borderRadius:"8px"},children:[u.jsx("label",{style:{fontSize:"0.7rem",fontWeight:"bold",opacity:.5,textTransform:"uppercase",display:"block",marginBottom:"4px"},children:"Section Note"}),u.jsx(Ih,{value:K.noteSegment,onChange:X=>{const xe=[...se];xe[le].noteSegment=X.target.value,U(xe)},placeholder:"Enter section note...",style:{minHeight:"40px",background:"transparent",boxShadow:"none"}})]}),u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:me.map((X,xe)=>u.jsx(tT,{question:X,index:xe,totalQuestions:me.length,onUpdate:(ye,_t)=>{const Ke=[...se],je=Ke[le].questions||Ke[le].cards||[];je[xe]={...X,[ye]:_t},Ke[le].questions=je,U(Ke),V(Ke.flatMap(zt=>zt.questions||zt.cards))},onRemove:()=>{const ye=[...se],_t=ye[le].questions||ye[le].cards||[];_t.splice(xe,1),ye[le].questions=_t,U(ye),V(ye.flatMap(Ke=>Ke.questions||Ke.cards))},onMove:ye=>Zt(xe,ye,le),recording:ke,startRecording:fe,stopRecording:De,cancelRecording:nt,recordingTime:Ye,handleFileUpload:de,handleOptionChange:(ye,_t,Ke)=>{const je=[...se],zt=je[le].questions||je[le].cards||[],Bt=zt[xe];_t==="isCorrect"?Bt.options=Bt.options.map(tn=>({...tn,isCorrect:tn.id===ye})):Bt.options=Bt.options.map(tn=>tn.id===ye?{...tn,[_t]:Ke}:tn),je[le].questions=zt,U(je),V(je.flatMap(tn=>tn.questions||tn.cards))},setViewingImage:q,showSplitUI:J,selectedQuestions:ie,toggleQuestionSelection:Je},X.id))}),u.jsxs("button",{className:"neo-button",style:{alignSelf:"center",fontSize:"0.8rem",opacity:.6},onClick:()=>{const X=[...se];X.splice(le+1,0,{noteSegment:"",questions:[]}),U(X)},children:[u.jsx(Ji,{size:14})," Insert Section Here"]})]},le)}):L.map((K,le)=>u.jsx(tT,{question:K,index:le,totalQuestions:L.length,onUpdate:(me,X)=>Ee(K.id,me,X),onRemove:()=>Pr(K.id),onMove:me=>Zt(le,me),recording:ke,startRecording:fe,stopRecording:De,cancelRecording:nt,recordingTime:Ye,handleFileUpload:de,handleOptionChange:(me,X,xe)=>en(K.id,me,X,xe),setViewingImage:q,showSplitUI:J,selectedQuestions:ie,toggleQuestionSelection:Je},K.id))}),u.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[u.jsxs("button",{className:"neo-button neo-glow-blue",style:{flex:1,justifyContent:"center",background:"var(--accent-soft)",color:"var(--accent-color)"},onClick:Hn,children:[u.jsx(Ji,{size:18})," Add Question"]}),u.jsxs("button",{className:"neo-button neo-glow-blue",style:{flex:1,justifyContent:"center",background:"var(--accent-soft)",color:"var(--accent-color)"},onClick:Gn,children:[u.jsx(Ji,{size:18})," Add MCQ"]}),u.jsxs("button",{className:"neo-button neo-glow-blue",style:{flex:1,justifyContent:"center",background:"var(--bg-color)",color:"var(--accent-color)"},onClick:Dn,children:[u.jsx(Ji,{size:18})," Add Section"]})]}),e&&L.length>1&&u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[u.jsxs("button",{className:`neo-button ${J?"neo-inset":""}`,style:{flex:1,justifyContent:"center",fontSize:"0.9rem"},onClick:()=>{ee(!J),Y(!1),Z(new Set)},children:[u.jsx(t9,{size:16})," ",J?"Cancel Split":"Split Lesson"]}),l&&l.filter(K=>K.id!==(e==null?void 0:e.id)).length>0&&u.jsxs("button",{className:`neo-button ${z?"neo-inset":""}`,style:{flex:1,justifyContent:"center",fontSize:"0.9rem"},onClick:()=>{Y(!z),ee(!1),Z(new Set)},children:[u.jsx(G8,{size:16})," ",z?"Cancel Merge":"Merge Lesson"]})]}),J&&u.jsxs("div",{className:"neo-inset",style:{padding:"1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("p",{style:{fontSize:"0.9rem",opacity:.7},children:"Select questions to move to a new lesson:"}),u.jsxs("button",{className:"neo-button neo-glow-blue",style:{background:"var(--accent-color)",color:"white",border:"none",justifyContent:"center"},onClick:$e,children:["Create New Lesson with ",ie.size," Selected Question(s)"]})]}),z&&u.jsxs("div",{className:"neo-inset",style:{padding:"1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("p",{style:{fontSize:"0.9rem",opacity:.7},children:"Select lesson to merge into:"}),u.jsx(yr,{value:pe,options:l==null?void 0:l.filter(K=>K.id!==(e==null?void 0:e.id)).map(K=>{var le,me;return{label:`${K.title} (${((le=K.questions)==null?void 0:le.length)||((me=K.cards)==null?void 0:me.length)||0} questions)`,value:K.id}}),onChange:_e,placeholder:"-- Select Lesson --",displayValue:K=>{var le;return(le=l.find(me=>me.id===K))==null?void 0:le.title}}),u.jsx("button",{className:"neo-button neo-glow-blue",style:{background:"var(--accent-color)",color:"white",border:"none",justifyContent:"center"},onClick:hn,disabled:!pe,children:"Merge Into Selected Lesson"})]})]})]}),u.jsx("div",{style:{padding:"1.5rem",borderTop:"1px solid var(--shadow-dark)",display:"flex",flexDirection:"column",gap:"1rem",background:"var(--bg-color)",zIndex:10},children:u.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:[e&&u.jsxs("button",{className:"neo-button neo-glow-red",style:{flex:"1 1 8.75rem",justifyContent:"center",color:"var(--error-color)",padding:"0.8rem"},onClick:()=>i(e),children:[u.jsx(yi,{size:18})," Delete Lesson"]}),u.jsx("button",{className:"neo-button",style:{flex:"1 1 6.25rem",justifyContent:"center",padding:"0.8rem"},onClick:n,children:"Cancel"}),u.jsx("button",{className:`neo-button ${ge?"neo-inset":""}`,style:{flex:"2 1 12.5rem",justifyContent:"center",background:ge?"var(--bg-color)":"var(--accent-color)",color:ge?"var(--accent-color)":"white",border:"none",padding:"0.8rem",cursor:ge?"not-allowed":"pointer",opacity:ge?.8:1},onClick:rt,disabled:ge,children:ge?u.jsxs(u.Fragment,{children:[u.jsx(Pc,{size:18,className:"spin",style:{marginRight:"8px"}})," Saving..."]}):u.jsxs(u.Fragment,{children:[u.jsx(J8,{size:18,style:{marginRight:"8px"}})," ",e?"Save Changes":"Create Lesson"]})})]})}),u.jsx(Cn,{children:D&&u.jsx(qC,{imageUrl:D,onClose:()=>q(null)})})]})})},uv="/chethan-in-cardland/beta/assets/avatar_guide_new-9cb767fe.png",I9="/chethan-in-cardland/beta/assets/congratulations-565fc759.png",C9=({currentIndex:t,totalQuestions:e,masteredCount:n,totalOriginalQuestions:r,rating:i,onClose:s,user:o,lesson:a})=>u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[u.jsxs("div",{className:"neo-button",style:{height:"2.25rem",padding:"0 1rem",fontSize:"1rem",justifyContent:"center",minWidth:"5rem"},children:[t+1," / ",e]}),u.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"0 20px"},children:u.jsxs("div",{style:{width:"100%",maxWidth:"14rem",height:"1rem",background:"rgba(0,0,0,0.05)",borderRadius:"0.625rem",position:"relative",display:"flex",alignItems:"center",boxShadow:"inset 0.125rem 0.125rem 0.25rem var(--shadow-dark), inset -0.1rem -0.1rem 0.2rem var(--shadow-light)"},children:[u.jsx(Ue.div,{animate:{left:`${r>0?n/r*100:0}%`,y:i===2?[0,-15,0]:i===1?[0,-5,0]:0},transition:{left:{type:"spring",stiffness:50,damping:15},y:{duration:.4,ease:"easeOut"}},style:{position:"absolute",left:0,top:-4,zIndex:10,x:"-50%"},children:u.jsx(j8,{size:24,color:i===2?"#22c55e":"var(--accent-color)",fill:i===2?"#dcfce7":"none"})}),u.jsx("div",{style:{width:`${r>0?n/r*100:0}%`,height:"100%",background:i===2?"linear-gradient(90deg, var(--accent-color), #22c55e)":"var(--accent-color)",borderRadius:"10px",transition:"width 0.5s cubic-bezier(0.4, 0, 0.2, 1), background 0.3s ease",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),u.jsx("div",{style:{position:"absolute",right:-12,top:-4,opacity:.9},children:u.jsx(Eh,{size:24,color:"var(--accent-color)",fill:"var(--bg-color)"})})]})}),u.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:u.jsx(ti,{onClick:s,size:18})})]}),Yp=({audioData:t})=>{const[e,n]=R.useState(!1),[r,i]=R.useState(0),s=R.useRef(null),o=R.useRef(),a=R.useRef();s.current||(s.current=new Audio(t)),R.useEffect(()=>{const f=s.current;f.src!==t&&(f.pause(),f.src=t,f.load(),i(0),n(!1))},[t]),R.useEffect(()=>{const f=s.current,p=()=>{f.duration&&i(f.currentTime/f.duration*100),o.current=requestAnimationFrame(p)},g=()=>{n(!0),o.current=requestAnimationFrame(p)},x=()=>{n(!1),cancelAnimationFrame(o.current)},_=()=>{n(!1),i(0),cancelAnimationFrame(o.current)};return f.addEventListener("play",g),f.addEventListener("pause",x),f.addEventListener("ended",_),()=>{f.pause(),f.removeEventListener("play",g),f.removeEventListener("pause",x),f.removeEventListener("ended",_),cancelAnimationFrame(o.current)}},[]);const l=f=>{f.stopPropagation();const p=s.current;e?p.pause():p.play()},d=f=>{f.stopPropagation();const p=s.current;p.pause(),p.currentTime=0,i(0)},h=f=>{f.stopPropagation();const p=a.current.getBoundingClientRect(),g=f.clientX-p.left,x=Math.max(0,Math.min(100,g/p.width*100)),_=s.current;_.duration&&(_.currentTime=x/100*_.duration,i(x))};return u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"0.5rem",width:"100%",maxWidth:"250px"},onClick:f=>f.stopPropagation(),children:[u.jsx("button",{className:"neo-button icon-btn",onClick:l,style:{width:"30px",height:"30px",background:"var(--accent-soft)",color:"var(--accent-color)",borderRadius:"50%",flexShrink:0},children:e?u.jsx(K8,{size:12,fill:"currentColor"}):u.jsx(Rf,{size:12,fill:"currentColor"})}),u.jsx("button",{className:"neo-button icon-btn",onClick:d,style:{width:"30px",height:"30px",borderRadius:"50%",flexShrink:0},children:u.jsx(zg,{size:10,fill:"currentColor"})}),u.jsx("div",{ref:a,className:"neo-inset",onClick:h,style:{flex:1,height:"6px",borderRadius:"3px",overflow:"hidden",position:"relative",cursor:"pointer"},children:u.jsx("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:`${r}%`,background:"var(--accent-color)",transition:"width 0.1s linear"}})})]})},k9=t=>t?t.split(`
`).map((e,n)=>{const i=e.split(/(\*\*[^*]+\*\*)/g).map((s,o)=>s.startsWith("**")&&s.endsWith("**")?u.jsx("strong",{children:s.slice(2,-2)},o):s);return u.jsxs("span",{children:[i,n<t.split(`
`).length-1&&u.jsx("br",{})]},n)}):null,A9=({noteText:t,onStart:e})=>t?u.jsx("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},"data-testid":"section-note-card",children:u.jsxs("div",{className:"neo-flat",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",padding:"1.5rem",position:"relative",overflow:"hidden"},children:[u.jsx("div",{style:{flex:1,width:"100%",display:"flex",flexDirection:"column",overflowY:"auto",paddingRight:"0.25rem"},className:"custom-scrollbar",children:u.jsx("div",{style:{padding:"0.5rem 0.5rem 2rem",flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:u.jsx("div",{style:{fontSize:"1.2rem",lineHeight:"1.6",color:"var(--text-color)",textAlign:"center"},children:k9(t)})})}),u.jsx("div",{style:{width:"100%",marginTop:"auto",display:"flex",justifyContent:"center",paddingTop:"1rem"},children:u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:e,style:{width:"100%",padding:"1rem",fontSize:"1.1rem",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",background:"var(--accent-color)",color:"white",border:"none",borderRadius:"1rem"},children:[u.jsx("span",{children:"Start Questions"}),u.jsx(PC,{size:20})]})})]})}):null,R9=({currentQuestion:t,isFlipped:e,setIsFlipped:n,setViewingImage:r,onRateMCQ:i,feedback:s,showSectionNotes:o=!1})=>{var h;const[a,l]=R.useState(!1);return R.useEffect(()=>{t&&t.isFirstInSection&&l(!1)},[t==null?void 0:t.id,t==null?void 0:t.isFirstInSection]),t?o&&t.isFirstInSection&&t.sectionNoteSegment&&!a?u.jsx(A9,{noteText:t.sectionNoteSegment,onStart:()=>l(!0)}):t.type==="mcq"?u.jsx("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},"data-testid":"question-card-mcq",children:u.jsxs("div",{className:"neo-flat",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",padding:"1.5rem",position:"relative",overflow:"hidden"},children:[u.jsx("div",{style:{flex:1,width:"100%",display:"flex",flexDirection:"column",overflowY:"auto",paddingRight:"0.25rem"},className:"custom-scrollbar",children:u.jsxs("div",{style:{padding:"0.5rem 0.5rem 2rem",flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[t.question.image&&u.jsx("img",{src:t.question.image,style:{maxWidth:"100%",maxHeight:"12rem",objectFit:"contain",borderRadius:"0.75rem",marginBottom:"1.5rem",cursor:"pointer"},alt:"Q",onClick:()=>r(t.question.image)}),u.jsx("h2",{style:{fontSize:"1.3rem",fontWeight:"800",margin:0,textAlign:"center",lineHeight:"1.4"},children:t.question.text}),t.question.audio&&u.jsx("div",{style:{marginTop:"1rem"},children:u.jsx(Yp,{audioData:t.question.audio})})]})}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"0.75rem",width:"100%",marginTop:"auto",paddingTop:"1rem"},children:(h=t.options)==null?void 0:h.map((f,p)=>{const g=s&&f.isCorrect;return u.jsx("button",{disabled:!!s,className:"neo-button",onClick:()=>i(f),style:{padding:"1rem",justifyContent:"flex-start",textAlign:"left",minHeight:"3.5rem",background:"var(--bg-color)",borderColor:g?"#22c55e":"var(--border-color)",boxShadow:g?"0 0 15px rgba(34, 197, 94, 0.4)":void 0,color:g?"#16a34a":void 0,opacity:s&&!g?.5:1,fontSize:"0.95rem",lineHeight:"1.3",fontWeight:g?"bold":"500"},children:f.text},f.id||p)})})]})}):u.jsx("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},"data-testid":"question-card-flashcard",children:u.jsx("div",{style:{perspective:"62.5rem",flex:1,minHeight:0,cursor:"pointer"},onClick:()=>{e&&n(!1)},children:u.jsxs(Ue.div,{style:{width:"100%",height:"100%",position:"relative",transformStyle:"preserve-3d"},animate:{rotateY:e?180:0},transition:{type:"spring",stiffness:260,damping:20},children:[u.jsxs("div",{className:"neo-flat",style:{position:"absolute",width:"100%",height:"100%",backfaceVisibility:"hidden",display:"flex",flexDirection:"column",padding:"1.5rem",overflow:"hidden"},children:[u.jsx("div",{style:{flex:1,width:"100%",overflowY:"auto",paddingRight:"0.25rem",display:"flex",flexDirection:"column"},className:"custom-scrollbar",children:u.jsxs("div",{style:{padding:"0.5rem 0.5rem 2rem",flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[t&&t.question.image&&u.jsx("img",{src:t.question.image,style:{maxWidth:"100%",maxHeight:"14rem",objectFit:"contain",borderRadius:"0.75rem",marginBottom:"1.5rem",cursor:"pointer"},alt:"Q",onClick:f=>{f.stopPropagation(),r(t.question.image)}}),u.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"800",textAlign:"center",lineHeight:"1.4"},children:t?t.question.text:"No more questions"}),t&&t.question.audio&&u.jsx("div",{style:{marginTop:"1.5rem"},onClick:f=>f.stopPropagation(),children:u.jsx(Yp,{audioData:t.question.audio})})]})}),u.jsx("div",{style:{textAlign:"center",opacity:.3,fontSize:"0.75rem",marginTop:"1rem",fontWeight:"bold"},children:'TAP "SHOW ANSWER" AT THE BOTTOM'})]}),u.jsxs("div",{className:"neo-flat",style:{position:"absolute",width:"100%",height:"100%",backfaceVisibility:"hidden",transform:"rotateY(180deg)",display:"flex",flexDirection:"column",padding:"1.5rem",overflow:"hidden"},children:[u.jsx("div",{style:{flex:1,width:"100%",overflowY:"auto",paddingRight:"0.25rem",display:"flex",flexDirection:"column"},className:"custom-scrollbar",children:u.jsxs("div",{style:{padding:"0.5rem 0.5rem 2rem",flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[t&&t.answer.image&&u.jsx("img",{src:t.answer.image,style:{maxWidth:"100%",maxHeight:"14rem",objectFit:"contain",borderRadius:"0.75rem",marginBottom:"1.5rem",cursor:"pointer"},alt:"A",onClick:f=>{f.stopPropagation(),r(t.answer.image)}}),u.jsx("h2",{style:{fontSize:"1.6rem",color:"var(--accent-color)",fontWeight:"800",textAlign:"center",lineHeight:"1.4"},children:t?t.answer.text:""}),t&&t.answer.audio&&u.jsx("div",{style:{marginTop:"1.5rem"},onClick:f=>f.stopPropagation(),children:u.jsx(Yp,{audioData:t.answer.audio})})]})}),u.jsx("div",{style:{textAlign:"center",opacity:.3,fontSize:"0.75rem",marginTop:"1rem",fontWeight:"bold"},children:"RATE YOURSELF AT THE BOTTOM"})]})]})})}):null};let Xp=null;const jo=()=>(Xp||(Xp=new(window.AudioContext||window.webkitAudioContext)),Xp),tl=()=>localStorage.getItem("soundsEnabled")!=="false",Ha=(t,e,n,r,i=.1)=>{const s=jo(),o=s.createOscillator(),a=s.createGain();o.type=t,o.frequency.setValueAtTime(e,n),o.connect(a),a.connect(s.destination),a.gain.setValueAtTime(0,n),a.gain.linearRampToValueAtTime(i,n+.05),a.gain.exponentialRampToValueAtTime(.001,n+r),o.start(n),o.stop(n+r)},P9=()=>{if(!tl())return;const t=jo();t.state==="suspended"&&t.resume();const e=t.currentTime;[523.25,659.25,783.99,1046.5].forEach((r,i)=>{Ha("sine",r,e+i*.1,.6,.1)})},N9=()=>{if(!tl())return;const t=jo();t.state==="suspended"&&t.resume();const e=t.currentTime,n=.5,r=t.sampleRate*n,i=t.createBuffer(1,r,t.sampleRate),s=i.getChannelData(0);for(let d=0;d<r;d++)s[d]=Math.random()*2-1;const o=t.createBufferSource();o.buffer=i;const a=t.createBiquadFilter();a.type="lowpass",a.frequency.setValueAtTime(200,e),a.frequency.exponentialRampToValueAtTime(4e3,e+n);const l=t.createGain();l.gain.setValueAtTime(.05,e),l.gain.linearRampToValueAtTime(.1,e+n/2),l.gain.linearRampToValueAtTime(0,e+n),o.connect(a),a.connect(l),l.connect(t.destination),o.start(e)},D9=()=>{if(!tl())return;const t=jo();t.state==="suspended"&&t.resume();const e=t.currentTime;Ha("sine",1975.53,e,.8,.15),Ha("sine",3951.07,e,.4,.05)},j9=()=>{if(!tl())return;const t=jo();t.state==="suspended"&&t.resume();const e=t.currentTime;[{freq:392,time:0,dur:.15},{freq:523.25,time:.15,dur:.15},{freq:659.25,time:.3,dur:.15},{freq:783.99,time:.45,dur:.4}].forEach(({freq:r,time:i,dur:s})=>{const o=t.createOscillator(),a=t.createGain(),l=t.createBiquadFilter();o.type="sawtooth",o.frequency.value=r,l.type="lowpass",l.Q.value=2,o.connect(l),l.connect(a),a.connect(t.destination);const d=e+i,h=d+s;l.frequency.setValueAtTime(500,d),l.frequency.linearRampToValueAtTime(3e3,d+.05),l.frequency.exponentialRampToValueAtTime(500,h),a.gain.setValueAtTime(0,d),a.gain.linearRampToValueAtTime(.2,d+.02),a.gain.linearRampToValueAtTime(.15,d+.05),a.gain.exponentialRampToValueAtTime(.001,h),o.start(d),o.stop(h+.1)})},L9=()=>{if(!tl())return;const t=jo();t.state==="suspended"&&t.resume();const e=t.currentTime;[{freq:523.25,delay:0,vol:.1},{freq:659.25,delay:.05,vol:.1},{freq:783.99,delay:.1,vol:.1},{freq:1046.5,delay:.15,vol:.08}].forEach(({freq:r,delay:i,vol:s})=>{Ha("sine",r,e+i,1,s)})},M9=()=>{if(!tl())return;const t=jo();t.state==="suspended"&&t.resume();const e=t.currentTime;Ha("triangle",440,e,.3,.04),Ha("sine",554.37,e,.3,.04)},V9=({isFlipped:t,currentQuestion:e,isRecording:n,recordedAudio:r,isPlayingRecorded:i,startRecording:s,stopRecording:o,deleteRecording:a,toggleRecordedPlayback:l,setIsFlipped:d,handleRating:h,feedback:f})=>!e||e.type==="mcq"?null:t?f?null:u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",width:"100%",minHeight:"5rem",justifyContent:"center"},children:u.jsx(Cn,{mode:"wait",children:u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",width:"100%"},children:[u.jsxs("div",{className:"neo-flat",style:{padding:"0.75rem",display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",borderRadius:"1rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[u.jsx("div",{style:{width:"0.6rem",height:"0.6rem",borderRadius:"50%",background:"var(--accent-color)",opacity:.6}}),u.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"bold",opacity:.7},children:"SELECT MATCHING ANSWER"})]}),u.jsx("div",{style:{display:"flex",gap:"0.75rem"},children:r&&u.jsx("button",{className:"neo-button icon-btn",onClick:l,style:{color:"var(--accent-color)",width:"2.25rem",height:"2.25rem"},children:i?u.jsx(zg,{size:16,fill:"currentColor"}):u.jsx(Rf,{size:16,fill:"currentColor"})})})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:"10px",width:"100%",justifyContent:"center"},children:[u.jsx("button",{className:"neo-button",style:{flex:1,flexDirection:"column",padding:"0.75rem 0.25rem",background:"#fee2e2",color:"#dc2626",border:"1px solid #fecaca",minWidth:"4rem",borderRadius:"0.75rem",minHeight:"3.75rem"},onClick:p=>{p.stopPropagation(),h(-1)},children:u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"bold"},children:"Wrong"})}),u.jsx("button",{className:"neo-button",style:{flex:1,flexDirection:"column",padding:"0.75rem 0.25rem",background:"#f3f4f6",color:"#4b5563",border:"1px solid #e5e7eb",minWidth:"4rem",borderRadius:"0.75rem",minHeight:"3.75rem"},onClick:p=>{p.stopPropagation(),h(0)},children:u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"bold"},children:"Unsure"})}),u.jsx("button",{className:"neo-button",style:{flex:1,flexDirection:"column",padding:"0.75rem 0.25rem",background:"#e0f2fe",color:"#0284c7",border:"1px solid #bae6fd",minWidth:"4rem",borderRadius:"0.75rem",minHeight:"3.75rem"},onClick:p=>{p.stopPropagation(),h(1)},children:u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"bold"},children:"Partly"})}),u.jsx("button",{className:"neo-button",style:{flex:1,flexDirection:"column",padding:"0.75rem 0.25rem",background:"#dcfce7",color:"#16a34a",border:"1px solid #bbf7d0",minWidth:"4rem",borderRadius:"0.75rem",minHeight:"3.75rem"},onClick:p=>{p.stopPropagation(),h(2)},children:u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"bold"},children:"By heart"})})]})]})})}):u.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsxs("div",{className:"neo-flat",style:{padding:"0.75rem",display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",borderRadius:"1rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[u.jsx("div",{style:{width:"0.6rem",height:"0.6rem",borderRadius:"50%",background:n?"#ff4444":"#ccc",boxShadow:n?"0 0 0.5rem #ff4444":"none",animation:n?"pulse 1.5s infinite":"none"}}),u.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"bold",opacity:.7},children:n?"RECORDING ANSWER...":r?"ANSWER RECORDED":"RECORD YOUR ANSWER"})]}),u.jsx("div",{style:{display:"flex",gap:"0.75rem"},children:!n&&!r?u.jsx("button",{className:"neo-button icon-btn",onClick:s,style:{color:"var(--accent-color)",width:"2.25rem",height:"2.25rem"},children:u.jsx(bh,{size:18})}):n?u.jsx("button",{className:"neo-button icon-btn",onClick:o,style:{color:"#ff4444",width:"2.25rem",height:"2.25rem"},children:u.jsx(zg,{size:18,fill:"currentColor"})}):u.jsx(u.Fragment,{children:u.jsx("button",{className:"neo-button icon-btn",onClick:a,style:{color:"#ff4444",width:"2.25rem",height:"2.25rem"},children:u.jsx(yi,{size:18})})})})]}),u.jsx("button",{className:"neo-button neo-glow-blue",style:{width:"100%",justifyContent:"center",padding:"1rem",fontSize:"1.1rem",background:"var(--accent-color)",color:"white",minHeight:"3.75rem",borderRadius:"1rem"},onClick:()=>{N9(),d(!0),r&&setTimeout(()=>l(),300)},children:"Show Answer"})]});var dv={};(function t(e,n,r,i){var s=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),o=typeof Path2D=="function"&&typeof DOMMatrix=="function",a=function(){if(!e.OffscreenCanvas)return!1;try{var M=new OffscreenCanvas(1,1),D=M.getContext("2d");D.fillRect(0,0,1,1);var q=M.transferToImageBitmap();D.createPattern(q,"no-repeat")}catch{return!1}return!0}();function l(){}function d(M){var D=n.exports.Promise,q=D!==void 0?D:e.Promise;return typeof q=="function"?new q(M):(M(l,l),null)}var h=function(M,D){return{transform:function(q){if(M)return q;if(D.has(q))return D.get(q);var J=new OffscreenCanvas(q.width,q.height),ee=J.getContext("2d");return ee.drawImage(q,0,0),D.set(q,J),J},clear:function(){D.clear()}}}(a,new Map),f=function(){var M=Math.floor(16.666666666666668),D,q,J={},ee=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(D=function(ie){var Z=Math.random();return J[Z]=requestAnimationFrame(function z(Y){ee===Y||ee+M-1<Y?(ee=Y,delete J[Z],ie()):J[Z]=requestAnimationFrame(z)}),Z},q=function(ie){J[ie]&&cancelAnimationFrame(J[ie])}):(D=function(ie){return setTimeout(ie,M)},q=function(ie){return clearTimeout(ie)}),{frame:D,cancel:q}}(),p=function(){var M,D,q={};function J(ee){function ie(Z,z){ee.postMessage({options:Z||{},callback:z})}ee.init=function(z){var Y=z.transferControlToOffscreen();ee.postMessage({canvas:Y},[Y])},ee.fire=function(z,Y,pe){if(D)return ie(z,null),D;var _e=Math.random().toString(36).slice(2);return D=d(function(ge){function Ae($){$.data.callback===_e&&(delete q[_e],ee.removeEventListener("message",Ae),D=null,h.clear(),pe(),ge())}ee.addEventListener("message",Ae),ie(z,_e),q[_e]=Ae.bind(null,{data:{callback:_e}})}),D},ee.reset=function(){ee.postMessage({reset:!0});for(var z in q)q[z](),delete q[z]}}return function(){if(M)return M;if(!r&&s){var ee=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{M=new Worker(URL.createObjectURL(new Blob([ee])))}catch(ie){return typeof console<"u"&&typeof console.warn=="function"&&console.warn(" Could not load worker",ie),null}J(M)}return M}}(),g={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function x(M,D){return D?D(M):M}function _(M){return M!=null}function k(M,D,q){return x(M&&_(M[D])?M[D]:g[D],q)}function S(M){return M<0?0:Math.floor(M)}function v(M,D){return Math.floor(Math.random()*(D-M))+M}function w(M){return parseInt(M,16)}function j(M){return M.map(L)}function L(M){var D=String(M).replace(/[^0-9a-f]/gi,"");return D.length<6&&(D=D[0]+D[0]+D[1]+D[1]+D[2]+D[2]),{r:w(D.substring(0,2)),g:w(D.substring(2,4)),b:w(D.substring(4,6))}}function V(M){var D=k(M,"origin",Object);return D.x=k(D,"x",Number),D.y=k(D,"y",Number),D}function E(M){M.width=document.documentElement.clientWidth,M.height=document.documentElement.clientHeight}function T(M){var D=M.getBoundingClientRect();M.width=D.width,M.height=D.height}function I(M){var D=document.createElement("canvas");return D.style.position="fixed",D.style.top="0px",D.style.left="0px",D.style.pointerEvents="none",D.style.zIndex=M,D}function A(M,D,q,J,ee,ie,Z,z,Y){M.save(),M.translate(D,q),M.rotate(ie),M.scale(J,ee),M.arc(0,0,1,Z,z,Y),M.restore()}function P(M){var D=M.angle*(Math.PI/180),q=M.spread*(Math.PI/180);return{x:M.x,y:M.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:M.startVelocity*.5+Math.random()*M.startVelocity,angle2D:-D+(.5*q-Math.random()*q),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:M.color,shape:M.shape,tick:0,totalTicks:M.ticks,decay:M.decay,drift:M.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:M.gravity*3,ovalScalar:.6,scalar:M.scalar,flat:M.flat}}function N(M,D){D.x+=Math.cos(D.angle2D)*D.velocity+D.drift,D.y+=Math.sin(D.angle2D)*D.velocity+D.gravity,D.velocity*=D.decay,D.flat?(D.wobble=0,D.wobbleX=D.x+10*D.scalar,D.wobbleY=D.y+10*D.scalar,D.tiltSin=0,D.tiltCos=0,D.random=1):(D.wobble+=D.wobbleSpeed,D.wobbleX=D.x+10*D.scalar*Math.cos(D.wobble),D.wobbleY=D.y+10*D.scalar*Math.sin(D.wobble),D.tiltAngle+=.1,D.tiltSin=Math.sin(D.tiltAngle),D.tiltCos=Math.cos(D.tiltAngle),D.random=Math.random()+2);var q=D.tick++/D.totalTicks,J=D.x+D.random*D.tiltCos,ee=D.y+D.random*D.tiltSin,ie=D.wobbleX+D.random*D.tiltCos,Z=D.wobbleY+D.random*D.tiltSin;if(M.fillStyle="rgba("+D.color.r+", "+D.color.g+", "+D.color.b+", "+(1-q)+")",M.beginPath(),o&&D.shape.type==="path"&&typeof D.shape.path=="string"&&Array.isArray(D.shape.matrix))M.fill(se(D.shape.path,D.shape.matrix,D.x,D.y,Math.abs(ie-J)*.1,Math.abs(Z-ee)*.1,Math.PI/10*D.wobble));else if(D.shape.type==="bitmap"){var z=Math.PI/10*D.wobble,Y=Math.abs(ie-J)*.1,pe=Math.abs(Z-ee)*.1,_e=D.shape.bitmap.width*D.scalar,ge=D.shape.bitmap.height*D.scalar,Ae=new DOMMatrix([Math.cos(z)*Y,Math.sin(z)*Y,-Math.sin(z)*pe,Math.cos(z)*pe,D.x,D.y]);Ae.multiplySelf(new DOMMatrix(D.shape.matrix));var $=M.createPattern(h.transform(D.shape.bitmap),"no-repeat");$.setTransform(Ae),M.globalAlpha=1-q,M.fillStyle=$,M.fillRect(D.x-_e/2,D.y-ge/2,_e,ge),M.globalAlpha=1}else if(D.shape==="circle")M.ellipse?M.ellipse(D.x,D.y,Math.abs(ie-J)*D.ovalScalar,Math.abs(Z-ee)*D.ovalScalar,Math.PI/10*D.wobble,0,2*Math.PI):A(M,D.x,D.y,Math.abs(ie-J)*D.ovalScalar,Math.abs(Z-ee)*D.ovalScalar,Math.PI/10*D.wobble,0,2*Math.PI);else if(D.shape==="star")for(var ae=Math.PI/2*3,ke=4*D.scalar,Ge=8*D.scalar,Ye=D.x,Xe=D.y,dt=5,Ne=Math.PI/dt;dt--;)Ye=D.x+Math.cos(ae)*Ge,Xe=D.y+Math.sin(ae)*Ge,M.lineTo(Ye,Xe),ae+=Ne,Ye=D.x+Math.cos(ae)*ke,Xe=D.y+Math.sin(ae)*ke,M.lineTo(Ye,Xe),ae+=Ne;else M.moveTo(Math.floor(D.x),Math.floor(D.y)),M.lineTo(Math.floor(D.wobbleX),Math.floor(ee)),M.lineTo(Math.floor(ie),Math.floor(Z)),M.lineTo(Math.floor(J),Math.floor(D.wobbleY));return M.closePath(),M.fill(),D.tick<D.totalTicks}function b(M,D,q,J,ee){var ie=D.slice(),Z=M.getContext("2d"),z,Y,pe=d(function(_e){function ge(){z=Y=null,Z.clearRect(0,0,J.width,J.height),h.clear(),ee(),_e()}function Ae(){r&&!(J.width===i.width&&J.height===i.height)&&(J.width=M.width=i.width,J.height=M.height=i.height),!J.width&&!J.height&&(q(M),J.width=M.width,J.height=M.height),Z.clearRect(0,0,J.width,J.height),ie=ie.filter(function($){return N(Z,$)}),ie.length?z=f.frame(Ae):ge()}z=f.frame(Ae),Y=ge});return{addFettis:function(_e){return ie=ie.concat(_e),pe},canvas:M,promise:pe,reset:function(){z&&f.cancel(z),Y&&Y()}}}function H(M,D){var q=!M,J=!!k(D||{},"resize"),ee=!1,ie=k(D,"disableForReducedMotion",Boolean),Z=s&&!!k(D||{},"useWorker"),z=Z?p():null,Y=q?E:T,pe=M&&z?!!M.__confetti_initialized:!1,_e=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,ge;function Ae(ae,ke,Ge){for(var Ye=k(ae,"particleCount",S),Xe=k(ae,"angle",Number),dt=k(ae,"spread",Number),Ne=k(ae,"startVelocity",Number),qe=k(ae,"decay",Number),Hn=k(ae,"gravity",Number),Gn=k(ae,"drift",Number),Dn=k(ae,"colors",j),Rr=k(ae,"ticks",Number),Zt=k(ae,"shapes"),en=k(ae,"scalar"),Pr=!!k(ae,"flat"),Ee=V(ae),de=Ye,fe=[],De=M.width*Ee.x,nt=M.height*Ee.y;de--;)fe.push(P({x:De,y:nt,angle:Xe,spread:dt,startVelocity:Ne,color:Dn[de%Dn.length],shape:Zt[v(0,Zt.length)],ticks:Rr,decay:qe,gravity:Hn,drift:Gn,scalar:en,flat:Pr}));return ge?ge.addFettis(fe):(ge=b(M,fe,Y,ke,Ge),ge.promise)}function $(ae){var ke=ie||k(ae,"disableForReducedMotion",Boolean),Ge=k(ae,"zIndex",Number);if(ke&&_e)return d(function(Ne){Ne()});q&&ge?M=ge.canvas:q&&!M&&(M=I(Ge),document.body.appendChild(M)),J&&!pe&&Y(M);var Ye={width:M.width,height:M.height};z&&!pe&&z.init(M),pe=!0,z&&(M.__confetti_initialized=!0);function Xe(){if(z){var Ne={getBoundingClientRect:function(){if(!q)return M.getBoundingClientRect()}};Y(Ne),z.postMessage({resize:{width:Ne.width,height:Ne.height}});return}Ye.width=Ye.height=null}function dt(){ge=null,J&&(ee=!1,e.removeEventListener("resize",Xe)),q&&M&&(document.body.contains(M)&&document.body.removeChild(M),M=null,pe=!1)}return J&&!ee&&(ee=!0,e.addEventListener("resize",Xe,!1)),z?z.fire(ae,Ye,dt):Ae(ae,Ye,dt)}return $.reset=function(){z&&z.reset(),ge&&ge.reset()},$}var he;function re(){return he||(he=H(null,{useWorker:!0,resize:!0})),he}function se(M,D,q,J,ee,ie,Z){var z=new Path2D(M),Y=new Path2D;Y.addPath(z,new DOMMatrix(D));var pe=new Path2D;return pe.addPath(Y,new DOMMatrix([Math.cos(Z)*ee,Math.sin(Z)*ee,-Math.sin(Z)*ie,Math.cos(Z)*ie,q,J])),pe}function U(M){if(!o)throw new Error("path confetti are not supported in this browser");var D,q;typeof M=="string"?D=M:(D=M.path,q=M.matrix);var J=new Path2D(D),ee=document.createElement("canvas"),ie=ee.getContext("2d");if(!q){for(var Z=1e3,z=Z,Y=Z,pe=0,_e=0,ge,Ae,$=0;$<Z;$+=2)for(var ae=0;ae<Z;ae+=2)ie.isPointInPath(J,$,ae,"nonzero")&&(z=Math.min(z,$),Y=Math.min(Y,ae),pe=Math.max(pe,$),_e=Math.max(_e,ae));ge=pe-z,Ae=_e-Y;var ke=10,Ge=Math.min(ke/ge,ke/Ae);q=[Ge,0,0,Ge,-Math.round(ge/2+z)*Ge,-Math.round(Ae/2+Y)*Ge]}return{type:"path",path:D,matrix:q}}function G(M){var D,q=1,J="#000000",ee='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof M=="string"?D=M:(D=M.text,q="scalar"in M?M.scalar:q,ee="fontFamily"in M?M.fontFamily:ee,J="color"in M?M.color:J);var ie=10*q,Z=""+ie+"px "+ee,z=new OffscreenCanvas(ie,ie),Y=z.getContext("2d");Y.font=Z;var pe=Y.measureText(D),_e=Math.ceil(pe.actualBoundingBoxRight+pe.actualBoundingBoxLeft),ge=Math.ceil(pe.actualBoundingBoxAscent+pe.actualBoundingBoxDescent),Ae=2,$=pe.actualBoundingBoxLeft+Ae,ae=pe.actualBoundingBoxAscent+Ae;_e+=Ae+Ae,ge+=Ae+Ae,z=new OffscreenCanvas(_e,ge),Y=z.getContext("2d"),Y.font=Z,Y.fillStyle=J,Y.fillText(D,$,ae);var ke=1/q;return{type:"bitmap",bitmap:z.transferToImageBitmap(),matrix:[ke,0,0,ke,-_e*ke/2,-ge*ke/2]}}n.exports=function(){return re().apply(this,arguments)},n.exports.reset=function(){re().reset()},n.exports.create=H,n.exports.shapeFromPath=U,n.exports.shapeFromText=G})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),dv,!1);const O9=dv.exports;dv.exports.create;const F9=["Off to a flying start!","Great beginning!","First one down, perfectly done!","Strong start!","Excellent opener!","That's how we start!","Right out of the gate - perfect!","Setting a great pace!","Boom! First one nailed!","You're ready for this!"],U9=["You're on fire!","Unstoppable!","Look at you go!","Nothing can stop you now!","Incredible momentum!","You're crushing this!","Back-to-back brilliance!","Another one! Perfect!","You're in the zone!","Keeping the streak alive!"],nT=["Great job!","Very good!","Super!","Excellent work!","Spot on!","You've got this by heart!","Brilliant!","Fantastic!","Wonderful progress!","You're doing amazing!","Perfectly done!","That's the spirit!","Keep it up, champion!","You're a natural!","Masterful!","Impressive memory!","You nailed it!","Outstanding!","Way to go!","Incredible focus!","Gold star for you!","You're making this look easy!","Top notch!","Simply superb!","Bravo!","Pure genius!","Love that confidence!","Right on the money!","You're a star student!","Marvelous!","High five!","That's exactly right!","Spectacular!","So proud of your progress!","You're really shining today!","Unbeatable!","You've mastered this one!","Clear and confident - well done!","Your hard work is paying off!","Solid effort, perfect result!","You're built for this!","A-plus performance!","Victory is yours!"],z9=["Almost there! A quick review will help.","Good effort! Just missed a detail.","On the right track, let's polish it.","Refining this will make it perfect.","You're getting close, keep going!","A little bit more practice on this one.","Not quite 100%, but good try!","Let's turn that 'almost' into 'perfect'.","Close! We'll nail it next time.","Good recall, just needs sharpening."],B9=["Every mistake is a step toward mastery. Reviewing now!","Give it another careful read; well revisit this question.","Take your time and read it again  Ill ask it once more.","No worries! Let's try this one again in a bit.","Let's keep this one in the loop for a little longer.","Practice makes perfect! We'll come back to this.","Don't lose heart, let's give it another look together.","Slow and steady wins the race. Read it once more.","I'll ask this again soon to help you remember.","It's okay! Even the best need a second look sometimes.","Let's refine this one. Read carefully and we'll retry.","A little more focus here will do wonders.","Let's polish this answer together. See you again soon!","Deep breaths! Read it again, and we'll revisit.","Learning takes time. Let's keep this one active.","You're doing great, just need to master this specific one.","Give it one more glance. I'll be back with this question.","Let's solidify this. A quick revisit is coming up.","Don't rush! Read it again to let it sink in.","We'll get this one right next time, I promise!","Keep your chin up! Let's re-study this card.","It's just a hurdle, not a wall. Re-reading helps!","Let's refresh your memory on this one shortly.","Stay positive! We'll tackle this again very soon.","A quick recap, and you'll have it in no time.","Let's keep this card in the 'must-know' pile for now.","Reviewing is the key to success. Let's do it again.","One more read-through will make all the difference.","Persistence pays off! We'll cycle back to this.","It's trial and error. Let's try one more trial.","Let's give this one a second chance to shine.","Focus on the details this time. Re-visiting shortly!","You're learning! Let's re-confirm this one later.","A bit more practice is all you need here.","I believe in you! Let's re-read and try again.","Let's not let this one slip away. Re-asking soon!","Each review makes your brain stronger. Ready for round 2?","Patience is a virtue in learning. Re-reading now.","Let's keep the conversation going on this card.","Small steps lead to big jumps. Let's re-step this one.","Almost caught it! Let's throw the question again later.","It's on the tip of your tongue! Let's review to be sure.","Constructive repetition! We'll be back for this.","Let's strengthen this connection in your memory.","Honesty is the first step to learning. Re-trying soon!","A moment of focus now saves a lot of time later.","Let's bridge the gap on this one. Re-reading...","Your friend is here to help! Let's look at this again.","Final check is coming soon. Give it a good read now!"],$9=({type:t,isFirstQuestion:e=!1,streakCount:n=0}={})=>{let r=[];return t==="success"?e?r=F9:n>=3?r=Math.random()>.4?U9:nT:r=nT:t==="partial"?r=z9:r=B9,r[Math.floor(Math.random()*r.length)]},W9=({lesson:t,user:e,onUpdate:n,onClose:r,showAlert:i,onReviewStart:s})=>{(t.questions||t.cards||[]).some(Ee=>Ee.lastRating!==void 0);const a=t.lastSessionIndex!==void 0,[l,d]=R.useState(!0),[h,f]=R.useState(!1),[p,g]=R.useState(0),[x,_]=R.useState(!1),[k,S]=R.useState(0),[v,w]=R.useState([]),[j,L]=R.useState([]),[V,E]=R.useState(null),[T,I]=R.useState(null),[A,P]=R.useState(null),[N,b]=R.useState(0),[H,he]=R.useState({}),[re,se]=R.useState(0),[U,G]=R.useState(0),[M,D]=R.useState(t.showSectionNotes!==void 0?t.showSectionNotes:!1),[q,J]=R.useState(!1),[ee,ie]=R.useState(null),[Z,z]=R.useState(!1),Y=R.useRef(null),pe=R.useRef(null),_e=R.useRef([]),ge=R.useRef(!1),Ae=R.useRef({lesson:t,firstRatings:H,reviewedCountSession:U,currentIndex:p,rating:k,showSectionNotes:M,onUpdate:n});R.useEffect(()=>{Ae.current={lesson:t,firstRatings:H,reviewedCountSession:U,currentIndex:p,rating:k,showSectionNotes:M,onUpdate:n}},[t,H,U,p,k,M,n]);const $=j[p],ke=(t.questions||t.cards||[]).filter(Ee=>Ee.lastRating!==void 0&&Ee.lastRating<2).length,Ge=R.useCallback(()=>{if(U<1||t.isPublic)return;const Ee=k!==0?p+1:p,de=(t.questions||t.cards||[]).map(De=>{var $e;const nt=De.id||(($e=De.question)==null?void 0:$e.text),rt=H[nt];return rt!==void 0?{...De,lastRating:rt}:De}),fe={...t,questions:de,lastSessionIndex:Ee,partialReviewDate:new Date().toISOString(),showSectionNotes:M};n(fe)},[t,H,U,p,k,M,n]),Ye=R.useCallback(()=>{ge.current||(Ge(),ge.current=!0),r()},[Ge,r]);R.useEffect(()=>{v.length>0&&s&&s()},[v,s]),R.useEffect(()=>()=>{Y.current&&(Y.current.pause(),Y.current=null)},[]),R.useEffect(()=>{const Ee=()=>{const fe=Ae.current;if(fe.reviewedCountSession>=1&&!fe.lesson.isPublic&&!ge.current){const De=fe.rating!==0?fe.currentIndex+1:fe.currentIndex,nt=(fe.lesson.questions||fe.lesson.cards||[]).map($e=>{var K;const hn=$e.id||((K=$e.question)==null?void 0:K.text),Je=fe.firstRatings[hn];return Je!==void 0?{...$e,lastRating:Je}:$e}),rt={...fe.lesson,questions:nt,lastSessionIndex:De,partialReviewDate:new Date().toISOString(),showSectionNotes:fe.showSectionNotes};fe.onUpdate&&fe.onUpdate(rt),ge.current=!0}},de=fe=>{var De;Ee(),((De=storageService.hasPendingSyncs)!=null&&De.call(storageService)||Ae.current.reviewedCountSession>0&&!ge.current)&&(fe.preventDefault(),fe.returnValue="")};return window.addEventListener("beforeunload",de),()=>{window.removeEventListener("beforeunload",de),Ee()}},[]),R.useEffect(()=>{!l&&!h&&j.length>0&&P9()},[l,h,j.length]);const Xe=R.useCallback((Ee,de={})=>{const{resumeFromIndex:fe=0}=de,De=[...t.questions||t.cards||[]];De.sort(($e,hn)=>{const Je=$e.lastRating!==void 0?$e.lastRating:-2,K=hn.lastRating!==void 0?hn.lastRating:-2;return Je-K});let nt=[];Ee==="all"||Ee==="resume"?nt=De:Ee==="difficult"&&(nt=De.filter($e=>$e.lastRating!==void 0&&$e.lastRating<2));const rt=Ee==="resume"?Math.min(fe,nt.length-1):0;if(L(nt),se(nt.length),d(!1),f(!1),g(rt),w([]),E(null),b(Ee==="resume"?rt:0),he({}),P(null),G(0),ge.current=!1,Ee==="all"&&t.lastSessionIndex!==void 0){const $e={...t,lastSessionIndex:void 0};n($e)}},[t,n]),dt=Ee=>{const de=[1,3,7,30];return Ee>=de.length-1?30:de[Ee+1]},Ne=async()=>{const de=k===2;P(null);const fe=de?N+1:N;if(de&&b(fe),fe===re){const $e=j.slice(0,re).map(je=>{const zt=je.id||je.question.text;return H[zt]??0}).reduce((je,zt)=>je+zt,0),hn=re*2,Je=re>0?($e/re).toFixed(1):0,K=$e===hn,le=t.questions||t.cards||[],me=le.filter(je=>{const zt=je.id||je.question.text,Bt=H[zt];return Bt!==void 0&&Bt<2}),X=t.reviewStage||-1;let xe=new Date,ye=X;if(Je>=1.5){ye=X+1;const je=dt(ye);xe.setDate(xe.getDate()+je)}else ye=-1;if(E({avg:Je,totalMarks:$e,maxPossibleMarks:hn,fullMarks:K,lowRatedQuestions:me,nextReviewDate:xe.toLocaleDateString()}),j9(),K&&O9({particleCount:200,spread:160,origin:{y:.6},colors:["#FFD700","#FF4500","#00FF7F","#00BFFF","#FF1493"],zIndex:2001}),t.isPublic||re<le.length)return;const _t=le.map(je=>{const zt=je.id||je.question.text,Bt=H[zt];return Bt!==void 0?{...je,lastRating:Bt}:je}),Ke={...t,questions:_t,lastMarks:$e,questionCountAtLastReview:re,lastReviewed:new Date().toLocaleDateString(),nextReview:xe.toISOString(),reviewStage:ye};if(n(Ke),e!=null&&e.uid){const je=t.id==="demo-lesson",zt=!t.lessonId&&!t.storagePath;try{const Bt=await rr.checkReferralCompletion(e.uid,t.id||t.lessonId,je,zt);Bt.rewarded&&i&&i({type:"success",message:`Congratulations! Your referrer received ${Bt.bonus} coins for your first lesson completion! `})}catch(Bt){console.error("[ReferralCheck] Error:",Bt)}}}else _(!1),S(0),en(),setTimeout(()=>{g(p+1)},100)},qe=Ee=>{L(Ee),se(Ee.length),g(0),_(!1),S(0),w([]),E(null),b(0),he({}),P(null),en()},[Hn,Gn]=R.useState(0),Dn=(Ee,de=null)=>{const fe=Ee===2,De=Ee===1;fe?(L9(),Gn(Je=>Je+1)):De?(M9(),Gn(0)):(D9(),Gn(0)),S(Ee);const nt=$.id||$.question.text;H[nt]===void 0&&he(Je=>({...Je,[nt]:Ee})),fe||L(Je=>[...Je,$]);let rt="retry";fe?rt="success":De&&(rt="partial");const $e={type:rt,isFirstQuestion:p===0&&U===0,streakCount:fe?Hn+1:0},hn=de||$9($e);P({message:hn,type:fe?"success":"retry"}),G(Je=>Je+1),Ge()},Rr=async()=>{try{const Ee=await navigator.mediaDevices.getUserMedia({audio:!0}),de=new MediaRecorder(Ee);pe.current=de,_e.current=[],de.ondataavailable=fe=>{fe.data.size>0&&_e.current.push(fe.data)},de.onstop=()=>{const fe=new Blob(_e.current,{type:"audio/webm"}),De=URL.createObjectURL(fe);ie(De),Y.current=new Audio(De),Y.current.onended=()=>z(!1),Ee.getTracks().forEach(nt=>nt.stop())},de.start(),J(!0)}catch{i("Microphone access denied or not available.")}},Zt=()=>{pe.current&&q&&(pe.current.stop(),J(!1))},en=()=>{ee&&(Y.current&&(Y.current.pause(),Y.current=null),URL.revokeObjectURL(ee),ie(null),z(!1))},Pr=Ee=>{Ee&&Ee.stopPropagation(),Y.current&&(Z?(Y.current.pause(),z(!1)):(Y.current.play(),z(!0)))};return{showStartScreen:l,showModeSelection:h,currentIndex:p,currentQuestion:$,isFlipped:x,rating:k,sessionResult:V,viewingImage:T,feedback:A,masteredCount:N,totalOriginalQuestions:re,studyQuestions:j,showSectionNotes:M,hasInterruptedSession:a,lessonTitle:t.title||"Untitled Lesson",lastSessionIndex:t.lastSessionIndex,handleStartReview:Xe,handleNextSession:Ne,restartSession:qe,handleRating:Dn,setIsFlipped:_,setViewingImage:I,handleCloseWithSave:Ye,setShowSectionNotes:D,isRecording:q,recordedAudio:ee,isPlayingRecorded:Z,startRecording:Rr,stopRecording:Zt,deleteRecording:en,toggleRecordedPlayback:Pr,difficultQuestionsCount:ke}},q9=({lesson:t,user:e,onClose:n,onEdit:r,onUpdate:i,showAlert:s,userCoins:o,onDeductCoins:a,onReviewStart:l,displayName:d})=>{var z;const{showStartScreen:h,showModeSelection:f,currentIndex:p,currentQuestion:g,isFlipped:x,rating:_,sessionResult:k,viewingImage:S,feedback:v,masteredCount:w,totalOriginalQuestions:j,studyQuestions:L,difficultQuestionsCount:V,handleStartReview:E,handleNextSession:T,restartSession:I,handleRating:A,setIsFlipped:P,setViewingImage:N,isRecording:b,recordedAudio:H,isPlayingRecorded:he,startRecording:re,stopRecording:se,deleteRecording:U,toggleRecordedPlayback:G,handleCloseWithSave:M,showSectionNotes:D,setShowSectionNotes:q,hasInterruptedSession:J,lessonTitle:ee,lastSessionIndex:ie}=W9({lesson:t,user:e,onUpdate:i,onClose:n,showAlert:s,onReviewStart:l}),Z=(t.questions||t.cards||[]).length;return h?u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",background:"rgba(255,255,255,0.01)",zIndex:2e3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"max(1rem, 2vh)"},children:u.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsxs(Ue.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"neo-flat",style:{width:"100%",maxWidth:"420px",padding:"2rem",position:"relative"},children:[u.jsx(ti,{onClick:M,theme:"light"}),u.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[u.jsx("div",{style:{width:"5rem",height:"5rem",background:"linear-gradient(135deg, var(--accent-color), var(--primary-color))",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1.25rem",color:"white",boxShadow:"0 8px 20px rgba(var(--accent-rgb), 0.3)"},children:u.jsx(Eh,{size:36})}),u.jsx("h2",{style:{fontSize:"1.6rem",fontWeight:"bold",marginBottom:"0.5rem",background:"linear-gradient(135deg, var(--text-color), var(--accent-color))",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:ee}),u.jsxs("p",{style:{opacity:.6,fontSize:"0.95rem"},children:[Z," questions"]})]}),u.jsx("div",{style:{marginBottom:"1rem",padding:"1rem",background:"var(--bg-color)",borderRadius:"1rem",boxShadow:"inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light)"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[D?u.jsx(jC,{size:20,color:"var(--accent-color)"}):u.jsx(DC,{size:20,style:{opacity:.5}}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"600",fontSize:"0.95rem"},children:"Show Important Notes"}),u.jsx("div",{style:{fontSize:"0.8rem",opacity:.6},children:"Display short notes for quick review"})]})]}),u.jsx("button",{onClick:()=>q(!D),style:{width:"52px",height:"28px",borderRadius:"14px",border:"none",background:D?"var(--accent-color)":"var(--shadow-dark)",position:"relative",cursor:"pointer",transition:"background 0.3s ease",boxShadow:D?"0 0 12px rgba(var(--accent-rgb), 0.5)":"inset 2px 2px 4px var(--shadow-dark)"},children:u.jsx(Ue.div,{animate:{x:D?24:2},transition:{type:"spring",stiffness:500,damping:30},style:{width:"22px",height:"22px",borderRadius:"50%",background:"white",position:"absolute",top:"3px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"}})})]})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.875rem"},children:[t.lastReviewed&&V>0&&u.jsxs("button",{className:"neo-button",onClick:()=>E("all"),style:{padding:"1.1rem 1rem",display:"flex",alignItems:"center",gap:"1rem",border:"2px solid var(--border-color)",justifyContent:"flex-start"},children:[u.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",overflow:"hidden",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",background:"var(--accent-soft)"},children:u.jsx(tc,{size:22,color:"var(--accent-color)"})}),u.jsxs("div",{style:{textAlign:"left"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1.05rem"},children:"Start From Beginning"}),u.jsxs("div",{style:{fontSize:"0.8rem",opacity:.6},children:["Go through all ",Z," questions"]})]})]}),J&&!(t.lastReviewed&&V>0)&&u.jsxs("button",{className:"neo-button",onClick:()=>E("all"),style:{padding:"1.1rem 1rem",display:"flex",alignItems:"center",gap:"1rem",border:"2px solid var(--border-color)",justifyContent:"flex-start"},children:[u.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",overflow:"hidden",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",background:"var(--accent-soft)"},children:u.jsx(tc,{size:22,color:"var(--accent-color)"})}),u.jsxs("div",{style:{textAlign:"left"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1.05rem"},children:"Start From Beginning"}),u.jsxs("div",{style:{fontSize:"0.8rem",opacity:.6},children:["Go through all ",Z," questions"]})]})]}),t.lastReviewed&&V>0?u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:()=>E("difficult"),style:{padding:"1.1rem 1rem",display:"flex",alignItems:"center",gap:"1rem",border:"none",justifyContent:"flex-start",background:"var(--accent-color)",color:"white"},children:[u.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",overflow:"hidden",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255,255,255,0.2)"},children:u.jsx(RC,{size:22,color:"white"})}),u.jsxs("div",{style:{textAlign:"left"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1.05rem"},children:"Review Tough Cards Only"}),u.jsxs("div",{style:{fontSize:"0.8rem",opacity:.9},children:["Focus on ",V," challenging questions"]})]})]}):J?ie!==void 0&&u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:()=>E("resume",{resumeFromIndex:ie}),style:{padding:"1.1rem 1rem",display:"flex",alignItems:"center",gap:"1rem",justifyContent:"flex-start",background:"var(--accent-color)",color:"white",border:"none"},children:[u.jsx("div",{style:{padding:"0.6rem",background:"rgba(255,255,255,0.2)",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsx(Rf,{size:22,fill:"white"})}),u.jsxs("div",{style:{textAlign:"left"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1.05rem"},children:"Continue Where You Left"}),u.jsxs("div",{style:{fontSize:"0.8rem",opacity:.85},children:["Resume from question ",ie+1]})]})]}):u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:()=>E("all"),style:{padding:"1.1rem 1rem",display:"flex",alignItems:"center",gap:"1rem",border:"none",justifyContent:"flex-start",background:"var(--accent-color)",color:"white"},children:[u.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",overflow:"hidden",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255,255,255,0.2)"},children:u.jsx(tc,{size:22,color:"white"})}),u.jsxs("div",{style:{textAlign:"left"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1.05rem"},children:"Start Review"}),u.jsxs("div",{style:{fontSize:"0.8rem",opacity:.9},children:["Go through all ",Z," questions"]})]})]})]})]})})}):(!L||L.length===0)&&!k?u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",background:"rgba(255,255,255,0.01)",zIndex:2e3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"max(1rem, 2vh)"},children:u.jsxs(Ue.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"neo-flat",style:{width:"100%",maxWidth:"400px",padding:"2.5rem",display:"flex",flexDirection:"column",gap:"2rem",textAlign:"center"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",alignItems:"center"},children:[u.jsx("div",{className:"neo-inset",style:{padding:"20px",borderRadius:"50%",color:"#94a3b8"},children:u.jsx(Fg,{size:48})}),u.jsx("h2",{style:{fontSize:"1.5rem"},children:"No Questions Found"}),u.jsx("p",{style:{opacity:.6},children:"This lesson appears to be empty. Would you like to add some questions?"})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsxs("button",{className:"neo-button neo-glow-blue",style:{justifyContent:"center",padding:"1rem"},onClick:r,children:[u.jsx(cv,{size:18,style:{marginRight:"8px"}})," Add Questions Now"]}),u.jsx("button",{className:"neo-button",style:{justifyContent:"center",opacity:.6},onClick:n,children:"Close"})]})]},"empty-lesson")}):k?u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",background:"rgba(255,255,255,0.01)",zIndex:2e3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"max(1rem, 2vh)"},children:u.jsxs(Ue.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"neo-flat",style:{width:"100%",maxWidth:"420px",maxHeight:"90vh",overflowY:"auto",padding:"2rem",textAlign:"center",display:"flex",flexDirection:"column",gap:"1.5rem"},children:[u.jsx("h2",{style:{fontSize:"1.8rem"},children:"Study Summary"}),u.jsxs("div",{className:"neo-flat",style:{padding:"1.5rem",borderRadius:"24px"},children:[u.jsx("div",{style:{fontSize:"0.9rem",opacity:.6,marginBottom:"0.5rem",fontWeight:"bold"},children:"SESSION MARKS"}),u.jsxs("div",{style:{fontSize:"3rem",fontWeight:"bold",color:"var(--accent-color)",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[k.totalMarks," ",u.jsxs("span",{style:{fontSize:"1.5rem",opacity:.5},children:["/ ",k.maxPossibleMarks]})]}),k.nextReviewDate&&u.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.9rem",color:"var(--accent-color)",fontWeight:"600"},children:["Recommended next review: ",k.nextReviewDate]})]}),k.fullMarks?u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem",width:"100%"},children:[u.jsxs("div",{style:{position:"relative"},children:[u.jsx(Ue.div,{initial:{scale:0},animate:{scale:[0,1.2,1],rotate:[0,-10,10,0]},transition:{duration:.8,ease:"backOut"},children:u.jsx(Eh,{size:64,color:"var(--accent-color)"})}),[...Array(8)].map((Y,pe)=>u.jsx(Ue.div,{initial:{opacity:0,x:0,y:0,scale:0},animate:{opacity:[0,1,0],x:(Math.random()-.5)*100,y:(Math.random()-.5)*100-50,scale:[0,1,0]},transition:{duration:1.5,delay:.5+Math.random()*.5,repeat:1/0,repeatDelay:1},style:{position:"absolute",top:"50%",left:"50%",zIndex:0,pointerEvents:"none"},children:u.jsx(VC,{size:20,color:["#FFD700","#FF4500","#00FF7F"][Math.floor(Math.random()*3)]})},pe))]}),u.jsx(Ue.img,{src:I9,alt:"Congratulations",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:12,delay:.3},style:{maxWidth:"80%",height:"auto",borderRadius:"12px"}}),u.jsx("div",{className:"neo-inset",style:{padding:"1.5rem",color:"var(--accent-color)",borderRadius:"16px",width:"100%",textAlign:"center"},children:u.jsxs("p",{style:{fontWeight:"bold",fontSize:"1.2rem",lineHeight:"1.6"},children:["Congratulations. ",u.jsx("br",{}),"By royal decree, I name you Master of ",u.jsx("br",{}),u.jsx("span",{style:{color:"var(--accent-color)",fontSize:"1.4rem"},children:t.title})]})})]}):u.jsxs("div",{style:{padding:"1rem",background:"rgba(59, 130, 246, 0.1)",borderRadius:"16px",border:"1px solid #3b82f6"},children:[u.jsx("p",{style:{fontWeight:"bold",color:"#1d4ed8",marginBottom:"0.5rem",fontSize:"1.1rem"},children:"Don't give up!"}),u.jsxs("p",{style:{opacity:.8,fontSize:"0.95rem"},children:["Mastery takes patience. ",u.jsx("br",{}),"Why not try the tough questions again right now?"]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginTop:"0.5rem"},children:[!k.fullMarks&&u.jsxs("button",{className:"neo-button",style:{justifyContent:"center",background:"var(--accent-color)",color:"white",border:"none",padding:"1rem"},onClick:()=>I(k.lowRatedQuestions),children:["Focus on Weak Questions (",k.lowRatedQuestions.length,")"]}),u.jsx("button",{className:"neo-button",style:{justifyContent:"center",padding:"1rem",background:k.fullMarks?"var(--accent-color)":"transparent",color:k.fullMarks?"white":"inherit",border:k.fullMarks?"none":"1px solid var(--border-color)"},onClick:()=>I(t.questions||t.cards||[]),children:"Try All Questions Again"}),u.jsx("button",{className:"neo-button",style:{justifyContent:"center",padding:"1rem",opacity:.7},onClick:n,children:"Done for now"})]})]},"session-result")}):u.jsxs("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(1.2rem)",WebkitBackdropFilter:"blur(1.2rem)",background:"rgba(255,255,255,0.01)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center",padding:0,height:"100vh",overflow:"hidden"},children:[u.jsx(Cn,{mode:"wait",children:u.jsxs("div",{className:"review-container",style:{width:"100%",maxWidth:"35rem",height:"100%",display:"flex",flexDirection:"column",position:"relative",padding:"10px 1rem",background:"var(--bg-color)"},children:[u.jsx(C9,{currentIndex:p,totalQuestions:L.length,masteredCount:w,totalOriginalQuestions:j,rating:_,onClose:M,user:e,lesson:t}),u.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",margin:"10px 0",position:"relative",minHeight:0},children:u.jsx(Cn,{mode:"wait",children:u.jsx(Ue.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:u.jsx(R9,{currentQuestion:g,isFlipped:x,setIsFlipped:P,setViewingImage:N,showSectionNotes:D,onRateMCQ:Y=>{var pe;if(Y!=null&&Y.isCorrect)A(2);else{const _e=((pe=g.options.find(ge=>ge.isCorrect))==null?void 0:pe.text)||"Unknown";A(0,`Incorrect. The right answer is "${_e}". I shall ask this again.`)}},feedback:v})},g?g.id||((z=g.question)==null?void 0:z.text):"end")})}),u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",width:"100%",paddingBottom:"0"},children:u.jsx(Cn,{mode:"wait",children:v?u.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"neo-flat",style:{width:"100%",padding:"1rem",borderRadius:"1.5rem",background:"var(--bg-color)",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",border:"1px solid var(--border-color)",boxShadow:"var(--neo-box-shadow)"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",width:"100%"},children:[u.jsx("img",{src:uv,alt:"Guide",style:{width:"2rem",height:"2rem",borderRadius:"50%",flexShrink:0,border:"1.5px solid var(--accent-color)"}}),u.jsx("h3",{style:{fontSize:"0.9rem",color:v.type==="success"?"#16a34a":"#dc2626",margin:0,flex:1,fontWeight:"800"},children:v.message})]}),u.jsx("button",{className:"neo-button neo-glow-blue",onClick:T,style:{width:"100%",justifyContent:"center",padding:"1rem",fontSize:"1.1rem",background:v.type==="success"?"#16a34a":"var(--accent-color)",color:"white",fontWeight:"bold",borderRadius:"1rem",minHeight:"3.5rem"},children:"Next Question"})]},"feedback-actions"):u.jsx(V9,{isFlipped:x,currentQuestion:g,isRecording:b,recordedAudio:H,isPlayingRecorded:he,startRecording:re,stopRecording:se,deleteRecording:U,toggleRecordedPlayback:G,setIsFlipped:P,handleRating:(Y,pe)=>A(Y,pe),feedback:v})})})]})}),u.jsx(Cn,{children:S&&u.jsx(qC,{imageUrl:S,onClose:()=>N(null)})})]})},H9=({user:t,onClose:e,showAlert:n})=>{const[r,i]=R.useState(""),[s,o]=R.useState(!1),a=async()=>{if(!r.trim())return n("Please provide some feedback text.");o(!0);try{const l=g9(r),d=y9(t.email)?t.email:"Unknown";let f=`*New Feedback for Chethan in Cardland*

*From:* ${t.name||"Anonymous"} (${d})

*Feedback:* ${l}`;const p=`https://wa.me/919497449115?text=${encodeURIComponent(f)}`;window.open(p,"_blank"),n("Thank you! Redirecting to WhatsApp to send your feedback."),e()}catch{n("Failed to open WhatsApp. Please try again.")}finally{o(!1)}};return u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)",background:"rgba(255,255,255,0.01)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:u.jsxs("div",{className:"modal-content neo-flat",style:{width:"100%",maxWidth:"500px",maxHeight:"90vh",overflowY:"auto",padding:"2rem",display:"flex",flexDirection:"column",gap:"1.5rem",position:"relative"},children:[u.jsx(ti,{onClick:e,style:{position:"absolute",top:"1.5rem",right:"1.5rem"},size:18}),u.jsx("h2",{style:{fontSize:"1.5rem"},children:"Help & Feedback"}),u.jsx("p",{style:{opacity:.7,fontSize:"0.9rem"},children:"Help us improve Chethan in Cardland! Your feedback will be sent via WhatsApp."}),u.jsxs("div",{className:"neo-inset",style:{padding:"1rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsx("label",{style:{fontWeight:"600",opacity:.7,fontSize:"0.9rem"},children:"Feedback"}),u.jsxs("div",{style:{position:"relative"},children:[u.jsx("textarea",{className:"neo-input",rows:"6",placeholder:"What's on your mind? ",style:{width:"100%",resize:"none",paddingRight:"30px"},value:r,onChange:l=>i(l.target.value)}),u.jsx("span",{style:{position:"absolute",right:"12px",top:"12px",color:"red",pointerEvents:"none",visibility:r?"hidden":"visible"},children:"*"})]})]}),u.jsx("button",{className:"neo-button neo-glow-blue",style:{justifyContent:"center",background:"var(--accent-color)",color:"white",border:"none",padding:"1rem",opacity:s?.7:1,cursor:s?"not-allowed":"pointer",gap:"10px"},onClick:a,disabled:s,children:s?"Redirecting...":u.jsxs(u.Fragment,{children:[u.jsx(Z8,{size:18})," Send via WhatsApp"]})})]})})},G9=({isOpen:t,onClose:e,onLogin:n})=>{const r=[{icon:u.jsx("img",{src:uv,alt:"Chethan",style:{width:"32px",height:"32px",objectFit:"contain"}}),title:"Built for how you learn",text:"Science-based learning, designed to keep you focused and motivated."},{icon:u.jsx(o9,{size:28}),title:"Learns how you remember",text:"A smart algorithm understands your memory, tracks progress, and adapts automatically."},{icon:u.jsx(n9,{size:28}),title:"Learns. Adapts. Guides.",text:"The app creates a personalised learning path that adapts to your memory and progress."},{icon:u.jsx(Y8,{size:28}),title:"Create lessons your way",content:u.jsxs("div",{children:[u.jsx("p",{style:{margin:"0 0 1rem 0",lineHeight:"1.5",fontSize:"0.95rem",opacity:.8},children:"Make lessons using one or more options:"}),u.jsxs("div",{style:{display:"flex",gap:"2.5rem",justifyContent:"flex-start",marginBottom:"0.5rem",marginTop:"1rem"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[u.jsx("div",{className:"neo-inset",style:{width:"50px",height:"50px",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)"},children:u.jsx($8,{size:22})}),u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"500",opacity:.8},children:"Typing"})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[u.jsx("div",{className:"neo-inset",style:{width:"50px",height:"50px",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)"},children:u.jsx(bh,{size:22})}),u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"500",opacity:.8},children:"Voice"})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[u.jsx("div",{className:"neo-inset",style:{width:"50px",height:"50px",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)"},children:u.jsx(M8,{size:22})}),u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"500",opacity:.8},children:"Photo"})]})]})]})},{icon:u.jsx(Eh,{size:28}),title:"Expert Lesson Content",text:"Study curated lessons built from real previous question papers and exam patterns."}];return u.jsx(Cn,{children:t&&u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",background:"rgba(255,255,255,0.01)",zIndex:4e3,display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsxs(Ue.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"neo-flat",style:{width:"95vw",maxWidth:"600px",maxHeight:"90vh",display:"flex",flexDirection:"column",position:"relative",padding:0,overflow:"hidden",borderRadius:"32px"},children:[u.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid rgba(0,0,0,0.05)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsx("h2",{style:{margin:0,fontSize:"1.5rem",fontWeight:"800",color:"var(--accent-color)"},children:"How it Works"}),u.jsx(ti,{onClick:e})]}),u.jsx("div",{style:{padding:"2rem 1.5rem",overflowY:"auto",flex:1,display:"flex",flexDirection:"column",gap:"2rem"},children:r.map((i,s)=>u.jsxs("div",{style:{display:"flex",gap:"1.5rem",alignItems:"flex-start"},children:[u.jsx("div",{className:"neo-flat",style:{padding:"0.8rem",borderRadius:"16px",color:"var(--accent-color)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:i.icon}),u.jsxs("div",{style:{flex:1},children:[i.title&&u.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1.1rem",fontWeight:"700",color:"var(--text-color)"},children:i.title}),i.text&&u.jsx("p",{style:{margin:0,lineHeight:"1.5",fontSize:"0.95rem",opacity:.8},children:i.text}),i.content]})]},s))}),u.jsx("div",{style:{padding:"1.5rem",textAlign:"center",borderTop:"1px solid rgba(0,0,0,0.05)"},children:u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:n,style:{width:"100%",justifyContent:"center",padding:"1rem",gap:"12px",background:"var(--accent-color)",color:"white"},children:[u.jsx(q8,{size:20}),u.jsx("span",{style:{fontWeight:"600"},children:"Get Started with Google"})]})})]})})})};var Pf={},HC={exports:{}},K9="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Q9=K9,Y9=Q9;function GC(){}function KC(){}KC.resetWarningCache=GC;var X9=function(){function t(r,i,s,o,a,l){if(l!==Y9){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:KC,resetWarningCache:GC};return n.PropTypes=n,n};HC.exports=X9();var QC=HC.exports,YC={L:1,M:0,Q:3,H:2},XC={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},J9=XC;function JC(t){this.mode=J9.MODE_8BIT_BYTE,this.data=t}JC.prototype={getLength:function(t){return this.data.length},write:function(t){for(var e=0;e<this.data.length;e++)t.put(this.data.charCodeAt(e),8)}};var Z9=JC,Qu=YC;function zr(t,e){this.totalCount=t,this.dataCount=e}zr.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];zr.getRSBlocks=function(t,e){var n=zr.getRsBlockTable(t,e);if(n==null)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var r=n.length/3,i=new Array,s=0;s<r;s++)for(var o=n[s*3+0],a=n[s*3+1],l=n[s*3+2],d=0;d<o;d++)i.push(new zr(a,l));return i};zr.getRsBlockTable=function(t,e){switch(e){case Qu.L:return zr.RS_BLOCK_TABLE[(t-1)*4+0];case Qu.M:return zr.RS_BLOCK_TABLE[(t-1)*4+1];case Qu.Q:return zr.RS_BLOCK_TABLE[(t-1)*4+2];case Qu.H:return zr.RS_BLOCK_TABLE[(t-1)*4+3];default:return}};var eU=zr;function ZC(){this.buffer=new Array,this.length=0}ZC.prototype={get:function(t){var e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)==1},put:function(t,e){for(var n=0;n<e;n++)this.putBit((t>>>e-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var tU=ZC,wr={glog:function(t){if(t<1)throw new Error("glog("+t+")");return wr.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return wr.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var Gt=0;Gt<8;Gt++)wr.EXP_TABLE[Gt]=1<<Gt;for(var Gt=8;Gt<256;Gt++)wr.EXP_TABLE[Gt]=wr.EXP_TABLE[Gt-4]^wr.EXP_TABLE[Gt-5]^wr.EXP_TABLE[Gt-6]^wr.EXP_TABLE[Gt-8];for(var Gt=0;Gt<255;Gt++)wr.LOG_TABLE[wr.EXP_TABLE[Gt]]=Gt;var ek=wr,Bs=ek;function Sd(t,e){if(t.length==null)throw new Error(t.length+"/"+e);for(var n=0;n<t.length&&t[n]==0;)n++;this.num=new Array(t.length-n+e);for(var r=0;r<t.length-n;r++)this.num[r]=t[r+n]}Sd.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var r=0;r<t.getLength();r++)e[n+r]^=Bs.gexp(Bs.glog(this.get(n))+Bs.glog(t.get(r)));return new Sd(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=Bs.glog(this.get(0))-Bs.glog(t.get(0)),n=new Array(this.getLength()),r=0;r<this.getLength();r++)n[r]=this.get(r);for(var r=0;r<t.getLength();r++)n[r]^=Bs.gexp(Bs.glog(t.get(r))+e);return new Sd(n,0).mod(t)}};var tk=Sd,Qn=XC,rT=tk,nU=ek,Ui={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},Wt={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;Wt.getBCHDigit(e)-Wt.getBCHDigit(Wt.G15)>=0;)e^=Wt.G15<<Wt.getBCHDigit(e)-Wt.getBCHDigit(Wt.G15);return(t<<10|e)^Wt.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;Wt.getBCHDigit(e)-Wt.getBCHDigit(Wt.G18)>=0;)e^=Wt.G18<<Wt.getBCHDigit(e)-Wt.getBCHDigit(Wt.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;t!=0;)e++,t>>>=1;return e},getPatternPosition:function(t){return Wt.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case Ui.PATTERN000:return(e+n)%2==0;case Ui.PATTERN001:return e%2==0;case Ui.PATTERN010:return n%3==0;case Ui.PATTERN011:return(e+n)%3==0;case Ui.PATTERN100:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case Ui.PATTERN101:return e*n%2+e*n%3==0;case Ui.PATTERN110:return(e*n%2+e*n%3)%2==0;case Ui.PATTERN111:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new rT([1],0),n=0;n<t;n++)e=e.multiply(new rT([1,nU.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case Qn.MODE_NUMBER:return 10;case Qn.MODE_ALPHA_NUM:return 9;case Qn.MODE_8BIT_BYTE:return 8;case Qn.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case Qn.MODE_NUMBER:return 12;case Qn.MODE_ALPHA_NUM:return 11;case Qn.MODE_8BIT_BYTE:return 16;case Qn.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else if(e<41)switch(t){case Qn.MODE_NUMBER:return 14;case Qn.MODE_ALPHA_NUM:return 13;case Qn.MODE_8BIT_BYTE:return 16;case Qn.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}else throw new Error("type:"+e)},getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,r=0;r<e;r++)for(var i=0;i<e;i++){for(var s=0,o=t.isDark(r,i),a=-1;a<=1;a++)if(!(r+a<0||e<=r+a))for(var l=-1;l<=1;l++)i+l<0||e<=i+l||a==0&&l==0||o==t.isDark(r+a,i+l)&&s++;s>5&&(n+=3+s-5)}for(var r=0;r<e-1;r++)for(var i=0;i<e-1;i++){var d=0;t.isDark(r,i)&&d++,t.isDark(r+1,i)&&d++,t.isDark(r,i+1)&&d++,t.isDark(r+1,i+1)&&d++,(d==0||d==4)&&(n+=3)}for(var r=0;r<e;r++)for(var i=0;i<e-6;i++)t.isDark(r,i)&&!t.isDark(r,i+1)&&t.isDark(r,i+2)&&t.isDark(r,i+3)&&t.isDark(r,i+4)&&!t.isDark(r,i+5)&&t.isDark(r,i+6)&&(n+=40);for(var i=0;i<e;i++)for(var r=0;r<e-6;r++)t.isDark(r,i)&&!t.isDark(r+1,i)&&t.isDark(r+2,i)&&t.isDark(r+3,i)&&t.isDark(r+4,i)&&!t.isDark(r+5,i)&&t.isDark(r+6,i)&&(n+=40);for(var h=0,i=0;i<e;i++)for(var r=0;r<e;r++)t.isDark(r,i)&&h++;var f=Math.abs(100*h/e/e-50)/5;return n+=f*10,n}},rU=Wt,iU=Z9,nk=eU,rk=tU,Ms=rU,sU=tk;function $r(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var qn=$r.prototype;qn.addData=function(t){var e=new iU(t);this.dataList.push(e),this.dataCache=null};qn.isDark=function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]};qn.getModuleCount=function(){return this.moduleCount};qn.make=function(){if(this.typeNumber<1){var t=1;for(t=1;t<40;t++){for(var e=nk.getRSBlocks(t,this.errorCorrectLevel),n=new rk,r=0,i=0;i<e.length;i++)r+=e[i].dataCount;for(var i=0;i<this.dataList.length;i++){var s=this.dataList[i];n.put(s.mode,4),n.put(s.getLength(),Ms.getLengthInBits(s.mode,t)),s.write(n)}if(n.getLengthInBits()<=r*8)break}this.typeNumber=t}this.makeImpl(!1,this.getBestMaskPattern())};qn.makeImpl=function(t,e){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++)this.modules[n][r]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),this.typeNumber>=7&&this.setupTypeNumber(t),this.dataCache==null&&(this.dataCache=$r.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)};qn.setupPositionProbePattern=function(t,e){for(var n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(var r=-1;r<=7;r++)e+r<=-1||this.moduleCount<=e+r||(0<=n&&n<=6&&(r==0||r==6)||0<=r&&r<=6&&(n==0||n==6)||2<=n&&n<=4&&2<=r&&r<=4?this.modules[t+n][e+r]=!0:this.modules[t+n][e+r]=!1)};qn.getBestMaskPattern=function(){for(var t=0,e=0,n=0;n<8;n++){this.makeImpl(!0,n);var r=Ms.getLostPoint(this);(n==0||t>r)&&(t=r,e=n)}return e};qn.createMovieClip=function(t,e,n){var r=t.createEmptyMovieClip(e,n),i=1;this.make();for(var s=0;s<this.modules.length;s++)for(var o=s*i,a=0;a<this.modules[s].length;a++){var l=a*i,d=this.modules[s][a];d&&(r.beginFill(0,100),r.moveTo(l,o),r.lineTo(l+i,o),r.lineTo(l+i,o+i),r.lineTo(l,o+i),r.endFill())}return r};qn.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)this.modules[t][6]==null&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)this.modules[6][e]==null&&(this.modules[6][e]=e%2==0)};qn.setupPositionAdjustPattern=function(){for(var t=Ms.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var r=t[e],i=t[n];if(this.modules[r][i]==null)for(var s=-2;s<=2;s++)for(var o=-2;o<=2;o++)s==-2||s==2||o==-2||o==2||s==0&&o==0?this.modules[r+s][i+o]=!0:this.modules[r+s][i+o]=!1}};qn.setupTypeNumber=function(t){for(var e=Ms.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var r=!t&&(e>>n&1)==1;this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=r}for(var n=0;n<18;n++){var r=!t&&(e>>n&1)==1;this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=r}};qn.setupTypeInfo=function(t,e){for(var n=this.errorCorrectLevel<<3|e,r=Ms.getBCHTypeInfo(n),i=0;i<15;i++){var s=!t&&(r>>i&1)==1;i<6?this.modules[i][8]=s:i<8?this.modules[i+1][8]=s:this.modules[this.moduleCount-15+i][8]=s}for(var i=0;i<15;i++){var s=!t&&(r>>i&1)==1;i<8?this.modules[8][this.moduleCount-i-1]=s:i<9?this.modules[8][15-i-1+1]=s:this.modules[8][15-i-1]=s}this.modules[this.moduleCount-8][8]=!t};qn.mapData=function(t,e){for(var n=-1,r=this.moduleCount-1,i=7,s=0,o=this.moduleCount-1;o>0;o-=2)for(o==6&&o--;;){for(var a=0;a<2;a++)if(this.modules[r][o-a]==null){var l=!1;s<t.length&&(l=(t[s]>>>i&1)==1);var d=Ms.getMask(e,r,o-a);d&&(l=!l),this.modules[r][o-a]=l,i--,i==-1&&(s++,i=7)}if(r+=n,r<0||this.moduleCount<=r){r-=n,n=-n;break}}};$r.PAD0=236;$r.PAD1=17;$r.createData=function(t,e,n){for(var r=nk.getRSBlocks(t,e),i=new rk,s=0;s<n.length;s++){var o=n[s];i.put(o.mode,4),i.put(o.getLength(),Ms.getLengthInBits(o.mode,t)),o.write(i)}for(var a=0,s=0;s<r.length;s++)a+=r[s].dataCount;if(i.getLengthInBits()>a*8)throw new Error("code length overflow. ("+i.getLengthInBits()+">"+a*8+")");for(i.getLengthInBits()+4<=a*8&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(!1);for(;!(i.getLengthInBits()>=a*8||(i.put($r.PAD0,8),i.getLengthInBits()>=a*8));)i.put($r.PAD1,8);return $r.createBytes(i,r)};$r.createBytes=function(t,e){for(var n=0,r=0,i=0,s=new Array(e.length),o=new Array(e.length),a=0;a<e.length;a++){var l=e[a].dataCount,d=e[a].totalCount-l;r=Math.max(r,l),i=Math.max(i,d),s[a]=new Array(l);for(var h=0;h<s[a].length;h++)s[a][h]=255&t.buffer[h+n];n+=l;var f=Ms.getErrorCorrectPolynomial(d),p=new sU(s[a],f.getLength()-1),g=p.mod(f);o[a]=new Array(f.getLength()-1);for(var h=0;h<o[a].length;h++){var x=h+g.getLength()-o[a].length;o[a][h]=x>=0?g.get(x):0}}for(var _=0,h=0;h<e.length;h++)_+=e[h].totalCount;for(var k=new Array(_),S=0,h=0;h<r;h++)for(var a=0;a<e.length;a++)h<s[a].length&&(k[S++]=s[a][h]);for(var h=0;h<i;h++)for(var a=0;a<e.length;a++)h<o[a].length&&(k[S++]=o[a][h]);return k};var oU=$r,hv={};Object.defineProperty(hv,"__esModule",{value:!0});var aU=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lU=QC,Yn=sk(lU),ik=R,Yu=sk(ik);function sk(t){return t&&t.__esModule?t:{default:t}}function cU(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}var uU={bgColor:Yn.default.oneOfType([Yn.default.object,Yn.default.string]).isRequired,bgD:Yn.default.string.isRequired,fgColor:Yn.default.oneOfType([Yn.default.object,Yn.default.string]).isRequired,fgD:Yn.default.string.isRequired,size:Yn.default.number.isRequired,title:Yn.default.string,viewBoxSize:Yn.default.number.isRequired,xmlns:Yn.default.string},fv=(0,ik.forwardRef)(function(t,e){var n=t.bgColor,r=t.bgD,i=t.fgD,s=t.fgColor,o=t.size,a=t.title,l=t.viewBoxSize,d=t.xmlns,h=d===void 0?"http://www.w3.org/2000/svg":d,f=cU(t,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return Yu.default.createElement("svg",aU({},f,{height:o,ref:e,viewBox:"0 0 "+l+" "+l,width:o,xmlns:h}),a?Yu.default.createElement("title",null,a):null,Yu.default.createElement("path",{d:r,fill:n}),Yu.default.createElement("path",{d:i,fill:s}))});fv.displayName="QRCodeSvg";fv.propTypes=uU;hv.default=fv;Object.defineProperty(Pf,"__esModule",{value:!0});Pf.QRCode=void 0;var dU=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hU=QC,ni=lu(hU),fU=YC,pU=lu(fU),mU=oU,gU=lu(mU),ok=R,yU=lu(ok),vU=hv,xU=lu(vU);function lu(t){return t&&t.__esModule?t:{default:t}}function wU(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}var _U={bgColor:ni.default.oneOfType([ni.default.object,ni.default.string]),fgColor:ni.default.oneOfType([ni.default.object,ni.default.string]),level:ni.default.string,size:ni.default.number,value:ni.default.string.isRequired},Nf=(0,ok.forwardRef)(function(t,e){var n=t.bgColor,r=n===void 0?"#FFFFFF":n,i=t.fgColor,s=i===void 0?"#000000":i,o=t.level,a=o===void 0?"L":o,l=t.size,d=l===void 0?256:l,h=t.value,f=wU(t,["bgColor","fgColor","level","size","value"]),p=new gU.default(-1,pU.default[a]);p.addData(h),p.make();var g=p.modules;return yU.default.createElement(xU.default,dU({},f,{bgColor:r,bgD:g.map(function(x,_){return x.map(function(k,S){return k?"":"M "+S+" "+_+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:s,fgD:g.map(function(x,_){return x.map(function(k,S){return k?"M "+S+" "+_+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:e,size:d,viewBoxSize:g.length}))});Pf.QRCode=Nf;Nf.displayName="QRCode";Nf.propTypes=_U;var TU=Pf.default=Nf;const SU=({user:t,onClose:e,userCoins:n,onShare:r,onShowFeedback:i})=>{const[s,o]=R.useState(null),a=d=>{const h=(t==null?void 0:t.email)||"UserPayment";return`upi://pay?pa=${I8}&pn=${k8}&am=${d}&cu=INR&tn=${encodeURIComponent(h)}`},l=d=>{const h=a(d);window.innerWidth>768?o({amount:d,link:h}):window.location.href=h};return u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)",background:"rgba(0,0,0,0.4)",zIndex:3e3,display:"flex",alignItems:"center",justifyContent:"center"},onClick:e,children:u.jsxs(Ue.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"neo-flat",onClick:d=>d.stopPropagation(),style:{width:"90%",maxWidth:"420px",padding:"0",borderRadius:"24px",overflow:"hidden",display:"flex",flexDirection:"column",maxHeight:"90vh",margin:"20px 0",background:"var(--bg-color)",position:"relative"},children:[u.jsx(Cn,{children:s&&u.jsxs(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"var(--bg-color)",zIndex:10,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"2rem"},children:[u.jsx("button",{onClick:()=>o(null),className:"neo-button icon-btn",style:{position:"absolute",top:"15px",right:"15px"},children:u.jsx(Qt,{size:24})}),u.jsxs("h3",{style:{margin:"0 0 1.5rem 0",color:"var(--text-primary)"},children:["Scan to Pay ",s.amount]}),u.jsx("div",{style:{background:"white",padding:"16px",borderRadius:"16px"},children:u.jsx(TU,{value:s.link,size:200})}),u.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",opacity:.7,fontSize:"0.9rem"},children:"Scan this QR code using GPay, PhonePe, or Paytm on your mobile."})]})}),u.jsxs("div",{style:{padding:"1.25rem 1.5rem",background:"var(--bg-color)",borderBottom:"1px solid rgba(0,0,0,0.05)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("div",{children:[u.jsx("h2",{style:{fontSize:"1.4rem",margin:0,fontWeight:"700",color:"var(--text-color)"},children:"Coin Store"}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"4px"},children:[u.jsx("span",{style:{fontSize:"0.9rem",opacity:.7},children:"Balance:"}),u.jsxs("span",{style:{fontSize:"1.1rem",fontWeight:"800",background:"rgba(99, 102, 241, 0.1)",padding:"2px 8px",borderRadius:"8px",color:"var(--accent-color)"},children:[n," "]})]})]}),u.jsxs("div",{style:{display:"flex",gap:"12px"},children:[i&&u.jsxs("button",{className:"neo-button",onClick:i,style:{padding:"0 16px",height:"36px",display:"flex",alignItems:"center",gap:"8px",fontSize:"0.9rem",fontWeight:"600",borderRadius:"12px",color:"var(--accent-color)",border:"none",cursor:"pointer"},title:"Help & Feedback",children:[u.jsx(rs,{size:18}),u.jsx("span",{children:"Help"})]}),u.jsx(ti,{onClick:e})]})]}),u.jsxs("div",{style:{padding:"1.5rem",display:"flex",flexDirection:"column",gap:"1.5rem",overflowY:"auto",flex:1},children:[u.jsxs("div",{children:[u.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"0.8rem"},children:u.jsx("h4",{style:{margin:0,fontSize:"0.9rem",fontWeight:"700",textTransform:"uppercase",letterSpacing:"1px",opacity:.6},children:"Ways to Earn"})}),u.jsxs("div",{className:"neo-flat",style:{padding:"1.5rem",borderRadius:"20px",border:"none",background:"linear-gradient(135deg, rgba(59,130,246,0.08) 0%, rgba(255,255,255,0.05) 100%)",position:"relative",overflow:"hidden",boxShadow:"0 0 15px rgba(59, 130, 246, 0.5), 0 10px 25px -5px rgba(59, 130, 246, 0.15)"},children:[u.jsx("div",{style:{position:"absolute",top:0,right:0,background:"#3b82f6",color:"white",padding:"4px 12px",borderRadius:"0 0 0 16px",fontWeight:"700",fontSize:"0.75rem",letterSpacing:"0.5px"},children:"LAUNCH OFFER"}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.2rem",marginTop:"0.5rem"},children:[u.jsxs("div",{children:[u.jsx("h3",{style:{fontSize:"1.4rem",margin:"0 0 4px 0",color:"#1d4ed8",fontWeight:"800"},children:"Invite a Friend"}),u.jsx("p",{style:{margin:0,opacity:.8,fontSize:"0.9rem"},children:"Grow our community"})]}),u.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"800",color:"#f59e0b",textShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"+50"})]}),u.jsxs("button",{className:"neo-button",onClick:r,style:{width:"100%",justifyContent:"center",padding:"1rem",background:"#3b82f6",color:"white",border:"none",fontSize:"1rem",fontWeight:"700",borderRadius:"14px",gap:"8px",boxShadow:"0 4px 6px -1px rgba(59, 130, 246, 0.4)"},children:[u.jsx(e9,{size:18})," Invite Now"]})]}),u.jsxs("div",{className:"neo-flat",style:{marginTop:"1rem",padding:"1rem",borderRadius:"16px",border:"none",display:"flex",alignItems:"center",justifyContent:"space-between",background:"rgba(16, 185, 129, 0.05)",boxShadow:"0 0 10px rgba(16, 185, 129, 0.2)"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[u.jsx("div",{style:{background:"#10b981",color:"white",padding:"10px",borderRadius:"12px",boxShadow:"0 2px 5px rgba(16, 185, 129, 0.3)"},children:u.jsx(Eo,{size:20,strokeWidth:3})}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"700",color:"var(--text-primary)",fontSize:"1rem"},children:"Daily Login"}),u.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:"Streak bonus active"})]})]}),u.jsx("div",{style:{fontWeight:"800",color:"#10b981",fontSize:"1.2rem"},children:"+5"})]}),u.jsxs("div",{className:"neo-flat",style:{marginTop:"1rem",padding:"1rem",borderRadius:"16px",border:"none",display:"flex",alignItems:"center",justifyContent:"space-between",background:"rgba(236, 72, 153, 0.05)",boxShadow:"0 0 10px rgba(236, 72, 153, 0.2)",cursor:"pointer"},onClick:i,children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[u.jsx("div",{style:{background:"#ec4899",color:"white",padding:"10px",borderRadius:"12px",boxShadow:"0 2px 5px rgba(236, 72, 153, 0.3)"},children:u.jsx(rs,{size:20,strokeWidth:2})}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"700",color:"var(--text-primary)",fontSize:"1rem"},children:"Find Mistakes"}),u.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:"Report errors to get free coins"})]})]}),u.jsx("div",{style:{fontWeight:"800",color:"#ec4899",fontSize:"0.9rem"},children:"Bonus"})]})]}),u.jsx("div",{style:{width:"100%",height:"1px",background:"var(--border-color)",opacity:.3}}),u.jsxs("div",{children:[u.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"0.8rem"},children:u.jsx("h4",{style:{margin:0,fontSize:"0.9rem",fontWeight:"700",textTransform:"uppercase",letterSpacing:"1px",opacity:.6},children:"Store"})}),u.jsxs("div",{className:"neo-flat",style:{padding:"1.2rem",borderRadius:"18px",border:"none",background:"linear-gradient(135deg, rgba(59,130,246,0.08) 0%, rgba(255,255,255,0) 100%)",marginBottom:"1rem",position:"relative",cursor:"pointer",boxShadow:"0 0 15px rgba(59, 130, 246, 0.3)"},onClick:()=>l(79),children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("div",{children:[u.jsx("h3",{style:{fontSize:"1.2rem",margin:"0 0 4px 0",color:"#1d4ed8",fontWeight:"700"},children:"50 Coins"}),u.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.85rem"},children:"Basic Pack"})]}),u.jsx("div",{style:{textAlign:"right"},children:u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"800",color:"#3b82f6"},children:"79"})})]}),u.jsxs("div",{style:{marginTop:"1rem",paddingTop:"0.8rem",borderTop:"1px dashed rgba(59,130,246,0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",color:"#1d4ed8",fontWeight:"600",fontSize:"0.9rem"},children:[u.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/f/f2/Google_Pay_Logo.svg",alt:"GPay",style:{height:"16px"}}),u.jsx("span",{children:"Tap to Pay"})]})]}),u.jsxs("div",{className:"neo-flat",style:{padding:"1.2rem",borderRadius:"18px",border:"none",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.08) 0%, rgba(255,255,255,0) 100%)",marginBottom:"1rem",position:"relative",cursor:"pointer",boxShadow:"0 0 15px rgba(16, 185, 129, 0.3)"},onClick:()=>l(299),children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("div",{children:[u.jsx("h3",{style:{fontSize:"1.2rem",margin:"0 0 4px 0",color:"#059669",fontWeight:"700"},children:"200 Coins"}),u.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.85rem"},children:"Popular Choice"})]}),u.jsx("div",{style:{textAlign:"right"},children:u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"800",color:"#10b981"},children:"299"})})]}),u.jsxs("div",{style:{marginTop:"1rem",paddingTop:"0.8rem",borderTop:"1px dashed rgba(16, 185, 129, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",color:"#059669",fontWeight:"600",fontSize:"0.9rem"},children:[u.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/f/f2/Google_Pay_Logo.svg",alt:"GPay",style:{height:"16px"}}),u.jsx("span",{children:"Tap to Pay"})]})]}),u.jsxs("div",{className:"neo-flat",style:{padding:"1.2rem",borderRadius:"18px",border:"none",background:"linear-gradient(135deg, rgba(245,158,11,0.08) 0%, rgba(255,255,255,0) 100%)",position:"relative",cursor:"pointer",boxShadow:"0 0 15px rgba(245, 158, 11, 0.5)"},onClick:()=>l(479),children:[u.jsx("div",{style:{position:"absolute",top:-10,left:20,background:"#f59e0b",color:"white",padding:"4px 10px",borderRadius:"8px",fontSize:"0.7rem",fontWeight:"700"},children:"BEST VALUE"}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("div",{children:[u.jsx("h3",{style:{fontSize:"1.2rem",margin:"0 0 4px 0",color:"#b45309",fontWeight:"700"},children:"500 Coins"}),u.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.85rem"},children:"Master Study Pack"})]}),u.jsx("div",{style:{textAlign:"right"},children:u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"800",color:"#f59e0b"},children:"479"})})]}),u.jsxs("div",{style:{marginTop:"1rem",paddingTop:"0.8rem",borderTop:"1px dashed rgba(245,158,11,0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",color:"#b45309",fontWeight:"600",fontSize:"0.9rem"},children:[u.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/f/f2/Google_Pay_Logo.svg",alt:"GPay",style:{height:"16px"}}),u.jsx("span",{children:"Tap to Pay"})]})]})]}),u.jsxs("div",{style:{background:"rgba(0,0,0,0.03)",padding:"1rem",borderRadius:"12px",fontSize:"0.85rem",opacity:.8,marginTop:"0.5rem"},children:[u.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"600"},children:"Alternative Payment Method:"}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[u.jsx("span",{children:"GPay to:"}),u.jsx("span",{style:{fontFamily:"monospace",fontWeight:"bold",fontSize:"1rem"},children:C8.replace("91","")})]}),u.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.8},children:"After payment, send the screenshot to the same number on WhatsApp to receive your coins."})]})]})]})})},EU=({user:t,userProfile:e,onClose:n,onUpdateProfile:r,showAlert:i,onShowFeedback:s})=>{const[o,a]=R.useState(""),[l,d]=R.useState(!1),h=`${window.location.origin}/?ref=${(e==null?void 0:e.referralCode)||""}`,f=`Study smarter.
Remember longer.

${t.name} invites you to join Cardland to start easy, efficient and personalised learning journey.

${h}`,p=()=>{navigator.clipboard.writeText(e.referralCode),i("Referral code copied!")},g=()=>{const _=`https://wa.me/?text=${encodeURIComponent(f)}`;window.open(_,"_blank")},x=async()=>{if(o.trim()){if(o.trim()===e.referralCode){i("You can't refer yourself!");return}d(!0);try{const _=await rr.applyReferral(t.uid,o.trim());i(_.message||"Referral code applied successfully!"),n(),window.location.reload()}catch(_){const k=_.message||"Failed to apply referral code.";i(k)}finally{d(!1)}}};return u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(8px)",background:"rgba(0,0,0,0.5)",zIndex:3e3,display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsxs(Ue.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"neo-flat",style:{padding:"2rem",maxWidth:"400px",width:"90%",position:"relative"},children:[u.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",display:"flex",gap:"8px"},children:[s&&u.jsxs("button",{className:"neo-button",onClick:s,style:{padding:"0 12px",height:"36px",display:"flex",alignItems:"center",gap:"8px",fontSize:"0.85rem",fontWeight:"600",borderRadius:"12px",color:"var(--accent-color)",border:"none",cursor:"pointer"},title:"Help & Feedback",children:[u.jsx(rs,{size:16}),u.jsx("span",{children:"Help"})]}),u.jsx(ti,{onClick:n,size:20})]}),u.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[u.jsx("div",{className:"neo-inset",style:{width:"60px",height:"60px",borderRadius:"50%",margin:"0 auto 1rem",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)"},children:u.jsx(B8,{size:32})}),u.jsx("h2",{style:{margin:0},children:"Refer a Friend"}),u.jsxs("p",{style:{opacity:.7,marginTop:"0.5rem",fontSize:"0.95rem",lineHeight:"1.6"},children:["Invite a ",u.jsx("strong",{children:"first-time user"})," and earn ",u.jsx("strong",{style:{color:"#f59e0b"},children:"50 Coins"})," when they complete their first lesson!"]}),u.jsx("p",{style:{opacity:.6,marginTop:"0.75rem",fontSize:"0.85rem",fontStyle:"italic"},children:"Note: The referred user must be new to the app and complete a published lesson (demo and user-created lessons don't count)."})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[u.jsxs("button",{className:"neo-button",onClick:g,style:{background:"#25D366",color:"white",border:"none",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",padding:"12px",fontSize:"1.1rem"},children:[u.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),"Share Invite via WhatsApp"]}),u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"10px"},children:[u.jsx("div",{style:{height:"1px",flex:1,background:"var(--border-color)"}}),u.jsx("span",{style:{fontSize:"0.8rem",opacity:.5},children:"OR USE CODE"}),u.jsx("div",{style:{height:"1px",flex:1,background:"var(--border-color)"}})]}),u.jsxs("div",{className:"neo-inset",style:{marginTop:"15px",padding:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:"12px",fontSize:"1.2rem",fontWeight:"bold",letterSpacing:"1px"},children:[u.jsx("span",{children:(e==null?void 0:e.referralCode)||"----"}),u.jsx("button",{className:"neo-button icon-btn",onClick:p,title:"Copy Code",children:u.jsx(U8,{size:20})})]})]}),!(e!=null&&e.referredBy)&&u.jsx("div",{style:{marginTop:"10px"},children:u.jsxs("details",{children:[u.jsx("summary",{style:{cursor:"pointer",fontSize:"0.9rem",opacity:.7,listStyle:"none",textAlign:"center"},children:"Have a referral code? Enter it here"}),u.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[u.jsx("input",{className:"neo-input",style:{flex:1},placeholder:"Enter code",value:o,onChange:_=>a(_.target.value)}),u.jsx("button",{className:"neo-button neo-glow-blue",onClick:x,disabled:l||!o,style:{background:"var(--accent-color)",color:"white"},children:l?"...":u.jsx(Eo,{size:20})})]})]})}),(e==null?void 0:e.referredBy)&&u.jsxs("div",{className:"neo-inset",style:{padding:"0.8rem",textAlign:"center",fontSize:"0.9rem",color:"green"},children:["Referred by: ",e.referredBy]})]})]})})};class bU{static async getUsers(e,n,r=!1){try{return console.log("[AdminService] Fetching authoritative registry from Firestore..."),(await rr.listUsers()).map(s=>{var o,a,l;return{id:s.id||s.uid||s.email,uid:s.uid||s.id,email:s.email,displayName:s.displayName||"Guest User",lastLogin:((l=(a=(o=s.lastSeen)==null?void 0:o.toDate)==null?void 0:a.call(o))==null?void 0:l.toISOString())||null,coins:s.coins||0,loginCount:s.loginCount||0}})}catch(i){throw console.error("[AdminService] Registry Sync Failed:",i),i}}static async grantCoins(e,n,r){let i=n.uid;if(!i&&n.id&&!n.id.includes("@")&&(i=n.id),!i&&n.email){console.log(`[AdminService] UID missing for ${n.email}, performing lookup...`);const s=await rr.getProfileByEmail(n.email);i=(s==null?void 0:s.uid)||(s==null?void 0:s.id)}if(!i)throw new Error("Could not identify user ID for transaction.");console.log(`[AdminService] Granting ${r} coins to ${i} via Secure Cloud Function...`);try{const o=await Ho(Go,"grantCoins")({uid:i,amount:r}),{newBalance:a}=o.data;return{success:!0,newBalance:a,email:n.email}}catch(s){console.error("[AdminService] Grant Coins failed:",s);const o=s.message||"Unknown error occurred";throw o.includes("permission-denied")?new Error("Permission Denied: You are not authorized to grant coins."):new Error(`Grant failed: ${o}`)}}static async getPrompts(){return[]}}const iT=bU,ak=R.createContext(null),IU=({children:t})=>{const{user:e}=Ls(),{showToast:n}=Do(),[r,i]=R.useState([]),[s,o]=R.useState(!1),[a,l]=R.useState(new Set),[d,h]=R.useState(new Set),[f,p]=R.useState(null),[g,x]=R.useState({totalReceived:0,lastSync:null}),_=R.useCallback(async()=>{if(!e){p("AUTH_REQUIRED");return}o(!0),p(null);try{const k=await iT.getUsers(e.token);i(k||[]),x({totalReceived:(k==null?void 0:k.length)||0,lastSync:new Date().toLocaleTimeString()})}catch(k){console.error("[AdminContext] Discovery Failed:",k),p(k.message||"Failed to synchronize registry.")}finally{o(!1)}},[e]);return R.useEffect(()=>{e&&_()},[_,e]),u.jsx(ak.Provider,{value:{users:r,loading:s,error:f,stats:g,processingIds:a,recentlyGranted:d,refresh:()=>_(),grantCoins:async(k,S)=>{const v=k.id||k.uid||k.email,w=k.coins||0;let j=!1;i(L=>L.map(V=>(V.id||V.uid||V.email)===v?{...V,coins:(V.coins||0)+S}:V)),n({message:`Granted ${S} coins to ${k.email}`,type:"undo",duration:1e4,onUndo:()=>{j=!0,i(L=>L.map(V=>(V.id||V.uid||V.email)===v?{...V,coins:w}:V))},onClose:async()=>{if(!j){l(L=>new Set(L).add(v));try{const L=await iT.grantCoins(e.token,k,S);L&&L.newBalance!==void 0&&i(V=>V.map(E=>(E.id||E.uid||E.email)===v?{...E,coins:L.newBalance}:E))}catch(L){console.error("[AdminContext] Grant failed",L),i(V=>V.map(E=>(E.id||E.uid||E.email)===v?{...E,coins:w}:E))}finally{l(L=>{const V=new Set(L);return V.delete(v),V})}}}})}},children:t})},CU=()=>{const t=R.useContext(ak);if(!t)throw new Error("useAdmin must be used within AdminProvider");return t},kU=({children:t,activeSection:e,onNavigate:n,onClose:r})=>{const[i,s]=R.useState(!1),[o,a]=R.useState(!1),[l,d]=R.useState(!1);R.useEffect(()=>{const f=()=>a(window.innerWidth<=768);return f(),window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]);const h=()=>s(!i);return u.jsxs("div",{style:Tt.shell,children:[o&&u.jsxs("div",{style:Tt.mobileHeader,children:[u.jsx("button",{onClick:h,style:Tt.iconBtn,children:i?u.jsx(Qt,{size:20}):u.jsx(LC,{size:20})}),u.jsx("span",{style:Tt.storeName,children:"Admin Workspace"}),u.jsx("button",{onClick:r,style:{...Tt.exitBtnTopRight,background:l?"#f1f2f3":"transparent"},onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),title:"Exit Admin",children:u.jsx(Qt,{size:20})})]}),u.jsxs("aside",{style:{...Tt.sidebar,transform:o?i?"translateX(0)":"translateX(-100%)":"none",position:o?"absolute":"relative",height:"100%"},className:"admin-sidebar",children:[!o&&u.jsxs("div",{style:Tt.sidebarHeader,children:[u.jsx("div",{style:Tt.logoBadge,children:"A"}),u.jsx("span",{style:Tt.storeName,children:"Admin Workspace"})]}),u.jsxs("nav",{style:Tt.nav,children:[u.jsx("div",{style:Tt.sectionLabel,children:"GENERAL"}),u.jsx(Jp,{icon:u.jsx(OC,{size:18}),label:"Registry",active:e==="users",onClick:()=>{n("users"),o&&s(!1)}}),u.jsx(Jp,{icon:u.jsx(NC,{size:18}),label:"Smart Paste",active:e==="smart_paste",onClick:()=>{n("smart_paste"),o&&s(!1)}}),u.jsx(Jp,{icon:u.jsx(z8,{size:18}),label:"Prompts",active:e==="prompts",onClick:()=>{n("prompts"),o&&s(!1)}})]})]}),o&&i&&u.jsx("div",{style:Tt.backdrop,onClick:()=>s(!1)}),u.jsxs("main",{style:{...Tt.main,paddingTop:o?"60px":"0"},children:[!o&&u.jsxs("header",{style:Tt.topBar,children:[u.jsxs("div",{style:Tt.searchWrapper,children:[u.jsx(Ug,{size:16,style:{opacity:.5}}),u.jsx("input",{type:"text",placeholder:"Search",style:Tt.globalSearch})]}),u.jsxs("div",{style:Tt.userMenu,children:[u.jsx("div",{style:Tt.avatar,children:"A"}),u.jsx("button",{onClick:r,style:{...Tt.exitBtnTopRight,background:l?"#f1f2f3":"transparent"},onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),title:"Exit Admin",children:u.jsx(Qt,{size:20})})]})]}),u.jsx("div",{style:Tt.contentFrame,children:t})]})]})},Jp=({icon:t,label:e,active:n,onClick:r})=>u.jsxs("button",{onClick:r,style:{...Tt.navItem,background:n?"#ffffff":"transparent",color:n?"#008060":"#5c5f62",fontWeight:n?600:500,boxShadow:n?"0 1px 3px rgba(0,0,0,0.1)":"none"},children:[t,u.jsx("span",{children:e})]}),Tt={shell:{position:"fixed",inset:0,background:"#f6f6f7",zIndex:5e3,display:"flex",fontFamily:'-apple-system, BlinkMacSystemFont, "San Francisco", "Segoe UI", Roboto, "Helvetica Neue", sans-serif'},mobileHeader:{position:"absolute",top:0,left:0,right:0,height:"56px",background:"white",borderBottom:"1px solid #e1e3e5",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 1rem",zIndex:20},sidebar:{width:"240px",background:"#ebebeb",borderRight:"1px solid #e1e3e5",display:"flex",flexDirection:"column",zIndex:30,transition:"transform 0.3s ease-in-out",boxShadow:"2px 0 8px rgba(0,0,0,0.1)"},backdrop:{position:"absolute",inset:0,background:"rgba(0,0,0,0.5)",zIndex:25},sidebarHeader:{padding:"1rem",display:"flex",alignItems:"center",gap:"0.75rem",borderBottom:"1px solid rgba(0,0,0,0.05)"},logoBadge:{width:"32px",height:"32px",background:"#5c5f62",color:"white",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700},storeName:{fontWeight:600,fontSize:"0.9rem",color:"#202223"},nav:{padding:"1rem 0.5rem",flex:1,display:"flex",flexDirection:"column",gap:"0.25rem"},sectionLabel:{fontSize:"0.75rem",fontWeight:600,color:"#444",padding:"0.5rem 0.75rem",marginTop:"0.5rem"},navItem:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.5rem 0.75rem",border:"none",borderRadius:"4px",cursor:"pointer",textAlign:"left",fontSize:"0.9rem",marginBottom:"2px"},exitBtnTopRight:{background:"transparent",border:"none",cursor:"pointer",padding:"8px",display:"flex",alignItems:"center",justifyContent:"center",color:"#5c5f62",borderRadius:"4px",transition:"background 0.2s ease"},main:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},topBar:{height:"56px",background:"white",borderBottom:"1px solid #e1e3e5",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 1rem"},searchWrapper:{width:"400px",height:"36px",background:"#f1f2f3",borderRadius:"4px",display:"flex",alignItems:"center",padding:"0 0.75rem",gap:"0.5rem",border:"1px solid #e1e3e5"},globalSearch:{border:"none",background:"transparent",outline:"none",width:"100%",fontSize:"0.9rem"},contentFrame:{flex:1,overflowY:"auto",padding:"2rem",maxWidth:"1100px",margin:"0 auto",width:"100%"},userMenu:{display:"flex",alignItems:"center",gap:"1rem"},avatar:{width:"32px",height:"32px",borderRadius:"50%",background:"#008060",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.8rem",fontWeight:600},iconBtn:{background:"none",border:"none",cursor:"pointer",padding:"4px"}},AU=({user:t,isOpen:e,onClose:n,onGrant:r})=>{const[i,s]=R.useState("");R.useState("Manual Grant");const[o,a]=R.useState(!1);if(!e||!t)return null;const l=[50,200,500],d=async h=>{if(h.preventDefault(),!(!i||i<=0)){a(!0);try{await r(t,parseInt(i)),n()}catch(f){console.error("Grant failed:",f)}finally{a(!1),s("")}}};return u.jsx("div",{style:pn.overlay,onClick:n,children:u.jsxs("div",{style:pn.modal,onClick:h=>h.stopPropagation(),children:[u.jsxs("div",{style:pn.header,children:[u.jsx("h3",{style:pn.title,children:"Grant Coins"}),u.jsx("button",{onClick:n,style:pn.closeBtn,children:u.jsx(Qt,{size:20})})]}),u.jsxs("div",{style:pn.body,children:[u.jsxs("p",{style:pn.userText,children:["To: ",u.jsx("strong",{children:t.email})]}),u.jsx("div",{style:pn.quickGrid,children:l.map(h=>u.jsx("button",{type:"button",onClick:()=>s(h),style:{...pn.optionBtn,background:i===h?"#e3f1df":"white",borderColor:i===h?"#008060":"#e1e3e5",color:i===h?"#008060":"#202223"},children:h},h))}),u.jsxs("form",{onSubmit:d,style:pn.form,children:[u.jsxs("label",{style:pn.label,children:["Custom Amount",u.jsx("input",{type:"number",min:"1",value:i,onChange:h=>s(h.target.value),style:pn.input,placeholder:"Enter coin amount..."})]}),u.jsxs("div",{style:pn.actions,children:[u.jsx("button",{type:"button",onClick:n,style:pn.cancelBtn,disabled:o,children:"Cancel"}),u.jsx("button",{type:"submit",disabled:!i||o,style:{...pn.submitBtn,opacity:!i||o?.5:1,cursor:!i||o?"not-allowed":"pointer"},children:o?"Granting...":`Grant ${i||"..."} Coins`})]})]})]})]})})},pn={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},modal:{background:"white",borderRadius:"8px",width:"100%",maxWidth:"400px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},header:{padding:"1rem",borderBottom:"1px solid #e1e3e5",display:"flex",justifyContent:"space-between",alignItems:"center"},title:{margin:0,fontSize:"1rem",fontWeight:600},closeBtn:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#5c5f62",display:"flex"},body:{padding:"1.5rem"},userText:{marginTop:0,marginBottom:"1.5rem",color:"#5c5f62"},quickGrid:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.75rem",marginBottom:"1.5rem"},optionBtn:{padding:"0.75rem",border:"1px solid #e1e3e5",borderRadius:"4px",fontWeight:600,cursor:"pointer",fontSize:"0.9rem",transition:"all 0.2s"},form:{display:"flex",flexDirection:"column",gap:"1.5rem"},label:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.9rem",fontWeight:500},input:{padding:"0.75rem",border:"1px solid #e1e3e5",borderRadius:"4px",fontSize:"1rem"},actions:{display:"flex",justifyContent:"flex-end",gap:"0.75rem"},cancelBtn:{padding:"0.75rem 1rem",background:"white",border:"1px solid #e1e3e5",borderRadius:"4px",fontWeight:600,cursor:"pointer"},submitBtn:{padding:"0.75rem 1rem",background:"#008060",color:"white",border:"none",borderRadius:"4px",fontWeight:600,boxShadow:"0 1px 0 rgba(0,0,0,0.05)"}},RU=()=>{const{users:t,loading:e,error:n,stats:r,refresh:i,grantCoins:s,processingIds:o,recentlyGranted:a}=CU(),[l,d]=Ir.useState(null);return e&&t.length===0?u.jsx(NU,{}):n==="AUTH_REQUIRED"?u.jsx(PU,{}):n?u.jsx(DU,{error:n,retry:i}):u.jsxs("div",{style:Pe.container,children:[u.jsxs("div",{style:Pe.header,children:[u.jsx("h1",{style:Pe.title,children:"Users"}),u.jsxs("div",{style:Pe.actions,children:[u.jsxs("span",{style:Pe.badge,children:[t.length," Records"]}),u.jsx("button",{onClick:i,style:Pe.iconBtn,title:"Refresh Index",children:u.jsx(Pc,{size:16})})]})]}),r.lastSync&&u.jsxs("div",{style:Pe.diagnosticBanner,children:[u.jsx(V8,{size:14,color:"#008060"}),u.jsxs("span",{children:["Directory Synced at ",r.lastSync,". Status: Live from Firestore"]})]}),t.length===0?u.jsx(jU,{retry:i}):u.jsx("div",{style:Pe.card,children:u.jsx("div",{className:"table-responsive",children:u.jsxs("table",{style:Pe.table,children:[u.jsx("thead",{children:u.jsxs("tr",{style:Pe.theadRow,children:[u.jsx("th",{style:Pe.th,children:"Name"}),u.jsx("th",{style:Pe.th,children:"Email"}),u.jsx("th",{style:Pe.th,children:"Last Active"}),u.jsx("th",{style:Pe.th,children:"Logins"}),u.jsx("th",{style:Pe.th,children:"Coins"}),u.jsx("th",{style:Pe.th,children:"Actions"})]})}),u.jsx("tbody",{children:t.map(h=>{const f=h.id||h.uid||h.email,p=o==null?void 0:o.has(f);return u.jsxs("tr",{style:Pe.tr,children:[u.jsx("td",{style:Pe.td,children:u.jsx("span",{style:Pe.nameText,children:h.displayName})}),u.jsx("td",{style:Pe.td,children:h.email}),u.jsx("td",{style:Pe.td,children:h.lastLogin?new Date(h.lastLogin).toLocaleDateString():"-"}),u.jsx("td",{style:Pe.td,children:h.loginCount||0}),u.jsx("td",{style:Pe.td,children:u.jsx("span",{style:{color:"#008060",fontWeight:700,background:"#e3f1df",padding:"2px 8px",borderRadius:"10px",fontSize:"0.85rem"},children:h.coins||0})}),u.jsx("td",{style:Pe.td,children:u.jsx("button",{disabled:p,onClick:()=>d(h),style:{...Pe.actionLink,color:p?"#6d7175":"#008060",opacity:p?.5:1,cursor:p?"wait":"pointer",textDecoration:p?"none":"underline",display:"flex",alignItems:"center",gap:"4px"},children:p?"Store...":"Grant Coins"})})]},f)})})]})})}),u.jsx(AU,{user:l,isOpen:!!l,onClose:()=>d(null),onGrant:s}),u.jsx("style",{children:`
                .table-responsive { overflow-x: auto; }
                @media (max-width: 600px) {
                    /* Mobile styles can be enhanced here */
                }
            `})]})},PU=()=>{const[t,e]=Ir.useState(!1);return u.jsxs("div",{style:Pe.errorBox,children:[u.jsx(W8,{size:32,color:"#5c5f62"}),u.jsx("h3",{style:Pe.errorTitle,children:"Authorization Required"}),u.jsx("p",{style:Pe.errorDesc,children:"Admin access requires Google Drive permissions."}),u.jsx("button",{disabled:t,onClick:async()=>{e(!0);try{console.log("[AdminAuth] Requesting Drive Access..."),await l8(),console.log("[AdminAuth] Access Granted. Refreshing context...")}catch(n){console.error("[AdminAuth] Access Denied:",n),alert(`Authorization Failed: ${n.message||n}`)}finally{e(!1)}},style:{...Pe.primaryBtn,opacity:t?.7:1,cursor:t?"wait":"pointer"},children:t?"Authorizing...":"Authorize Admin Access"})]})},NU=()=>u.jsxs("div",{style:Pe.centerBox,children:[u.jsx("div",{className:"polaris-spinner",style:Pe.spinner}),u.jsx("p",{style:{marginTop:"1rem",color:"#6d7175"},children:"Loading Users from Firestore..."})]}),DU=({error:t,retry:e})=>u.jsxs("div",{style:Pe.errorBox,children:[u.jsx(D8,{size:32,color:"#d82c0d"}),u.jsx("h3",{style:Pe.errorTitle,children:"Directory Access Failed"}),u.jsx("p",{style:Pe.errorDesc,children:t}),u.jsx("button",{onClick:e,style:Pe.primaryBtn,children:"Retry Sync"})]}),jU=({retry:t})=>{const{user:e}=Ls(),[n,r]=Ir.useState(!1),i=async()=>{if(e){r(!0);try{await rr.syncProfile(e),t()}catch(s){console.error(s),alert("Registration failed: "+s.message)}finally{r(!1)}}};return u.jsxs("div",{style:Pe.centerBox,children:[u.jsx(NC,{size:48,color:"#babec3"}),u.jsx("h2",{style:Pe.emptyTitle,children:"No Users Found"}),u.jsx("p",{style:Pe.emptyDesc,children:"The user directory is currently empty."}),u.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[u.jsxs("button",{onClick:t,style:Pe.primaryBtn,children:[u.jsx(Pc,{size:14,style:{marginRight:"8px"}})," Refresh List"]}),u.jsxs("button",{onClick:i,disabled:n||!e,style:{...Pe.primaryBtn,background:"white",color:"#008060",border:"1px solid #008060",display:"flex",alignItems:"center"},children:[u.jsx(r9,{size:14,style:{marginRight:"8px"}}),n?"Registering...":"Register Me"]})]})]})},Pe={container:{display:"flex",flexDirection:"column",gap:"1rem"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},title:{fontSize:"1.5rem",fontWeight:700,color:"#202223",margin:0},actions:{display:"flex",gap:"1rem",alignItems:"center"},badge:{background:"#dfe3e8",color:"#202223",padding:"0.25rem 0.75rem",borderRadius:"12px",fontSize:"0.8rem",fontWeight:600},iconBtn:{background:"white",border:"1px solid #e1e3e5",borderRadius:"4px",padding:"0.5rem",cursor:"pointer",color:"#5c5f62"},diagnosticBanner:{background:"#e3f1df",color:"#008060",padding:"0.75rem 1rem",borderRadius:"4px",fontSize:"0.85rem",display:"flex",alignItems:"center",gap:"0.5rem",border:"1px solid #1a1a1a0d"},card:{background:"white",borderRadius:"8px",boxShadow:"0 0 0 1px rgba(63, 63, 68, 0.05), 0 1px 3px 0 rgba(63, 63, 68, 0.15)",overflow:"hidden"},table:{width:"100%",borderCollapse:"collapse",textAlign:"left"},theadRow:{background:"#f9fafb",borderBottom:"1px solid #e1e3e5"},th:{padding:"1rem",fontSize:"0.8rem",fontWeight:600,color:"#6d7175",textTransform:"uppercase"},tr:{borderBottom:"1px solid #e1e3e5"},td:{padding:"1rem",fontSize:"0.9rem",color:"#202223"},nameText:{fontWeight:600},actionLink:{background:"none",border:"none",color:"#008060",fontWeight:600,cursor:"pointer",fontSize:"0.85rem",textDecoration:"underline"},centerBox:{padding:"4rem",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},primaryBtn:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:"#008060",color:"white",border:"none",borderRadius:"4px",fontWeight:600,cursor:"pointer"},errorBox:{padding:"2rem",background:"#fff4f4",border:"1px solid #eecaca",borderRadius:"8px",display:"flex",flexDirection:"column",alignItems:"center",color:"#8f2316"},errorTitle:{marginTop:"1rem",fontSize:"1.2rem"},errorDesc:{opacity:.8}},LU=({onClose:t,showAlert:e,onEditLesson:n,initialSection:r="users"})=>{var S;const{user:i}=Ls(),[s,o]=R.useState(r),[a,l]=R.useState(""),[d,h]=R.useState(null),[f,p]=R.useState(null),g=v=>{o(v),p(null)},x=()=>{var v;try{p(null);const w=E9(a),j=w.questions||w.cards||[];if(!w.title&&j.length===0&&(((v=w.sections)==null?void 0:v.length)||0)===0)throw new Error("Could not find any valid lesson data in the paste.");h(w),e("Content processed successfully!")}catch(w){p(w.message)}},_=()=>{if(d&&n){const v={...d,questions:d.questions||d.cards||[],id:`draft-${Date.now()}`,isPublic:!0,owner:i==null?void 0:i.email};n(v),t()}},k=d?d.questions||d.cards||[]:[];return u.jsx(IU,{children:u.jsxs(kU,{activeSection:s,onNavigate:g,onClose:t,children:[s==="users"&&u.jsx(RU,{}),s==="smart_paste"&&u.jsxs("div",{style:Dt.card,children:[u.jsx("h2",{style:Dt.cardTitle,children:"Smart Paste (New Schema Support)"}),u.jsx("p",{style:Dt.cardDesc,children:"Paste lesson JSON following the new hierarchical schema (sections, noteSegments, etc.). The system will automatically recognize the structure."}),u.jsxs("div",{style:Dt.pasteWrapper,children:[u.jsx("textarea",{style:Dt.textarea,placeholder:"Paste JSON here...",value:a,onChange:v=>l(v.target.value)}),u.jsxs("div",{style:Dt.pasteActions,children:[u.jsxs("button",{onClick:x,style:Dt.primaryBtn,disabled:!a.trim(),children:[u.jsx(F8,{size:16,style:{marginRight:"8px"}}),"Analyze & Process"]}),a&&u.jsx("button",{onClick:()=>{l(""),h(null)},style:Dt.secondaryBtn,children:"Clear"})]})]}),f&&u.jsxs("div",{style:Dt.errorBanner,children:[u.jsx(RC,{size:18}),u.jsx("span",{children:f})]}),d&&u.jsxs("div",{style:Dt.previewBox,children:[u.jsxs("div",{style:Dt.previewHeader,children:[u.jsx(Eo,{size:18,color:"#008060"}),u.jsx("h3",{style:Dt.previewTitle,children:"Analysis Complete"})]}),u.jsxs("div",{style:Dt.metaGrid,children:[u.jsx(Uo,{label:"Title",value:d.title}),u.jsx(Uo,{label:"Subject",value:d.subject}),u.jsx(Uo,{label:"Standard",value:d.standard}),u.jsx(Uo,{label:"Syllabus",value:d.syllabus}),u.jsx(Uo,{label:"Questions",value:k.length}),u.jsx(Uo,{label:"Sections",value:(S=d.sections)==null?void 0:S.length})]}),u.jsxs("button",{onClick:_,style:Dt.editBtn,children:[u.jsx(Q8,{size:16}),"Open in Lesson Editor"]})]})]}),s==="prompts"&&u.jsxs("div",{style:Dt.card,children:[u.jsx("h2",{style:Dt.cardTitle,children:"Prompt Library"}),u.jsx("p",{children:"Manage system prompts for AI generation."})]})]})})},Uo=({label:t,value:e})=>u.jsxs("div",{style:Dt.metaItem,children:[u.jsxs("span",{style:Dt.metaLabel,children:[t,":"]}),u.jsx("span",{style:Dt.metaValue,children:e||"N/A"})]}),Dt={card:{background:"white",padding:"2rem",borderRadius:"8px",border:"1px solid #e1e3e5",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},cardTitle:{marginBottom:"0.5rem",fontSize:"1.25rem",fontWeight:600,color:"#202223"},cardDesc:{marginBottom:"1.5rem",fontSize:"0.9rem",color:"#6d7175"},pasteWrapper:{display:"flex",flexDirection:"column",gap:"1rem"},textarea:{width:"100%",height:"200px",padding:"1rem",borderRadius:"4px",border:"1.5px solid #dcdfe3",fontFamily:"monospace",fontSize:"0.85rem",outline:"none",resize:"vertical"},pasteActions:{display:"flex",gap:"1rem"},primaryBtn:{padding:"0.75rem 1.5rem",background:"#008060",color:"white",border:"none",borderRadius:"4px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center"},secondaryBtn:{padding:"0.75rem 1rem",background:"transparent",color:"#5c5f62",border:"1px solid #c9cccf",borderRadius:"4px",cursor:"pointer"},errorBanner:{marginTop:"1rem",padding:"1rem",background:"#fff4f4",color:"#8f2316",borderRadius:"4px",display:"flex",alignItems:"center",gap:"0.75rem",fontSize:"0.9rem"},previewBox:{marginTop:"2rem",padding:"1.5rem",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e1e3e5"},previewHeader:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},previewTitle:{margin:0,fontSize:"1rem",fontWeight:600,color:"#008060"},metaGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},metaItem:{display:"flex",flexDirection:"column",gap:"0.25rem"},metaLabel:{fontSize:"0.75rem",fontWeight:600,color:"#6d7175",textTransform:"uppercase"},metaValue:{fontSize:"0.95rem",fontWeight:500,color:"#202223"},editBtn:{width:"100%",padding:"0.75rem",background:"white",color:"#2c6ecb",border:"1px solid #2c6ecb",borderRadius:"4px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"}},MU=({lesson:t,user:e,onStart:n,onClose:r,onEdit:i,onDelete:s,showConfirm:o})=>{const a=R.useRef(null),l=e&&(t.ownedByMe||e.email===ki);return!t||!t.importantNote?null:(R.useEffect(()=>{a.current&&(a.current.scrollTop=0)},[t]),u.jsxs(Ue.div,{ref:a,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"var(--bg-color)",zIndex:1500,display:"flex",flexDirection:"column",padding:window.innerWidth<768?"1rem":"2rem",overflowY:"auto",overscrollBehavior:"contain"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",flexShrink:0},children:[u.jsx("h2",{style:{fontSize:window.innerWidth<768?"1.5rem":"1.8rem",margin:0},children:"Important Note"}),u.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[l&&u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"neo-button icon-btn",onClick:()=>o(`Delete "${t.title}"?`,s),title:"Delete Lesson",style:{color:"#ef4444"},children:u.jsx(yi,{size:20})}),u.jsx("button",{className:"neo-button icon-btn",onClick:i,title:"Edit Lesson",children:u.jsx(cv,{size:20})})]}),u.jsx(ti,{onClick:r,size:20})]})]}),u.jsx("div",{className:"neo-inset",style:{flex:1,padding:window.innerWidth<768?"1.25rem":"2rem",whiteSpace:"pre-wrap",fontSize:window.innerWidth<768?"1rem":"1.1rem",lineHeight:"1.6",color:"var(--text-color)",marginBottom:"8rem",borderRadius:"16px"},children:t.importantNote}),u.jsxs("button",{className:"neo-button neo-glow-blue",onClick:n,style:{position:"fixed",bottom:"2rem",left:"50%",transform:"translateX(-50%)",padding:"1rem 2.5rem",fontSize:"1.2rem",background:"var(--accent-color)",color:"white",border:"none",borderRadius:"50px",display:"flex",alignItems:"center",gap:"10px",zIndex:1600,boxShadow:"0 4px 15px rgba(0,0,0,0.3)",width:"max-content",maxWidth:"90%"},children:[u.jsx(Rf,{size:24,fill:"currentColor"}),"Start Review"]})]}))},VU=({onSave:t})=>{const[e,n]=R.useState(""),r=i=>{i.preventDefault(),e.trim()&&t(e.trim())};return u.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,right:0,bottom:0,left:0,backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",background:"rgba(255,255,255,0.01)",zIndex:3e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},children:u.jsxs(Ue.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},className:"neo-flat",style:{width:"100%",maxWidth:"400px",padding:"2.5rem",textAlign:"center",display:"flex",flexDirection:"column",gap:"2rem"},children:[u.jsxs("div",{children:[u.jsx("div",{className:"neo-inset",style:{width:"64px",height:"64px",borderRadius:"50%",margin:"0 auto 1.5rem",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--accent-color)"},children:u.jsx(Td,{size:32})}),u.jsx("h2",{style:{fontSize:"1.8rem",marginBottom:"0.5rem"},children:"Welcome, Friend!"}),u.jsx("p",{style:{opacity:.6},children:"I want to be your well-wisher on this learning journey. What should I call you?"})]}),u.jsxs("form",{onSubmit:r,style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[u.jsx("div",{className:"neo-inset",style:{padding:"4px 15px",borderRadius:"12px",display:"flex",alignItems:"center"},children:u.jsx("input",{autoFocus:!0,type:"text",value:e,onChange:i=>n(i.target.value),placeholder:"Your name...",style:{width:"100%",padding:"12px 5px",background:"transparent",border:"none",fontSize:"1.1rem",color:"inherit",outline:"none"}})}),u.jsxs("button",{type:"submit",disabled:!e.trim(),className:"neo-button neo-glow-blue",style:{padding:"1.2rem",justifyContent:"center",gap:"0.8rem",background:"var(--accent-color)",color:"white",opacity:e.trim()?1:.5},children:[u.jsx(Eo,{size:20}),"Get Started"]})]})]})})},OU=({user:t,lessons:e,publicLessons:n,userProfile:r,activeLesson:i,reviewLesson:s,noteLesson:o,theme:a,onToggleTheme:l,soundsEnabled:d,onToggleSounds:h,onLogout:f,onDeleteData:p,onShowTour:g,onSaveLesson:x,onDeleteLesson:_,onImportLesson:k,onUpdateCoins:S,isUnlimited:v,signIn:w,onReviewStart:j,handleEditLesson:L,handleReviewLaunch:V,activeTab:E,fetchPublicLessons:T,fetchLessons:I,ADMIN_EMAIL:A,APP_VERSION:P,showNotification:N,setUserProfile:b,saveUserProfile:H,refreshProfile:he,onRestorePurchases:re})=>{const{modals:se,toggleModal:U,setReviewLesson:G,setNoteLesson:M,setActiveLesson:D}=Do(),{isActive:q,endTour:J,startTour:ee}=au(),ie=()=>{G(null),M(null),U("showAddModal",!1)},Z=Ir.useRef({});return Ir.useEffect(()=>{const z=["showMenu","showCoinModal","showReferral","showAdminPanel"];let Y=!1;z.forEach(pe=>{const _e=se[pe],ge=Z.current[pe];_e&&!ge&&(Y=!0)}),Z.current={...se},Y&&he&&(console.log("[ModalRegistry] Syncing profile on modal open."),he())},[se,he]),u.jsxs(Cn,{children:[se.showMenu&&u.jsx(S9,{user:t,theme:a,onToggleTheme:l,soundsEnabled:d,onToggleSounds:h,onShowFeedback:()=>{U("showMenu",!1),window.history.pushState({modal:"active"},"",window.location.pathname),U("showFeedback",!0)},onShowReferral:()=>{U("showMenu",!1),window.history.pushState({modal:"active"},"",window.location.pathname),U("showReferral",!0)},onClose:()=>U("showMenu",!1),onLogout:f,onRestorePurchases:re,onLogin:()=>{U("showMenu",!1),w("consent")},onDeleteData:p,onShowAdminPanel:()=>{U("showMenu",!1),window.history.pushState({modal:"active"},"",window.location.pathname),U("showAdminPanel",!0)},onShowTour:()=>{U("showMenu",!1),J(),setTimeout(()=>ee(),300)},appVersion:P}),se.showAddModal&&u.jsx(b9,{user:t,lesson:i,onClose:()=>window.history.back(),onSave:x,onDelete:_,showAlert:z=>N("alert",z),showConfirm:(z,Y)=>N("confirm",z,Y),availableLabels:[...new Set(e.map(z=>z.label).filter(z=>z))],allLessons:e,activeTab:E}),s&&u.jsx(q9,{lesson:s,user:t,onClose:ie,onUpdate:z=>x(z,!1),onEdit:()=>{L(s),G(null)},showAlert:z=>typeof z=="string"?N("alert",z):N(z.type,z.message,z.onConfirm),userCoins:(r==null?void 0:r.coins)||0,onDeductCoins:z=>{v||S(((r==null?void 0:r.coins)||0)-z)},isUnlimited:v,onReviewStart:j,displayName:r==null?void 0:r.displayName}),o&&u.jsx(MU,{lesson:o,user:t,onStart:()=>{G(o),M(null)},onClose:()=>window.history.back(),onEdit:()=>{L(o),M(null)},onDelete:()=>_(o),showConfirm:(z,Y)=>N("confirm",z,Y)}),se.showFeedback&&u.jsx(H9,{user:t,onClose:()=>window.history.back(),showAlert:z=>N("alert",z)}),se.showKnowMore&&u.jsx(G9,{isOpen:se.showKnowMore,onClose:()=>window.history.back(),onLogin:()=>{U("showKnowMore",!1),onLoginRequired(null)}}),se.showCoinModal&&u.jsx(SU,{user:t,userCoins:(r==null?void 0:r.coins)||0,onClose:()=>window.history.back(),onShare:()=>{U("showCoinModal",!1),window.history.pushState({modal:"active"},"",window.location.pathname),U("showReferral",!0)},onShowFeedback:()=>{U("showCoinModal",!1),window.history.pushState({modal:"active"},"",window.location.pathname),U("showFeedback",!0)}}),se.showReferral&&u.jsx(EU,{user:t,userProfile:r,onClose:()=>window.history.back(),onUpdateProfile:z=>{b(z),H(t.token,z)},showAlert:z=>N("alert",z),onShowFeedback:()=>{U("showReferral",!1),window.history.pushState({modal:"active"},"",window.location.pathname),U("showFeedback",!0)}}),se.showAdminPanel&&u.jsx(LU,{user:t,onClose:()=>window.history.back(),publicLessons:n,onRefreshPublic:T,showAlert:z=>N("alert",z),showConfirm:(z,Y)=>N("confirm",z,Y),onEditLesson:L}),se.showNamePrompt&&!q&&u.jsx(VU,{onSave:async z=>{const Y={...r,displayName:z};b(Y),U("showNamePrompt",!1),await H(t.token,Y)}})]})},FU=()=>{try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return;const e=new t,n=e.createOscillator(),r=e.createGain();n.connect(r),r.connect(e.destination),n.type="sine",n.frequency.setValueAtTime(1200,e.currentTime),n.frequency.exponentialRampToValueAtTime(1800,e.currentTime+.1),r.gain.setValueAtTime(.3,e.currentTime),r.gain.exponentialRampToValueAtTime(.01,e.currentTime+.6),n.start(),n.stop(e.currentTime+.6)}catch(t){console.error("Audio play failed",t)}},UU=()=>{try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return;const e=new t,n=[523.25,659.25,783.99,1046.5];let r=e.currentTime;n.forEach((i,s)=>{const o=e.createOscillator(),a=e.createGain();o.connect(a),a.connect(e.destination),o.type="triangle",o.frequency.value=i,a.gain.setValueAtTime(.1,r),a.gain.exponentialRampToValueAtTime(.01,r+.5),o.start(r),o.stop(r+.5),r+=.1})}catch(t){console.error("Celebration audio failed",t)}},zU=({color:t})=>u.jsx("svg",{viewBox:"0 0 100 100",style:{width:"100%",height:"100%",fill:t},children:u.jsx("circle",{cx:"50",cy:"50",r:"40"})}),BU=({color:t})=>u.jsx("svg",{viewBox:"0 0 100 100",style:{width:"100%",height:"100%",fill:t},children:u.jsx("path",{d:"M50 15 L90 85 L10 85 Z"})}),$U=({color:t})=>u.jsxs("svg",{viewBox:"0 0 100 100",style:{width:"100%",height:"100%",fill:t},children:[u.jsx("rect",{x:"35",y:"10",width:"30",height:"80",rx:"5"}),u.jsx("rect",{x:"10",y:"35",width:"80",height:"30",rx:"5"})]}),WU=({amount:t,onClose:e,type:n="Daily Login"})=>{const[r,i]=R.useState(0);R.useEffect(()=>{UU();const l=setTimeout(()=>{FU()},200);let d=0;const h=parseInt(t,10)||0;if(d===h){i(h);return}const f=1e3,p=performance.now(),g=x=>{const _=x-p,k=Math.min(_/f,1),S=1-Math.pow(1-k,4);i(Math.floor(d+(h-d)*S)),k<1&&requestAnimationFrame(g)};return requestAnimationFrame(g),()=>clearTimeout(l)},[t]);const s=12,o=["#FBBF24","#3B82F6","#EF4444","#10B981"],a=180;return u.jsx("div",{style:{position:"fixed",inset:0,zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"auto",backdropFilter:"blur(4px)",background:"rgba(0,0,0,0.3)"},onClick:e,children:u.jsxs("div",{style:{position:"relative"},onClick:l=>l.stopPropagation(),children:[u.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:0,height:0,pointerEvents:"none"},children:[...Array(s)].map((l,d)=>{const h=d/s*360,f=[zU,BU,$U][d%3];return u.jsx(Ue.div,{style:{position:"absolute",width:"32px",height:"32px"},initial:{x:0,y:0,scale:0,rotate:0},animate:{x:Math.cos(h*Math.PI/180)*a,y:Math.sin(h*Math.PI/180)*a,scale:[0,1.2,0],rotate:[0,180,360],opacity:[1,1,0]},transition:{duration:1.5,ease:"easeOut",delay:.1},children:u.jsx(f,{color:o[d%o.length]})},d)})}),u.jsxs(Ue.div,{initial:{scale:.8,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0},transition:{type:"spring",damping:15},style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem",textAlign:"center"},children:[u.jsxs("div",{style:{position:"relative"},children:[u.jsx(Ue.div,{animate:{y:[-10,10,-10],rotateY:[0,180,360]},transition:{y:{duration:2,repeat:1/0,ease:"easeInOut"},rotateY:{duration:4,repeat:1/0,ease:"linear"}},style:{width:"120px",height:"120px",background:"linear-gradient(135deg, #fbbf24, #d97706)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"4px solid #fef3c7",boxShadow:"0 10px 25px rgba(217, 119, 6, 0.4), inset 0 2px 5px rgba(255, 255, 255, 0.5)",position:"relative",zIndex:2},children:u.jsx(lv,{size:60,color:"white"})}),u.jsx("div",{style:{position:"absolute",inset:"-20px",background:"radial-gradient(circle, rgba(251, 191, 36, 0.4) 0%, transparent 70%)",borderRadius:"50%",zIndex:1}})]}),u.jsxs("div",{children:[u.jsx(Ue.h2,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},style:{color:"white",fontSize:"1.5rem",fontWeight:"900",textTransform:"uppercase",letterSpacing:"2px",textShadow:"0 2px 10px rgba(0,0,0,0.5)",marginBottom:"0.5rem"},children:n}),u.jsxs(Ue.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,type:"spring"},style:{color:"#fbbf24",fontSize:"4rem",fontWeight:"900",textShadow:"0 4px 15px rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center"},children:["+",r]})]}),u.jsxs(Ue.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:e,style:{background:"white",border:"none",borderRadius:"50px",padding:"1rem 3rem",fontSize:"1.2rem",fontWeight:"800",color:"#d97706",display:"flex",alignItems:"center",gap:"0.75rem",cursor:"pointer",boxShadow:"0 10px 20px rgba(0,0,0,0.2), 0 5px 0 #e5e7eb",marginTop:"1rem"},children:[u.jsx(Eo,{size:24,strokeWidth:3}),"CONTINUE"]})]}),u.jsx("button",{onClick:e,style:{position:"absolute",top:"-4rem",right:"0",background:"rgba(255, 255, 255, 0.1)",border:"none",color:"white",padding:"0.5rem",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)",transition:"background 0.2s"},onMouseEnter:l=>l.currentTarget.style.background="rgba(255, 255, 255, 0.2)",onMouseLeave:l=>l.currentTarget.style.background="rgba(255, 255, 255, 0.1)",children:u.jsx(Qt,{size:24})})]})})},qU=({onStartDemo:t,onGoToMyLessons:e,userName:n,onLogin:r,onAddLesson:i})=>{const{isActive:s,currentStep:o,nextStep:a,setStep:l,endTour:d,isDemoGracePeriod:h}=au(),[f,p]=R.useState(null),[g,x]=R.useState(window.innerWidth<768);R.useRef(null),R.useEffect(()=>{const E=()=>x(window.innerWidth<768);return window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]);const _=R.useMemo(()=>[{id:1,targetId:null,mobilePos:{bottom:"20px",left:0,right:0,margin:"0 auto",width:"90%"},desktopPos:{bottom:"50px",left:"50px"},text:`Welcome${n?" "+n:""}! Im Chethan.
Im here to guide you through a more efficient way to learn and retain information.`,actionLabel:"Begin Tour",layout:"duo-card",canSkip:!0},{id:2,targetId:null,mobilePos:{bottom:"20px",left:0,right:0,margin:"0 auto",width:"90%"},desktopPos:{bottom:"20px",left:"20px"},text:"Your progress and lessons are stored securely in your personal Google Drive, ensuring your data remains private and under your exclusive control.",actionLabel:"Sign in with Google",onAction:r,layout:"duo-card",isLoginStep:!0,canSkip:!0,onSkip:()=>l(3),extraContent:u.jsxs("div",{style:{marginTop:"12px",padding:"14px",background:"var(--accent-soft)",borderRadius:"16px",border:"1px solid var(--tour-border)",fontSize:"0.85rem",color:"var(--tour-text)",textAlign:"left"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",fontWeight:"700"},children:[u.jsx("div",{style:{background:"var(--accent-color)",color:"white",width:"22px",height:"22px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.8rem"},children:"!"}),"Setup Requirement"]}),"To enable synchronization, please ensure you ",u.jsx("strong",{children:"check the permission box"})," during sign-in."]})},{id:3,targetId:"tab-lessons",text:"Explore our collection of professionally curated lessons. You can easily add any of these to your personal library.",actionLabel:"Next",layout:"tooltip",placement:"bottom",canSkip:!0},{id:4,targetId:"fab-add-lesson",text:"Ready to create your own? Click the '+' button to start building your personal lesson.",onAction:()=>{i==null||i(),a()},layout:"tooltip",placement:"top",canSkip:!0},{id:5,targetId:"lesson-modal-title-input",text:"Give your lesson a catchy title and start adding questions. You can use text, images, and even voice recordings!",actionLabel:"Got it",layout:"tooltip",placement:"bottom",canSkip:!1},{id:6,targetId:null,text:"You are now fully equipped for success. Start creating your own personalized lessons whenever you're ready.",actionLabel:"Get Started",onAction:e,layout:"duo-card",isFinalAction:!0,canSkip:!1}],[n,r,t,e,l,g,i]),k=_.findIndex(E=>E.id===o),S=_[k]||_[0];R.useEffect(()=>{if(!s)return;const E=()=>{if(S.targetId){const I=document.getElementById(S.targetId),P=(S.highlightId?document.getElementById(S.highlightId):null)||I;if(P){const N=P.getBoundingClientRect();p(N),N.top>=0&&N.left>=0&&N.bottom<=window.innerHeight&&N.right<=window.innerWidth||P.scrollIntoView({behavior:"smooth",block:"center"})}else p(null)}else p(null)};E(),window.addEventListener("resize",E),window.addEventListener("scroll",E);const T=setInterval(E,500);return()=>{window.removeEventListener("resize",E),window.removeEventListener("scroll",E),clearInterval(T)}},[o,S,s]);const v=()=>{S.onAction?S.onAction():S.isFinalAction?d():a()},w=E=>{E.stopPropagation(),S.onSkip?S.onSkip():a()};if(!s)return null;const j=()=>{const E=window.innerWidth,T=window.innerHeight,I=E<768;let A=I?Math.min(E-32,340):S.layout==="duo-card"?550:380;const P=16,N=16,b={position:"fixed",width:A,zIndex:"var(--tour-z-index)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"};if(!f)return{...b,left:(E-A)/2,top:I?"auto":(T-200)/2,bottom:I?"24px":"auto",maxWidth:`calc(100vw - ${P*2}px)`};const H=f.left+f.width/2,he=f.top+f.height/2;let re=S.placement||"bottom";return I&&((re==="left"||re==="right")&&(re=f.top>T/2?"top":"bottom"),re==="bottom"&&f.bottom+220>T&&(re="top"),re==="top"&&f.top<220&&(re="bottom")),re==="top"?(b.left=H-A/2,b.bottom=T-f.top+N):re==="bottom"?(b.left=H-A/2,b.top=f.bottom+N):re==="left"?(b.left=f.left-A-N,b.top=he-100):(b.left=f.right+N,b.top=he-100),b.left<P?b.left=P:b.left+A>E-P&&(b.left=E-A-P),b.top!==void 0?b.top<P?b.top=P:b.top+200>T&&(b.top=T-200-P):b.bottom!==void 0&&b.bottom<P&&(b.bottom=P),b.activePlacement=re,b.arrowLeft=H-b.left,b};if(!s||h)return null;const L=j(),V=g&&S.mobilePos?S.mobilePos:!g&&S.desktopPos?S.desktopPos:L;return u.jsxs("div",{className:"feature-tour-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:"var(--tour-z-index)",pointerEvents:"none"},children:[u.jsx(Cn,{children:!S.targetId&&u.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"absolute",inset:0,background:"var(--tour-overlay-bg)",backdropFilter:"blur(4px)",pointerEvents:"auto"}})}),u.jsx(Cn,{mode:"wait",children:u.jsx(Ue.div,{initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},style:{position:"fixed",display:"flex",flexDirection:"column",alignItems:"center",pointerEvents:"auto",...V},children:u.jsxs("div",{className:"neo-flat tour-glass",style:{background:"var(--tour-bg)",backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",color:"var(--tour-text)",borderRadius:"24px",border:"1px solid var(--tour-border)",padding:"1.25rem",display:"flex",flexDirection:g?"column":"row",alignItems:"center",gap:"1.25rem",overflow:"hidden",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1)",width:"100%",position:"relative"},children:[u.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minWidth:g?"60px":S.layout==="duo-card"?"140px":"90px",width:g?"60px":S.layout==="duo-card"?"140px":"90px",flexShrink:0},children:u.jsx("img",{src:uv,alt:"Guide",style:{width:"100%",height:"auto",maxWidth:"120px"}})}),u.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.75rem",textAlign:"left"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"8px"},children:[u.jsx("p",{style:{margin:0,fontSize:"0.95rem",lineHeight:"1.6",fontWeight:"600",whiteSpace:"pre-line"},children:S.text}),u.jsx("button",{onClick:d,style:{background:"none",border:"none",color:"var(--tour-text-muted)",cursor:"pointer",padding:4,flexShrink:0},children:u.jsx(Qt,{size:18})})]}),S.extraContent,u.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"4px"},children:[S.canSkip&&u.jsx("button",{onClick:w,style:{padding:"0.6rem 1rem",background:"transparent",color:"var(--tour-text-muted)",fontWeight:"600",borderRadius:"12px",border:"1px solid var(--tour-border)",fontSize:"0.85rem"},children:"Skip"}),u.jsxs("button",{onClick:v,style:{flex:2,padding:"0.6rem 1.25rem",background:"var(--tour-accent)",color:"white",fontWeight:"700",borderRadius:"12px",boxShadow:"0 4px 0 var(--tour-accent-dark)",border:"none",fontSize:"0.9rem",display:"flex",justifyContent:"center",alignItems:"center",gap:"8px"},children:[S.isLoginStep&&u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"18px",height:"18px",style:{flexShrink:0},children:[u.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),u.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),u.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),u.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571l6.19,5.238C40.483,35.58,44,30.2,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),S.actionLabel,S.actionIcon||u.jsx(PC,{size:16})]})]})]}),S.targetId&&L.activePlacement&&(L.activePlacement==="top"||L.activePlacement==="bottom")&&u.jsx("div",{style:{position:"absolute",[L.activePlacement==="top"?"bottom":"top"]:"-8px",left:`${L.arrowLeft}px`,transform:"translateX(-50%)",borderLeft:"8px solid transparent",borderRight:"8px solid transparent",[L.activePlacement==="top"?"borderTop":"borderBottom"]:"8px solid var(--tour-bg)",zIndex:1}})]})},o)})]})},HU=()=>{const{user:t,signIn:e,signOut:n}=Ls(),{handleUpdateLocalLesson:r,deleteLesson:i,fetchLessons:s,fetchPublicLessons:o,lessons:a,setPublicLessons:l,publicLessons:d,setLessons:h}=zC(),{toggleModal:f,setReviewLesson:p,setNoteLesson:g,showNotification:x,setActiveLesson:_,showToast:k,modals:S,setHeaderLoading:v,showHeaderNotice:w}=Do(),{queuePostTourEvent:j,endTour:L}=au(),V=async(N,b,H,he)=>{const re=(H==null?void 0:H.coins)||0;b>0&&he&&he(Math.max(0,re-b)),v(!0);const se=new Promise((U,G)=>setTimeout(()=>G(new Error("Operation timed out. Please try again.")),15e3));try{const U=async()=>{var ie,Z;if(!(t!=null&&t.uid))throw new Error("User must be logged in to add lessons.");console.log(`[AppActions] Recording ownership for "${N.title}" (${b} coins)`),await rr.purchaseLesson(t.uid,N.id,b,N.title),console.log("[AppActions] Entitlement recorded in Cloud Ledger.");let G={...N};console.log("[AppActions] Starting import for:",N.title);const M=G.questions||G.cards||[];if(G.isPublic&&M.length===0){const{getPublicFileContent:z}=await gr(()=>import("./publicDrive-e06dc611.js"),[]),Y=G.storagePath||G.driveFileId||G.id;console.log("[AppActions] Fetching full content from:",Y);const pe=await z(Y);if(pe){let _e=null;if(typeof pe=="string"){const{decryptionService:Ae}=await gr(()=>Promise.resolve().then(()=>Kp),void 0);console.log("[AppActions] Requesting server-side decryption...");const $=await((ie=pr.currentUser)==null?void 0:ie.getIdToken());if(!$)throw new Error("User must be authenticated to decrypt lessons.");const ae=G.lessonId||G.id,ke=await Ae.decryptPublicLesson(pe,ae,$);_e=Qp(ke),console.log("[AppActions] Server decryption successful. Normalized questions:",(Z=_e.questions)==null?void 0:Z.length)}else _e=pe;G={...G,..._e,isPublic:!0};const ge=G.questions||G.cards||[];if(console.log("[AppActions] Merged content. Questions count:",ge.length),ge.length===0)throw new Error("Imported lesson contains no questions.")}else throw new Error("Could not fetch lesson questions for import.")}const q=(G.questions||G.cards||[]).length,J={...G,id:Date.now().toString(),driveFileId:null,isPublic:!1,source:"local",isLocal:!0,cost:0,questionCount:q};console.log("[AppActions] Saving imported lesson as new local lesson. Questions:",q);const ee=await xr.saveLesson(J);r(J)};await Promise.race([U(),se])}catch(U){console.error("[AppActions] Import/Purchase failed:",U),b>0&&he&&he(re),x("alert",`Operation failed: ${U.message}`)}finally{v(!1)}},E=R.useCallback(async(N,b,H)=>{if(!t){j(()=>E(N,b,H)),e();return}const he=N.cost||0;if(he>0&&((b==null?void 0:b.coins)||0)<he){x("alert",`Not enough coins! You need ${he} coins.`);return}const re=()=>{V(N,he,b,H)};he>0?x("confirm",`Buy "${N.title}" for ${he} coins?`,re):re()},[t,j,e,x]),T=R.useCallback(N=>{h(H=>H.filter(he=>he.id!==N.id));let b=!1;k({message:`Deleted "${N.title}"`,type:"undo",duration:1e4,onUndo:()=>{b=!0,h(H=>[...H,N])},onClose:async()=>{if(!b)try{await i(N),t!=null&&t.uid&&N.id&&(await rr.archiveLesson(t.uid,N.id),console.log(`[AppActions] Lesson ${N.id} archived in Firestore.`))}catch(H){console.error("Delete failed:",H),h(he=>[...he,N]),x("alert",`Failed to delete: ${H.message}`)}}}),f("showAddModal",!1),p(null),g(null)},[t,i,f,p,g,h,k,x]),I=R.useCallback(async N=>{if(t&&window.confirm("Are you sure? This will delete ALL your lessons. This cannot be undone."))try{const b=a.filter(H=>H.driveFileId&&!H.isPublic);for(const H of b)await i(H);x("alert","All local data deleted."),N(),n()}catch(b){x("alert",`Cleanup partially failed: ${b.message}`)}finally{f("showMenu",!1)}},[t,a,i,n,x,f]),A=R.useCallback(async(N,b=null)=>{var re,se,U;let H=N;const he=H.questions||H.cards||[];if(H.isPublic&&!H.isLocal&&he.length===0)try{const{getPublicFileContent:G}=await gr(()=>import("./publicDrive-e06dc611.js"),[]),M=H.storagePath||H.driveFileId||H.id,D=await G(M);if(D){let q=null;if(typeof D=="string"){const{decryptionService:J}=await gr(()=>Promise.resolve().then(()=>Kp),void 0),ee=await((re=pr.currentUser)==null?void 0:re.getIdToken());if(!ee){x("alert","Please sign in to edit this lesson.");return}const ie=H.lessonId||H.id,Z=await J.decryptPublicLesson(D,ie,ee);q=Qp(Z)}else q=D;if(q&&(((se=q.questions)==null?void 0:se.length)>0||((U=q.cards)==null?void 0:U.length)>0))H={...H,...q,isPublic:!0},l(J=>J.map(ee=>ee.id===N.id?H:ee));else throw new Error("Decrypted content has no questions.")}}catch(G){console.error("[AppActions] Failed to fetch full content for edit:",G),x("alert","Failed to load lesson for editing.");return}_(H),window.history.pushState({modal:"active"},"",window.location.pathname),f("showAddModal",!0)},[t,l,_,f,x]),P=R.useCallback(async N=>{var he;if(N.isPublic&&!N.isOwned&&!N.isLocal){w("Add to My Lessons to open");return}let b=N;if((b.questions||b.cards||[]).length===0&&b.isPublic&&!b.isLocal)try{const{getPublicFileContent:re}=await gr(()=>import("./publicDrive-e06dc611.js"),[]),se=b.driveFileId||b.storagePath||b.id,U=await re(se);if(U){let G=null;if(typeof U=="string"){if(!G&&(U.startsWith("v1:")||U.length>100)){const{decryptionService:M}=await gr(()=>Promise.resolve().then(()=>Kp),void 0),D=await((he=pr.currentUser)==null?void 0:he.getIdToken());if(D){const q=b.lessonId||b.id,J=await M.decryptPublicLesson(U,q,D);G=Qp(J)}else{console.log("[AppActions] User not authenticated. Triggering sign-in..."),j(()=>P(N)),e("consent");return}}G||(G={})}else G=U;b={...b,...G}}}catch(re){console.error("[AppActions] Failed to fetch full content for review:",re),w("Add to My Lessons to open");return}b.importantNote?g(b):p(b)},[t,w,g,p,j,e]);return{handleImportLesson:E,handleDeleteLesson:T,handleDeleteAllData:I,handleEditLesson:A,handleReviewLaunch:P}},GU=()=>{const{user:t,signIn:e,signOut:n}=Ls(),{allowExit:r}=f9(!!t),{lessons:i,setLessons:s,publicLessons:o,setPublicLessons:a,loading:l,publicLoading:d,fetchLessons:h,fetchPublicLessons:f,handleUpdateLocalLesson:p}=zC(),{modals:g,toggleModal:x,activeLesson:_,setActiveLesson:k,reviewLesson:S,setReviewLesson:v,noteLesson:w,setNoteLesson:j,showNotification:L,headerLoading:V}=Do(),{isActive:E,currentStep:T,setStep:I,startTour:A,endTour:P,isDemoGracePeriod:N,setIsDemoGracePeriod:b}=au(),[H,he]=R.useState(!1),[re,se]=R.useState(null),[U,G]=R.useState(localStorage.getItem("theme")||"light"),[M,D]=R.useState("Creation Date"),[q,J]=R.useState(null),[ee,ie]=R.useState(""),[Z,z]=R.useState("my-lessons"),[Y,pe]=R.useState({standard:"",syllabus:"",medium:"",subject:""}),[_e,ge]=R.useState(localStorage.getItem("soundsEnabled")!=="false"),[Ae,$]=R.useState(!1),ae=R.useCallback(de=>L(de.type,de.message,de.onConfirm),[L]),{userProfile:ke,setUserProfile:Ge,handleUpdateCoins:Ye,loadProfile:Xe,isProfileLoading:dt}=h9(t,ae,se),{handleImportLesson:Ne,handleDeleteLesson:qe,handleDeleteAllData:Hn,handleEditLesson:Gn,handleReviewLaunch:Dn}=HU(),{performSync:Rr}=p9(),Zt=H||l,en="1.1.4";R.useEffect(()=>{const de=Oi.get("app_version");if(de&&de!==en){console.log(`[VersionControl] Upgrading to ${en}.`);const fe=Oi.get("theme"),De=Oi.get("soundsEnabled");Oi.purge(),fe&&Oi.set("theme",fe),De&&Oi.set("soundsEnabled",De),Oi.set("app_version",en),window.location.reload(!0)}else Oi.set("app_version",en)},[]),R.useEffect(()=>{document.documentElement.setAttribute("data-theme",U),localStorage.setItem("theme",U)},[U]),R.useEffect(()=>{window.location.pathname.includes("/admin")&&x("showAdminPanel",!0),f(),t?(h(),x("showMenu",!1)):s([])},[t,h,f,s,x]),R.useEffect(()=>{E&&(T===3&&z("lessons"),T===4&&z("my-lessons"),T===2&&t&&I(3))},[E,T,t,I]),R.useEffect(()=>{N&&!S&&(b(!1),I(5),z("my-lessons"))},[S,N,I,b]),R.useEffect(()=>{const de=fe=>{re?se(null):w?j(null):g.showReferral?x("showReferral",!1):g.showFeedback?x("showFeedback",!1):g.showKnowMore?x("showKnowMore",!1):g.showAdminPanel?x("showAdminPanel",!1):g.showAdminQuickTools?x("showAdminQuickTools",!1):g.showCoinModal?x("showCoinModal",!1):g.showAddModal?x("showAddModal",!1):S?Ae?(window.history.pushState({modalOpen:!0},"",window.location.pathname),L("confirm","End session?",()=>{v(null),$(!1),window.history.back()})):v(null):g.showMenu?x("showMenu",!1):t&&(!fe.state||fe.state.guard!=="active")&&(window.history.pushState({guard:"active"},"",window.location.pathname),L("confirm","Sign out and exit?",()=>{r(),n(),window.history.back()}))};return window.addEventListener("popstate",de),()=>window.removeEventListener("popstate",de)},[re,g,w,S,Ae,t,n,r,x,j,v,L]);const Pr=R.useMemo(()=>{let de=q?i.filter(fe=>fe.label===q):i;if(ee.trim()){const fe=ee.toLowerCase().trim(),De=/^\d+\.$/.test(fe);de=de.filter(nt=>{const rt=(nt.title||"").toLowerCase();return De?new RegExp(`(^|\\s)${fe.replace(".","\\.")}(\\s|$)`).test(rt):rt.includes(fe)})}return[...de].sort((fe,De)=>{if(E){if(fe.id==="demo-lesson")return-1;if(De.id==="demo-lesson")return 1}return(De.id||0)-(fe.id||0)})},[i,q,ee,E]),Ee=(ke==null?void 0:ke.unlimitedCoinsExpiry)&&new Date(ke.unlimitedCoinsExpiry).getTime()>Date.now();return u.jsxs(T9,{user:t,userProfile:ke,isUnlimited:Ee,isProfileLoading:dt,isAdmin:(t==null?void 0:t.email)===ki,isTourActive:E,onShowCoinModal:()=>{window.history.pushState({modal:"active"},"",window.location.pathname),x("showCoinModal",!0)},onShowMenu:()=>x("showMenu",!0),onAddLesson:()=>{if(!t){e("consent");return}k(null),window.history.pushState({modal:"active"},"",window.location.pathname),x("showAddModal",!0)},headerLoading:V||Zt,children:[u.jsx(w9,{activeTab:Z,setActiveTab:z,lessons:Pr,publicLessons:o,user:t,onLogin:de=>e(de||"consent"),loading:Zt,publicLoading:d,userCoins:(ke==null?void 0:ke.coins)||0,onReview:Dn,onEdit:Gn,onImport:de=>Ne(de,ke,Ye),searchQuery:ee,setSearchQuery:ie,onShowFeedback:()=>{window.history.pushState({modal:"active"},"",window.location.pathname),x("showFeedback",!0)},filters:Y,setFilters:pe,sortBy:M,onSortChange:D,filterLabel:q,onLabelChange:J,availableLabels:[...new Set(i.map(de=>de.label).filter(de=>de))],onShowKnowMore:()=>{window.history.pushState({modal:"active"},"",window.location.pathname),x("showKnowMore",!0)},onDelete:qe,showConfirm:(de,fe)=>L("confirm",de,fe),onAddLesson:()=>{k(null),window.history.pushState({modal:"active"},"",window.location.pathname),x("showAddModal",!0)},onRefresh:()=>{Z==="my-lessons"&&t?(h(),Xe()):f()}}),u.jsx(OU,{user:t,lessons:i,publicLessons:o,userProfile:ke,activeLesson:_,reviewLesson:S,noteLesson:w,theme:U,onToggleTheme:()=>G(de=>de==="light"?"dark":"light"),soundsEnabled:_e,onToggleSounds:()=>{const de=!_e;return ge(de),localStorage.setItem("soundsEnabled",de),de},onLogout:()=>{r(),n()},onDeleteData:()=>Hn(r),onShowTour:()=>{x("showMenu",!1),P(),setTimeout(()=>A(),300)},onSaveLesson:(de,fe,De)=>{p(de),(de.isPublic||De)&&f(),fe!==!1&&window.history.back()},onDeleteLesson:qe,onImportLesson:de=>Ne(de,ke,Ye),onUpdateCoins:Ye,isUnlimited:Ee,signIn:e,onReviewStart:()=>$(!0),handleEditLesson:Gn,handleReviewLaunch:Dn,activeTab:Z,fetchPublicLessons:f,fetchLessons:h,ADMIN_EMAIL:ki,APP_VERSION:en,showNotification:L,setUserProfile:Ge,refreshProfile:Xe,onRestorePurchases:()=>Rr(!0,h)}),u.jsx(qU,{userName:ke==null?void 0:ke.displayName,onLogin:()=>e("consent"),onAddLesson:()=>{k(null),window.history.pushState({modal:"active"},"",window.location.pathname),x("showAddModal",!0)},onStartDemo:()=>{const de=i.find(fe=>fe.id==="demo-lesson")||DEMO_LESSON;Dn(de),b(!0)},onGoToMyLessons:()=>{z("my-lessons"),P()}}),u.jsx(Cn,{children:re&&!E&&u.jsx(WU,{amount:re.amount,type:re.type,onClose:()=>se(null)})})]})},KU=()=>u.jsx(CC,{children:u.jsx(u9,{children:u.jsx($C,{children:u.jsx(d9,{children:u.jsx(GU,{})})})})});console.log("%c Chethan in Cardland ","background: #4f46e5; color: #fff; font-weight: bold; padding: 4px; border-radius: 4px;");console.log(`Build Version: 1.1.1 | Sync: ${new Date().toISOString()}`);Zp.createRoot(document.getElementById("root")).render(u.jsx(Ir.StrictMode,{children:u.jsx(CC,{children:u.jsx($C,{children:u.jsx(KU,{})})})}));"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(t=>{for(const e of t)console.log("Unregistering Service Worker:",e),e.unregister()});export{tz as a,qo as b,i3 as c,Qs as d,T3 as e,iz as f,_3 as g,$p as h,ez as o,v3 as q,rz as r,qu as s,nz as u,ZU as w};
